const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/browserAll-FNvS0lMR.js","assets/webworkerAll-BD5j-Ege.js","assets/colorToUniform-C2GHuDhf.js","assets/WebGPURenderer-9sWckbSG.js","assets/SharedSystems-BPkt97SZ.js","assets/WebGLRenderer--D_8BoSu.js"])))=>i.map(i=>d[i]);
var le=Object.defineProperty;var he=(P,_,C)=>_ in P?le(P,_,{enumerable:!0,configurable:!0,writable:!0,value:C}):P[_]=C;var Kt=(P,_,C)=>he(P,typeof _!="symbol"?_+"":_,C);(function(){const _=document.createElement("link").relList;if(_&&_.supports&&_.supports("modulepreload"))return;for(const T of document.querySelectorAll('link[rel="modulepreload"]'))A(T);new MutationObserver(T=>{for(const E of T)if(E.type==="childList")for(const I of E.addedNodes)I.tagName==="LINK"&&I.rel==="modulepreload"&&A(I)}).observe(document,{childList:!0,subtree:!0});function C(T){const E={};return T.integrity&&(E.integrity=T.integrity),T.referrerPolicy&&(E.referrerPolicy=T.referrerPolicy),T.crossOrigin==="use-credentials"?E.credentials="include":T.crossOrigin==="anonymous"?E.credentials="omit":E.credentials="same-origin",E}function A(T){if(T.ep)return;T.ep=!0;const E=C(T);fetch(T.href,E)}})();const scriptRel="modulepreload",assetsURL=function(P){return"/game/flappy-plane/"+P},seen={},__vitePreload=function(_,C,A){let T=Promise.resolve();if(C&&C.length>0){document.getElementsByTagName("link");const I=document.querySelector("meta[property=csp-nonce]"),F=(I==null?void 0:I.nonce)||(I==null?void 0:I.getAttribute("nonce"));T=Promise.allSettled(C.map(B=>{if(B=assetsURL(B),B in seen)return;seen[B]=!0;const G=B.endsWith(".css"),R=G?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${B}"]${R}`))return;const z=document.createElement("link");if(z.rel=G?"stylesheet":scriptRel,G||(z.as="script"),z.crossOrigin="",z.href=B,F&&z.setAttribute("nonce",F),document.head.appendChild(z),G)return new Promise((D,L)=>{z.addEventListener("load",D),z.addEventListener("error",()=>L(new Error(`Unable to preload CSS for ${B}`)))})}))}function E(I){const F=new Event("vite:preloadError",{cancelable:!0});if(F.payload=I,window.dispatchEvent(F),!F.defaultPrevented)throw I}return T.then(I=>{for(const F of I||[])F.status==="rejected"&&E(F.reason);return _().catch(E)})};var ExtensionType=(P=>(P.Application="application",P.WebGLPipes="webgl-pipes",P.WebGLPipesAdaptor="webgl-pipes-adaptor",P.WebGLSystem="webgl-system",P.WebGPUPipes="webgpu-pipes",P.WebGPUPipesAdaptor="webgpu-pipes-adaptor",P.WebGPUSystem="webgpu-system",P.CanvasSystem="canvas-system",P.CanvasPipesAdaptor="canvas-pipes-adaptor",P.CanvasPipes="canvas-pipes",P.Asset="asset",P.LoadParser="load-parser",P.ResolveParser="resolve-parser",P.CacheParser="cache-parser",P.DetectionParser="detection-parser",P.MaskEffect="mask-effect",P.BlendMode="blend-mode",P.TextureSource="texture-source",P.Environment="environment",P.ShapeBuilder="shape-builder",P.Batcher="batcher",P))(ExtensionType||{});const normalizeExtension=P=>{if(typeof P=="function"||typeof P=="object"&&P.extension){if(!P.extension)throw new Error("Extension class must have an extension object");P={...typeof P.extension!="object"?{type:P.extension}:P.extension,ref:P}}if(typeof P=="object")P={...P};else throw new Error("Invalid extension type");return typeof P.type=="string"&&(P.type=[P.type]),P},normalizeExtensionPriority=(P,_)=>normalizeExtension(P).priority??_,extensions={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...P){return P.map(normalizeExtension).forEach(_=>{_.type.forEach(C=>{var A,T;return(T=(A=this._removeHandlers)[C])==null?void 0:T.call(A,_)})}),this},add(...P){return P.map(normalizeExtension).forEach(_=>{_.type.forEach(C=>{var E,I;const A=this._addHandlers,T=this._queue;A[C]?(I=A[C])==null||I.call(A,_):(T[C]=T[C]||[],(E=T[C])==null||E.push(_))})}),this},handle(P,_,C){var I;const A=this._addHandlers,T=this._removeHandlers;if(A[P]||T[P])throw new Error(`Extension type ${P} already has a handler`);A[P]=_,T[P]=C;const E=this._queue;return E[P]&&((I=E[P])==null||I.forEach(F=>_(F)),delete E[P]),this},handleByMap(P,_){return this.handle(P,C=>{C.name&&(_[C.name]=C.ref)},C=>{C.name&&delete _[C.name]})},handleByNamedList(P,_,C=-1){return this.handle(P,A=>{_.findIndex(E=>E.name===A.name)>=0||(_.push({name:A.name,value:A.ref}),_.sort((E,I)=>normalizeExtensionPriority(I.value,C)-normalizeExtensionPriority(E.value,C)))},A=>{const T=_.findIndex(E=>E.name===A.name);T!==-1&&_.splice(T,1)})},handleByList(P,_,C=-1){return this.handle(P,A=>{_.includes(A.ref)||(_.push(A.ref),_.sort((T,E)=>normalizeExtensionPriority(E,C)-normalizeExtensionPriority(T,C)))},A=>{const T=_.indexOf(A.ref);T!==-1&&_.splice(T,1)})},mixin(P,..._){for(const C of _)Object.defineProperties(P.prototype,Object.getOwnPropertyDescriptors(C))}},browserExt={extension:{type:ExtensionType.Environment,name:"browser",priority:-1},test:()=>!0,load:async()=>{await __vitePreload(()=>import("./browserAll-FNvS0lMR.js"),__vite__mapDeps([0,1,2]))}},webworkerExt={extension:{type:ExtensionType.Environment,name:"webworker",priority:0},test:()=>typeof self<"u"&&self.WorkerGlobalScope!==void 0,load:async()=>{await __vitePreload(()=>import("./webworkerAll-BD5j-Ege.js"),__vite__mapDeps([1,2]))}};class ObservablePoint{constructor(_,C,A){this._x=C||0,this._y=A||0,this._observer=_}clone(_){return new ObservablePoint(_??this._observer,this._x,this._y)}set(_=0,C=_){return(this._x!==_||this._y!==C)&&(this._x=_,this._y=C,this._observer._onUpdate(this)),this}copyFrom(_){return(this._x!==_.x||this._y!==_.y)&&(this._x=_.x,this._y=_.y,this._observer._onUpdate(this)),this}copyTo(_){return _.set(this._x,this._y),_}equals(_){return _.x===this._x&&_.y===this._y}toString(){return`[pixi.js/math:ObservablePoint x=0 y=0 scope=${this._observer}]`}get x(){return this._x}set x(_){this._x!==_&&(this._x=_,this._observer._onUpdate(this))}get y(){return this._y}set y(_){this._y!==_&&(this._y=_,this._observer._onUpdate(this))}}var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(P){return P&&P.__esModule&&Object.prototype.hasOwnProperty.call(P,"default")?P.default:P}var eventemitter3={exports:{}},hasRequiredEventemitter3;function requireEventemitter3(){return hasRequiredEventemitter3||(hasRequiredEventemitter3=1,function(P){var _=Object.prototype.hasOwnProperty,C="~";function A(){}Object.create&&(A.prototype=Object.create(null),new A().__proto__||(C=!1));function T(B,G,R){this.fn=B,this.context=G,this.once=R||!1}function E(B,G,R,z,D){if(typeof R!="function")throw new TypeError("The listener must be a function");var L=new T(R,z||B,D),O=C?C+G:G;return B._events[O]?B._events[O].fn?B._events[O]=[B._events[O],L]:B._events[O].push(L):(B._events[O]=L,B._eventsCount++),B}function I(B,G){--B._eventsCount===0?B._events=new A:delete B._events[G]}function F(){this._events=new A,this._eventsCount=0}F.prototype.eventNames=function(){var G=[],R,z;if(this._eventsCount===0)return G;for(z in R=this._events)_.call(R,z)&&G.push(C?z.slice(1):z);return Object.getOwnPropertySymbols?G.concat(Object.getOwnPropertySymbols(R)):G},F.prototype.listeners=function(G){var R=C?C+G:G,z=this._events[R];if(!z)return[];if(z.fn)return[z.fn];for(var D=0,L=z.length,O=new Array(L);D<L;D++)O[D]=z[D].fn;return O},F.prototype.listenerCount=function(G){var R=C?C+G:G,z=this._events[R];return z?z.fn?1:z.length:0},F.prototype.emit=function(G,R,z,D,L,O){var V=C?C+G:G;if(!this._events[V])return!1;var U=this._events[V],W=arguments.length,X,Y;if(U.fn){switch(U.once&&this.removeListener(G,U.fn,void 0,!0),W){case 1:return U.fn.call(U.context),!0;case 2:return U.fn.call(U.context,R),!0;case 3:return U.fn.call(U.context,R,z),!0;case 4:return U.fn.call(U.context,R,z,D),!0;case 5:return U.fn.call(U.context,R,z,D,L),!0;case 6:return U.fn.call(U.context,R,z,D,L,O),!0}for(Y=1,X=new Array(W-1);Y<W;Y++)X[Y-1]=arguments[Y];U.fn.apply(U.context,X)}else{var K=U.length,q;for(Y=0;Y<K;Y++)switch(U[Y].once&&this.removeListener(G,U[Y].fn,void 0,!0),W){case 1:U[Y].fn.call(U[Y].context);break;case 2:U[Y].fn.call(U[Y].context,R);break;case 3:U[Y].fn.call(U[Y].context,R,z);break;case 4:U[Y].fn.call(U[Y].context,R,z,D);break;default:if(!X)for(q=1,X=new Array(W-1);q<W;q++)X[q-1]=arguments[q];U[Y].fn.apply(U[Y].context,X)}}return!0},F.prototype.on=function(G,R,z){return E(this,G,R,z,!1)},F.prototype.once=function(G,R,z){return E(this,G,R,z,!0)},F.prototype.removeListener=function(G,R,z,D){var L=C?C+G:G;if(!this._events[L])return this;if(!R)return I(this,L),this;var O=this._events[L];if(O.fn)O.fn===R&&(!D||O.once)&&(!z||O.context===z)&&I(this,L);else{for(var V=0,U=[],W=O.length;V<W;V++)(O[V].fn!==R||D&&!O[V].once||z&&O[V].context!==z)&&U.push(O[V]);U.length?this._events[L]=U.length===1?U[0]:U:I(this,L)}return this},F.prototype.removeAllListeners=function(G){var R;return G?(R=C?C+G:G,this._events[R]&&I(this,R)):(this._events=new A,this._eventsCount=0),this},F.prototype.off=F.prototype.removeListener,F.prototype.addListener=F.prototype.on,F.prefixed=C,F.EventEmitter=F,P.exports=F}(eventemitter3)),eventemitter3.exports}var eventemitter3Exports=requireEventemitter3();const EventEmitter=getDefaultExportFromCjs(eventemitter3Exports),PI_2=Math.PI*2,RAD_TO_DEG=180/Math.PI,DEG_TO_RAD=Math.PI/180;class Point{constructor(_=0,C=0){this.x=0,this.y=0,this.x=_,this.y=C}clone(){return new Point(this.x,this.y)}copyFrom(_){return this.set(_.x,_.y),this}copyTo(_){return _.set(this.x,this.y),_}equals(_){return _.x===this.x&&_.y===this.y}set(_=0,C=_){return this.x=_,this.y=C,this}toString(){return`[pixi.js/math:Point x=${this.x} y=${this.y}]`}static get shared(){return tempPoint.x=0,tempPoint.y=0,tempPoint}}const tempPoint=new Point;class Matrix{constructor(_=1,C=0,A=0,T=1,E=0,I=0){this.array=null,this.a=_,this.b=C,this.c=A,this.d=T,this.tx=E,this.ty=I}fromArray(_){this.a=_[0],this.b=_[1],this.c=_[3],this.d=_[4],this.tx=_[2],this.ty=_[5]}set(_,C,A,T,E,I){return this.a=_,this.b=C,this.c=A,this.d=T,this.tx=E,this.ty=I,this}toArray(_,C){this.array||(this.array=new Float32Array(9));const A=C||this.array;return _?(A[0]=this.a,A[1]=this.b,A[2]=0,A[3]=this.c,A[4]=this.d,A[5]=0,A[6]=this.tx,A[7]=this.ty,A[8]=1):(A[0]=this.a,A[1]=this.c,A[2]=this.tx,A[3]=this.b,A[4]=this.d,A[5]=this.ty,A[6]=0,A[7]=0,A[8]=1),A}apply(_,C){C=C||new Point;const A=_.x,T=_.y;return C.x=this.a*A+this.c*T+this.tx,C.y=this.b*A+this.d*T+this.ty,C}applyInverse(_,C){C=C||new Point;const A=this.a,T=this.b,E=this.c,I=this.d,F=this.tx,B=this.ty,G=1/(A*I+E*-T),R=_.x,z=_.y;return C.x=I*G*R+-E*G*z+(B*E-F*I)*G,C.y=A*G*z+-T*G*R+(-B*A+F*T)*G,C}translate(_,C){return this.tx+=_,this.ty+=C,this}scale(_,C){return this.a*=_,this.d*=C,this.c*=_,this.b*=C,this.tx*=_,this.ty*=C,this}rotate(_){const C=Math.cos(_),A=Math.sin(_),T=this.a,E=this.c,I=this.tx;return this.a=T*C-this.b*A,this.b=T*A+this.b*C,this.c=E*C-this.d*A,this.d=E*A+this.d*C,this.tx=I*C-this.ty*A,this.ty=I*A+this.ty*C,this}append(_){const C=this.a,A=this.b,T=this.c,E=this.d;return this.a=_.a*C+_.b*T,this.b=_.a*A+_.b*E,this.c=_.c*C+_.d*T,this.d=_.c*A+_.d*E,this.tx=_.tx*C+_.ty*T+this.tx,this.ty=_.tx*A+_.ty*E+this.ty,this}appendFrom(_,C){const A=_.a,T=_.b,E=_.c,I=_.d,F=_.tx,B=_.ty,G=C.a,R=C.b,z=C.c,D=C.d;return this.a=A*G+T*z,this.b=A*R+T*D,this.c=E*G+I*z,this.d=E*R+I*D,this.tx=F*G+B*z+C.tx,this.ty=F*R+B*D+C.ty,this}setTransform(_,C,A,T,E,I,F,B,G){return this.a=Math.cos(F+G)*E,this.b=Math.sin(F+G)*E,this.c=-Math.sin(F-B)*I,this.d=Math.cos(F-B)*I,this.tx=_-(A*this.a+T*this.c),this.ty=C-(A*this.b+T*this.d),this}prepend(_){const C=this.tx;if(_.a!==1||_.b!==0||_.c!==0||_.d!==1){const A=this.a,T=this.c;this.a=A*_.a+this.b*_.c,this.b=A*_.b+this.b*_.d,this.c=T*_.a+this.d*_.c,this.d=T*_.b+this.d*_.d}return this.tx=C*_.a+this.ty*_.c+_.tx,this.ty=C*_.b+this.ty*_.d+_.ty,this}decompose(_){const C=this.a,A=this.b,T=this.c,E=this.d,I=_.pivot,F=-Math.atan2(-T,E),B=Math.atan2(A,C),G=Math.abs(F+B);return G<1e-5||Math.abs(PI_2-G)<1e-5?(_.rotation=B,_.skew.x=_.skew.y=0):(_.rotation=0,_.skew.x=F,_.skew.y=B),_.scale.x=Math.sqrt(C*C+A*A),_.scale.y=Math.sqrt(T*T+E*E),_.position.x=this.tx+(I.x*C+I.y*T),_.position.y=this.ty+(I.x*A+I.y*E),_}invert(){const _=this.a,C=this.b,A=this.c,T=this.d,E=this.tx,I=_*T-C*A;return this.a=T/I,this.b=-C/I,this.c=-A/I,this.d=_/I,this.tx=(A*this.ty-T*E)/I,this.ty=-(_*this.ty-C*E)/I,this}isIdentity(){return this.a===1&&this.b===0&&this.c===0&&this.d===1&&this.tx===0&&this.ty===0}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const _=new Matrix;return _.a=this.a,_.b=this.b,_.c=this.c,_.d=this.d,_.tx=this.tx,_.ty=this.ty,_}copyTo(_){return _.a=this.a,_.b=this.b,_.c=this.c,_.d=this.d,_.tx=this.tx,_.ty=this.ty,_}copyFrom(_){return this.a=_.a,this.b=_.b,this.c=_.c,this.d=_.d,this.tx=_.tx,this.ty=_.ty,this}equals(_){return _.a===this.a&&_.b===this.b&&_.c===this.c&&_.d===this.d&&_.tx===this.tx&&_.ty===this.ty}toString(){return`[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return identityMatrix$1.identity()}static get shared(){return tempMatrix$3.identity()}}const tempMatrix$3=new Matrix,identityMatrix$1=new Matrix,ux=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],uy=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],vx=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],vy=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],rotationCayley=[],rotationMatrices=[],signum=Math.sign;function init(){for(let P=0;P<16;P++){const _=[];rotationCayley.push(_);for(let C=0;C<16;C++){const A=signum(ux[P]*ux[C]+vx[P]*uy[C]),T=signum(uy[P]*ux[C]+vy[P]*uy[C]),E=signum(ux[P]*vx[C]+vx[P]*vy[C]),I=signum(uy[P]*vx[C]+vy[P]*vy[C]);for(let F=0;F<16;F++)if(ux[F]===A&&uy[F]===T&&vx[F]===E&&vy[F]===I){_.push(F);break}}}for(let P=0;P<16;P++){const _=new Matrix;_.set(ux[P],uy[P],vx[P],vy[P],0,0),rotationMatrices.push(_)}}init();const groupD8={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:P=>ux[P],uY:P=>uy[P],vX:P=>vx[P],vY:P=>vy[P],inv:P=>P&8?P&15:-P&7,add:(P,_)=>rotationCayley[P][_],sub:(P,_)=>rotationCayley[P][groupD8.inv(_)],rotate180:P=>P^4,isVertical:P=>(P&3)===2,byDirection:(P,_)=>Math.abs(P)*2<=Math.abs(_)?_>=0?groupD8.S:groupD8.N:Math.abs(_)*2<=Math.abs(P)?P>0?groupD8.E:groupD8.W:_>0?P>0?groupD8.SE:groupD8.SW:P>0?groupD8.NE:groupD8.NW,matrixAppendRotationInv:(P,_,C=0,A=0)=>{const T=rotationMatrices[groupD8.inv(_)];T.tx=C,T.ty=A,P.append(T)}},tempPoints=[new Point,new Point,new Point,new Point];class Rectangle{constructor(_=0,C=0,A=0,T=0){this.type="rectangle",this.x=Number(_),this.y=Number(C),this.width=Number(A),this.height=Number(T)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}isEmpty(){return this.left===this.right||this.top===this.bottom}static get EMPTY(){return new Rectangle(0,0,0,0)}clone(){return new Rectangle(this.x,this.y,this.width,this.height)}copyFromBounds(_){return this.x=_.minX,this.y=_.minY,this.width=_.maxX-_.minX,this.height=_.maxY-_.minY,this}copyFrom(_){return this.x=_.x,this.y=_.y,this.width=_.width,this.height=_.height,this}copyTo(_){return _.copyFrom(this),_}contains(_,C){return this.width<=0||this.height<=0?!1:_>=this.x&&_<this.x+this.width&&C>=this.y&&C<this.y+this.height}strokeContains(_,C,A,T=.5){const{width:E,height:I}=this;if(E<=0||I<=0)return!1;const F=this.x,B=this.y,G=A*(1-T),R=A-G,z=F-G,D=F+E+G,L=B-G,O=B+I+G,V=F+R,U=F+E-R,W=B+R,X=B+I-R;return _>=z&&_<=D&&C>=L&&C<=O&&!(_>V&&_<U&&C>W&&C<X)}intersects(_,C){if(!C){const rt=this.x<_.x?_.x:this.x;if((this.right>_.right?_.right:this.right)<=rt)return!1;const nt=this.y<_.y?_.y:this.y;return(this.bottom>_.bottom?_.bottom:this.bottom)>nt}const A=this.left,T=this.right,E=this.top,I=this.bottom;if(T<=A||I<=E)return!1;const F=tempPoints[0].set(_.left,_.top),B=tempPoints[1].set(_.left,_.bottom),G=tempPoints[2].set(_.right,_.top),R=tempPoints[3].set(_.right,_.bottom);if(G.x<=F.x||B.y<=F.y)return!1;const z=Math.sign(C.a*C.d-C.b*C.c);if(z===0||(C.apply(F,F),C.apply(B,B),C.apply(G,G),C.apply(R,R),Math.max(F.x,B.x,G.x,R.x)<=A||Math.min(F.x,B.x,G.x,R.x)>=T||Math.max(F.y,B.y,G.y,R.y)<=E||Math.min(F.y,B.y,G.y,R.y)>=I))return!1;const D=z*(B.y-F.y),L=z*(F.x-B.x),O=D*A+L*E,V=D*T+L*E,U=D*A+L*I,W=D*T+L*I;if(Math.max(O,V,U,W)<=D*F.x+L*F.y||Math.min(O,V,U,W)>=D*R.x+L*R.y)return!1;const X=z*(F.y-G.y),Y=z*(G.x-F.x),K=X*A+Y*E,q=X*T+Y*E,J=X*A+Y*I,tt=X*T+Y*I;return!(Math.max(K,q,J,tt)<=X*F.x+Y*F.y||Math.min(K,q,J,tt)>=X*R.x+Y*R.y)}pad(_=0,C=_){return this.x-=_,this.y-=C,this.width+=_*2,this.height+=C*2,this}fit(_){const C=Math.max(this.x,_.x),A=Math.min(this.x+this.width,_.x+_.width),T=Math.max(this.y,_.y),E=Math.min(this.y+this.height,_.y+_.height);return this.x=C,this.width=Math.max(A-C,0),this.y=T,this.height=Math.max(E-T,0),this}ceil(_=1,C=.001){const A=Math.ceil((this.x+this.width-C)*_)/_,T=Math.ceil((this.y+this.height-C)*_)/_;return this.x=Math.floor((this.x+C)*_)/_,this.y=Math.floor((this.y+C)*_)/_,this.width=A-this.x,this.height=T-this.y,this}enlarge(_){const C=Math.min(this.x,_.x),A=Math.max(this.x+this.width,_.x+_.width),T=Math.min(this.y,_.y),E=Math.max(this.y+this.height,_.y+_.height);return this.x=C,this.width=A-C,this.y=T,this.height=E-T,this}getBounds(_){return _||(_=new Rectangle),_.copyFrom(this),_}containsRect(_){if(this.width<=0||this.height<=0)return!1;const C=_.x,A=_.y,T=_.x+_.width,E=_.y+_.height;return C>=this.x&&C<this.x+this.width&&A>=this.y&&A<this.y+this.height&&T>=this.x&&T<this.x+this.width&&E>=this.y&&E<this.y+this.height}toString(){return`[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}const uidCache={default:-1};function uid(P="default"){return uidCache[P]===void 0&&(uidCache[P]=-1),++uidCache[P]}const warnings={},v8_0_0="8.0.0",v8_3_4="8.3.4";function deprecation(P,_,C=3){if(warnings[_])return;let A=new Error().stack;typeof A>"u"?console.warn("PixiJS Deprecation Warning: ",`${_}
Deprecated since v${P}`):(A=A.split(`
`).splice(C).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${_}
Deprecated since v${P}`),console.warn(A),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${_}
Deprecated since v${P}`),console.warn(A))),warnings[_]=!0}const NOOP=()=>{};function nextPow2(P){return P+=P===0?1:0,--P,P|=P>>>1,P|=P>>>2,P|=P>>>4,P|=P>>>8,P|=P>>>16,P+1}function isPow2(P){return!(P&P-1)&&!!P}function definedProps(P){const _={};for(const C in P)P[C]!==void 0&&(_[C]=P[C]);return _}const idHash$1=Object.create(null);function createResourceIdFromString(P){const _=idHash$1[P];return _===void 0&&(idHash$1[P]=uid("resource")),_}const _TextureStyle=class ee extends EventEmitter{constructor(_={}){super(),this._resourceType="textureSampler",this._touched=0,this._maxAnisotropy=1,this.destroyed=!1,_={...ee.defaultOptions,..._},this.addressMode=_.addressMode,this.addressModeU=_.addressModeU??this.addressModeU,this.addressModeV=_.addressModeV??this.addressModeV,this.addressModeW=_.addressModeW??this.addressModeW,this.scaleMode=_.scaleMode,this.magFilter=_.magFilter??this.magFilter,this.minFilter=_.minFilter??this.minFilter,this.mipmapFilter=_.mipmapFilter??this.mipmapFilter,this.lodMinClamp=_.lodMinClamp,this.lodMaxClamp=_.lodMaxClamp,this.compare=_.compare,this.maxAnisotropy=_.maxAnisotropy??1}set addressMode(_){this.addressModeU=_,this.addressModeV=_,this.addressModeW=_}get addressMode(){return this.addressModeU}set wrapMode(_){deprecation(v8_0_0,"TextureStyle.wrapMode is now TextureStyle.addressMode"),this.addressMode=_}get wrapMode(){return this.addressMode}set scaleMode(_){this.magFilter=_,this.minFilter=_,this.mipmapFilter=_}get scaleMode(){return this.magFilter}set maxAnisotropy(_){this._maxAnisotropy=Math.min(_,16),this._maxAnisotropy>1&&(this.scaleMode="linear")}get maxAnisotropy(){return this._maxAnisotropy}get _resourceId(){return this._sharedResourceId||this._generateResourceId()}update(){this.emit("change",this),this._sharedResourceId=null}_generateResourceId(){const _=`${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;return this._sharedResourceId=createResourceIdFromString(_),this._resourceId}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this.removeAllListeners()}};_TextureStyle.defaultOptions={addressMode:"clamp-to-edge",scaleMode:"linear"};let TextureStyle=_TextureStyle;const _TextureSource=class re extends EventEmitter{constructor(_={}){super(),this.options=_,this.uid=uid("textureSource"),this._resourceType="textureSource",this._resourceId=uid("resource"),this.uploadMethodId="unknown",this._resolution=1,this.pixelWidth=1,this.pixelHeight=1,this.width=1,this.height=1,this.sampleCount=1,this.mipLevelCount=1,this.autoGenerateMipmaps=!1,this.format="rgba8unorm",this.dimension="2d",this.antialias=!1,this._touched=0,this._batchTick=-1,this._textureBindLocation=-1,_={...re.defaultOptions,..._},this.label=_.label??"",this.resource=_.resource,this.autoGarbageCollect=_.autoGarbageCollect,this._resolution=_.resolution,_.width?this.pixelWidth=_.width*this._resolution:this.pixelWidth=this.resource?this.resourceWidth??1:1,_.height?this.pixelHeight=_.height*this._resolution:this.pixelHeight=this.resource?this.resourceHeight??1:1,this.width=this.pixelWidth/this._resolution,this.height=this.pixelHeight/this._resolution,this.format=_.format,this.dimension=_.dimensions,this.mipLevelCount=_.mipLevelCount,this.autoGenerateMipmaps=_.autoGenerateMipmaps,this.sampleCount=_.sampleCount,this.antialias=_.antialias,this.alphaMode=_.alphaMode,this.style=new TextureStyle(definedProps(_)),this.destroyed=!1,this._refreshPOT()}get source(){return this}get style(){return this._style}set style(_){var C,A;this.style!==_&&((C=this._style)==null||C.off("change",this._onStyleChange,this),this._style=_,(A=this._style)==null||A.on("change",this._onStyleChange,this),this._onStyleChange())}get addressMode(){return this._style.addressMode}set addressMode(_){this._style.addressMode=_}get repeatMode(){return this._style.addressMode}set repeatMode(_){this._style.addressMode=_}get magFilter(){return this._style.magFilter}set magFilter(_){this._style.magFilter=_}get minFilter(){return this._style.minFilter}set minFilter(_){this._style.minFilter=_}get mipmapFilter(){return this._style.mipmapFilter}set mipmapFilter(_){this._style.mipmapFilter=_}get lodMinClamp(){return this._style.lodMinClamp}set lodMinClamp(_){this._style.lodMinClamp=_}get lodMaxClamp(){return this._style.lodMaxClamp}set lodMaxClamp(_){this._style.lodMaxClamp=_}_onStyleChange(){this.emit("styleChange",this)}update(){if(this.resource){const _=this._resolution;if(this.resize(this.resourceWidth/_,this.resourceHeight/_))return}this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._style&&(this._style.destroy(),this._style=null),this.uploadMethodId=null,this.resource=null,this.removeAllListeners()}unload(){this._resourceId=uid("resource"),this.emit("change",this),this.emit("unload",this)}get resourceWidth(){const{resource:_}=this;return _.naturalWidth||_.videoWidth||_.displayWidth||_.width}get resourceHeight(){const{resource:_}=this;return _.naturalHeight||_.videoHeight||_.displayHeight||_.height}get resolution(){return this._resolution}set resolution(_){this._resolution!==_&&(this._resolution=_,this.width=this.pixelWidth/_,this.height=this.pixelHeight/_)}resize(_,C,A){A||(A=this._resolution),_||(_=this.width),C||(C=this.height);const T=Math.round(_*A),E=Math.round(C*A);return this.width=T/A,this.height=E/A,this._resolution=A,this.pixelWidth===T&&this.pixelHeight===E?!1:(this._refreshPOT(),this.pixelWidth=T,this.pixelHeight=E,this.emit("resize",this),this._resourceId=uid("resource"),this.emit("change",this),!0)}updateMipmaps(){this.autoGenerateMipmaps&&this.mipLevelCount>1&&this.emit("updateMipmaps",this)}set wrapMode(_){this._style.wrapMode=_}get wrapMode(){return this._style.wrapMode}set scaleMode(_){this._style.scaleMode=_}get scaleMode(){return this._style.scaleMode}_refreshPOT(){this.isPowerOfTwo=isPow2(this.pixelWidth)&&isPow2(this.pixelHeight)}static test(_){throw new Error("Unimplemented")}};_TextureSource.defaultOptions={resolution:1,format:"bgra8unorm",alphaMode:"premultiply-alpha-on-upload",dimensions:"2d",mipLevelCount:1,autoGenerateMipmaps:!1,sampleCount:1,antialias:!1,autoGarbageCollect:!1};let TextureSource=_TextureSource;class BufferImageSource extends TextureSource{constructor(_){const C=_.resource||new Float32Array(_.width*_.height*4);let A=_.format;A||(C instanceof Float32Array?A="rgba32float":C instanceof Int32Array||C instanceof Uint32Array?A="rgba32uint":C instanceof Int16Array||C instanceof Uint16Array?A="rgba16uint":(C instanceof Int8Array,A="bgra8unorm")),super({..._,resource:C,format:A}),this.uploadMethodId="buffer"}static test(_){return _ instanceof Int8Array||_ instanceof Uint8Array||_ instanceof Uint8ClampedArray||_ instanceof Int16Array||_ instanceof Uint16Array||_ instanceof Int32Array||_ instanceof Uint32Array||_ instanceof Float32Array}}BufferImageSource.extension=ExtensionType.TextureSource;const tempMat=new Matrix;class TextureMatrix{constructor(_,C){this.mapCoord=new Matrix,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,typeof C>"u"?this.clampMargin=_.width<10?0:.5:this.clampMargin=C,this.isSimple=!1,this.texture=_}get texture(){return this._texture}set texture(_){var C;this.texture!==_&&((C=this._texture)==null||C.removeListener("update",this.update,this),this._texture=_,this._texture.addListener("update",this.update,this),this.update())}multiplyUvs(_,C){C===void 0&&(C=_);const A=this.mapCoord;for(let T=0;T<_.length;T+=2){const E=_[T],I=_[T+1];C[T]=E*A.a+I*A.c+A.tx,C[T+1]=E*A.b+I*A.d+A.ty}return C}update(){const _=this._texture;this._updateID++;const C=_.uvs;this.mapCoord.set(C.x1-C.x0,C.y1-C.y0,C.x3-C.x0,C.y3-C.y0,C.x0,C.y0);const A=_.orig,T=_.trim;T&&(tempMat.set(A.width/T.width,0,0,A.height/T.height,-T.x/T.width,-T.y/T.height),this.mapCoord.append(tempMat));const E=_.source,I=this.uClampFrame,F=this.clampMargin/E._resolution,B=this.clampOffset/E._resolution;return I[0]=(_.frame.x+F+B)/E.width,I[1]=(_.frame.y+F+B)/E.height,I[2]=(_.frame.x+_.frame.width-F+B)/E.width,I[3]=(_.frame.y+_.frame.height-F+B)/E.height,this.uClampOffset[0]=this.clampOffset/E.pixelWidth,this.uClampOffset[1]=this.clampOffset/E.pixelHeight,this.isSimple=_.frame.width===E.width&&_.frame.height===E.height&&_.rotate===0,!0}}class Texture extends EventEmitter{constructor({source:_,label:C,frame:A,orig:T,trim:E,defaultAnchor:I,defaultBorders:F,rotate:B,dynamic:G}={}){if(super(),this.uid=uid("texture"),this.uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},this.frame=new Rectangle,this.noFrame=!1,this.dynamic=!1,this.isTexture=!0,this.label=C,this.source=(_==null?void 0:_.source)??new TextureSource,this.noFrame=!A,A)this.frame.copyFrom(A);else{const{width:R,height:z}=this._source;this.frame.width=R,this.frame.height=z}this.orig=T||this.frame,this.trim=E,this.rotate=B??0,this.defaultAnchor=I,this.defaultBorders=F,this.destroyed=!1,this.dynamic=G||!1,this.updateUvs()}set source(_){this._source&&this._source.off("resize",this.update,this),this._source=_,_.on("resize",this.update,this),this.emit("update",this)}get source(){return this._source}get textureMatrix(){return this._textureMatrix||(this._textureMatrix=new TextureMatrix(this)),this._textureMatrix}get width(){return this.orig.width}get height(){return this.orig.height}updateUvs(){const{uvs:_,frame:C}=this,{width:A,height:T}=this._source,E=C.x/A,I=C.y/T,F=C.width/A,B=C.height/T;let G=this.rotate;if(G){const R=F/2,z=B/2,D=E+R,L=I+z;G=groupD8.add(G,groupD8.NW),_.x0=D+R*groupD8.uX(G),_.y0=L+z*groupD8.uY(G),G=groupD8.add(G,2),_.x1=D+R*groupD8.uX(G),_.y1=L+z*groupD8.uY(G),G=groupD8.add(G,2),_.x2=D+R*groupD8.uX(G),_.y2=L+z*groupD8.uY(G),G=groupD8.add(G,2),_.x3=D+R*groupD8.uX(G),_.y3=L+z*groupD8.uY(G)}else _.x0=E,_.y0=I,_.x1=E+F,_.y1=I,_.x2=E+F,_.y2=I+B,_.x3=E,_.y3=I+B}destroy(_=!1){this._source&&_&&(this._source.destroy(),this._source=null),this._textureMatrix=null,this.destroyed=!0,this.emit("destroy",this),this.removeAllListeners()}update(){this.noFrame&&(this.frame.width=this._source.width,this.frame.height=this._source.height),this.updateUvs(),this.emit("update",this)}get baseTexture(){return deprecation(v8_0_0,"Texture.baseTexture is now Texture.source"),this._source}}Texture.EMPTY=new Texture({label:"EMPTY",source:new TextureSource({label:"EMPTY"})});Texture.EMPTY.destroy=NOOP;Texture.WHITE=new Texture({source:new BufferImageSource({resource:new Uint8Array([255,255,255,255]),width:1,height:1,alphaMode:"premultiply-alpha-on-upload",label:"WHITE"}),label:"WHITE"});Texture.WHITE.destroy=NOOP;function updateQuadBounds(P,_,C){const{width:A,height:T}=C.orig,E=C.trim;if(E){const I=E.width,F=E.height;P.minX=E.x-_._x*A,P.maxX=P.minX+I,P.minY=E.y-_._y*T,P.maxY=P.minY+F}else P.minX=-_._x*A,P.maxX=P.minX+A,P.minY=-_._y*T,P.maxY=P.minY+T}const defaultMatrix=new Matrix;class Bounds{constructor(_=1/0,C=1/0,A=-1/0,T=-1/0){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=defaultMatrix,this.minX=_,this.minY=C,this.maxX=A,this.maxY=T}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}get rectangle(){this._rectangle||(this._rectangle=new Rectangle);const _=this._rectangle;return this.minX>this.maxX||this.minY>this.maxY?(_.x=0,_.y=0,_.width=0,_.height=0):_.copyFromBounds(this),_}clear(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=defaultMatrix,this}set(_,C,A,T){this.minX=_,this.minY=C,this.maxX=A,this.maxY=T}addFrame(_,C,A,T,E){E||(E=this.matrix);const I=E.a,F=E.b,B=E.c,G=E.d,R=E.tx,z=E.ty;let D=this.minX,L=this.minY,O=this.maxX,V=this.maxY,U=I*_+B*C+R,W=F*_+G*C+z;U<D&&(D=U),W<L&&(L=W),U>O&&(O=U),W>V&&(V=W),U=I*A+B*C+R,W=F*A+G*C+z,U<D&&(D=U),W<L&&(L=W),U>O&&(O=U),W>V&&(V=W),U=I*_+B*T+R,W=F*_+G*T+z,U<D&&(D=U),W<L&&(L=W),U>O&&(O=U),W>V&&(V=W),U=I*A+B*T+R,W=F*A+G*T+z,U<D&&(D=U),W<L&&(L=W),U>O&&(O=U),W>V&&(V=W),this.minX=D,this.minY=L,this.maxX=O,this.maxY=V}addRect(_,C){this.addFrame(_.x,_.y,_.x+_.width,_.y+_.height,C)}addBounds(_,C){this.addFrame(_.minX,_.minY,_.maxX,_.maxY,C)}addBoundsMask(_){this.minX=this.minX>_.minX?this.minX:_.minX,this.minY=this.minY>_.minY?this.minY:_.minY,this.maxX=this.maxX<_.maxX?this.maxX:_.maxX,this.maxY=this.maxY<_.maxY?this.maxY:_.maxY}applyMatrix(_){const C=this.minX,A=this.minY,T=this.maxX,E=this.maxY,{a:I,b:F,c:B,d:G,tx:R,ty:z}=_;let D=I*C+B*A+R,L=F*C+G*A+z;this.minX=D,this.minY=L,this.maxX=D,this.maxY=L,D=I*T+B*A+R,L=F*T+G*A+z,this.minX=D<this.minX?D:this.minX,this.minY=L<this.minY?L:this.minY,this.maxX=D>this.maxX?D:this.maxX,this.maxY=L>this.maxY?L:this.maxY,D=I*C+B*E+R,L=F*C+G*E+z,this.minX=D<this.minX?D:this.minX,this.minY=L<this.minY?L:this.minY,this.maxX=D>this.maxX?D:this.maxX,this.maxY=L>this.maxY?L:this.maxY,D=I*T+B*E+R,L=F*T+G*E+z,this.minX=D<this.minX?D:this.minX,this.minY=L<this.minY?L:this.minY,this.maxX=D>this.maxX?D:this.maxX,this.maxY=L>this.maxY?L:this.maxY}fit(_){return this.minX<_.left&&(this.minX=_.left),this.maxX>_.right&&(this.maxX=_.right),this.minY<_.top&&(this.minY=_.top),this.maxY>_.bottom&&(this.maxY=_.bottom),this}fitBounds(_,C,A,T){return this.minX<_&&(this.minX=_),this.maxX>C&&(this.maxX=C),this.minY<A&&(this.minY=A),this.maxY>T&&(this.maxY=T),this}pad(_,C=_){return this.minX-=_,this.maxX+=_,this.minY-=C,this.maxY+=C,this}ceil(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}clone(){return new Bounds(this.minX,this.minY,this.maxX,this.maxY)}scale(_,C=_){return this.minX*=_,this.minY*=C,this.maxX*=_,this.maxY*=C,this}get x(){return this.minX}set x(_){const C=this.maxX-this.minX;this.minX=_,this.maxX=_+C}get y(){return this.minY}set y(_){const C=this.maxY-this.minY;this.minY=_,this.maxY=_+C}get width(){return this.maxX-this.minX}set width(_){this.maxX=this.minX+_}get height(){return this.maxY-this.minY}set height(_){this.maxY=this.minY+_}get left(){return this.minX}get right(){return this.maxX}get top(){return this.minY}get bottom(){return this.maxY}get isPositive(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}get isValid(){return this.minX+this.minY!==1/0}addVertexData(_,C,A,T){let E=this.minX,I=this.minY,F=this.maxX,B=this.maxY;T||(T=this.matrix);const G=T.a,R=T.b,z=T.c,D=T.d,L=T.tx,O=T.ty;for(let V=C;V<A;V+=2){const U=_[V],W=_[V+1],X=G*U+z*W+L,Y=R*U+D*W+O;E=X<E?X:E,I=Y<I?Y:I,F=X>F?X:F,B=Y>B?Y:B}this.minX=E,this.minY=I,this.maxX=F,this.maxY=B}containsPoint(_,C){return this.minX<=_&&this.minY<=C&&this.maxX>=_&&this.maxY>=C}toString(){return`[pixi.js:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`}copyFrom(_){return this.minX=_.minX,this.minY=_.minY,this.maxX=_.maxX,this.maxY=_.maxY,this}}var r={grad:.9,turn:360,rad:360/(2*Math.PI)},t=function(P){return typeof P=="string"?P.length>0:typeof P=="number"},n=function(P,_,C){return _===void 0&&(_=0),C===void 0&&(C=Math.pow(10,_)),Math.round(C*P)/C+0},e=function(P,_,C){return _===void 0&&(_=0),C===void 0&&(C=1),P>C?C:P>_?P:_},u=function(P){return(P=isFinite(P)?P%360:0)>0?P:P+360},a=function(P){return{r:e(P.r,0,255),g:e(P.g,0,255),b:e(P.b,0,255),a:e(P.a)}},o=function(P){return{r:n(P.r),g:n(P.g),b:n(P.b),a:n(P.a,3)}},i=/^#([0-9a-f]{3,8})$/i,s=function(P){var _=P.toString(16);return _.length<2?"0"+_:_},h=function(P){var _=P.r,C=P.g,A=P.b,T=P.a,E=Math.max(_,C,A),I=E-Math.min(_,C,A),F=I?E===_?(C-A)/I:E===C?2+(A-_)/I:4+(_-C)/I:0;return{h:60*(F<0?F+6:F),s:E?I/E*100:0,v:E/255*100,a:T}},b=function(P){var _=P.h,C=P.s,A=P.v,T=P.a;_=_/360*6,C/=100,A/=100;var E=Math.floor(_),I=A*(1-C),F=A*(1-(_-E)*C),B=A*(1-(1-_+E)*C),G=E%6;return{r:255*[A,F,I,I,B,A][G],g:255*[B,A,A,F,I,I][G],b:255*[I,I,B,A,A,F][G],a:T}},g=function(P){return{h:u(P.h),s:e(P.s,0,100),l:e(P.l,0,100),a:e(P.a)}},d=function(P){return{h:n(P.h),s:n(P.s),l:n(P.l),a:n(P.a,3)}},f=function(P){return b((C=(_=P).s,{h:_.h,s:(C*=((A=_.l)<50?A:100-A)/100)>0?2*C/(A+C)*100:0,v:A+C,a:_.a}));var _,C,A},c=function(P){return{h:(_=h(P)).h,s:(T=(200-(C=_.s))*(A=_.v)/100)>0&&T<200?C*A/100/(T<=100?T:200-T)*100:0,l:T/2,a:_.a};var _,C,A,T},l=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,p=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,v=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,m=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,y={string:[[function(P){var _=i.exec(P);return _?(P=_[1]).length<=4?{r:parseInt(P[0]+P[0],16),g:parseInt(P[1]+P[1],16),b:parseInt(P[2]+P[2],16),a:P.length===4?n(parseInt(P[3]+P[3],16)/255,2):1}:P.length===6||P.length===8?{r:parseInt(P.substr(0,2),16),g:parseInt(P.substr(2,2),16),b:parseInt(P.substr(4,2),16),a:P.length===8?n(parseInt(P.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(P){var _=v.exec(P)||m.exec(P);return _?_[2]!==_[4]||_[4]!==_[6]?null:a({r:Number(_[1])/(_[2]?100/255:1),g:Number(_[3])/(_[4]?100/255:1),b:Number(_[5])/(_[6]?100/255:1),a:_[7]===void 0?1:Number(_[7])/(_[8]?100:1)}):null},"rgb"],[function(P){var _=l.exec(P)||p.exec(P);if(!_)return null;var C,A,T=g({h:(C=_[1],A=_[2],A===void 0&&(A="deg"),Number(C)*(r[A]||1)),s:Number(_[3]),l:Number(_[4]),a:_[5]===void 0?1:Number(_[5])/(_[6]?100:1)});return f(T)},"hsl"]],object:[[function(P){var _=P.r,C=P.g,A=P.b,T=P.a,E=T===void 0?1:T;return t(_)&&t(C)&&t(A)?a({r:Number(_),g:Number(C),b:Number(A),a:Number(E)}):null},"rgb"],[function(P){var _=P.h,C=P.s,A=P.l,T=P.a,E=T===void 0?1:T;if(!t(_)||!t(C)||!t(A))return null;var I=g({h:Number(_),s:Number(C),l:Number(A),a:Number(E)});return f(I)},"hsl"],[function(P){var _=P.h,C=P.s,A=P.v,T=P.a,E=T===void 0?1:T;if(!t(_)||!t(C)||!t(A))return null;var I=function(F){return{h:u(F.h),s:e(F.s,0,100),v:e(F.v,0,100),a:e(F.a)}}({h:Number(_),s:Number(C),v:Number(A),a:Number(E)});return b(I)},"hsv"]]},N=function(P,_){for(var C=0;C<_.length;C++){var A=_[C][0](P);if(A)return[A,_[C][1]]}return[null,void 0]},x=function(P){return typeof P=="string"?N(P.trim(),y.string):typeof P=="object"&&P!==null?N(P,y.object):[null,void 0]},M=function(P,_){var C=c(P);return{h:C.h,s:e(C.s+100*_,0,100),l:C.l,a:C.a}},H=function(P){return(299*P.r+587*P.g+114*P.b)/1e3/255},$=function(P,_){var C=c(P);return{h:C.h,s:C.s,l:e(C.l+100*_,0,100),a:C.a}},j=function(){function P(_){this.parsed=x(_)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return P.prototype.isValid=function(){return this.parsed!==null},P.prototype.brightness=function(){return n(H(this.rgba),2)},P.prototype.isDark=function(){return H(this.rgba)<.5},P.prototype.isLight=function(){return H(this.rgba)>=.5},P.prototype.toHex=function(){return _=o(this.rgba),C=_.r,A=_.g,T=_.b,I=(E=_.a)<1?s(n(255*E)):"","#"+s(C)+s(A)+s(T)+I;var _,C,A,T,E,I},P.prototype.toRgb=function(){return o(this.rgba)},P.prototype.toRgbString=function(){return _=o(this.rgba),C=_.r,A=_.g,T=_.b,(E=_.a)<1?"rgba("+C+", "+A+", "+T+", "+E+")":"rgb("+C+", "+A+", "+T+")";var _,C,A,T,E},P.prototype.toHsl=function(){return d(c(this.rgba))},P.prototype.toHslString=function(){return _=d(c(this.rgba)),C=_.h,A=_.s,T=_.l,(E=_.a)<1?"hsla("+C+", "+A+"%, "+T+"%, "+E+")":"hsl("+C+", "+A+"%, "+T+"%)";var _,C,A,T,E},P.prototype.toHsv=function(){return _=h(this.rgba),{h:n(_.h),s:n(_.s),v:n(_.v),a:n(_.a,3)};var _},P.prototype.invert=function(){return w({r:255-(_=this.rgba).r,g:255-_.g,b:255-_.b,a:_.a});var _},P.prototype.saturate=function(_){return _===void 0&&(_=.1),w(M(this.rgba,_))},P.prototype.desaturate=function(_){return _===void 0&&(_=.1),w(M(this.rgba,-_))},P.prototype.grayscale=function(){return w(M(this.rgba,-1))},P.prototype.lighten=function(_){return _===void 0&&(_=.1),w($(this.rgba,_))},P.prototype.darken=function(_){return _===void 0&&(_=.1),w($(this.rgba,-_))},P.prototype.rotate=function(_){return _===void 0&&(_=15),this.hue(this.hue()+_)},P.prototype.alpha=function(_){return typeof _=="number"?w({r:(C=this.rgba).r,g:C.g,b:C.b,a:_}):n(this.rgba.a,3);var C},P.prototype.hue=function(_){var C=c(this.rgba);return typeof _=="number"?w({h:_,s:C.s,l:C.l,a:C.a}):n(C.h)},P.prototype.isEqual=function(_){return this.toHex()===w(_).toHex()},P}(),w=function(P){return P instanceof j?P:new j(P)},S=[],k=function(P){P.forEach(function(_){S.indexOf(_)<0&&(_(j,y),S.push(_))})};function namesPlugin(P,_){var C={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},A={};for(var T in C)A[C[T]]=T;var E={};P.prototype.toName=function(I){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var F,B,G=A[this.toHex()];if(G)return G;if(I!=null&&I.closest){var R=this.toRgb(),z=1/0,D="black";if(!E.length)for(var L in C)E[L]=new P(C[L]).toRgb();for(var O in C){var V=(F=R,B=E[O],Math.pow(F.r-B.r,2)+Math.pow(F.g-B.g,2)+Math.pow(F.b-B.b,2));V<z&&(z=V,D=O)}return D}},_.string.push([function(I){var F=I.toLowerCase(),B=F==="transparent"?"#0000":C[F];return B?new P(B).toRgb():null},"name"])}k([namesPlugin]);const _Color=class jt{constructor(_=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=_}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(_){return this.value=_,this}set value(_){if(_ instanceof jt)this._value=this._cloneSource(_._value),this._int=_._int,this._components.set(_._components);else{if(_===null)throw new Error("Cannot set Color#value to null");(this._value===null||!this._isSourceEqual(this._value,_))&&(this._value=this._cloneSource(_),this._normalize(this._value))}}get value(){return this._value}_cloneSource(_){return typeof _=="string"||typeof _=="number"||_ instanceof Number||_===null?_:Array.isArray(_)||ArrayBuffer.isView(_)?_.slice(0):typeof _=="object"&&_!==null?{..._}:_}_isSourceEqual(_,C){const A=typeof _;if(A!==typeof C)return!1;if(A==="number"||A==="string"||_ instanceof Number)return _===C;if(Array.isArray(_)&&Array.isArray(C)||ArrayBuffer.isView(_)&&ArrayBuffer.isView(C))return _.length!==C.length?!1:_.every((E,I)=>E===C[I]);if(_!==null&&C!==null){const E=Object.keys(_),I=Object.keys(C);return E.length!==I.length?!1:E.every(F=>_[F]===C[F])}return _===C}toRgba(){const[_,C,A,T]=this._components;return{r:_,g:C,b:A,a:T}}toRgb(){const[_,C,A]=this._components;return{r:_,g:C,b:A}}toRgbaString(){const[_,C,A]=this.toUint8RgbArray();return`rgba(${_},${C},${A},${this.alpha})`}toUint8RgbArray(_){const[C,A,T]=this._components;return this._arrayRgb||(this._arrayRgb=[]),_||(_=this._arrayRgb),_[0]=Math.round(C*255),_[1]=Math.round(A*255),_[2]=Math.round(T*255),_}toArray(_){this._arrayRgba||(this._arrayRgba=[]),_||(_=this._arrayRgba);const[C,A,T,E]=this._components;return _[0]=C,_[1]=A,_[2]=T,_[3]=E,_}toRgbArray(_){this._arrayRgb||(this._arrayRgb=[]),_||(_=this._arrayRgb);const[C,A,T]=this._components;return _[0]=C,_[1]=A,_[2]=T,_}toNumber(){return this._int}toBgrNumber(){const[_,C,A]=this.toUint8RgbArray();return(A<<16)+(C<<8)+_}toLittleEndianNumber(){const _=this._int;return(_>>16)+(_&65280)+((_&255)<<16)}multiply(_){const[C,A,T,E]=jt._temp.setValue(_)._components;return this._components[0]*=C,this._components[1]*=A,this._components[2]*=T,this._components[3]*=E,this._refreshInt(),this._value=null,this}premultiply(_,C=!0){return C&&(this._components[0]*=_,this._components[1]*=_,this._components[2]*=_),this._components[3]=_,this._refreshInt(),this._value=null,this}toPremultiplied(_,C=!0){if(_===1)return(255<<24)+this._int;if(_===0)return C?0:this._int;let A=this._int>>16&255,T=this._int>>8&255,E=this._int&255;return C&&(A=A*_+.5|0,T=T*_+.5|0,E=E*_+.5|0),(_*255<<24)+(A<<16)+(T<<8)+E}toHex(){const _=this._int.toString(16);return`#${"000000".substring(0,6-_.length)+_}`}toHexa(){const C=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-C.length)+C}setAlpha(_){return this._components[3]=this._clamp(_),this}_normalize(_){let C,A,T,E;if((typeof _=="number"||_ instanceof Number)&&_>=0&&_<=16777215){const I=_;C=(I>>16&255)/255,A=(I>>8&255)/255,T=(I&255)/255,E=1}else if((Array.isArray(_)||_ instanceof Float32Array)&&_.length>=3&&_.length<=4)_=this._clamp(_),[C,A,T,E=1]=_;else if((_ instanceof Uint8Array||_ instanceof Uint8ClampedArray)&&_.length>=3&&_.length<=4)_=this._clamp(_,0,255),[C,A,T,E=255]=_,C/=255,A/=255,T/=255,E/=255;else if(typeof _=="string"||typeof _=="object"){if(typeof _=="string"){const F=jt.HEX_PATTERN.exec(_);F&&(_=`#${F[2]}`)}const I=w(_);I.isValid()&&({r:C,g:A,b:T,a:E}=I.rgba,C/=255,A/=255,T/=255)}if(C!==void 0)this._components[0]=C,this._components[1]=A,this._components[2]=T,this._components[3]=E,this._refreshInt();else throw new Error(`Unable to convert color ${_}`)}_refreshInt(){this._clamp(this._components);const[_,C,A]=this._components;this._int=(_*255<<16)+(C*255<<8)+(A*255|0)}_clamp(_,C=0,A=1){return typeof _=="number"?Math.min(Math.max(_,C),A):(_.forEach((T,E)=>{_[E]=Math.min(Math.max(T,C),A)}),_)}static isColorLike(_){return typeof _=="number"||typeof _=="string"||_ instanceof Number||_ instanceof jt||Array.isArray(_)||_ instanceof Uint8Array||_ instanceof Uint8ClampedArray||_ instanceof Float32Array||_.r!==void 0&&_.g!==void 0&&_.b!==void 0||_.r!==void 0&&_.g!==void 0&&_.b!==void 0&&_.a!==void 0||_.h!==void 0&&_.s!==void 0&&_.l!==void 0||_.h!==void 0&&_.s!==void 0&&_.l!==void 0&&_.a!==void 0||_.h!==void 0&&_.s!==void 0&&_.v!==void 0||_.h!==void 0&&_.s!==void 0&&_.v!==void 0&&_.a!==void 0}};_Color.shared=new _Color;_Color._temp=new _Color;_Color.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let Color=_Color;const cullingMixin={cullArea:null,cullable:!1,cullableChildren:!0};class Pool{constructor(_,C){this._pool=[],this._count=0,this._index=0,this._classType=_,C&&this.prepopulate(C)}prepopulate(_){for(let C=0;C<_;C++)this._pool[this._index++]=new this._classType;this._count+=_}get(_){var A;let C;return this._index>0?C=this._pool[--this._index]:C=new this._classType,(A=C.init)==null||A.call(C,_),C}return(_){var C;(C=_.reset)==null||C.call(_),this._pool[this._index++]=_}get totalSize(){return this._count}get totalFree(){return this._index}get totalUsed(){return this._count-this._index}clear(){this._pool.length=0,this._index=0}}class PoolGroupClass{constructor(){this._poolsByClass=new Map}prepopulate(_,C){this.getPool(_).prepopulate(C)}get(_,C){return this.getPool(_).get(C)}return(_){this.getPool(_.constructor).return(_)}getPool(_){return this._poolsByClass.has(_)||this._poolsByClass.set(_,new Pool(_)),this._poolsByClass.get(_)}stats(){const _={};return this._poolsByClass.forEach(C=>{const A=_[C._classType.name]?C._classType.name+C._classType.ID:C._classType.name;_[A]={free:C.totalFree,used:C.totalUsed,size:C.totalSize}}),_}}const BigPool=new PoolGroupClass,cacheAsTextureMixin={get isCachedAsTexture(){var P;return!!((P=this.renderGroup)!=null&&P.isCachedAsTexture)},cacheAsTexture(P){typeof P=="boolean"&&P===!1?this.disableRenderGroup():(this.enableRenderGroup(),this.renderGroup.enableCacheAsTexture(P===!0?{}:P))},updateCacheTexture(){var P;(P=this.renderGroup)==null||P.updateCacheTexture()},get cacheAsBitmap(){return this.isCachedAsTexture},set cacheAsBitmap(P){deprecation("v8.6.0","cacheAsBitmap is deprecated, use cacheAsTexture instead."),this.cacheAsTexture(P)}};function removeItems(P,_,C){const A=P.length;let T;if(_>=A||C===0)return;C=_+C>A?A-_:C;const E=A-C;for(T=_;T<E;++T)P[T]=P[T+C];P.length=E}const childrenHelperMixin={allowChildren:!0,removeChildren(P=0,_){const C=_??this.children.length,A=C-P,T=[];if(A>0&&A<=C){for(let I=C-1;I>=P;I--){const F=this.children[I];F&&(T.push(F),F.parent=null)}removeItems(this.children,P,C);const E=this.renderGroup||this.parentRenderGroup;E&&E.removeChildren(T);for(let I=0;I<T.length;++I)this.emit("childRemoved",T[I],this,I),T[I].emit("removed",this);return T.length>0&&this._didViewChangeTick++,T}else if(A===0&&this.children.length===0)return T;throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},removeChildAt(P){const _=this.getChildAt(P);return this.removeChild(_)},getChildAt(P){if(P<0||P>=this.children.length)throw new Error(`getChildAt: Index (${P}) does not exist.`);return this.children[P]},setChildIndex(P,_){if(_<0||_>=this.children.length)throw new Error(`The index ${_} supplied is out of bounds ${this.children.length}`);this.getChildIndex(P),this.addChildAt(P,_)},getChildIndex(P){const _=this.children.indexOf(P);if(_===-1)throw new Error("The supplied Container must be a child of the caller");return _},addChildAt(P,_){this.allowChildren||deprecation(v8_0_0,"addChildAt: Only Containers will be allowed to add children in v8.0.0");const{children:C}=this;if(_<0||_>C.length)throw new Error(`${P}addChildAt: The index ${_} supplied is out of bounds ${C.length}`);if(P.parent){const T=P.parent.children.indexOf(P);if(P.parent===this&&T===_)return P;T!==-1&&P.parent.children.splice(T,1)}_===C.length?C.push(P):C.splice(_,0,P),P.parent=this,P.didChange=!0,P._updateFlags=15;const A=this.renderGroup||this.parentRenderGroup;return A&&A.addChild(P),this.sortableChildren&&(this.sortDirty=!0),this.emit("childAdded",P,this,_),P.emit("added",this),P},swapChildren(P,_){if(P===_)return;const C=this.getChildIndex(P),A=this.getChildIndex(_);this.children[C]=_,this.children[A]=P;const T=this.renderGroup||this.parentRenderGroup;T&&(T.structureDidChange=!0),this._didContainerChangeTick++},removeFromParent(){var P;(P=this.parent)==null||P.removeChild(this)},reparentChild(...P){return P.length===1?this.reparentChildAt(P[0],this.children.length):(P.forEach(_=>this.reparentChildAt(_,this.children.length)),P[0])},reparentChildAt(P,_){if(P.parent===this)return this.setChildIndex(P,_),P;const C=P.worldTransform.clone();P.removeFromParent(),this.addChildAt(P,_);const A=this.worldTransform.clone();return A.invert(),C.prepend(A),P.setFromMatrix(C),P}},collectRenderablesMixin={collectRenderables(P,_,C){this.parentRenderLayer&&this.parentRenderLayer!==C||this.globalDisplayStatus<7||!this.includeInBuild||(this.sortableChildren&&this.sortChildren(),this.isSimple?this.collectRenderablesSimple(P,_,C):this.renderGroup?_.renderPipes.renderGroup.addRenderGroup(this.renderGroup,P):this.collectRenderablesWithEffects(P,_,C))},collectRenderablesSimple(P,_,C){const A=this.children,T=A.length;for(let E=0;E<T;E++)A[E].collectRenderables(P,_,C)},collectRenderablesWithEffects(P,_,C){const{renderPipes:A}=_;for(let T=0;T<this.effects.length;T++){const E=this.effects[T];A[E.pipe].push(E,this,P)}this.collectRenderablesSimple(P,_,C);for(let T=this.effects.length-1;T>=0;T--){const E=this.effects[T];A[E.pipe].pop(E,this,P)}}};class FilterEffect{constructor(){this.pipe="filter",this.priority=1}destroy(){for(let _=0;_<this.filters.length;_++)this.filters[_].destroy();this.filters=null,this.filterArea=null}}class MaskEffectManagerClass{constructor(){this._effectClasses=[],this._tests=[],this._initialized=!1}init(){this._initialized||(this._initialized=!0,this._effectClasses.forEach(_=>{this.add({test:_.test,maskClass:_})}))}add(_){this._tests.push(_)}getMaskEffect(_){this._initialized||this.init();for(let C=0;C<this._tests.length;C++){const A=this._tests[C];if(A.test(_))return BigPool.get(A.maskClass,_)}return _}returnMaskEffect(_){BigPool.return(_)}}const MaskEffectManager=new MaskEffectManagerClass;extensions.handleByList(ExtensionType.MaskEffect,MaskEffectManager._effectClasses);const effectsMixin={_maskEffect:null,_maskOptions:{inverse:!1},_filterEffect:null,effects:[],_markStructureAsChanged(){const P=this.renderGroup||this.parentRenderGroup;P&&(P.structureDidChange=!0)},addEffect(P){this.effects.indexOf(P)===-1&&(this.effects.push(P),this.effects.sort((C,A)=>C.priority-A.priority),this._markStructureAsChanged(),this._updateIsSimple())},removeEffect(P){const _=this.effects.indexOf(P);_!==-1&&(this.effects.splice(_,1),this._markStructureAsChanged(),this._updateIsSimple())},set mask(P){const _=this._maskEffect;(_==null?void 0:_.mask)!==P&&(_&&(this.removeEffect(_),MaskEffectManager.returnMaskEffect(_),this._maskEffect=null),P!=null&&(this._maskEffect=MaskEffectManager.getMaskEffect(P),this.addEffect(this._maskEffect)))},setMask(P){this._maskOptions={...this._maskOptions,...P},P.mask&&(this.mask=P.mask),this._markStructureAsChanged()},get mask(){var P;return(P=this._maskEffect)==null?void 0:P.mask},set filters(P){var E;!Array.isArray(P)&&P&&(P=[P]);const _=this._filterEffect||(this._filterEffect=new FilterEffect);P=P;const C=(P==null?void 0:P.length)>0,A=((E=_.filters)==null?void 0:E.length)>0,T=C!==A;P=Array.isArray(P)?P.slice(0):P,_.filters=Object.freeze(P),T&&(C?this.addEffect(_):(this.removeEffect(_),_.filters=P??null))},get filters(){var P;return(P=this._filterEffect)==null?void 0:P.filters},set filterArea(P){this._filterEffect||(this._filterEffect=new FilterEffect),this._filterEffect.filterArea=P},get filterArea(){var P;return(P=this._filterEffect)==null?void 0:P.filterArea}},findMixin={label:null,get name(){return deprecation(v8_0_0,"Container.name property has been removed, use Container.label instead"),this.label},set name(P){deprecation(v8_0_0,"Container.name property has been removed, use Container.label instead"),this.label=P},getChildByName(P,_=!1){return this.getChildByLabel(P,_)},getChildByLabel(P,_=!1){const C=this.children;for(let A=0;A<C.length;A++){const T=C[A];if(T.label===P||P instanceof RegExp&&P.test(T.label))return T}if(_)for(let A=0;A<C.length;A++){const E=C[A].getChildByLabel(P,!0);if(E)return E}return null},getChildrenByLabel(P,_=!1,C=[]){const A=this.children;for(let T=0;T<A.length;T++){const E=A[T];(E.label===P||P instanceof RegExp&&P.test(E.label))&&C.push(E)}if(_)for(let T=0;T<A.length;T++)A[T].getChildrenByLabel(P,!0,C);return C}},matrixPool=new Pool(Matrix),boundsPool=new Pool(Bounds),tempMatrix$2=new Matrix,getFastGlobalBoundsMixin={getFastGlobalBounds(P,_){_||(_=new Bounds),_.clear(),this._getGlobalBoundsRecursive(!!P,_,this.parentRenderLayer),_.isValid||_.set(0,0,0,0);const C=this.renderGroup||this.parentRenderGroup;return _.applyMatrix(C.worldTransform),_},_getGlobalBoundsRecursive(P,_,C){let A=_;if(P&&this.parentRenderLayer&&this.parentRenderLayer!==C||this.localDisplayStatus!==7||!this.measurable)return;const T=!!this.effects.length;if((this.renderGroup||T)&&(A=boundsPool.get().clear()),this.boundsArea)_.addRect(this.boundsArea,this.worldTransform);else{if(this.renderPipeId){const I=this.bounds;A.addFrame(I.minX,I.minY,I.maxX,I.maxY,this.groupTransform)}const E=this.children;for(let I=0;I<E.length;I++)E[I]._getGlobalBoundsRecursive(P,A,C)}if(T){let E=!1;const I=this.renderGroup||this.parentRenderGroup;for(let F=0;F<this.effects.length;F++)this.effects[F].addBounds&&(E||(E=!0,A.applyMatrix(I.worldTransform)),this.effects[F].addBounds(A,!0));E&&(A.applyMatrix(I.worldTransform.copyTo(tempMatrix$2).invert()),_.addBounds(A,this.relativeGroupTransform)),_.addBounds(A),boundsPool.return(A)}else this.renderGroup&&(_.addBounds(A,this.relativeGroupTransform),boundsPool.return(A))}};function getGlobalBounds(P,_,C){C.clear();let A,T;return P.parent?_?A=P.parent.worldTransform:(T=matrixPool.get().identity(),A=updateTransformBackwards(P,T)):A=Matrix.IDENTITY,_getGlobalBounds(P,C,A,_),T&&matrixPool.return(T),C.isValid||C.set(0,0,0,0),C}function _getGlobalBounds(P,_,C,A){var F,B;if(!P.visible||!P.measurable)return;let T;A?T=P.worldTransform:(P.updateLocalTransform(),T=matrixPool.get(),T.appendFrom(P.localTransform,C));const E=_,I=!!P.effects.length;if(I&&(_=boundsPool.get().clear()),P.boundsArea)_.addRect(P.boundsArea,T);else{P.bounds&&(_.matrix=T,_.addBounds(P.bounds));for(let G=0;G<P.children.length;G++)_getGlobalBounds(P.children[G],_,T,A)}if(I){for(let G=0;G<P.effects.length;G++)(B=(F=P.effects[G]).addBounds)==null||B.call(F,_);E.addBounds(_,Matrix.IDENTITY),boundsPool.return(_)}A||matrixPool.return(T)}function updateTransformBackwards(P,_){const C=P.parent;return C&&(updateTransformBackwards(C,_),C.updateLocalTransform(),_.append(C.localTransform)),_}function multiplyHexColors(P,_){if(P===16777215||!_)return _;if(_===16777215||!P)return P;const C=P>>16&255,A=P>>8&255,T=P&255,E=_>>16&255,I=_>>8&255,F=_&255,B=C*E/255|0,G=A*I/255|0,R=T*F/255|0;return(B<<16)+(G<<8)+R}const WHITE_BGR=16777215;function multiplyColors(P,_){return P===WHITE_BGR?_:_===WHITE_BGR?P:multiplyHexColors(P,_)}function bgr2rgb(P){return((P&255)<<16)+(P&65280)+(P>>16&255)}const getGlobalMixin={getGlobalAlpha(P){if(P)return this.renderGroup?this.renderGroup.worldAlpha:this.parentRenderGroup?this.parentRenderGroup.worldAlpha*this.alpha:this.alpha;let _=this.alpha,C=this.parent;for(;C;)_*=C.alpha,C=C.parent;return _},getGlobalTransform(P,_){if(_)return P.copyFrom(this.worldTransform);this.updateLocalTransform();const C=updateTransformBackwards(this,matrixPool.get().identity());return P.appendFrom(this.localTransform,C),matrixPool.return(C),P},getGlobalTint(P){if(P)return this.renderGroup?bgr2rgb(this.renderGroup.worldColor):this.parentRenderGroup?bgr2rgb(multiplyColors(this.localColor,this.parentRenderGroup.worldColor)):this.tint;let _=this.localColor,C=this.parent;for(;C;)_=multiplyColors(_,C.localColor),C=C.parent;return bgr2rgb(_)}};let warnCount=0;const maxWarnings=500;function warn(...P){warnCount!==maxWarnings&&(warnCount++,warnCount===maxWarnings?console.warn("PixiJS Warning: too many warnings, no more warnings will be reported to the console by PixiJS."):console.warn("PixiJS Warning: ",...P))}function getLocalBounds(P,_,C){return _.clear(),C||(C=Matrix.IDENTITY),_getLocalBounds(P,_,C,P,!0),_.isValid||_.set(0,0,0,0),_}function _getLocalBounds(P,_,C,A,T){var B,G;let E;if(T)E=matrixPool.get(),E=C.copyTo(E);else{if(!P.visible||!P.measurable)return;P.updateLocalTransform();const R=P.localTransform;E=matrixPool.get(),E.appendFrom(R,C)}const I=_,F=!!P.effects.length;if(F&&(_=boundsPool.get().clear()),P.boundsArea)_.addRect(P.boundsArea,E);else{P.renderPipeId&&(_.matrix=E,_.addBounds(P.bounds));const R=P.children;for(let z=0;z<R.length;z++)_getLocalBounds(R[z],_,E,A,!1)}if(F){for(let R=0;R<P.effects.length;R++)(G=(B=P.effects[R]).addLocalBounds)==null||G.call(B,_,A);I.addBounds(_,Matrix.IDENTITY),boundsPool.return(_)}matrixPool.return(E)}function checkChildrenDidChange(P,_){const C=P.children;for(let A=0;A<C.length;A++){const T=C[A],E=T.uid,I=(T._didViewChangeTick&65535)<<16|T._didContainerChangeTick&65535,F=_.index;(_.data[F]!==E||_.data[F+1]!==I)&&(_.data[_.index]=E,_.data[_.index+1]=I,_.didChange=!0),_.index=F+2,T.children.length&&checkChildrenDidChange(T,_)}return _.didChange}const tempMatrix$1=new Matrix,measureMixin={_localBoundsCacheId:-1,_localBoundsCacheData:null,_setWidth(P,_){const C=Math.sign(this.scale.x)||1;_!==0?this.scale.x=P/_*C:this.scale.x=C},_setHeight(P,_){const C=Math.sign(this.scale.y)||1;_!==0?this.scale.y=P/_*C:this.scale.y=C},getLocalBounds(){this._localBoundsCacheData||(this._localBoundsCacheData={data:[],index:1,didChange:!1,localBounds:new Bounds});const P=this._localBoundsCacheData;return P.index=1,P.didChange=!1,P.data[0]!==this._didViewChangeTick&&(P.didChange=!0,P.data[0]=this._didViewChangeTick),checkChildrenDidChange(this,P),P.didChange&&getLocalBounds(this,P.localBounds,tempMatrix$1),P.localBounds},getBounds(P,_){return getGlobalBounds(this,P,_||new Bounds)}},onRenderMixin={_onRender:null,set onRender(P){const _=this.renderGroup||this.parentRenderGroup;if(!P){this._onRender&&(_==null||_.removeOnRender(this)),this._onRender=null;return}this._onRender||_==null||_.addOnRender(this),this._onRender=P},get onRender(){return this._onRender}},sortMixin={_zIndex:0,sortDirty:!1,sortableChildren:!1,get zIndex(){return this._zIndex},set zIndex(P){this._zIndex!==P&&(this._zIndex=P,this.depthOfChildModified())},depthOfChildModified(){this.parent&&(this.parent.sortableChildren=!0,this.parent.sortDirty=!0),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0)},sortChildren(){this.sortDirty&&(this.sortDirty=!1,this.children.sort(sortChildren))}};function sortChildren(P,_){return P._zIndex-_._zIndex}const toLocalGlobalMixin={getGlobalPosition(P=new Point,_=!1){return this.parent?this.parent.toGlobal(this._position,P,_):(P.x=this._position.x,P.y=this._position.y),P},toGlobal(P,_,C=!1){const A=this.getGlobalTransform(matrixPool.get(),C);return _=A.apply(P,_),matrixPool.return(A),_},toLocal(P,_,C,A){_&&(P=_.toGlobal(P,C,A));const T=this.getGlobalTransform(matrixPool.get(),A);return C=T.applyInverse(P,C),matrixPool.return(T),C}};class InstructionSet{constructor(){this.uid=uid("instructionSet"),this.instructions=[],this.instructionSize=0,this.renderables=[],this.gcTick=0}reset(){this.instructionSize=0}add(_){this.instructions[this.instructionSize++]=_}log(){this.instructions.length=this.instructionSize,console.table(this.instructions,["type","action"])}}let count=0;class TexturePoolClass{constructor(_){this._poolKeyHash=Object.create(null),this._texturePool={},this.textureOptions=_||{},this.enableFullScreen=!1}createTexture(_,C,A){const T=new TextureSource({...this.textureOptions,width:_,height:C,resolution:1,antialias:A,autoGarbageCollect:!1});return new Texture({source:T,label:`texturePool_${count++}`})}getOptimalTexture(_,C,A=1,T){let E=Math.ceil(_*A-1e-6),I=Math.ceil(C*A-1e-6);E=nextPow2(E),I=nextPow2(I);const F=(E<<17)+(I<<1)+(T?1:0);this._texturePool[F]||(this._texturePool[F]=[]);let B=this._texturePool[F].pop();return B||(B=this.createTexture(E,I,T)),B.source._resolution=A,B.source.width=E/A,B.source.height=I/A,B.source.pixelWidth=E,B.source.pixelHeight=I,B.frame.x=0,B.frame.y=0,B.frame.width=_,B.frame.height=C,B.updateUvs(),this._poolKeyHash[B.uid]=F,B}getSameSizeTexture(_,C=!1){const A=_.source;return this.getOptimalTexture(_.width,_.height,A._resolution,C)}returnTexture(_){const C=this._poolKeyHash[_.uid];this._texturePool[C].push(_)}clear(_){if(_=_!==!1,_)for(const C in this._texturePool){const A=this._texturePool[C];if(A)for(let T=0;T<A.length;T++)A[T].destroy(!0)}this._texturePool={}}}const TexturePool=new TexturePoolClass;class RenderGroup{constructor(){this.renderPipeId="renderGroup",this.root=null,this.canBundle=!1,this.renderGroupParent=null,this.renderGroupChildren=[],this.worldTransform=new Matrix,this.worldColorAlpha=4294967295,this.worldColor=16777215,this.worldAlpha=1,this.childrenToUpdate=Object.create(null),this.updateTick=0,this.gcTick=0,this.childrenRenderablesToUpdate={list:[],index:0},this.structureDidChange=!0,this.instructionSet=new InstructionSet,this._onRenderContainers=[],this.textureNeedsUpdate=!0,this.isCachedAsTexture=!1,this._matrixDirty=7}init(_){this.root=_,_._onRender&&this.addOnRender(_),_.didChange=!0;const C=_.children;for(let A=0;A<C.length;A++){const T=C[A];T._updateFlags=15,this.addChild(T)}}enableCacheAsTexture(_={}){this.textureOptions=_,this.isCachedAsTexture=!0,this.textureNeedsUpdate=!0}disableCacheAsTexture(){this.isCachedAsTexture=!1,this.texture&&(TexturePool.returnTexture(this.texture),this.texture=null)}updateCacheTexture(){this.textureNeedsUpdate=!0}reset(){this.renderGroupChildren.length=0;for(const _ in this.childrenToUpdate){const C=this.childrenToUpdate[_];C.list.fill(null),C.index=0}this.childrenRenderablesToUpdate.index=0,this.childrenRenderablesToUpdate.list.fill(null),this.root=null,this.updateTick=0,this.structureDidChange=!0,this._onRenderContainers.length=0,this.renderGroupParent=null,this.disableCacheAsTexture()}get localTransform(){return this.root.localTransform}addRenderGroupChild(_){_.renderGroupParent&&_.renderGroupParent._removeRenderGroupChild(_),_.renderGroupParent=this,this.renderGroupChildren.push(_)}_removeRenderGroupChild(_){const C=this.renderGroupChildren.indexOf(_);C>-1&&this.renderGroupChildren.splice(C,1),_.renderGroupParent=null}addChild(_){if(this.structureDidChange=!0,_.parentRenderGroup=this,_.updateTick=-1,_.parent===this.root?_.relativeRenderGroupDepth=1:_.relativeRenderGroupDepth=_.parent.relativeRenderGroupDepth+1,_.didChange=!0,this.onChildUpdate(_),_.renderGroup){this.addRenderGroupChild(_.renderGroup);return}_._onRender&&this.addOnRender(_);const C=_.children;for(let A=0;A<C.length;A++)this.addChild(C[A])}removeChild(_){if(this.structureDidChange=!0,_._onRender&&(_.renderGroup||this.removeOnRender(_)),_.parentRenderGroup=null,_.renderGroup){this._removeRenderGroupChild(_.renderGroup);return}const C=_.children;for(let A=0;A<C.length;A++)this.removeChild(C[A])}removeChildren(_){for(let C=0;C<_.length;C++)this.removeChild(_[C])}onChildUpdate(_){let C=this.childrenToUpdate[_.relativeRenderGroupDepth];C||(C=this.childrenToUpdate[_.relativeRenderGroupDepth]={index:0,list:[]}),C.list[C.index++]=_}updateRenderable(_){_.globalDisplayStatus<7||(this.instructionSet.renderPipes[_.renderPipeId].updateRenderable(_),_.didViewUpdate=!1)}onChildViewUpdate(_){this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++]=_}get isRenderable(){return this.root.localDisplayStatus===7&&this.worldAlpha>0}addOnRender(_){this._onRenderContainers.push(_)}removeOnRender(_){this._onRenderContainers.splice(this._onRenderContainers.indexOf(_),1)}runOnRender(_){for(let C=0;C<this._onRenderContainers.length;C++)this._onRenderContainers[C]._onRender(_)}destroy(){this.disableCacheAsTexture(),this.renderGroupParent=null,this.root=null,this.childrenRenderablesToUpdate=null,this.childrenToUpdate=null,this.renderGroupChildren=null,this._onRenderContainers=null,this.instructionSet=null}getChildren(_=[]){const C=this.root.children;for(let A=0;A<C.length;A++)this._getChildren(C[A],_);return _}_getChildren(_,C=[]){if(C.push(_),_.renderGroup)return C;const A=_.children;for(let T=0;T<A.length;T++)this._getChildren(A[T],C);return C}invalidateMatrices(){this._matrixDirty=7}get inverseWorldTransform(){return(this._matrixDirty&1)===0?this._inverseWorldTransform:(this._matrixDirty&=-2,this._inverseWorldTransform||(this._inverseWorldTransform=new Matrix),this._inverseWorldTransform.copyFrom(this.worldTransform).invert())}get textureOffsetInverseTransform(){return(this._matrixDirty&2)===0?this._textureOffsetInverseTransform:(this._matrixDirty&=-3,this._textureOffsetInverseTransform||(this._textureOffsetInverseTransform=new Matrix),this._textureOffsetInverseTransform.copyFrom(this.inverseWorldTransform).translate(-this._textureBounds.x,-this._textureBounds.y))}get inverseParentTextureTransform(){if((this._matrixDirty&4)===0)return this._inverseParentTextureTransform;this._matrixDirty&=-5;const _=this._parentCacheAsTextureRenderGroup;return _?(this._inverseParentTextureTransform||(this._inverseParentTextureTransform=new Matrix),this._inverseParentTextureTransform.copyFrom(this.worldTransform).prepend(_.inverseWorldTransform).translate(-_._textureBounds.x,-_._textureBounds.y)):this.worldTransform}get cacheToLocalTransform(){return this._parentCacheAsTextureRenderGroup?this._parentCacheAsTextureRenderGroup.textureOffsetInverseTransform:null}}function assignWithIgnore(P,_,C={}){for(const A in _)!C[A]&&_[A]!==void 0&&(P[A]=_[A])}const defaultSkew=new ObservablePoint(null),defaultPivot=new ObservablePoint(null),defaultScale=new ObservablePoint(null,1,1),UPDATE_COLOR=1,UPDATE_BLEND=2,UPDATE_VISIBLE=4;class Container extends EventEmitter{constructor(_={}){var C,A;super(),this.uid=uid("renderable"),this._updateFlags=15,this.renderGroup=null,this.parentRenderGroup=null,this.parentRenderGroupIndex=0,this.didChange=!1,this.didViewUpdate=!1,this.relativeRenderGroupDepth=0,this.children=[],this.parent=null,this.includeInBuild=!0,this.measurable=!0,this.isSimple=!0,this.updateTick=-1,this.localTransform=new Matrix,this.relativeGroupTransform=new Matrix,this.groupTransform=this.relativeGroupTransform,this.destroyed=!1,this._position=new ObservablePoint(this,0,0),this._scale=defaultScale,this._pivot=defaultPivot,this._skew=defaultSkew,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._rotation=0,this.localColor=16777215,this.localAlpha=1,this.groupAlpha=1,this.groupColor=16777215,this.groupColorAlpha=4294967295,this.localBlendMode="inherit",this.groupBlendMode="normal",this.localDisplayStatus=7,this.globalDisplayStatus=7,this._didContainerChangeTick=0,this._didViewChangeTick=0,this._didLocalTransformChangeId=-1,this.effects=[],assignWithIgnore(this,_,{children:!0,parent:!0,effects:!0}),(C=_.children)==null||C.forEach(T=>this.addChild(T)),(A=_.parent)==null||A.addChild(this)}static mixin(_){deprecation("8.8.0","Container.mixin is deprecated, please use extensions.mixin instead."),extensions.mixin(Container,_)}set _didChangeId(_){this._didViewChangeTick=_>>12&4095,this._didContainerChangeTick=_&4095}get _didChangeId(){return this._didContainerChangeTick&4095|(this._didViewChangeTick&4095)<<12}addChild(..._){if(this.allowChildren||deprecation(v8_0_0,"addChild: Only Containers will be allowed to add children in v8.0.0"),_.length>1){for(let T=0;T<_.length;T++)this.addChild(_[T]);return _[0]}const C=_[0],A=this.renderGroup||this.parentRenderGroup;return C.parent===this?(this.children.splice(this.children.indexOf(C),1),this.children.push(C),A&&(A.structureDidChange=!0),C):(C.parent&&C.parent.removeChild(C),this.children.push(C),this.sortableChildren&&(this.sortDirty=!0),C.parent=this,C.didChange=!0,C._updateFlags=15,A&&A.addChild(C),this.emit("childAdded",C,this,this.children.length-1),C.emit("added",this),this._didViewChangeTick++,C._zIndex!==0&&C.depthOfChildModified(),C)}removeChild(..._){if(_.length>1){for(let T=0;T<_.length;T++)this.removeChild(_[T]);return _[0]}const C=_[0],A=this.children.indexOf(C);return A>-1&&(this._didViewChangeTick++,this.children.splice(A,1),this.renderGroup?this.renderGroup.removeChild(C):this.parentRenderGroup&&this.parentRenderGroup.removeChild(C),C.parentRenderLayer&&C.parentRenderLayer.detach(C),C.parent=null,this.emit("childRemoved",C,this,A),C.emit("removed",this)),C}_onUpdate(_){_&&_===this._skew&&this._updateSkew(),this._didContainerChangeTick++,!this.didChange&&(this.didChange=!0,this.parentRenderGroup&&this.parentRenderGroup.onChildUpdate(this))}set isRenderGroup(_){!!this.renderGroup!==_&&(_?this.enableRenderGroup():this.disableRenderGroup())}get isRenderGroup(){return!!this.renderGroup}enableRenderGroup(){if(this.renderGroup)return;const _=this.parentRenderGroup;_==null||_.removeChild(this),this.renderGroup=BigPool.get(RenderGroup,this),this.groupTransform=Matrix.IDENTITY,_==null||_.addChild(this),this._updateIsSimple()}disableRenderGroup(){if(!this.renderGroup)return;const _=this.parentRenderGroup;_==null||_.removeChild(this),BigPool.return(this.renderGroup),this.renderGroup=null,this.groupTransform=this.relativeGroupTransform,_==null||_.addChild(this),this._updateIsSimple()}_updateIsSimple(){this.isSimple=!this.renderGroup&&this.effects.length===0}get worldTransform(){return this._worldTransform||(this._worldTransform=new Matrix),this.renderGroup?this._worldTransform.copyFrom(this.renderGroup.worldTransform):this.parentRenderGroup&&this._worldTransform.appendFrom(this.relativeGroupTransform,this.parentRenderGroup.worldTransform),this._worldTransform}get x(){return this._position.x}set x(_){this._position.x=_}get y(){return this._position.y}set y(_){this._position.y=_}get position(){return this._position}set position(_){this._position.copyFrom(_)}get rotation(){return this._rotation}set rotation(_){this._rotation!==_&&(this._rotation=_,this._onUpdate(this._skew))}get angle(){return this.rotation*RAD_TO_DEG}set angle(_){this.rotation=_*DEG_TO_RAD}get pivot(){return this._pivot===defaultPivot&&(this._pivot=new ObservablePoint(this,0,0)),this._pivot}set pivot(_){this._pivot===defaultPivot&&(this._pivot=new ObservablePoint(this,0,0)),typeof _=="number"?this._pivot.set(_):this._pivot.copyFrom(_)}get skew(){return this._skew===defaultSkew&&(this._skew=new ObservablePoint(this,0,0)),this._skew}set skew(_){this._skew===defaultSkew&&(this._skew=new ObservablePoint(this,0,0)),this._skew.copyFrom(_)}get scale(){return this._scale===defaultScale&&(this._scale=new ObservablePoint(this,1,1)),this._scale}set scale(_){this._scale===defaultScale&&(this._scale=new ObservablePoint(this,0,0)),typeof _=="number"?this._scale.set(_):this._scale.copyFrom(_)}get width(){return Math.abs(this.scale.x*this.getLocalBounds().width)}set width(_){const C=this.getLocalBounds().width;this._setWidth(_,C)}get height(){return Math.abs(this.scale.y*this.getLocalBounds().height)}set height(_){const C=this.getLocalBounds().height;this._setHeight(_,C)}getSize(_){_||(_={});const C=this.getLocalBounds();return _.width=Math.abs(this.scale.x*C.width),_.height=Math.abs(this.scale.y*C.height),_}setSize(_,C){const A=this.getLocalBounds();typeof _=="object"?(C=_.height??_.width,_=_.width):C??(C=_),_!==void 0&&this._setWidth(_,A.width),C!==void 0&&this._setHeight(C,A.height)}_updateSkew(){const _=this._rotation,C=this._skew;this._cx=Math.cos(_+C._y),this._sx=Math.sin(_+C._y),this._cy=-Math.sin(_-C._x),this._sy=Math.cos(_-C._x)}updateTransform(_){return this.position.set(typeof _.x=="number"?_.x:this.position.x,typeof _.y=="number"?_.y:this.position.y),this.scale.set(typeof _.scaleX=="number"?_.scaleX||1:this.scale.x,typeof _.scaleY=="number"?_.scaleY||1:this.scale.y),this.rotation=typeof _.rotation=="number"?_.rotation:this.rotation,this.skew.set(typeof _.skewX=="number"?_.skewX:this.skew.x,typeof _.skewY=="number"?_.skewY:this.skew.y),this.pivot.set(typeof _.pivotX=="number"?_.pivotX:this.pivot.x,typeof _.pivotY=="number"?_.pivotY:this.pivot.y),this}setFromMatrix(_){_.decompose(this)}updateLocalTransform(){const _=this._didContainerChangeTick;if(this._didLocalTransformChangeId===_)return;this._didLocalTransformChangeId=_;const C=this.localTransform,A=this._scale,T=this._pivot,E=this._position,I=A._x,F=A._y,B=T._x,G=T._y;C.a=this._cx*I,C.b=this._sx*I,C.c=this._cy*F,C.d=this._sy*F,C.tx=E._x-(B*C.a+G*C.c),C.ty=E._y-(B*C.b+G*C.d)}set alpha(_){_!==this.localAlpha&&(this.localAlpha=_,this._updateFlags|=UPDATE_COLOR,this._onUpdate())}get alpha(){return this.localAlpha}set tint(_){const A=Color.shared.setValue(_??16777215).toBgrNumber();A!==this.localColor&&(this.localColor=A,this._updateFlags|=UPDATE_COLOR,this._onUpdate())}get tint(){return bgr2rgb(this.localColor)}set blendMode(_){this.localBlendMode!==_&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=UPDATE_BLEND,this.localBlendMode=_,this._onUpdate())}get blendMode(){return this.localBlendMode}get visible(){return!!(this.localDisplayStatus&2)}set visible(_){const C=_?2:0;(this.localDisplayStatus&2)!==C&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=UPDATE_VISIBLE,this.localDisplayStatus^=2,this._onUpdate())}get culled(){return!(this.localDisplayStatus&4)}set culled(_){const C=_?0:4;(this.localDisplayStatus&4)!==C&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=UPDATE_VISIBLE,this.localDisplayStatus^=4,this._onUpdate())}get renderable(){return!!(this.localDisplayStatus&1)}set renderable(_){const C=_?1:0;(this.localDisplayStatus&1)!==C&&(this._updateFlags|=UPDATE_VISIBLE,this.localDisplayStatus^=1,this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._onUpdate())}get isRenderable(){return this.localDisplayStatus===7&&this.groupAlpha>0}destroy(_=!1){var T;if(this.destroyed)return;this.destroyed=!0;let C;if(this.children.length&&(C=this.removeChildren(0,this.children.length)),this.removeFromParent(),this.parent=null,this._maskEffect=null,this._filterEffect=null,this.effects=null,this._position=null,this._scale=null,this._pivot=null,this._skew=null,this.emit("destroyed",this),this.removeAllListeners(),(typeof _=="boolean"?_:_==null?void 0:_.children)&&C)for(let E=0;E<C.length;++E)C[E].destroy(_);(T=this.renderGroup)==null||T.destroy(),this.renderGroup=null}}extensions.mixin(Container,childrenHelperMixin,getFastGlobalBoundsMixin,toLocalGlobalMixin,onRenderMixin,measureMixin,effectsMixin,findMixin,sortMixin,cullingMixin,cacheAsTextureMixin,getGlobalMixin,collectRenderablesMixin);class ViewContainer extends Container{constructor(_){super(_),this.canBundle=!0,this.allowChildren=!1,this._roundPixels=0,this._lastUsed=-1,this._bounds=new Bounds(0,1,0,0),this._boundsDirty=!0}get bounds(){return this._boundsDirty?(this.updateBounds(),this._boundsDirty=!1,this._bounds):this._bounds}get roundPixels(){return!!this._roundPixels}set roundPixels(_){this._roundPixels=_?1:0}containsPoint(_){const C=this.bounds,{x:A,y:T}=_;return A>=C.minX&&A<=C.maxX&&T>=C.minY&&T<=C.maxY}onViewUpdate(){if(this._didViewChangeTick++,this._boundsDirty=!0,this.didViewUpdate)return;this.didViewUpdate=!0;const _=this.renderGroup||this.parentRenderGroup;_&&_.onChildViewUpdate(this)}destroy(_){super.destroy(_),this._bounds=null}collectRenderablesSimple(_,C,A){const{renderPipes:T,renderableGC:E}=C;T.blendMode.setBlendMode(this,this.groupBlendMode,_),T[this.renderPipeId].addRenderable(this,_),E.addRenderable(this),this.didViewUpdate=!1;const F=this.children,B=F.length;for(let G=0;G<B;G++)F[G].collectRenderables(_,C,A)}}class Sprite extends ViewContainer{constructor(_=Texture.EMPTY){_ instanceof Texture&&(_={texture:_});const{texture:C=Texture.EMPTY,anchor:A,roundPixels:T,width:E,height:I,...F}=_;super({label:"Sprite",...F}),this.renderPipeId="sprite",this.batched=!0,this._visualBounds={minX:0,maxX:1,minY:0,maxY:0},this._anchor=new ObservablePoint({_onUpdate:()=>{this.onViewUpdate()}}),A?this.anchor=A:C.defaultAnchor&&(this.anchor=C.defaultAnchor),this.texture=C,this.allowChildren=!1,this.roundPixels=T??!1,E!==void 0&&(this.width=E),I!==void 0&&(this.height=I)}static from(_,C=!1){return _ instanceof Texture?new Sprite(_):new Sprite(Texture.from(_,C))}set texture(_){_||(_=Texture.EMPTY);const C=this._texture;C!==_&&(C&&C.dynamic&&C.off("update",this.onViewUpdate,this),_.dynamic&&_.on("update",this.onViewUpdate,this),this._texture=_,this._width&&this._setWidth(this._width,this._texture.orig.width),this._height&&this._setHeight(this._height,this._texture.orig.height),this.onViewUpdate())}get texture(){return this._texture}get visualBounds(){return updateQuadBounds(this._visualBounds,this._anchor,this._texture),this._visualBounds}get sourceBounds(){return deprecation("8.6.1","Sprite.sourceBounds is deprecated, use visualBounds instead."),this.visualBounds}updateBounds(){const _=this._anchor,C=this._texture,A=this._bounds,{width:T,height:E}=C.orig;A.minX=-_._x*T,A.maxX=A.minX+T,A.minY=-_._y*E,A.maxY=A.minY+E}destroy(_=!1){if(super.destroy(_),typeof _=="boolean"?_:_==null?void 0:_.texture){const A=typeof _=="boolean"?_:_==null?void 0:_.textureSource;this._texture.destroy(A)}this._texture=null,this._visualBounds=null,this._bounds=null,this._anchor=null}get anchor(){return this._anchor}set anchor(_){typeof _=="number"?this._anchor.set(_):this._anchor.copyFrom(_)}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(_){this._setWidth(_,this._texture.orig.width),this._width=_}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(_){this._setHeight(_,this._texture.orig.height),this._height=_}getSize(_){return _||(_={}),_.width=Math.abs(this.scale.x)*this._texture.orig.width,_.height=Math.abs(this.scale.y)*this._texture.orig.height,_}setSize(_,C){typeof _=="object"?(C=_.height??_.width,_=_.width):C??(C=_),_!==void 0&&this._setWidth(_,this._texture.orig.width),C!==void 0&&this._setHeight(C,this._texture.orig.height)}}const tempBounds=new Bounds;function addMaskBounds(P,_,C){const A=tempBounds;P.measurable=!0,getGlobalBounds(P,C,A),_.addBoundsMask(A),P.measurable=!1}function addMaskLocalBounds(P,_,C){const A=boundsPool.get();P.measurable=!0;const T=matrixPool.get().identity(),E=getMatrixRelativeToParent(P,C,T);getLocalBounds(P,A,E),P.measurable=!1,_.addBoundsMask(A),matrixPool.return(T),boundsPool.return(A)}function getMatrixRelativeToParent(P,_,C){return P?(P!==_&&(getMatrixRelativeToParent(P.parent,_,C),P.updateLocalTransform(),C.append(P.localTransform)),C):(warn("Mask bounds, renderable is not inside the root container"),C)}class AlphaMask{constructor(_){this.priority=0,this.inverse=!1,this.pipe="alphaMask",_!=null&&_.mask&&this.init(_.mask)}init(_){this.mask=_,this.renderMaskToTexture=!(_ instanceof Sprite),this.mask.renderable=this.renderMaskToTexture,this.mask.includeInBuild=!this.renderMaskToTexture,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask=null}addBounds(_,C){this.inverse||addMaskBounds(this.mask,_,C)}addLocalBounds(_,C){addMaskLocalBounds(this.mask,_,C)}containsPoint(_,C){const A=this.mask;return C(A,_)}destroy(){this.reset()}static test(_){return _ instanceof Sprite}}AlphaMask.extension=ExtensionType.MaskEffect;class ColorMask{constructor(_){this.priority=0,this.pipe="colorMask",_!=null&&_.mask&&this.init(_.mask)}init(_){this.mask=_}destroy(){}static test(_){return typeof _=="number"}}ColorMask.extension=ExtensionType.MaskEffect;class StencilMask{constructor(_){this.priority=0,this.pipe="stencilMask",_!=null&&_.mask&&this.init(_.mask)}init(_){this.mask=_,this.mask.includeInBuild=!1,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask.includeInBuild=!0,this.mask=null}addBounds(_,C){addMaskBounds(this.mask,_,C)}addLocalBounds(_,C){addMaskLocalBounds(this.mask,_,C)}containsPoint(_,C){const A=this.mask;return C(A,_)}destroy(){this.reset()}static test(_){return _ instanceof Container}}StencilMask.extension=ExtensionType.MaskEffect;const BrowserAdapter={createCanvas:(P,_)=>{const C=document.createElement("canvas");return C.width=P,C.height=_,C},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(P,_)=>fetch(P,_),parseXML:P=>new DOMParser().parseFromString(P,"text/xml")};let currentAdapter=BrowserAdapter;const DOMAdapter={get(){return currentAdapter},set(P){currentAdapter=P}};class CanvasSource extends TextureSource{constructor(_){_.resource||(_.resource=DOMAdapter.get().createCanvas()),_.width||(_.width=_.resource.width,_.autoDensity||(_.width/=_.resolution)),_.height||(_.height=_.resource.height,_.autoDensity||(_.height/=_.resolution)),super(_),this.uploadMethodId="image",this.autoDensity=_.autoDensity,this.resizeCanvas(),this.transparent=!!_.transparent}resizeCanvas(){this.autoDensity&&"style"in this.resource&&(this.resource.style.width=`${this.width}px`,this.resource.style.height=`${this.height}px`),(this.resource.width!==this.pixelWidth||this.resource.height!==this.pixelHeight)&&(this.resource.width=this.pixelWidth,this.resource.height=this.pixelHeight)}resize(_=this.width,C=this.height,A=this._resolution){const T=super.resize(_,C,A);return T&&this.resizeCanvas(),T}static test(_){return globalThis.HTMLCanvasElement&&_ instanceof HTMLCanvasElement||globalThis.OffscreenCanvas&&_ instanceof OffscreenCanvas}get context2D(){return this._context2D||(this._context2D=this.resource.getContext("2d"))}}CanvasSource.extension=ExtensionType.TextureSource;class ImageSource extends TextureSource{constructor(_){if(_.resource&&globalThis.HTMLImageElement&&_.resource instanceof HTMLImageElement){const C=DOMAdapter.get().createCanvas(_.resource.width,_.resource.height);C.getContext("2d").drawImage(_.resource,0,0,_.resource.width,_.resource.height),_.resource=C,warn("ImageSource: Image element passed, converting to canvas. Use CanvasSource instead.")}super(_),this.uploadMethodId="image",this.autoGarbageCollect=!0}static test(_){return globalThis.HTMLImageElement&&_ instanceof HTMLImageElement||typeof ImageBitmap<"u"&&_ instanceof ImageBitmap||globalThis.VideoFrame&&_ instanceof VideoFrame}}ImageSource.extension=ExtensionType.TextureSource;var UPDATE_PRIORITY=(P=>(P[P.INTERACTION=50]="INTERACTION",P[P.HIGH=25]="HIGH",P[P.NORMAL=0]="NORMAL",P[P.LOW=-25]="LOW",P[P.UTILITY=-50]="UTILITY",P))(UPDATE_PRIORITY||{});class TickerListener{constructor(_,C=null,A=0,T=!1){this.next=null,this.previous=null,this._destroyed=!1,this._fn=_,this._context=C,this.priority=A,this._once=T}match(_,C=null){return this._fn===_&&this._context===C}emit(_){this._fn&&(this._context?this._fn.call(this._context,_):this._fn(_));const C=this.next;return this._once&&this.destroy(!0),this._destroyed&&(this.next=null),C}connect(_){this.previous=_,_.next&&(_.next.previous=this),this.next=_.next,_.next=this}destroy(_=!1){this._destroyed=!0,this._fn=null,this._context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const C=this.next;return this.next=_?null:C,this.previous=null,C}}const _Ticker=class Lt{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new TickerListener(null,null,1/0),this.deltaMS=1/Lt.targetFPMS,this.elapsedMS=1/Lt.targetFPMS,this._tick=_=>{this._requestId=null,this.started&&(this.update(_),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(_,C,A=UPDATE_PRIORITY.NORMAL){return this._addListener(new TickerListener(_,C,A))}addOnce(_,C,A=UPDATE_PRIORITY.NORMAL){return this._addListener(new TickerListener(_,C,A,!0))}_addListener(_){let C=this._head.next,A=this._head;if(!C)_.connect(A);else{for(;C;){if(_.priority>C.priority){_.connect(A);break}A=C,C=C.next}_.previous||_.connect(A)}return this._startIfPossible(),this}remove(_,C){let A=this._head.next;for(;A;)A.match(_,C)?A=A.destroy():A=A.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let _=0,C=this._head;for(;C=C.next;)_++;return _}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let _=this._head.next;for(;_;)_=_.destroy(!0);this._head.destroy(),this._head=null}}update(_=performance.now()){let C;if(_>this.lastTime){if(C=this.elapsedMS=_-this.lastTime,C>this._maxElapsedMS&&(C=this._maxElapsedMS),C*=this.speed,this._minElapsedMS){const E=_-this._lastFrame|0;if(E<this._minElapsedMS)return;this._lastFrame=_-E%this._minElapsedMS}this.deltaMS=C,this.deltaTime=this.deltaMS*Lt.targetFPMS;const A=this._head;let T=A.next;for(;T;)T=T.emit(this);A.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=_}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(_){const C=Math.min(this.maxFPS,_),A=Math.min(Math.max(0,C)/1e3,Lt.targetFPMS);this._maxElapsedMS=1/A}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(_){if(_===0)this._minElapsedMS=0;else{const C=Math.max(this.minFPS,_);this._minElapsedMS=1/(C/1e3)}}static get shared(){if(!Lt._shared){const _=Lt._shared=new Lt;_.autoStart=!0,_._protected=!0}return Lt._shared}static get system(){if(!Lt._system){const _=Lt._system=new Lt;_.autoStart=!0,_._protected=!0}return Lt._system}};_Ticker.targetFPMS=.06;let Ticker=_Ticker,promise;async function detectVideoAlphaMode(){return promise??(promise=(async()=>{var I;const _=document.createElement("canvas").getContext("webgl");if(!_)return"premultiply-alpha-on-upload";const C=await new Promise(F=>{const B=document.createElement("video");B.onloadeddata=()=>F(B),B.onerror=()=>F(null),B.autoplay=!1,B.crossOrigin="anonymous",B.preload="auto",B.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",B.load()});if(!C)return"premultiply-alpha-on-upload";const A=_.createTexture();_.bindTexture(_.TEXTURE_2D,A);const T=_.createFramebuffer();_.bindFramebuffer(_.FRAMEBUFFER,T),_.framebufferTexture2D(_.FRAMEBUFFER,_.COLOR_ATTACHMENT0,_.TEXTURE_2D,A,0),_.pixelStorei(_.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),_.pixelStorei(_.UNPACK_COLORSPACE_CONVERSION_WEBGL,_.NONE),_.texImage2D(_.TEXTURE_2D,0,_.RGBA,_.RGBA,_.UNSIGNED_BYTE,C);const E=new Uint8Array(4);return _.readPixels(0,0,1,1,_.RGBA,_.UNSIGNED_BYTE,E),_.deleteFramebuffer(T),_.deleteTexture(A),(I=_.getExtension("WEBGL_lose_context"))==null||I.loseContext(),E[0]<=E[3]?"premultiplied-alpha":"premultiply-alpha-on-upload"})()),promise}const _VideoSource=class ie extends TextureSource{constructor(_){super(_),this.isReady=!1,this.uploadMethodId="video",_={...ie.defaultOptions,..._},this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=_.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=_.autoPlay!==!1,this.alphaMode=_.alphaMode??"premultiply-alpha-on-upload",this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),_.autoLoad!==!1&&this.load()}updateFrame(){if(!this.destroyed){if(this._updateFPS){const _=Ticker.shared.elapsedMS*this.resource.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-_)}(!this._updateFPS||this._msToNextUpdate<=0)&&(this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0),this.isValid&&this.update()}}_videoFrameRequestCallback(){this.updateFrame(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback)}get isValid(){return!!this.resource.videoWidth&&!!this.resource.videoHeight}async load(){if(this._load)return this._load;const _=this.resource,C=this.options;return(_.readyState===_.HAVE_ENOUGH_DATA||_.readyState===_.HAVE_FUTURE_DATA)&&_.width&&_.height&&(_.complete=!0),_.addEventListener("play",this._onPlayStart),_.addEventListener("pause",this._onPlayStop),_.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._mediaReady():(C.preload||_.addEventListener("canplay",this._onCanPlay),_.addEventListener("canplaythrough",this._onCanPlayThrough),_.addEventListener("error",this._onError,!0)),this.alphaMode=await detectVideoAlphaMode(),this._load=new Promise((A,T)=>{this.isValid?A(this):(this._resolve=A,this._reject=T,C.preloadTimeoutMs!==void 0&&(this._preloadTimeout=setTimeout(()=>{this._onError(new ErrorEvent(`Preload exceeded timeout of ${C.preloadTimeoutMs}ms`))})),_.load())}),this._load}_onError(_){this.resource.removeEventListener("error",this._onError,!0),this.emit("error",_),this._reject&&(this._reject(_),this._reject=null,this._resolve=null)}_isSourcePlaying(){const _=this.resource;return!_.paused&&!_.ended}_isSourceReady(){return this.resource.readyState>2}_onPlayStart(){this.isValid||this._mediaReady(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0)}_onCanPlay(){this.resource.removeEventListener("canplay",this._onCanPlay),this._mediaReady()}_onCanPlayThrough(){this.resource.removeEventListener("canplaythrough",this._onCanPlay),this._preloadTimeout&&(clearTimeout(this._preloadTimeout),this._preloadTimeout=void 0),this._mediaReady()}_mediaReady(){const _=this.resource;this.isValid&&(this.isReady=!0,this.resize(_.videoWidth,_.videoHeight)),this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0,this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.resource.play()}destroy(){this._configureAutoUpdate();const _=this.resource;_&&(_.removeEventListener("play",this._onPlayStart),_.removeEventListener("pause",this._onPlayStop),_.removeEventListener("seeked",this._onSeeked),_.removeEventListener("canplay",this._onCanPlay),_.removeEventListener("canplaythrough",this._onCanPlayThrough),_.removeEventListener("error",this._onError,!0),_.pause(),_.src="",_.load()),super.destroy()}get autoUpdate(){return this._autoUpdate}set autoUpdate(_){_!==this._autoUpdate&&(this._autoUpdate=_,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(_){_!==this._updateFPS&&(this._updateFPS=_,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.resource.requestVideoFrameCallback?(this._isConnectedToTicker&&(Ticker.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(Ticker.shared.add(this.updateFrame,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(Ticker.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(_){return globalThis.HTMLVideoElement&&_ instanceof HTMLVideoElement}};_VideoSource.extension=ExtensionType.TextureSource;_VideoSource.defaultOptions={...TextureSource.defaultOptions,autoLoad:!0,autoPlay:!0,updateFPS:0,crossorigin:!0,loop:!1,muted:!0,playsinline:!0,preload:!1};_VideoSource.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let VideoSource=_VideoSource;const convertToList=(P,_,C=!1)=>(Array.isArray(P)||(P=[P]),_?P.map(A=>typeof A=="string"||C?_(A):A):P);class CacheClass{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(_){return this._cache.has(_)}get(_){const C=this._cache.get(_);return C||warn(`[Assets] Asset id ${_} was not found in the Cache`),C}set(_,C){const A=convertToList(_);let T;for(let B=0;B<this.parsers.length;B++){const G=this.parsers[B];if(G.test(C)){T=G.getCacheableAssets(A,C);break}}const E=new Map(Object.entries(T||{}));T||A.forEach(B=>{E.set(B,C)});const I=[...E.keys()],F={cacheKeys:I,keys:A};A.forEach(B=>{this._cacheMap.set(B,F)}),I.forEach(B=>{const G=T?T[B]:C;this._cache.has(B)&&this._cache.get(B)!==G&&warn("[Cache] already has key:",B),this._cache.set(B,E.get(B))})}remove(_){if(!this._cacheMap.has(_)){warn(`[Assets] Asset id ${_} was not found in the Cache`);return}const C=this._cacheMap.get(_);C.cacheKeys.forEach(T=>{this._cache.delete(T)}),C.keys.forEach(T=>{this._cacheMap.delete(T)})}get parsers(){return this._parsers}}const Cache=new CacheClass,sources=[];extensions.handleByList(ExtensionType.TextureSource,sources);function textureSourceFrom(P={}){const _=P&&P.resource,C=_?P.resource:P,A=_?P:{resource:P};for(let T=0;T<sources.length;T++){const E=sources[T];if(E.test(C))return new E(A)}throw new Error(`Could not find a source type for resource: ${A.resource}`)}function resourceToTexture(P={},_=!1){const C=P&&P.resource,A=C?P.resource:P,T=C?P:{resource:P};if(!_&&Cache.has(A))return Cache.get(A);const E=new Texture({source:textureSourceFrom(T)});return E.on("destroy",()=>{Cache.has(A)&&Cache.remove(A)}),_||Cache.set(A,E),E}function textureFrom(P,_=!1){return typeof P=="string"?Cache.get(P):P instanceof TextureSource?new Texture({source:P}):resourceToTexture(P,_)}Texture.from=textureFrom;TextureSource.from=textureSourceFrom;extensions.add(AlphaMask,ColorMask,StencilMask,VideoSource,ImageSource,CanvasSource,BufferImageSource);var LoaderParserPriority=(P=>(P[P.Low=0]="Low",P[P.Normal=1]="Normal",P[P.High=2]="High",P))(LoaderParserPriority||{});function assertPath(P){if(typeof P!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(P)}`)}function removeUrlParams(P){return P.split("?")[0].split("#")[0]}function escapeRegExp(P){return P.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function replaceAll(P,_,C){return P.replace(new RegExp(escapeRegExp(_),"g"),C)}function normalizeStringPosix(P,_){let C="",A=0,T=-1,E=0,I=-1;for(let F=0;F<=P.length;++F){if(F<P.length)I=P.charCodeAt(F);else{if(I===47)break;I=47}if(I===47){if(!(T===F-1||E===1))if(T!==F-1&&E===2){if(C.length<2||A!==2||C.charCodeAt(C.length-1)!==46||C.charCodeAt(C.length-2)!==46){if(C.length>2){const B=C.lastIndexOf("/");if(B!==C.length-1){B===-1?(C="",A=0):(C=C.slice(0,B),A=C.length-1-C.lastIndexOf("/")),T=F,E=0;continue}}else if(C.length===2||C.length===1){C="",A=0,T=F,E=0;continue}}}else C.length>0?C+=`/${P.slice(T+1,F)}`:C=P.slice(T+1,F),A=F-T-1;T=F,E=0}else I===46&&E!==-1?++E:E=-1}return C}const path={toPosix(P){return replaceAll(P,"\\","/")},isUrl(P){return/^https?:/.test(this.toPosix(P))},isDataUrl(P){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(P)},isBlobUrl(P){return P.startsWith("blob:")},hasProtocol(P){return/^[^/:]+:/.test(this.toPosix(P))},getProtocol(P){assertPath(P),P=this.toPosix(P);const _=/^file:\/\/\//.exec(P);if(_)return _[0];const C=/^[^/:]+:\/{0,2}/.exec(P);return C?C[0]:""},toAbsolute(P,_,C){if(assertPath(P),this.isDataUrl(P)||this.isBlobUrl(P))return P;const A=removeUrlParams(this.toPosix(_??DOMAdapter.get().getBaseUrl())),T=removeUrlParams(this.toPosix(C??this.rootname(A)));return P=this.toPosix(P),P.startsWith("/")?path.join(T,P.slice(1)):this.isAbsolute(P)?P:this.join(A,P)},normalize(P){if(assertPath(P),P.length===0)return".";if(this.isDataUrl(P)||this.isBlobUrl(P))return P;P=this.toPosix(P);let _="";const C=P.startsWith("/");this.hasProtocol(P)&&(_=this.rootname(P),P=P.slice(_.length));const A=P.endsWith("/");return P=normalizeStringPosix(P),P.length>0&&A&&(P+="/"),C?`/${P}`:_+P},isAbsolute(P){return assertPath(P),P=this.toPosix(P),this.hasProtocol(P)?!0:P.startsWith("/")},join(...P){if(P.length===0)return".";let _;for(let C=0;C<P.length;++C){const A=P[C];if(assertPath(A),A.length>0)if(_===void 0)_=A;else{const T=P[C-1]??"";this.joinExtensions.includes(this.extname(T).toLowerCase())?_+=`/../${A}`:_+=`/${A}`}}return _===void 0?".":this.normalize(_)},dirname(P){if(assertPath(P),P.length===0)return".";P=this.toPosix(P);let _=P.charCodeAt(0);const C=_===47;let A=-1,T=!0;const E=this.getProtocol(P),I=P;P=P.slice(E.length);for(let F=P.length-1;F>=1;--F)if(_=P.charCodeAt(F),_===47){if(!T){A=F;break}}else T=!1;return A===-1?C?"/":this.isUrl(I)?E+P:E:C&&A===1?"//":E+P.slice(0,A)},rootname(P){assertPath(P),P=this.toPosix(P);let _="";if(P.startsWith("/")?_="/":_=this.getProtocol(P),this.isUrl(P)){const C=P.indexOf("/",_.length);C!==-1?_=P.slice(0,C):_=P,_.endsWith("/")||(_+="/")}return _},basename(P,_){assertPath(P),_&&assertPath(_),P=removeUrlParams(this.toPosix(P));let C=0,A=-1,T=!0,E;if(_!==void 0&&_.length>0&&_.length<=P.length){if(_.length===P.length&&_===P)return"";let I=_.length-1,F=-1;for(E=P.length-1;E>=0;--E){const B=P.charCodeAt(E);if(B===47){if(!T){C=E+1;break}}else F===-1&&(T=!1,F=E+1),I>=0&&(B===_.charCodeAt(I)?--I===-1&&(A=E):(I=-1,A=F))}return C===A?A=F:A===-1&&(A=P.length),P.slice(C,A)}for(E=P.length-1;E>=0;--E)if(P.charCodeAt(E)===47){if(!T){C=E+1;break}}else A===-1&&(T=!1,A=E+1);return A===-1?"":P.slice(C,A)},extname(P){assertPath(P),P=removeUrlParams(this.toPosix(P));let _=-1,C=0,A=-1,T=!0,E=0;for(let I=P.length-1;I>=0;--I){const F=P.charCodeAt(I);if(F===47){if(!T){C=I+1;break}continue}A===-1&&(T=!1,A=I+1),F===46?_===-1?_=I:E!==1&&(E=1):_!==-1&&(E=-1)}return _===-1||A===-1||E===0||E===1&&_===A-1&&_===C+1?"":P.slice(_,A)},parse(P){assertPath(P);const _={root:"",dir:"",base:"",ext:"",name:""};if(P.length===0)return _;P=removeUrlParams(this.toPosix(P));let C=P.charCodeAt(0);const A=this.isAbsolute(P);let T;_.root=this.rootname(P),A||this.hasProtocol(P)?T=1:T=0;let E=-1,I=0,F=-1,B=!0,G=P.length-1,R=0;for(;G>=T;--G){if(C=P.charCodeAt(G),C===47){if(!B){I=G+1;break}continue}F===-1&&(B=!1,F=G+1),C===46?E===-1?E=G:R!==1&&(R=1):E!==-1&&(R=-1)}return E===-1||F===-1||R===0||R===1&&E===F-1&&E===I+1?F!==-1&&(I===0&&A?_.base=_.name=P.slice(1,F):_.base=_.name=P.slice(I,F)):(I===0&&A?(_.name=P.slice(1,E),_.base=P.slice(1,F)):(_.name=P.slice(I,E),_.base=P.slice(I,F)),_.ext=P.slice(E,F)),_.dir=this.dirname(P),_},sep:"/",delimiter:":",joinExtensions:[".html"]};function processX(P,_,C,A,T){const E=_[C];for(let I=0;I<E.length;I++){const F=E[I];C<_.length-1?processX(P.replace(A[C],F),_,C+1,A,T):T.push(P.replace(A[C],F))}}function createStringVariations(P){const _=/\{(.*?)\}/g,C=P.match(_),A=[];if(C){const T=[];C.forEach(E=>{const I=E.substring(1,E.length-1).split(",");T.push(I)}),processX(P,T,0,C,A)}else A.push(P);return A}const isSingleItem=P=>!Array.isArray(P);class Resolver{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(_,C)=>`${_}${this._bundleIdConnector}${C}`,extractAssetIdFromBundle:(_,C)=>C.replace(`${_}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(_){if(this._bundleIdConnector=_.connector??this._bundleIdConnector,this._createBundleAssetId=_.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=_.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(..._){_.forEach(C=>{this._preferredOrder.push(C),C.priority||(C.priority=Object.keys(C.params))}),this._resolverHash={}}set basePath(_){this._basePath=_}get basePath(){return this._basePath}set rootPath(_){this._rootPath=_}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(_){if(typeof _=="string")this._defaultSearchParams=_;else{const C=_;this._defaultSearchParams=Object.keys(C).map(A=>`${encodeURIComponent(A)}=${encodeURIComponent(C[A])}`).join("&")}}getAlias(_){const{alias:C,src:A}=_;return convertToList(C||A,E=>typeof E=="string"?E:Array.isArray(E)?E.map(I=>(I==null?void 0:I.src)??I):E!=null&&E.src?E.src:E,!0)}addManifest(_){this._manifest&&warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=_,_.bundles.forEach(C=>{this.addBundle(C.name,C.assets)})}addBundle(_,C){const A=[];let T=C;Array.isArray(C)||(T=Object.entries(C).map(([E,I])=>typeof I=="string"||Array.isArray(I)?{alias:E,src:I}:{alias:E,...I})),T.forEach(E=>{const I=E.src,F=E.alias;let B;if(typeof F=="string"){const G=this._createBundleAssetId(_,F);A.push(G),B=[F,G]}else{const G=F.map(R=>this._createBundleAssetId(_,R));A.push(...G),B=[...F,...G]}this.add({...E,alias:B,src:I})}),this._bundles[_]=A}add(_){const C=[];Array.isArray(_)?C.push(..._):C.push(_);let A;A=E=>{this.hasKey(E)&&warn(`[Resolver] already has key: ${E} overwriting`)},convertToList(C).forEach(E=>{const{src:I}=E;let{data:F,format:B,loadParser:G}=E;const R=convertToList(I).map(L=>typeof L=="string"?createStringVariations(L):Array.isArray(L)?L:[L]),z=this.getAlias(E);Array.isArray(z)?z.forEach(A):A(z);const D=[];R.forEach(L=>{L.forEach(O=>{let V={};if(typeof O!="object"){V.src=O;for(let U=0;U<this._parsers.length;U++){const W=this._parsers[U];if(W.test(O)){V=W.parse(O);break}}}else F=O.data??F,B=O.format??B,G=O.loadParser??G,V={...V,...O};if(!z)throw new Error(`[Resolver] alias is undefined for this asset: ${V.src}`);V=this._buildResolvedAsset(V,{aliases:z,data:F,format:B,loadParser:G}),D.push(V)})}),z.forEach(L=>{this._assetMap[L]=D})})}resolveBundle(_){const C=isSingleItem(_);_=convertToList(_);const A={};return _.forEach(T=>{const E=this._bundles[T];if(E){const I=this.resolve(E),F={};for(const B in I){const G=I[B];F[this._extractAssetIdFromBundle(T,B)]=G}A[T]=F}}),C?A[_[0]]:A}resolveUrl(_){const C=this.resolve(_);if(typeof _!="string"){const A={};for(const T in C)A[T]=C[T].src;return A}return C.src}resolve(_){const C=isSingleItem(_);_=convertToList(_);const A={};return _.forEach(T=>{if(!this._resolverHash[T])if(this._assetMap[T]){let E=this._assetMap[T];const I=this._getPreferredOrder(E);I==null||I.priority.forEach(F=>{I.params[F].forEach(B=>{const G=E.filter(R=>R[F]?R[F]===B:!1);G.length&&(E=G)})}),this._resolverHash[T]=E[0]}else this._resolverHash[T]=this._buildResolvedAsset({alias:[T],src:T},{});A[T]=this._resolverHash[T]}),C?A[_[0]]:A}hasKey(_){return!!this._assetMap[_]}hasBundle(_){return!!this._bundles[_]}_getPreferredOrder(_){for(let C=0;C<_.length;C++){const A=_[C],T=this._preferredOrder.find(E=>E.params.format.includes(A.format));if(T)return T}return this._preferredOrder[0]}_appendDefaultSearchParams(_){if(!this._defaultSearchParams)return _;const C=/\?/.test(_)?"&":"?";return`${_}${C}${this._defaultSearchParams}`}_buildResolvedAsset(_,C){const{aliases:A,data:T,loadParser:E,format:I}=C;return(this._basePath||this._rootPath)&&(_.src=path.toAbsolute(_.src,this._basePath,this._rootPath)),_.alias=A??_.alias??[_.src],_.src=this._appendDefaultSearchParams(_.src),_.data={...T||{},..._.data},_.loadParser=E??_.loadParser,_.format=I??_.format??getUrlExtension(_.src),_}}Resolver.RETINA_PREFIX=/@([0-9\.]+)x/;function getUrlExtension(P){return P.split(".").pop().split("?").shift().split("#").shift()}const copySearchParams=(P,_)=>{const C=_.split("?")[1];return C&&(P+=`?${C}`),P},_Spritesheet=class Yt{constructor(_,C){this.linkedSheets=[],this._texture=_ instanceof Texture?_:null,this.textureSource=_.source,this.textures={},this.animations={},this.data=C;const A=parseFloat(C.meta.scale);A?(this.resolution=A,_.source.resolution=this.resolution):this.resolution=_.source._resolution,this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}parse(){return new Promise(_=>{this._callback=_,this._batchIndex=0,this._frameKeys.length<=Yt.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(_){let C=_;const A=Yt.BATCH_SIZE;for(;C-_<A&&C<this._frameKeys.length;){const T=this._frameKeys[C],E=this._frames[T],I=E.frame;if(I){let F=null,B=null;const G=E.trimmed!==!1&&E.sourceSize?E.sourceSize:E.frame,R=new Rectangle(0,0,Math.floor(G.w)/this.resolution,Math.floor(G.h)/this.resolution);E.rotated?F=new Rectangle(Math.floor(I.x)/this.resolution,Math.floor(I.y)/this.resolution,Math.floor(I.h)/this.resolution,Math.floor(I.w)/this.resolution):F=new Rectangle(Math.floor(I.x)/this.resolution,Math.floor(I.y)/this.resolution,Math.floor(I.w)/this.resolution,Math.floor(I.h)/this.resolution),E.trimmed!==!1&&E.spriteSourceSize&&(B=new Rectangle(Math.floor(E.spriteSourceSize.x)/this.resolution,Math.floor(E.spriteSourceSize.y)/this.resolution,Math.floor(I.w)/this.resolution,Math.floor(I.h)/this.resolution)),this.textures[T]=new Texture({source:this.textureSource,frame:F,orig:R,trim:B,rotate:E.rotated?2:0,defaultAnchor:E.anchor,defaultBorders:E.borders,label:T.toString()})}C++}}_processAnimations(){const _=this.data.animations||{};for(const C in _){this.animations[C]=[];for(let A=0;A<_[C].length;A++){const T=_[C][A];this.animations[C].push(this.textures[T])}}}_parseComplete(){const _=this._callback;this._callback=null,this._batchIndex=0,_.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*Yt.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*Yt.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(_=!1){var C;for(const A in this.textures)this.textures[A].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,_&&((C=this._texture)==null||C.destroy(),this.textureSource.destroy()),this._texture=null,this.textureSource=null,this.linkedSheets=[]}};_Spritesheet.BATCH_SIZE=1e3;let Spritesheet=_Spritesheet;const validImages=["jpg","png","jpeg","avif","webp","basis","etc2","bc7","bc6h","bc5","bc4","bc3","bc2","bc1","eac","astc"];function getCacheableAssets(P,_,C){const A={};if(P.forEach(T=>{A[T]=_}),Object.keys(_.textures).forEach(T=>{A[T]=_.textures[T]}),!C){const T=path.dirname(P[0]);_.linkedSheets.forEach((E,I)=>{const F=getCacheableAssets([`${T}/${_.data.meta.related_multi_packs[I]}`],E,!0);Object.assign(A,F)})}return A}const spritesheetAsset={extension:ExtensionType.Asset,cache:{test:P=>P instanceof Spritesheet,getCacheableAssets:(P,_)=>getCacheableAssets(P,_,!1)},resolver:{extension:{type:ExtensionType.ResolveParser,name:"resolveSpritesheet"},test:P=>{const C=P.split("?")[0].split("."),A=C.pop(),T=C.pop();return A==="json"&&validImages.includes(T)},parse:P=>{var C;const _=P.split(".");return{resolution:parseFloat(((C=Resolver.RETINA_PREFIX.exec(P))==null?void 0:C[1])??"1"),format:_[_.length-2],src:P}}},loader:{name:"spritesheetLoader",extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.Normal,name:"spritesheetLoader"},async testParse(P,_){return path.extname(_.src).toLowerCase()===".json"&&!!P.frames},async parse(P,_,C){var R,z;const{texture:A,imageFilename:T,textureOptions:E}=(_==null?void 0:_.data)??{};let I=path.dirname(_.src);I&&I.lastIndexOf("/")!==I.length-1&&(I+="/");let F;if(A instanceof Texture)F=A;else{const D=copySearchParams(I+(T??P.meta.image),_.src);F=(await C.load([{src:D,data:E}]))[D]}const B=new Spritesheet(F.source,P);await B.parse();const G=(R=P==null?void 0:P.meta)==null?void 0:R.related_multi_packs;if(Array.isArray(G)){const D=[];for(const O of G){if(typeof O!="string")continue;let V=I+O;(z=_.data)!=null&&z.ignoreMultiPack||(V=copySearchParams(V,_.src),D.push(C.load({src:V,data:{textureOptions:E,ignoreMultiPack:!0}})))}const L=await Promise.all(D);B.linkedSheets=L,L.forEach(O=>{O.linkedSheets=[B].concat(B.linkedSheets.filter(V=>V!==O))})}return B},async unload(P,_,C){await C.unload(P.textureSource._sourceOrigin),P.destroy(!1)}}};extensions.add(spritesheetAsset);const idCounts=Object.create(null),idHash=Object.create(null);function createIdFromString(P,_){let C=idHash[P];return C===void 0&&(idCounts[_]===void 0&&(idCounts[_]=1),idHash[P]=C=idCounts[_]++),C}let context;function getTestContext(){return(!context||context!=null&&context.isContextLost())&&(context=DOMAdapter.get().createCanvas().getContext("webgl",{})),context}let maxFragmentPrecision;function getMaxFragmentPrecision(){if(!maxFragmentPrecision){maxFragmentPrecision="mediump";const P=getTestContext();P&&P.getShaderPrecisionFormat&&(maxFragmentPrecision=P.getShaderPrecisionFormat(P.FRAGMENT_SHADER,P.HIGH_FLOAT).precision?"highp":"mediump")}return maxFragmentPrecision}function addProgramDefines(P,_,C){return _?P:C?(P=P.replace("out vec4 finalColor;",""),`
        
        #ifdef GL_ES // This checks if it is WebGL1
        #define in varying
        #define finalColor gl_FragColor
        #define texture texture2D
        #endif
        ${P}
        `):`
        
        #ifdef GL_ES // This checks if it is WebGL1
        #define in attribute
        #define out varying
        #endif
        ${P}
        `}function ensurePrecision(P,_,C){const A=C?_.maxSupportedFragmentPrecision:_.maxSupportedVertexPrecision;if(P.substring(0,9)!=="precision"){let T=C?_.requestedFragmentPrecision:_.requestedVertexPrecision;return T==="highp"&&A!=="highp"&&(T="mediump"),`precision ${T} float;
${P}`}else if(A!=="highp"&&P.substring(0,15)==="precision highp")return P.replace("precision highp","precision mediump");return P}function insertVersion(P,_){return _?`#version 300 es
${P}`:P}const fragmentNameCache={},VertexNameCache={};function setProgramName(P,{name:_="pixi-program"},C=!0){_=_.replace(/\s+/g,"-"),_+=C?"-fragment":"-vertex";const A=C?fragmentNameCache:VertexNameCache;return A[_]?(A[_]++,_+=`-${A[_]}`):A[_]=1,P.indexOf("#define SHADER_NAME")!==-1?P:`${`#define SHADER_NAME ${_}`}
${P}`}function stripVersion(P,_){return _?P.replace("#version 300 es",""):P}const processes={stripVersion,ensurePrecision,addProgramDefines,setProgramName,insertVersion},programCache$1=Object.create(null),_GlProgram=class Zt{constructor(_){_={...Zt.defaultOptions,..._};const C=_.fragment.indexOf("#version 300 es")!==-1,A={stripVersion:C,ensurePrecision:{requestedFragmentPrecision:_.preferredFragmentPrecision,requestedVertexPrecision:_.preferredVertexPrecision,maxSupportedVertexPrecision:"highp",maxSupportedFragmentPrecision:getMaxFragmentPrecision()},setProgramName:{name:_.name},addProgramDefines:C,insertVersion:C};let T=_.fragment,E=_.vertex;Object.keys(processes).forEach(I=>{const F=A[I];T=processes[I](T,F,!0),E=processes[I](E,F,!1)}),this.fragment=T,this.vertex=E,this.transformFeedbackVaryings=_.transformFeedbackVaryings,this._key=createIdFromString(`${this.vertex}:${this.fragment}`,"gl-program")}destroy(){this.fragment=null,this.vertex=null,this._attributeData=null,this._uniformData=null,this._uniformBlockData=null,this.transformFeedbackVaryings=null}static from(_){const C=`${_.vertex}:${_.fragment}`;return programCache$1[C]||(programCache$1[C]=new Zt(_)),programCache$1[C]}};_GlProgram.defaultOptions={preferredVertexPrecision:"highp",preferredFragmentPrecision:"mediump"};let GlProgram=_GlProgram;const attributeFormatData={uint8x2:{size:2,stride:2,normalised:!1},uint8x4:{size:4,stride:4,normalised:!1},sint8x2:{size:2,stride:2,normalised:!1},sint8x4:{size:4,stride:4,normalised:!1},unorm8x2:{size:2,stride:2,normalised:!0},unorm8x4:{size:4,stride:4,normalised:!0},snorm8x2:{size:2,stride:2,normalised:!0},snorm8x4:{size:4,stride:4,normalised:!0},uint16x2:{size:2,stride:4,normalised:!1},uint16x4:{size:4,stride:8,normalised:!1},sint16x2:{size:2,stride:4,normalised:!1},sint16x4:{size:4,stride:8,normalised:!1},unorm16x2:{size:2,stride:4,normalised:!0},unorm16x4:{size:4,stride:8,normalised:!0},snorm16x2:{size:2,stride:4,normalised:!0},snorm16x4:{size:4,stride:8,normalised:!0},float16x2:{size:2,stride:4,normalised:!1},float16x4:{size:4,stride:8,normalised:!1},float32:{size:1,stride:4,normalised:!1},float32x2:{size:2,stride:8,normalised:!1},float32x3:{size:3,stride:12,normalised:!1},float32x4:{size:4,stride:16,normalised:!1},uint32:{size:1,stride:4,normalised:!1},uint32x2:{size:2,stride:8,normalised:!1},uint32x3:{size:3,stride:12,normalised:!1},uint32x4:{size:4,stride:16,normalised:!1},sint32:{size:1,stride:4,normalised:!1},sint32x2:{size:2,stride:8,normalised:!1},sint32x3:{size:3,stride:12,normalised:!1},sint32x4:{size:4,stride:16,normalised:!1}};function getAttributeInfoFromFormat(P){return attributeFormatData[P]??attributeFormatData.float32}const WGSL_TO_VERTEX_TYPES={f32:"float32","vec2<f32>":"float32x2","vec3<f32>":"float32x3","vec4<f32>":"float32x4",vec2f:"float32x2",vec3f:"float32x3",vec4f:"float32x4",i32:"sint32","vec2<i32>":"sint32x2","vec3<i32>":"sint32x3","vec4<i32>":"sint32x4",u32:"uint32","vec2<u32>":"uint32x2","vec3<u32>":"uint32x3","vec4<u32>":"uint32x4",bool:"uint32","vec2<bool>":"uint32x2","vec3<bool>":"uint32x3","vec4<bool>":"uint32x4"};function extractAttributesFromGpuProgram({source:P,entryPoint:_}){const C={},A=P.indexOf(`fn ${_}`);if(A!==-1){const T=P.indexOf("->",A);if(T!==-1){const E=P.substring(A,T),I=/@location\((\d+)\)\s+([a-zA-Z0-9_]+)\s*:\s*([a-zA-Z0-9_<>]+)(?:,|\s|$)/g;let F;for(;(F=I.exec(E))!==null;){const B=WGSL_TO_VERTEX_TYPES[F[3]]??"float32";C[F[2]]={location:parseInt(F[1],10),format:B,stride:getAttributeInfoFromFormat(B).stride,offset:0,instance:!1,start:0}}}}return C}function extractStructAndGroups(P){var z,D;const _=/(^|[^/])@(group|binding)\(\d+\)[^;]+;/g,C=/@group\((\d+)\)/,A=/@binding\((\d+)\)/,T=/var(<[^>]+>)? (\w+)/,E=/:\s*(\w+)/,I=/struct\s+(\w+)\s*{([^}]+)}/g,F=/(\w+)\s*:\s*([\w\<\>]+)/g,B=/struct\s+(\w+)/,G=(z=P.match(_))==null?void 0:z.map(L=>({group:parseInt(L.match(C)[1],10),binding:parseInt(L.match(A)[1],10),name:L.match(T)[2],isUniform:L.match(T)[1]==="<uniform>",type:L.match(E)[1]}));if(!G)return{groups:[],structs:[]};const R=((D=P.match(I))==null?void 0:D.map(L=>{const O=L.match(B)[1],V=L.match(F).reduce((U,W)=>{const[X,Y]=W.split(":");return U[X.trim()]=Y.trim(),U},{});return V?{name:O,members:V}:null}).filter(({name:L})=>G.some(O=>O.type===L)))??[];return{groups:G,structs:R}}var ShaderStage=(P=>(P[P.VERTEX=1]="VERTEX",P[P.FRAGMENT=2]="FRAGMENT",P[P.COMPUTE=4]="COMPUTE",P))(ShaderStage||{});function generateGpuLayoutGroups({groups:P}){const _=[];for(let C=0;C<P.length;C++){const A=P[C];_[A.group]||(_[A.group]=[]),A.isUniform?_[A.group].push({binding:A.binding,visibility:ShaderStage.VERTEX|ShaderStage.FRAGMENT,buffer:{type:"uniform"}}):A.type==="sampler"?_[A.group].push({binding:A.binding,visibility:ShaderStage.FRAGMENT,sampler:{type:"filtering"}}):A.type==="texture_2d"&&_[A.group].push({binding:A.binding,visibility:ShaderStage.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d",multisampled:!1}})}return _}function generateLayoutHash({groups:P}){const _=[];for(let C=0;C<P.length;C++){const A=P[C];_[A.group]||(_[A.group]={}),_[A.group][A.name]=A.binding}return _}function removeStructAndGroupDuplicates(P,_){const C=new Set,A=new Set,T=[...P.structs,..._.structs].filter(I=>C.has(I.name)?!1:(C.add(I.name),!0)),E=[...P.groups,..._.groups].filter(I=>{const F=`${I.name}-${I.binding}`;return A.has(F)?!1:(A.add(F),!0)});return{structs:T,groups:E}}const programCache=Object.create(null);class GpuProgram{constructor(_){var F,B;this._layoutKey=0,this._attributeLocationsKey=0;const{fragment:C,vertex:A,layout:T,gpuLayout:E,name:I}=_;if(this.name=I,this.fragment=C,this.vertex=A,C.source===A.source){const G=extractStructAndGroups(C.source);this.structsAndGroups=G}else{const G=extractStructAndGroups(A.source),R=extractStructAndGroups(C.source);this.structsAndGroups=removeStructAndGroupDuplicates(G,R)}this.layout=T??generateLayoutHash(this.structsAndGroups),this.gpuLayout=E??generateGpuLayoutGroups(this.structsAndGroups),this.autoAssignGlobalUniforms=((F=this.layout[0])==null?void 0:F.globalUniforms)!==void 0,this.autoAssignLocalUniforms=((B=this.layout[1])==null?void 0:B.localUniforms)!==void 0,this._generateProgramKey()}_generateProgramKey(){const{vertex:_,fragment:C}=this,A=_.source+C.source+_.entryPoint+C.entryPoint;this._layoutKey=createIdFromString(A,"program")}get attributeData(){return this._attributeData??(this._attributeData=extractAttributesFromGpuProgram(this.vertex)),this._attributeData}destroy(){this.gpuLayout=null,this.layout=null,this.structsAndGroups=null,this.fragment=null,this.vertex=null}static from(_){const C=`${_.vertex.source}:${_.fragment.source}:${_.fragment.entryPoint}:${_.vertex.entryPoint}`;return programCache[C]||(programCache[C]=new GpuProgram(_)),programCache[C]}}const UNIFORM_TYPES_VALUES=["f32","i32","vec2<f32>","vec3<f32>","vec4<f32>","mat2x2<f32>","mat3x3<f32>","mat4x4<f32>","mat3x2<f32>","mat4x2<f32>","mat2x3<f32>","mat4x3<f32>","mat2x4<f32>","mat3x4<f32>","vec2<i32>","vec3<i32>","vec4<i32>"],UNIFORM_TYPES_MAP=UNIFORM_TYPES_VALUES.reduce((P,_)=>(P[_]=!0,P),{});function getDefaultUniformValue(P,_){switch(P){case"f32":return 0;case"vec2<f32>":return new Float32Array(2*_);case"vec3<f32>":return new Float32Array(3*_);case"vec4<f32>":return new Float32Array(4*_);case"mat2x2<f32>":return new Float32Array([1,0,0,1]);case"mat3x3<f32>":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4x4<f32>":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const _UniformGroup=class se{constructor(_,C){this._touched=0,this.uid=uid("uniform"),this._resourceType="uniformGroup",this._resourceId=uid("resource"),this.isUniformGroup=!0,this._dirtyId=0,this.destroyed=!1,C={...se.defaultOptions,...C},this.uniformStructures=_;const A={};for(const T in _){const E=_[T];if(E.name=T,E.size=E.size??1,!UNIFORM_TYPES_MAP[E.type])throw new Error(`Uniform type ${E.type} is not supported. Supported uniform types are: ${UNIFORM_TYPES_VALUES.join(", ")}`);E.value??(E.value=getDefaultUniformValue(E.type,E.size)),A[T]=E.value}this.uniforms=A,this._dirtyId=1,this.ubo=C.ubo,this.isStatic=C.isStatic,this._signature=createIdFromString(Object.keys(A).map(T=>`${T}-${_[T].type}`).join("-"),"uniform-group")}update(){this._dirtyId++}};_UniformGroup.defaultOptions={ubo:!1,isStatic:!1};let UniformGroup=_UniformGroup;class BindGroup{constructor(_){this.resources=Object.create(null),this._dirty=!0;let C=0;for(const A in _){const T=_[A];this.setResource(T,C++)}this._updateKey()}_updateKey(){if(!this._dirty)return;this._dirty=!1;const _=[];let C=0;for(const A in this.resources)_[C++]=this.resources[A]._resourceId;this._key=_.join("|")}setResource(_,C){var T,E;const A=this.resources[C];_!==A&&(A&&((T=_.off)==null||T.call(_,"change",this.onResourceChange,this)),(E=_.on)==null||E.call(_,"change",this.onResourceChange,this),this.resources[C]=_,this._dirty=!0)}getResource(_){return this.resources[_]}_touch(_){const C=this.resources;for(const A in C)C[A]._touched=_}destroy(){var C;const _=this.resources;for(const A in _){const T=_[A];(C=T.off)==null||C.call(T,"change",this.onResourceChange,this)}this.resources=null}onResourceChange(_){if(this._dirty=!0,_.destroyed){const C=this.resources;for(const A in C)C[A]===_&&(C[A]=null)}else this._updateKey()}}var RendererType=(P=>(P[P.WEBGL=1]="WEBGL",P[P.WEBGPU=2]="WEBGPU",P[P.BOTH=3]="BOTH",P))(RendererType||{});class Shader extends EventEmitter{constructor(_){super(),this.uid=uid("shader"),this._uniformBindMap=Object.create(null),this._ownedBindGroups=[];let{gpuProgram:C,glProgram:A,groups:T,resources:E,compatibleRenderers:I,groupMap:F}=_;this.gpuProgram=C,this.glProgram=A,I===void 0&&(I=0,C&&(I|=RendererType.WEBGPU),A&&(I|=RendererType.WEBGL)),this.compatibleRenderers=I;const B={};if(!E&&!T&&(E={}),E&&T)throw new Error("[Shader] Cannot have both resources and groups");if(!C&&T&&!F)throw new Error("[Shader] No group map or WebGPU shader provided - consider using resources instead.");if(!C&&T&&F)for(const G in F)for(const R in F[G]){const z=F[G][R];B[z]={group:G,binding:R,name:z}}else if(C&&T&&!F){const G=C.structsAndGroups.groups;F={},G.forEach(R=>{F[R.group]=F[R.group]||{},F[R.group][R.binding]=R.name,B[R.name]=R})}else if(E){T={},F={},C&&C.structsAndGroups.groups.forEach(z=>{F[z.group]=F[z.group]||{},F[z.group][z.binding]=z.name,B[z.name]=z});let G=0;for(const R in E)B[R]||(T[99]||(T[99]=new BindGroup,this._ownedBindGroups.push(T[99])),B[R]={group:99,binding:G,name:R},F[99]=F[99]||{},F[99][G]=R,G++);for(const R in E){const z=R;let D=E[R];!D.source&&!D._resourceType&&(D=new UniformGroup(D));const L=B[z];L&&(T[L.group]||(T[L.group]=new BindGroup,this._ownedBindGroups.push(T[L.group])),T[L.group].setResource(D,L.binding))}}this.groups=T,this._uniformBindMap=F,this.resources=this._buildResourceAccessor(T,B)}addResource(_,C,A){var T,E;(T=this._uniformBindMap)[C]||(T[C]={}),(E=this._uniformBindMap[C])[A]||(E[A]=_),this.groups[C]||(this.groups[C]=new BindGroup,this._ownedBindGroups.push(this.groups[C]))}_buildResourceAccessor(_,C){const A={};for(const T in C){const E=C[T];Object.defineProperty(A,E.name,{get(){return _[E.group].getResource(E.binding)},set(I){_[E.group].setResource(I,E.binding)}})}return A}destroy(_=!1){var C,A;this.emit("destroy",this),_&&((C=this.gpuProgram)==null||C.destroy(),(A=this.glProgram)==null||A.destroy()),this.gpuProgram=null,this.glProgram=null,this.removeAllListeners(),this._uniformBindMap=null,this._ownedBindGroups.forEach(T=>{T.destroy()}),this._ownedBindGroups=null,this.resources=null,this.groups=null}static from(_){const{gpu:C,gl:A,...T}=_;let E,I;return C&&(E=GpuProgram.from(C)),A&&(I=GlProgram.from(A)),new Shader({gpuProgram:E,glProgram:I,...T})}}const environments=[];extensions.handleByNamedList(ExtensionType.Environment,environments);async function loadEnvironmentExtensions(P){if(!P)for(let _=0;_<environments.length;_++){const C=environments[_];if(C.value.test()){await C.value.load();return}}}let unsafeEval;function unsafeEvalSupported(){if(typeof unsafeEval=="boolean")return unsafeEval;try{unsafeEval=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{unsafeEval=!1}return unsafeEval}var earcut$1={exports:{}},hasRequiredEarcut;function requireEarcut(){if(hasRequiredEarcut)return earcut$1.exports;hasRequiredEarcut=1,earcut$1.exports=P,earcut$1.exports.default=P;function P(Q,it,Z){Z=Z||2;var et=it&&it.length,ht=et?it[0]*Z:Q.length,lt=_(Q,0,ht,Z,!0),ft=[];if(!lt||lt.next===lt.prev)return ft;var pt,mt,gt,yt,bt,xt,Et;if(et&&(lt=B(Q,it,lt,Z)),Q.length>80*Z){pt=gt=Q[0],mt=yt=Q[1];for(var _t=Z;_t<ht;_t+=Z)bt=Q[_t],xt=Q[_t+1],bt<pt&&(pt=bt),xt<mt&&(mt=xt),bt>gt&&(gt=bt),xt>yt&&(yt=xt);Et=Math.max(gt-pt,yt-mt),Et=Et!==0?32767/Et:0}return A(lt,ft,Z,pt,mt,Et,0),ft}function _(Q,it,Z,et,ht){var lt,ft;if(ht===ut(Q,it,Z,et)>0)for(lt=it;lt<Z;lt+=et)ft=ot(lt,Q[lt],Q[lt+1],ft);else for(lt=Z-et;lt>=it;lt-=et)ft=ot(lt,Q[lt],Q[lt+1],ft);return ft&&K(ft,ft.next)&&(ct(ft),ft=ft.next),ft}function C(Q,it){if(!Q)return Q;it||(it=Q);var Z=Q,et;do if(et=!1,!Z.steiner&&(K(Z,Z.next)||Y(Z.prev,Z,Z.next)===0)){if(ct(Z),Z=it=Z.prev,Z===Z.next)break;et=!0}else Z=Z.next;while(et||Z!==it);return it}function A(Q,it,Z,et,ht,lt,ft){if(Q){!ft&&lt&&L(Q,et,ht,lt);for(var pt=Q,mt,gt;Q.prev!==Q.next;){if(mt=Q.prev,gt=Q.next,lt?E(Q,et,ht,lt):T(Q)){it.push(mt.i/Z|0),it.push(Q.i/Z|0),it.push(gt.i/Z|0),ct(Q),Q=gt.next,pt=gt.next;continue}if(Q=gt,Q===pt){ft?ft===1?(Q=I(C(Q),it,Z),A(Q,it,Z,et,ht,lt,2)):ft===2&&F(Q,it,Z,et,ht,lt):A(C(Q),it,Z,et,ht,lt,1);break}}}}function T(Q){var it=Q.prev,Z=Q,et=Q.next;if(Y(it,Z,et)>=0)return!1;for(var ht=it.x,lt=Z.x,ft=et.x,pt=it.y,mt=Z.y,gt=et.y,yt=ht<lt?ht<ft?ht:ft:lt<ft?lt:ft,bt=pt<mt?pt<gt?pt:gt:mt<gt?mt:gt,xt=ht>lt?ht>ft?ht:ft:lt>ft?lt:ft,Et=pt>mt?pt>gt?pt:gt:mt>gt?mt:gt,_t=et.next;_t!==it;){if(_t.x>=yt&&_t.x<=xt&&_t.y>=bt&&_t.y<=Et&&W(ht,pt,lt,mt,ft,gt,_t.x,_t.y)&&Y(_t.prev,_t,_t.next)>=0)return!1;_t=_t.next}return!0}function E(Q,it,Z,et){var ht=Q.prev,lt=Q,ft=Q.next;if(Y(ht,lt,ft)>=0)return!1;for(var pt=ht.x,mt=lt.x,gt=ft.x,yt=ht.y,bt=lt.y,xt=ft.y,Et=pt<mt?pt<gt?pt:gt:mt<gt?mt:gt,_t=yt<bt?yt<xt?yt:xt:bt<xt?bt:xt,Tt=pt>mt?pt>gt?pt:gt:mt>gt?mt:gt,At=yt>bt?yt>xt?yt:xt:bt>xt?bt:xt,wt=V(Et,_t,it,Z,et),vt=V(Tt,At,it,Z,et),Pt=Q.prevZ,Ct=Q.nextZ;Pt&&Pt.z>=wt&&Ct&&Ct.z<=vt;){if(Pt.x>=Et&&Pt.x<=Tt&&Pt.y>=_t&&Pt.y<=At&&Pt!==ht&&Pt!==ft&&W(pt,yt,mt,bt,gt,xt,Pt.x,Pt.y)&&Y(Pt.prev,Pt,Pt.next)>=0||(Pt=Pt.prevZ,Ct.x>=Et&&Ct.x<=Tt&&Ct.y>=_t&&Ct.y<=At&&Ct!==ht&&Ct!==ft&&W(pt,yt,mt,bt,gt,xt,Ct.x,Ct.y)&&Y(Ct.prev,Ct,Ct.next)>=0))return!1;Ct=Ct.nextZ}for(;Pt&&Pt.z>=wt;){if(Pt.x>=Et&&Pt.x<=Tt&&Pt.y>=_t&&Pt.y<=At&&Pt!==ht&&Pt!==ft&&W(pt,yt,mt,bt,gt,xt,Pt.x,Pt.y)&&Y(Pt.prev,Pt,Pt.next)>=0)return!1;Pt=Pt.prevZ}for(;Ct&&Ct.z<=vt;){if(Ct.x>=Et&&Ct.x<=Tt&&Ct.y>=_t&&Ct.y<=At&&Ct!==ht&&Ct!==ft&&W(pt,yt,mt,bt,gt,xt,Ct.x,Ct.y)&&Y(Ct.prev,Ct,Ct.next)>=0)return!1;Ct=Ct.nextZ}return!0}function I(Q,it,Z){var et=Q;do{var ht=et.prev,lt=et.next.next;!K(ht,lt)&&q(ht,et,et.next,lt)&&st(ht,lt)&&st(lt,ht)&&(it.push(ht.i/Z|0),it.push(et.i/Z|0),it.push(lt.i/Z|0),ct(et),ct(et.next),et=Q=lt),et=et.next}while(et!==Q);return C(et)}function F(Q,it,Z,et,ht,lt){var ft=Q;do{for(var pt=ft.next.next;pt!==ft.prev;){if(ft.i!==pt.i&&X(ft,pt)){var mt=at(ft,pt);ft=C(ft,ft.next),mt=C(mt,mt.next),A(ft,it,Z,et,ht,lt,0),A(mt,it,Z,et,ht,lt,0);return}pt=pt.next}ft=ft.next}while(ft!==Q)}function B(Q,it,Z,et){var ht=[],lt,ft,pt,mt,gt;for(lt=0,ft=it.length;lt<ft;lt++)pt=it[lt]*et,mt=lt<ft-1?it[lt+1]*et:Q.length,gt=_(Q,pt,mt,et,!1),gt===gt.next&&(gt.steiner=!0),ht.push(U(gt));for(ht.sort(G),lt=0;lt<ht.length;lt++)Z=R(ht[lt],Z);return Z}function G(Q,it){return Q.x-it.x}function R(Q,it){var Z=z(Q,it);if(!Z)return it;var et=at(Z,Q);return C(et,et.next),C(Z,Z.next)}function z(Q,it){var Z=it,et=Q.x,ht=Q.y,lt=-1/0,ft;do{if(ht<=Z.y&&ht>=Z.next.y&&Z.next.y!==Z.y){var pt=Z.x+(ht-Z.y)*(Z.next.x-Z.x)/(Z.next.y-Z.y);if(pt<=et&&pt>lt&&(lt=pt,ft=Z.x<Z.next.x?Z:Z.next,pt===et))return ft}Z=Z.next}while(Z!==it);if(!ft)return null;var mt=ft,gt=ft.x,yt=ft.y,bt=1/0,xt;Z=ft;do et>=Z.x&&Z.x>=gt&&et!==Z.x&&W(ht<yt?et:lt,ht,gt,yt,ht<yt?lt:et,ht,Z.x,Z.y)&&(xt=Math.abs(ht-Z.y)/(et-Z.x),st(Z,Q)&&(xt<bt||xt===bt&&(Z.x>ft.x||Z.x===ft.x&&D(ft,Z)))&&(ft=Z,bt=xt)),Z=Z.next;while(Z!==mt);return ft}function D(Q,it){return Y(Q.prev,Q,it.prev)<0&&Y(it.next,Q,Q.next)<0}function L(Q,it,Z,et){var ht=Q;do ht.z===0&&(ht.z=V(ht.x,ht.y,it,Z,et)),ht.prevZ=ht.prev,ht.nextZ=ht.next,ht=ht.next;while(ht!==Q);ht.prevZ.nextZ=null,ht.prevZ=null,O(ht)}function O(Q){var it,Z,et,ht,lt,ft,pt,mt,gt=1;do{for(Z=Q,Q=null,lt=null,ft=0;Z;){for(ft++,et=Z,pt=0,it=0;it<gt&&(pt++,et=et.nextZ,!!et);it++);for(mt=gt;pt>0||mt>0&&et;)pt!==0&&(mt===0||!et||Z.z<=et.z)?(ht=Z,Z=Z.nextZ,pt--):(ht=et,et=et.nextZ,mt--),lt?lt.nextZ=ht:Q=ht,ht.prevZ=lt,lt=ht;Z=et}lt.nextZ=null,gt*=2}while(ft>1);return Q}function V(Q,it,Z,et,ht){return Q=(Q-Z)*ht|0,it=(it-et)*ht|0,Q=(Q|Q<<8)&16711935,Q=(Q|Q<<4)&252645135,Q=(Q|Q<<2)&858993459,Q=(Q|Q<<1)&1431655765,it=(it|it<<8)&16711935,it=(it|it<<4)&252645135,it=(it|it<<2)&858993459,it=(it|it<<1)&1431655765,Q|it<<1}function U(Q){var it=Q,Z=Q;do(it.x<Z.x||it.x===Z.x&&it.y<Z.y)&&(Z=it),it=it.next;while(it!==Q);return Z}function W(Q,it,Z,et,ht,lt,ft,pt){return(ht-ft)*(it-pt)>=(Q-ft)*(lt-pt)&&(Q-ft)*(et-pt)>=(Z-ft)*(it-pt)&&(Z-ft)*(lt-pt)>=(ht-ft)*(et-pt)}function X(Q,it){return Q.next.i!==it.i&&Q.prev.i!==it.i&&!rt(Q,it)&&(st(Q,it)&&st(it,Q)&&nt(Q,it)&&(Y(Q.prev,Q,it.prev)||Y(Q,it.prev,it))||K(Q,it)&&Y(Q.prev,Q,Q.next)>0&&Y(it.prev,it,it.next)>0)}function Y(Q,it,Z){return(it.y-Q.y)*(Z.x-it.x)-(it.x-Q.x)*(Z.y-it.y)}function K(Q,it){return Q.x===it.x&&Q.y===it.y}function q(Q,it,Z,et){var ht=tt(Y(Q,it,Z)),lt=tt(Y(Q,it,et)),ft=tt(Y(Z,et,Q)),pt=tt(Y(Z,et,it));return!!(ht!==lt&&ft!==pt||ht===0&&J(Q,Z,it)||lt===0&&J(Q,et,it)||ft===0&&J(Z,Q,et)||pt===0&&J(Z,it,et))}function J(Q,it,Z){return it.x<=Math.max(Q.x,Z.x)&&it.x>=Math.min(Q.x,Z.x)&&it.y<=Math.max(Q.y,Z.y)&&it.y>=Math.min(Q.y,Z.y)}function tt(Q){return Q>0?1:Q<0?-1:0}function rt(Q,it){var Z=Q;do{if(Z.i!==Q.i&&Z.next.i!==Q.i&&Z.i!==it.i&&Z.next.i!==it.i&&q(Z,Z.next,Q,it))return!0;Z=Z.next}while(Z!==Q);return!1}function st(Q,it){return Y(Q.prev,Q,Q.next)<0?Y(Q,it,Q.next)>=0&&Y(Q,Q.prev,it)>=0:Y(Q,it,Q.prev)<0||Y(Q,Q.next,it)<0}function nt(Q,it){var Z=Q,et=!1,ht=(Q.x+it.x)/2,lt=(Q.y+it.y)/2;do Z.y>lt!=Z.next.y>lt&&Z.next.y!==Z.y&&ht<(Z.next.x-Z.x)*(lt-Z.y)/(Z.next.y-Z.y)+Z.x&&(et=!et),Z=Z.next;while(Z!==Q);return et}function at(Q,it){var Z=new dt(Q.i,Q.x,Q.y),et=new dt(it.i,it.x,it.y),ht=Q.next,lt=it.prev;return Q.next=it,it.prev=Q,Z.next=ht,ht.prev=Z,et.next=Z,Z.prev=et,lt.next=et,et.prev=lt,et}function ot(Q,it,Z,et){var ht=new dt(Q,it,Z);return et?(ht.next=et.next,ht.prev=et,et.next.prev=ht,et.next=ht):(ht.prev=ht,ht.next=ht),ht}function ct(Q){Q.next.prev=Q.prev,Q.prev.next=Q.next,Q.prevZ&&(Q.prevZ.nextZ=Q.nextZ),Q.nextZ&&(Q.nextZ.prevZ=Q.prevZ)}function dt(Q,it,Z){this.i=Q,this.x=it,this.y=Z,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}P.deviation=function(Q,it,Z,et){var ht=it&&it.length,lt=ht?it[0]*Z:Q.length,ft=Math.abs(ut(Q,0,lt,Z));if(ht)for(var pt=0,mt=it.length;pt<mt;pt++){var gt=it[pt]*Z,yt=pt<mt-1?it[pt+1]*Z:Q.length;ft-=Math.abs(ut(Q,gt,yt,Z))}var bt=0;for(pt=0;pt<et.length;pt+=3){var xt=et[pt]*Z,Et=et[pt+1]*Z,_t=et[pt+2]*Z;bt+=Math.abs((Q[xt]-Q[_t])*(Q[Et+1]-Q[xt+1])-(Q[xt]-Q[Et])*(Q[_t+1]-Q[xt+1]))}return ft===0&&bt===0?0:Math.abs((bt-ft)/ft)};function ut(Q,it,Z,et){for(var ht=0,lt=it,ft=Z-et;lt<Z;lt+=et)ht+=(Q[ft]-Q[lt])*(Q[lt+1]+Q[ft+1]),ft=lt;return ht}return P.flatten=function(Q){for(var it=Q[0][0].length,Z={vertices:[],holes:[],dimensions:it},et=0,ht=0;ht<Q.length;ht++){for(var lt=0;lt<Q[ht].length;lt++)for(var ft=0;ft<it;ft++)Z.vertices.push(Q[ht][lt][ft]);ht>0&&(et+=Q[ht-1].length,Z.holes.push(et))}return Z},earcut$1.exports}var earcutExports=requireEarcut();const earcut=getDefaultExportFromCjs(earcutExports);var CLEAR=(P=>(P[P.NONE=0]="NONE",P[P.COLOR=16384]="COLOR",P[P.STENCIL=1024]="STENCIL",P[P.DEPTH=256]="DEPTH",P[P.COLOR_DEPTH=16640]="COLOR_DEPTH",P[P.COLOR_STENCIL=17408]="COLOR_STENCIL",P[P.DEPTH_STENCIL=1280]="DEPTH_STENCIL",P[P.ALL=17664]="ALL",P))(CLEAR||{});class SystemRunner{constructor(_){this.items=[],this._name=_}emit(_,C,A,T,E,I,F,B){const{name:G,items:R}=this;for(let z=0,D=R.length;z<D;z++)R[z][G](_,C,A,T,E,I,F,B);return this}add(_){return _[this._name]&&(this.remove(_),this.items.push(_)),this}remove(_){const C=this.items.indexOf(_);return C!==-1&&this.items.splice(C,1),this}contains(_){return this.items.indexOf(_)!==-1}removeAll(){return this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}const defaultRunners=["init","destroy","contextChange","resolutionChange","resetState","renderEnd","renderStart","render","update","postrender","prerender"],_AbstractRenderer=class ne extends EventEmitter{constructor(_){super(),this.runners=Object.create(null),this.renderPipes=Object.create(null),this._initOptions={},this._systemsHash=Object.create(null),this.type=_.type,this.name=_.name,this.config=_;const C=[...defaultRunners,...this.config.runners??[]];this._addRunners(...C),this._unsafeEvalCheck()}async init(_={}){const C=_.skipExtensionImports===!0?!0:_.manageImports===!1;await loadEnvironmentExtensions(C),this._addSystems(this.config.systems),this._addPipes(this.config.renderPipes,this.config.renderPipeAdaptors);for(const A in this._systemsHash)_={...this._systemsHash[A].constructor.defaultOptions,..._};_={...ne.defaultOptions,..._},this._roundPixels=_.roundPixels?1:0;for(let A=0;A<this.runners.init.items.length;A++)await this.runners.init.items[A].init(_);this._initOptions=_}render(_,C){let A=_;if(A instanceof Container&&(A={container:A},C&&(deprecation(v8_0_0,"passing a second argument is deprecated, please use render options instead"),A.target=C.renderTexture)),A.target||(A.target=this.view.renderTarget),A.target===this.view.renderTarget&&(this._lastObjectRendered=A.container,A.clearColor??(A.clearColor=this.background.colorRgba),A.clear??(A.clear=this.background.clearBeforeRender)),A.clearColor){const T=Array.isArray(A.clearColor)&&A.clearColor.length===4;A.clearColor=T?A.clearColor:Color.shared.setValue(A.clearColor).toArray()}A.transform||(A.container.updateLocalTransform(),A.transform=A.container.localTransform),A.container.enableRenderGroup(),this.runners.prerender.emit(A),this.runners.renderStart.emit(A),this.runners.render.emit(A),this.runners.renderEnd.emit(A),this.runners.postrender.emit(A)}resize(_,C,A){const T=this.view.resolution;this.view.resize(_,C,A),this.emit("resize",this.view.screen.width,this.view.screen.height,this.view.resolution),A!==void 0&&A!==T&&this.runners.resolutionChange.emit(A)}clear(_={}){const C=this;_.target||(_.target=C.renderTarget.renderTarget),_.clearColor||(_.clearColor=this.background.colorRgba),_.clear??(_.clear=CLEAR.ALL);const{clear:A,clearColor:T,target:E}=_;Color.shared.setValue(T??this.background.colorRgba),C.renderTarget.clear(E,A,Color.shared.toArray())}get resolution(){return this.view.resolution}set resolution(_){this.view.resolution=_,this.runners.resolutionChange.emit(_)}get width(){return this.view.texture.frame.width}get height(){return this.view.texture.frame.height}get canvas(){return this.view.canvas}get lastObjectRendered(){return this._lastObjectRendered}get renderingToScreen(){return this.renderTarget.renderingToScreen}get screen(){return this.view.screen}_addRunners(..._){_.forEach(C=>{this.runners[C]=new SystemRunner(C)})}_addSystems(_){let C;for(C in _){const A=_[C];this._addSystem(A.value,A.name)}}_addSystem(_,C){const A=new _(this);if(this[C])throw new Error(`Whoops! The name "${C}" is already in use`);this[C]=A,this._systemsHash[C]=A;for(const T in this.runners)this.runners[T].add(A);return this}_addPipes(_,C){const A=C.reduce((T,E)=>(T[E.name]=E.value,T),{});_.forEach(T=>{const E=T.value,I=T.name,F=A[I];this.renderPipes[I]=new E(this,F?new F:null)})}destroy(_=!1){this.runners.destroy.items.reverse(),this.runners.destroy.emit(_),Object.values(this.runners).forEach(C=>{C.destroy()}),this._systemsHash=null,this.renderPipes=null}generateTexture(_){return this.textureGenerator.generateTexture(_)}get roundPixels(){return!!this._roundPixels}_unsafeEvalCheck(){if(!unsafeEvalSupported())throw new Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")}resetState(){this.runners.resetState.emit()}};_AbstractRenderer.defaultOptions={resolution:1,failIfMajorPerformanceCaveat:!1,roundPixels:!1};let AbstractRenderer=_AbstractRenderer,_isWebGLSupported;function isWebGLSupported(P){return _isWebGLSupported!==void 0||(_isWebGLSupported=(()=>{var C;const _={stencil:!0,failIfMajorPerformanceCaveat:P??AbstractRenderer.defaultOptions.failIfMajorPerformanceCaveat};try{if(!DOMAdapter.get().getWebGLRenderingContext())return!1;let T=DOMAdapter.get().createCanvas().getContext("webgl",_);const E=!!((C=T==null?void 0:T.getContextAttributes())!=null&&C.stencil);if(T){const I=T.getExtension("WEBGL_lose_context");I&&I.loseContext()}return T=null,E}catch{return!1}})()),_isWebGLSupported}let _isWebGPUSupported;async function isWebGPUSupported(P={}){return _isWebGPUSupported!==void 0||(_isWebGPUSupported=await(async()=>{const _=DOMAdapter.get().getNavigator().gpu;if(!_)return!1;try{return await(await _.requestAdapter(P)).requestDevice(),!0}catch{return!1}})()),_isWebGPUSupported}const renderPriority=["webgl","webgpu","canvas"];async function autoDetectRenderer(P){let _=[];P.preference?(_.push(P.preference),renderPriority.forEach(E=>{E!==P.preference&&_.push(E)})):_=renderPriority.slice();let C,A={};for(let E=0;E<_.length;E++){const I=_[E];if(I==="webgpu"&&await isWebGPUSupported()){const{WebGPURenderer:F}=await __vitePreload(async()=>{const{WebGPURenderer:B}=await import("./WebGPURenderer-9sWckbSG.js");return{WebGPURenderer:B}},__vite__mapDeps([3,2,4]));C=F,A={...P,...P.webgpu};break}else if(I==="webgl"&&isWebGLSupported(P.failIfMajorPerformanceCaveat??AbstractRenderer.defaultOptions.failIfMajorPerformanceCaveat)){const{WebGLRenderer:F}=await __vitePreload(async()=>{const{WebGLRenderer:B}=await import("./WebGLRenderer--D_8BoSu.js");return{WebGLRenderer:B}},__vite__mapDeps([5,2,4]));C=F,A={...P,...P.webgl};break}else if(I==="canvas")throw A={...P},new Error("CanvasRenderer is not yet implemented")}if(delete A.webgpu,delete A.webgl,!C)throw new Error("No available renderer for the current environment");const T=new C;return await T.init(A),T}const VERSION="8.9.1";class ApplicationInitHook{static init(){var _;(_=globalThis.__PIXI_APP_INIT__)==null||_.call(globalThis,this,VERSION)}static destroy(){}}ApplicationInitHook.extension=ExtensionType.Application;class RendererInitHook{constructor(_){this._renderer=_}init(){var _;(_=globalThis.__PIXI_RENDERER_INIT__)==null||_.call(globalThis,this._renderer,VERSION)}destroy(){this._renderer=null}}RendererInitHook.extension={type:[ExtensionType.WebGLSystem,ExtensionType.WebGPUSystem],name:"initHook",priority:-10};const _Application=class Jt{constructor(..._){this.stage=new Container,_[0]!==void 0&&deprecation(v8_0_0,"Application constructor options are deprecated, please use Application.init() instead.")}async init(_){_={..._},this.renderer=await autoDetectRenderer(_),Jt._plugins.forEach(C=>{C.init.call(this,_)})}render(){this.renderer.render({container:this.stage})}get canvas(){return this.renderer.canvas}get view(){return deprecation(v8_0_0,"Application.view is deprecated, please use Application.canvas instead."),this.renderer.canvas}get screen(){return this.renderer.screen}destroy(_=!1,C=!1){const A=Jt._plugins.slice(0);A.reverse(),A.forEach(T=>{T.destroy.call(this)}),this.stage.destroy(C),this.stage=null,this.renderer.destroy(_),this.renderer=null}};_Application._plugins=[];let Application=_Application;extensions.handleByList(ExtensionType.Application,Application._plugins);extensions.add(ApplicationInitHook);class AbstractBitmapFont extends EventEmitter{constructor(){super(...arguments),this.chars=Object.create(null),this.lineHeight=0,this.fontFamily="",this.fontMetrics={fontSize:0,ascent:0,descent:0},this.baseLineOffset=0,this.distanceField={type:"none",range:0},this.pages=[],this.applyFillAsTint=!0,this.baseMeasurementFontSize=100,this.baseRenderedFontSize=100}get font(){return deprecation(v8_0_0,"BitmapFont.font is deprecated, please use BitmapFont.fontFamily instead."),this.fontFamily}get pageTextures(){return deprecation(v8_0_0,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}get size(){return deprecation(v8_0_0,"BitmapFont.size is deprecated, please use BitmapFont.fontMetrics.fontSize instead."),this.fontMetrics.fontSize}get distanceFieldRange(){return deprecation(v8_0_0,"BitmapFont.distanceFieldRange is deprecated, please use BitmapFont.distanceField.range instead."),this.distanceField.range}get distanceFieldType(){return deprecation(v8_0_0,"BitmapFont.distanceFieldType is deprecated, please use BitmapFont.distanceField.type instead."),this.distanceField.type}destroy(_=!1){var C;this.emit("destroy",this),this.removeAllListeners();for(const A in this.chars)(C=this.chars[A].texture)==null||C.destroy();this.chars=null,_&&(this.pages.forEach(A=>A.texture.destroy(!0)),this.pages=null)}}const emptyColorStops=[{offset:0,color:"white"},{offset:1,color:"black"}],_FillGradient=class Qt{constructor(..._){this.uid=uid("fillGradient"),this.type="linear",this.colorStops=[];let C=ensureGradientOptions(_);C={...C.type==="radial"?Qt.defaultRadialOptions:Qt.defaultLinearOptions,...definedProps(C)},this._textureSize=C.textureSize,C.type==="radial"?(this.center=C.center,this.outerCenter=C.outerCenter??this.center,this.innerRadius=C.innerRadius,this.outerRadius=C.outerRadius,this.scale=C.scale,this.rotation=C.rotation):(this.start=C.start,this.end=C.end),this.textureSpace=C.textureSpace,this.type=C.type,C.colorStops.forEach(T=>{this.addColorStop(T.offset,T.color)})}addColorStop(_,C){return this.colorStops.push({offset:_,color:Color.shared.setValue(C).toHexa()}),this}buildLinearGradient(){if(this.texture)return;const _=this.colorStops.length?this.colorStops:emptyColorStops,C=this._textureSize,{canvas:A,context:T}=getCanvas(C,1),E=T.createLinearGradient(0,0,this._textureSize,0);addColorStops(E,_),T.fillStyle=E,T.fillRect(0,0,C,1),this.texture=new Texture({source:new ImageSource({resource:A})});const{x:I,y:F}=this.start,{x:B,y:G}=this.end,R=new Matrix,z=B-I,D=G-F,L=Math.sqrt(z*z+D*D),O=Math.atan2(D,z);R.scale(L/C,1),R.rotate(O),R.translate(I,F),this.textureSpace==="local"&&R.scale(C,C),this.transform=R}buildGradient(){this.type==="linear"?this.buildLinearGradient():this.buildRadialGradient()}buildRadialGradient(){if(this.texture)return;const _=this.colorStops.length?this.colorStops:emptyColorStops,C=this._textureSize,{canvas:A,context:T}=getCanvas(C,C),{x:E,y:I}=this.center,{x:F,y:B}=this.outerCenter,G=this.innerRadius,R=this.outerRadius,z=F-R,D=B-R,L=C/(R*2),O=(E-z)*L,V=(I-D)*L,U=T.createRadialGradient(O,V,G*L,(F-z)*L,(B-D)*L,R*L);addColorStops(U,_),T.fillStyle=_[_.length-1].color,T.fillRect(0,0,C,C),T.fillStyle=U,T.translate(O,V),T.rotate(this.rotation),T.scale(1,this.scale),T.translate(-O,-V),T.fillRect(0,0,C,C),this.texture=new Texture({source:new ImageSource({resource:A,addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"})});const W=new Matrix;W.scale(1/L,1/L),W.translate(z,D),this.textureSpace==="local"&&W.scale(C,C),this.transform=W}get styleKey(){return this.uid}destroy(){var _;(_=this.texture)==null||_.destroy(!0),this.texture=null}};_FillGradient.defaultLinearOptions={start:{x:0,y:0},end:{x:0,y:1},colorStops:[],textureSpace:"local",type:"linear",textureSize:256};_FillGradient.defaultRadialOptions={center:{x:.5,y:.5},innerRadius:0,outerRadius:.5,colorStops:[],scale:1,textureSpace:"local",type:"radial",textureSize:256};let FillGradient=_FillGradient;function addColorStops(P,_){for(let C=0;C<_.length;C++){const A=_[C];P.addColorStop(A.offset,A.color)}}function getCanvas(P,_){const C=DOMAdapter.get().createCanvas(P,_),A=C.getContext("2d");return{canvas:C,context:A}}function ensureGradientOptions(P){let _=P[0]??{};return(typeof _=="number"||P[1])&&(deprecation("8.5.2","use options object instead"),_={type:"linear",start:{x:P[0],y:P[1]},end:{x:P[2],y:P[3]},textureSpace:P[4],textureSize:P[5]??FillGradient.defaultLinearOptions.textureSize}),_}const repetitionMap={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};class FillPattern{constructor(_,C){this.uid=uid("fillPattern"),this.transform=new Matrix,this._styleKey=null,this.texture=_,this.transform.scale(1/_.frame.width,1/_.frame.height),C&&(_.source.style.addressModeU=repetitionMap[C].addressModeU,_.source.style.addressModeV=repetitionMap[C].addressModeV)}setTransform(_){const C=this.texture;this.transform.copyFrom(_),this.transform.invert(),this.transform.scale(1/C.frame.width,1/C.frame.height),this._styleKey=null}get styleKey(){return this._styleKey?this._styleKey:(this._styleKey=`fill-pattern-${this.uid}-${this.texture.uid}-${this.transform.toArray().join("-")}`,this._styleKey)}}var parseSvgPath,hasRequiredParseSvgPath;function requireParseSvgPath(){if(hasRequiredParseSvgPath)return parseSvgPath;hasRequiredParseSvgPath=1,parseSvgPath=C;var P={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},_=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function C(E){var I=[];return E.replace(_,function(F,B,G){var R=B.toLowerCase();for(G=T(G),R=="m"&&G.length>2&&(I.push([B].concat(G.splice(0,2))),R="l",B=B=="m"?"l":"L");;){if(G.length==P[R])return G.unshift(B),I.push(G);if(G.length<P[R])throw new Error("malformed path data");I.push([B].concat(G.splice(0,P[R])))}}),I}var A=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function T(E){var I=E.match(A);return I?I.map(Number):[]}return parseSvgPath}var parseSvgPathExports=requireParseSvgPath();const parse=getDefaultExportFromCjs(parseSvgPathExports);function parseSVGPath(P,_){const C=parse(P),A=[];let T=null,E=0,I=0;for(let F=0;F<C.length;F++){const B=C[F],G=B[0],R=B;switch(G){case"M":E=R[1],I=R[2],_.moveTo(E,I);break;case"m":E+=R[1],I+=R[2],_.moveTo(E,I);break;case"H":E=R[1],_.lineTo(E,I);break;case"h":E+=R[1],_.lineTo(E,I);break;case"V":I=R[1],_.lineTo(E,I);break;case"v":I+=R[1],_.lineTo(E,I);break;case"L":E=R[1],I=R[2],_.lineTo(E,I);break;case"l":E+=R[1],I+=R[2],_.lineTo(E,I);break;case"C":E=R[5],I=R[6],_.bezierCurveTo(R[1],R[2],R[3],R[4],E,I);break;case"c":_.bezierCurveTo(E+R[1],I+R[2],E+R[3],I+R[4],E+R[5],I+R[6]),E+=R[5],I+=R[6];break;case"S":E=R[3],I=R[4],_.bezierCurveToShort(R[1],R[2],E,I);break;case"s":_.bezierCurveToShort(E+R[1],I+R[2],E+R[3],I+R[4]),E+=R[3],I+=R[4];break;case"Q":E=R[3],I=R[4],_.quadraticCurveTo(R[1],R[2],E,I);break;case"q":_.quadraticCurveTo(E+R[1],I+R[2],E+R[3],I+R[4]),E+=R[3],I+=R[4];break;case"T":E=R[1],I=R[2],_.quadraticCurveToShort(E,I);break;case"t":E+=R[1],I+=R[2],_.quadraticCurveToShort(E,I);break;case"A":E=R[6],I=R[7],_.arcToSvg(R[1],R[2],R[3],R[4],R[5],E,I);break;case"a":E+=R[6],I+=R[7],_.arcToSvg(R[1],R[2],R[3],R[4],R[5],E,I);break;case"Z":case"z":_.closePath(),A.length>0&&(T=A.pop(),T?(E=T.startX,I=T.startY):(E=0,I=0)),T=null;break;default:warn(`Unknown SVG path command: ${G}`)}G!=="Z"&&G!=="z"&&T===null&&(T={startX:E,startY:I},A.push(T))}return _}class Circle{constructor(_=0,C=0,A=0){this.type="circle",this.x=_,this.y=C,this.radius=A}clone(){return new Circle(this.x,this.y,this.radius)}contains(_,C){if(this.radius<=0)return!1;const A=this.radius*this.radius;let T=this.x-_,E=this.y-C;return T*=T,E*=E,T+E<=A}strokeContains(_,C,A,T=.5){if(this.radius===0)return!1;const E=this.x-_,I=this.y-C,F=this.radius,B=(1-T)*A,G=Math.sqrt(E*E+I*I);return G<=F+B&&G>F-(A-B)}getBounds(_){return _||(_=new Rectangle),_.x=this.x-this.radius,_.y=this.y-this.radius,_.width=this.radius*2,_.height=this.radius*2,_}copyFrom(_){return this.x=_.x,this.y=_.y,this.radius=_.radius,this}copyTo(_){return _.copyFrom(this),_}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class Ellipse{constructor(_=0,C=0,A=0,T=0){this.type="ellipse",this.x=_,this.y=C,this.halfWidth=A,this.halfHeight=T}clone(){return new Ellipse(this.x,this.y,this.halfWidth,this.halfHeight)}contains(_,C){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let A=(_-this.x)/this.halfWidth,T=(C-this.y)/this.halfHeight;return A*=A,T*=T,A+T<=1}strokeContains(_,C,A,T=.5){const{halfWidth:E,halfHeight:I}=this;if(E<=0||I<=0)return!1;const F=A*(1-T),B=A-F,G=E-B,R=I-B,z=E+F,D=I+F,L=_-this.x,O=C-this.y,V=L*L/(G*G)+O*O/(R*R),U=L*L/(z*z)+O*O/(D*D);return V>1&&U<=1}getBounds(_){return _||(_=new Rectangle),_.x=this.x-this.halfWidth,_.y=this.y-this.halfHeight,_.width=this.halfWidth*2,_.height=this.halfHeight*2,_}copyFrom(_){return this.x=_.x,this.y=_.y,this.halfWidth=_.halfWidth,this.halfHeight=_.halfHeight,this}copyTo(_){return _.copyFrom(this),_}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}function squaredDistanceToLineSegment(P,_,C,A,T,E){const I=P-C,F=_-A,B=T-C,G=E-A,R=I*B+F*G,z=B*B+G*G;let D=-1;z!==0&&(D=R/z);let L,O;D<0?(L=C,O=A):D>1?(L=T,O=E):(L=C+D*B,O=A+D*G);const V=P-L,U=_-O;return V*V+U*U}let tempRect$2,tempRect2;class Polygon{constructor(..._){this.type="polygon";let C=Array.isArray(_[0])?_[0]:_;if(typeof C[0]!="number"){const A=[];for(let T=0,E=C.length;T<E;T++)A.push(C[T].x,C[T].y);C=A}this.points=C,this.closePath=!0}isClockwise(){let _=0;const C=this.points,A=C.length;for(let T=0;T<A;T+=2){const E=C[T],I=C[T+1],F=C[(T+2)%A],B=C[(T+3)%A];_+=(F-E)*(B+I)}return _<0}containsPolygon(_){const C=this.getBounds(tempRect$2),A=_.getBounds(tempRect2);if(!C.containsRect(A))return!1;const T=_.points;for(let E=0;E<T.length;E+=2){const I=T[E],F=T[E+1];if(!this.contains(I,F))return!1}return!0}clone(){const _=this.points.slice(),C=new Polygon(_);return C.closePath=this.closePath,C}contains(_,C){let A=!1;const T=this.points.length/2;for(let E=0,I=T-1;E<T;I=E++){const F=this.points[E*2],B=this.points[E*2+1],G=this.points[I*2],R=this.points[I*2+1];B>C!=R>C&&_<(G-F)*((C-B)/(R-B))+F&&(A=!A)}return A}strokeContains(_,C,A,T=.5){const E=A*A,I=E*(1-T),F=E-I,{points:B}=this,G=B.length-(this.closePath?0:2);for(let R=0;R<G;R+=2){const z=B[R],D=B[R+1],L=B[(R+2)%B.length],O=B[(R+3)%B.length],V=squaredDistanceToLineSegment(_,C,z,D,L,O),U=Math.sign((L-z)*(C-D)-(O-D)*(_-z));if(V<=(U<0?F:I))return!0}return!1}getBounds(_){_||(_=new Rectangle);const C=this.points;let A=1/0,T=-1/0,E=1/0,I=-1/0;for(let F=0,B=C.length;F<B;F+=2){const G=C[F],R=C[F+1];A=G<A?G:A,T=G>T?G:T,E=R<E?R:E,I=R>I?R:I}return _.x=A,_.width=T-A,_.y=E,_.height=I-E,_}copyFrom(_){return this.points=_.points.slice(),this.closePath=_.closePath,this}copyTo(_){return _.copyFrom(this),_}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((_,C)=>`${_}, ${C}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return this.points[this.points.length-2]}get y(){return this.points[this.points.length-1]}}const isCornerWithinStroke=(P,_,C,A,T,E,I)=>{const F=P-C,B=_-A,G=Math.sqrt(F*F+B*B);return G>=T-E&&G<=T+I};class RoundedRectangle{constructor(_=0,C=0,A=0,T=0,E=20){this.type="roundedRectangle",this.x=_,this.y=C,this.width=A,this.height=T,this.radius=E}getBounds(_){return _||(_=new Rectangle),_.x=this.x,_.y=this.y,_.width=this.width,_.height=this.height,_}clone(){return new RoundedRectangle(this.x,this.y,this.width,this.height,this.radius)}copyFrom(_){return this.x=_.x,this.y=_.y,this.width=_.width,this.height=_.height,this}copyTo(_){return _.copyFrom(this),_}contains(_,C){if(this.width<=0||this.height<=0)return!1;if(_>=this.x&&_<=this.x+this.width&&C>=this.y&&C<=this.y+this.height){const A=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(C>=this.y+A&&C<=this.y+this.height-A||_>=this.x+A&&_<=this.x+this.width-A)return!0;let T=_-(this.x+A),E=C-(this.y+A);const I=A*A;if(T*T+E*E<=I||(T=_-(this.x+this.width-A),T*T+E*E<=I)||(E=C-(this.y+this.height-A),T*T+E*E<=I)||(T=_-(this.x+A),T*T+E*E<=I))return!0}return!1}strokeContains(_,C,A,T=.5){const{x:E,y:I,width:F,height:B,radius:G}=this,R=A*(1-T),z=A-R,D=E+G,L=I+G,O=F-G*2,V=B-G*2,U=E+F,W=I+B;return(_>=E-R&&_<=E+z||_>=U-z&&_<=U+R)&&C>=L&&C<=L+V||(C>=I-R&&C<=I+z||C>=W-z&&C<=W+R)&&_>=D&&_<=D+O?!0:_<D&&C<L&&isCornerWithinStroke(_,C,D,L,G,z,R)||_>U-G&&C<L&&isCornerWithinStroke(_,C,U-G,L,G,z,R)||_>U-G&&C>W-G&&isCornerWithinStroke(_,C,U-G,W-G,G,z,R)||_<D&&C>W-G&&isCornerWithinStroke(_,C,D,W-G,G,z,R)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}const fragTemplate=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function generateIfTestSrc(P){let _="";for(let C=0;C<P;++C)C>0&&(_+=`
else `),C<P-1&&(_+=`if(test == ${C}.0){}`);return _}function checkMaxIfStatementsInShader(P,_){if(P===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const C=_.createShader(_.FRAGMENT_SHADER);try{for(;;){const A=fragTemplate.replace(/%forloop%/gi,generateIfTestSrc(P));if(_.shaderSource(C,A),_.compileShader(C),!_.getShaderParameter(C,_.COMPILE_STATUS))P=P/2|0;else break}}finally{_.deleteShader(C)}return P}let maxTexturesPerBatchCache=null;function getMaxTexturesPerBatch(){var _;if(maxTexturesPerBatchCache)return maxTexturesPerBatchCache;const P=getTestContext();return maxTexturesPerBatchCache=P.getParameter(P.MAX_TEXTURE_IMAGE_UNITS),maxTexturesPerBatchCache=checkMaxIfStatementsInShader(maxTexturesPerBatchCache,P),(_=P.getExtension("WEBGL_lose_context"))==null||_.loseContext(),maxTexturesPerBatchCache}const cachedGroups={};function getTextureBatchBindGroup(P,_){let C=2166136261;for(let A=0;A<_;A++)C^=P[A].uid,C=Math.imul(C,16777619),C>>>=0;return cachedGroups[C]||generateTextureBatchBindGroup(P,_,C)}let maxTextures=0;function generateTextureBatchBindGroup(P,_,C){const A={};let T=0;maxTextures||(maxTextures=getMaxTexturesPerBatch());for(let I=0;I<maxTextures;I++){const F=I<_?P[I]:Texture.EMPTY.source;A[T++]=F.source,A[T++]=F.style}const E=new BindGroup(A);return cachedGroups[C]=E,E}class ViewableBuffer{constructor(_){typeof _=="number"?this.rawBinaryData=new ArrayBuffer(_):_ instanceof Uint8Array?this.rawBinaryData=_.buffer:this.rawBinaryData=_,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData),this.size=this.rawBinaryData.byteLength}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}get float64View(){return this._float64Array||(this._float64Array=new Float64Array(this.rawBinaryData)),this._float64Array}get bigUint64View(){return this._bigUint64Array||(this._bigUint64Array=new BigUint64Array(this.rawBinaryData)),this._bigUint64Array}view(_){return this[`${_}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this.uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(_){switch(_){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${_} isn't a valid view type`)}}}function fastCopy(P,_){const C=P.byteLength/8|0,A=new Float64Array(P,0,C);new Float64Array(_,0,C).set(A);const E=P.byteLength-C*8;if(E>0){const I=new Uint8Array(P,C*8,E);new Uint8Array(_,C*8,E).set(I)}}const BLEND_TO_NPM={normal:"normal-npm",add:"add-npm",screen:"screen-npm"};var STENCIL_MODES=(P=>(P[P.DISABLED=0]="DISABLED",P[P.RENDERING_MASK_ADD=1]="RENDERING_MASK_ADD",P[P.MASK_ACTIVE=2]="MASK_ACTIVE",P[P.INVERSE_MASK_ACTIVE=3]="INVERSE_MASK_ACTIVE",P[P.RENDERING_MASK_REMOVE=4]="RENDERING_MASK_REMOVE",P[P.NONE=5]="NONE",P))(STENCIL_MODES||{});function getAdjustedBlendModeBlend(P,_){return _.alphaMode==="no-premultiply-alpha"&&BLEND_TO_NPM[P]||P}class BatchTextureArray{constructor(){this.ids=Object.create(null),this.textures=[],this.count=0}clear(){for(let _=0;_<this.count;_++){const C=this.textures[_];this.textures[_]=null,this.ids[C.uid]=null}this.count=0}}class Batch{constructor(){this.renderPipeId="batch",this.action="startBatch",this.start=0,this.size=0,this.textures=new BatchTextureArray,this.blendMode="normal",this.topology="triangle-strip",this.canBundle=!0}destroy(){this.textures=null,this.gpuBindGroup=null,this.bindGroup=null,this.batcher=null}}const batchPool=[];let batchPoolIndex=0;function getBatchFromPool(){return batchPoolIndex>0?batchPool[--batchPoolIndex]:new Batch}function returnBatchToPool(P){batchPool[batchPoolIndex++]=P}let BATCH_TICK=0;const _Batcher=class Xt{constructor(_={}){this.uid=uid("batcher"),this.dirty=!0,this.batchIndex=0,this.batches=[],this._elements=[],Xt.defaultOptions.maxTextures=Xt.defaultOptions.maxTextures??getMaxTexturesPerBatch(),_={...Xt.defaultOptions,..._};const{maxTextures:C,attributesInitialSize:A,indicesInitialSize:T}=_;this.attributeBuffer=new ViewableBuffer(A*4),this.indexBuffer=new Uint16Array(T),this.maxTextures=C}begin(){this.elementSize=0,this.elementStart=0,this.indexSize=0,this.attributeSize=0;for(let _=0;_<this.batchIndex;_++)returnBatchToPool(this.batches[_]);this.batchIndex=0,this._batchIndexStart=0,this._batchIndexSize=0,this.dirty=!0}add(_){this._elements[this.elementSize++]=_,_._indexStart=this.indexSize,_._attributeStart=this.attributeSize,_._batcher=this,this.indexSize+=_.indexSize,this.attributeSize+=_.attributeSize*this.vertexSize}checkAndUpdateTexture(_,C){const A=_._batch.textures.ids[C._source.uid];return!A&&A!==0?!1:(_._textureId=A,_.texture=C,!0)}updateElement(_){this.dirty=!0;const C=this.attributeBuffer;_.packAsQuad?this.packQuadAttributes(_,C.float32View,C.uint32View,_._attributeStart,_._textureId):this.packAttributes(_,C.float32View,C.uint32View,_._attributeStart,_._textureId)}break(_){const C=this._elements;if(!C[this.elementStart])return;let A=getBatchFromPool(),T=A.textures;T.clear();const E=C[this.elementStart];let I=getAdjustedBlendModeBlend(E.blendMode,E.texture._source),F=E.topology;this.attributeSize*4>this.attributeBuffer.size&&this._resizeAttributeBuffer(this.attributeSize*4),this.indexSize>this.indexBuffer.length&&this._resizeIndexBuffer(this.indexSize);const B=this.attributeBuffer.float32View,G=this.attributeBuffer.uint32View,R=this.indexBuffer;let z=this._batchIndexSize,D=this._batchIndexStart,L="startBatch";const O=this.maxTextures;for(let V=this.elementStart;V<this.elementSize;++V){const U=C[V];C[V]=null;const X=U.texture._source,Y=getAdjustedBlendModeBlend(U.blendMode,X),K=I!==Y||F!==U.topology;if(X._batchTick===BATCH_TICK&&!K){U._textureId=X._textureBindLocation,z+=U.indexSize,U.packAsQuad?(this.packQuadAttributes(U,B,G,U._attributeStart,U._textureId),this.packQuadIndex(R,U._indexStart,U._attributeStart/this.vertexSize)):(this.packAttributes(U,B,G,U._attributeStart,U._textureId),this.packIndex(U,R,U._indexStart,U._attributeStart/this.vertexSize)),U._batch=A;continue}X._batchTick=BATCH_TICK,(T.count>=O||K)&&(this._finishBatch(A,D,z-D,T,I,F,_,L),L="renderBatch",D=z,I=Y,F=U.topology,A=getBatchFromPool(),T=A.textures,T.clear(),++BATCH_TICK),U._textureId=X._textureBindLocation=T.count,T.ids[X.uid]=T.count,T.textures[T.count++]=X,U._batch=A,z+=U.indexSize,U.packAsQuad?(this.packQuadAttributes(U,B,G,U._attributeStart,U._textureId),this.packQuadIndex(R,U._indexStart,U._attributeStart/this.vertexSize)):(this.packAttributes(U,B,G,U._attributeStart,U._textureId),this.packIndex(U,R,U._indexStart,U._attributeStart/this.vertexSize))}T.count>0&&(this._finishBatch(A,D,z-D,T,I,F,_,L),D=z,++BATCH_TICK),this.elementStart=this.elementSize,this._batchIndexStart=D,this._batchIndexSize=z}_finishBatch(_,C,A,T,E,I,F,B){_.gpuBindGroup=null,_.bindGroup=null,_.action=B,_.batcher=this,_.textures=T,_.blendMode=E,_.topology=I,_.start=C,_.size=A,++BATCH_TICK,this.batches[this.batchIndex++]=_,F.add(_)}finish(_){this.break(_)}ensureAttributeBuffer(_){_*4<=this.attributeBuffer.size||this._resizeAttributeBuffer(_*4)}ensureIndexBuffer(_){_<=this.indexBuffer.length||this._resizeIndexBuffer(_)}_resizeAttributeBuffer(_){const C=Math.max(_,this.attributeBuffer.size*2),A=new ViewableBuffer(C);fastCopy(this.attributeBuffer.rawBinaryData,A.rawBinaryData),this.attributeBuffer=A}_resizeIndexBuffer(_){const C=this.indexBuffer;let A=Math.max(_,C.length*1.5);A+=A%2;const T=A>65535?new Uint32Array(A):new Uint16Array(A);if(T.BYTES_PER_ELEMENT!==C.BYTES_PER_ELEMENT)for(let E=0;E<C.length;E++)T[E]=C[E];else fastCopy(C.buffer,T.buffer);this.indexBuffer=T}packQuadIndex(_,C,A){_[C]=A+0,_[C+1]=A+1,_[C+2]=A+2,_[C+3]=A+0,_[C+4]=A+2,_[C+5]=A+3}packIndex(_,C,A,T){const E=_.indices,I=_.indexSize,F=_.indexOffset,B=_.attributeOffset;for(let G=0;G<I;G++)C[A++]=T+E[G+F]-B}destroy(){for(let _=0;_<this.batches.length;_++)returnBatchToPool(this.batches[_]);this.batches=null;for(let _=0;_<this._elements.length;_++)this._elements[_]._batch=null;this._elements=null,this.indexBuffer=null,this.attributeBuffer.destroy(),this.attributeBuffer=null}};_Batcher.defaultOptions={maxTextures:null,attributesInitialSize:4,indicesInitialSize:6};let Batcher=_Batcher;var BufferUsage=(P=>(P[P.MAP_READ=1]="MAP_READ",P[P.MAP_WRITE=2]="MAP_WRITE",P[P.COPY_SRC=4]="COPY_SRC",P[P.COPY_DST=8]="COPY_DST",P[P.INDEX=16]="INDEX",P[P.VERTEX=32]="VERTEX",P[P.UNIFORM=64]="UNIFORM",P[P.STORAGE=128]="STORAGE",P[P.INDIRECT=256]="INDIRECT",P[P.QUERY_RESOLVE=512]="QUERY_RESOLVE",P[P.STATIC=1024]="STATIC",P))(BufferUsage||{});class Buffer extends EventEmitter{constructor(_){let{data:C,size:A}=_;const{usage:T,label:E,shrinkToFit:I}=_;super(),this.uid=uid("buffer"),this._resourceType="buffer",this._resourceId=uid("resource"),this._touched=0,this._updateID=1,this._dataInt32=null,this.shrinkToFit=!0,this.destroyed=!1,C instanceof Array&&(C=new Float32Array(C)),this._data=C,A??(A=C==null?void 0:C.byteLength);const F=!!C;this.descriptor={size:A,usage:T,mappedAtCreation:F,label:E},this.shrinkToFit=I??!0}get data(){return this._data}set data(_){this.setDataWithSize(_,_.length,!0)}get dataInt32(){return this._dataInt32||(this._dataInt32=new Int32Array(this.data.buffer)),this._dataInt32}get static(){return!!(this.descriptor.usage&BufferUsage.STATIC)}set static(_){_?this.descriptor.usage|=BufferUsage.STATIC:this.descriptor.usage&=~BufferUsage.STATIC}setDataWithSize(_,C,A){if(this._updateID++,this._updateSize=C*_.BYTES_PER_ELEMENT,this._data===_){A&&this.emit("update",this);return}const T=this._data;if(this._data=_,this._dataInt32=null,!T||T.length!==_.length){!this.shrinkToFit&&T&&_.byteLength<T.byteLength?A&&this.emit("update",this):(this.descriptor.size=_.byteLength,this._resourceId=uid("resource"),this.emit("change",this));return}A&&this.emit("update",this)}update(_){this._updateSize=_??this._updateSize,this._updateID++,this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._data=null,this.descriptor=null,this.removeAllListeners()}}function ensureIsBuffer(P,_){if(!(P instanceof Buffer)){let C=_?BufferUsage.INDEX:BufferUsage.VERTEX;P instanceof Array&&(_?(P=new Uint32Array(P),C=BufferUsage.INDEX|BufferUsage.COPY_DST):(P=new Float32Array(P),C=BufferUsage.VERTEX|BufferUsage.COPY_DST)),P=new Buffer({data:P,label:_?"index-mesh-buffer":"vertex-mesh-buffer",usage:C})}return P}function getGeometryBounds(P,_,C){const A=P.getAttribute(_);if(!A)return C.minX=0,C.minY=0,C.maxX=0,C.maxY=0,C;const T=A.buffer.data;let E=1/0,I=1/0,F=-1/0,B=-1/0;const G=T.BYTES_PER_ELEMENT,R=(A.offset||0)/G,z=(A.stride||2*4)/G;for(let D=R;D<T.length;D+=z){const L=T[D],O=T[D+1];L>F&&(F=L),O>B&&(B=O),L<E&&(E=L),O<I&&(I=O)}return C.minX=E,C.minY=I,C.maxX=F,C.maxY=B,C}function ensureIsAttribute(P){return(P instanceof Buffer||Array.isArray(P)||P.BYTES_PER_ELEMENT)&&(P={buffer:P}),P.buffer=ensureIsBuffer(P.buffer,!1),P}class Geometry extends EventEmitter{constructor(_={}){super(),this.uid=uid("geometry"),this._layoutKey=0,this.instanceCount=1,this._bounds=new Bounds,this._boundsDirty=!0;const{attributes:C,indexBuffer:A,topology:T}=_;if(this.buffers=[],this.attributes={},C)for(const E in C)this.addAttribute(E,C[E]);this.instanceCount=_.instanceCount??1,A&&this.addIndex(A),this.topology=T||"triangle-list"}onBufferUpdate(){this._boundsDirty=!0,this.emit("update",this)}getAttribute(_){return this.attributes[_]}getIndex(){return this.indexBuffer}getBuffer(_){return this.getAttribute(_).buffer}getSize(){for(const _ in this.attributes){const C=this.attributes[_];return C.buffer.data.length/(C.stride/4||C.size)}return 0}addAttribute(_,C){const A=ensureIsAttribute(C);this.buffers.indexOf(A.buffer)===-1&&(this.buffers.push(A.buffer),A.buffer.on("update",this.onBufferUpdate,this),A.buffer.on("change",this.onBufferUpdate,this)),this.attributes[_]=A}addIndex(_){this.indexBuffer=ensureIsBuffer(_,!0),this.buffers.push(this.indexBuffer)}get bounds(){return this._boundsDirty?(this._boundsDirty=!1,getGeometryBounds(this,"aPosition",this._bounds)):this._bounds}destroy(_=!1){this.emit("destroy",this),this.removeAllListeners(),_&&this.buffers.forEach(C=>C.destroy()),this.attributes=null,this.buffers=null,this.indexBuffer=null,this._bounds=null}}const placeHolderBufferData=new Float32Array(1),placeHolderIndexData=new Uint32Array(1);class BatchGeometry extends Geometry{constructor(){const C=new Buffer({data:placeHolderBufferData,label:"attribute-batch-buffer",usage:BufferUsage.VERTEX|BufferUsage.COPY_DST,shrinkToFit:!1}),A=new Buffer({data:placeHolderIndexData,label:"index-batch-buffer",usage:BufferUsage.INDEX|BufferUsage.COPY_DST,shrinkToFit:!1}),T=6*4;super({attributes:{aPosition:{buffer:C,format:"float32x2",stride:T,offset:0},aUV:{buffer:C,format:"float32x2",stride:T,offset:2*4},aColor:{buffer:C,format:"unorm8x4",stride:T,offset:4*4},aTextureIdAndRound:{buffer:C,format:"uint16x2",stride:T,offset:5*4}},indexBuffer:A})}}function addBits(P,_,C){if(P)for(const A in P){const T=A.toLocaleLowerCase(),E=_[T];if(E){let I=P[A];A==="header"&&(I=I.replace(/@in\s+[^;]+;\s*/g,"").replace(/@out\s+[^;]+;\s*/g,"")),C&&E.push(`//----${C}----//`),E.push(I)}else warn(`${A} placement hook does not exist in shader`)}}const findHooksRx=/\{\{(.*?)\}\}/g;function compileHooks(P){var A;const _={};return(((A=P.match(findHooksRx))==null?void 0:A.map(T=>T.replace(/[{()}]/g,"")))??[]).forEach(T=>{_[T]=[]}),_}function extractInputs(P,_){let C;const A=/@in\s+([^;]+);/g;for(;(C=A.exec(P))!==null;)_.push(C[1])}function compileInputs(P,_,C=!1){const A=[];extractInputs(_,A),P.forEach(F=>{F.header&&extractInputs(F.header,A)});const T=A;C&&T.sort();const E=T.map((F,B)=>`       @location(${B}) ${F},`).join(`
`);let I=_.replace(/@in\s+[^;]+;\s*/g,"");return I=I.replace("{{in}}",`
${E}
`),I}function extractOutputs(P,_){let C;const A=/@out\s+([^;]+);/g;for(;(C=A.exec(P))!==null;)_.push(C[1])}function extractVariableName(P){const C=/\b(\w+)\s*:/g.exec(P);return C?C[1]:""}function stripVariable(P){const _=/@.*?\s+/g;return P.replace(_,"")}function compileOutputs(P,_){const C=[];extractOutputs(_,C),P.forEach(B=>{B.header&&extractOutputs(B.header,C)});let A=0;const T=C.sort().map(B=>B.indexOf("builtin")>-1?B:`@location(${A++}) ${B}`).join(`,
`),E=C.sort().map(B=>`       var ${stripVariable(B)};`).join(`
`),I=`return VSOutput(
            ${C.sort().map(B=>` ${extractVariableName(B)}`).join(`,
`)});`;let F=_.replace(/@out\s+[^;]+;\s*/g,"");return F=F.replace("{{struct}}",`
${T}
`),F=F.replace("{{start}}",`
${E}
`),F=F.replace("{{return}}",`
${I}
`),F}function injectBits(P,_){let C=P;for(const A in _){const T=_[A];T.join(`
`).length?C=C.replace(`{{${A}}}`,`//-----${A} START-----//
${T.join(`
`)}
//----${A} FINISH----//`):C=C.replace(`{{${A}}}`,"")}return C}const cacheMap=Object.create(null),bitCacheMap=new Map;let CACHE_UID=0;function compileHighShader({template:P,bits:_}){const C=generateCacheId(P,_);if(cacheMap[C])return cacheMap[C];const{vertex:A,fragment:T}=compileInputsAndOutputs(P,_);return cacheMap[C]=compileBits(A,T,_),cacheMap[C]}function compileHighShaderGl({template:P,bits:_}){const C=generateCacheId(P,_);return cacheMap[C]||(cacheMap[C]=compileBits(P.vertex,P.fragment,_)),cacheMap[C]}function compileInputsAndOutputs(P,_){const C=_.map(I=>I.vertex).filter(I=>!!I),A=_.map(I=>I.fragment).filter(I=>!!I);let T=compileInputs(C,P.vertex,!0);T=compileOutputs(C,T);const E=compileInputs(A,P.fragment,!0);return{vertex:T,fragment:E}}function generateCacheId(P,_){return _.map(C=>(bitCacheMap.has(C)||bitCacheMap.set(C,CACHE_UID++),bitCacheMap.get(C))).sort((C,A)=>C-A).join("-")+P.vertex+P.fragment}function compileBits(P,_,C){const A=compileHooks(P),T=compileHooks(_);return C.forEach(E=>{addBits(E.vertex,A,E.name),addBits(E.fragment,T,E.name)}),{vertex:injectBits(P,A),fragment:injectBits(_,T)}}const vertexGPUTemplate=`
    @in aPosition: vec2<f32>;
    @in aUV: vec2<f32>;

    @out @builtin(position) vPosition: vec4<f32>;
    @out vUV : vec2<f32>;
    @out vColor : vec4<f32>;

    {{header}}

    struct VSOutput {
        {{struct}}
    };

    @vertex
    fn main( {{in}} ) -> VSOutput {

        var worldTransformMatrix = globalUniforms.uWorldTransformMatrix;
        var modelMatrix = mat3x3<f32>(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        var position = aPosition;
        var uv = aUV;

        {{start}}
        
        vColor = vec4<f32>(1., 1., 1., 1.);

        {{main}}

        vUV = uv;

        var modelViewProjectionMatrix = globalUniforms.uProjectionMatrix * worldTransformMatrix * modelMatrix;

        vPosition =  vec4<f32>((modelViewProjectionMatrix *  vec3<f32>(position, 1.0)).xy, 0.0, 1.0);
       
        vColor *= globalUniforms.uWorldColorAlpha;

        {{end}}

        {{return}}
    };
`,fragmentGPUTemplate=`
    @in vUV : vec2<f32>;
    @in vColor : vec4<f32>;
   
    {{header}}

    @fragment
    fn main(
        {{in}}
      ) -> @location(0) vec4<f32> {
        
        {{start}}

        var outColor:vec4<f32>;
      
        {{main}}
        
        var finalColor:vec4<f32> = outColor * vColor;

        {{end}}

        return finalColor;
      };
`,vertexGlTemplate=`
    in vec2 aPosition;
    in vec2 aUV;

    out vec4 vColor;
    out vec2 vUV;

    {{header}}

    void main(void){

        mat3 worldTransformMatrix = uWorldTransformMatrix;
        mat3 modelMatrix = mat3(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        vec2 position = aPosition;
        vec2 uv = aUV;
        
        {{start}}
        
        vColor = vec4(1.);
        
        {{main}}
        
        vUV = uv;
        
        mat3 modelViewProjectionMatrix = uProjectionMatrix * worldTransformMatrix * modelMatrix;

        gl_Position = vec4((modelViewProjectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);

        vColor *= uWorldColorAlpha;

        {{end}}
    }
`,fragmentGlTemplate=`
   
    in vec4 vColor;
    in vec2 vUV;

    out vec4 finalColor;

    {{header}}

    void main(void) {
        
        {{start}}

        vec4 outColor;
      
        {{main}}
        
        finalColor = outColor * vColor;
        
        {{end}}
    }
`,globalUniformsBit={name:"global-uniforms-bit",vertex:{header:`
        struct GlobalUniforms {
            uProjectionMatrix:mat3x3<f32>,
            uWorldTransformMatrix:mat3x3<f32>,
            uWorldColorAlpha: vec4<f32>,
            uResolution: vec2<f32>,
        }

        @group(0) @binding(0) var<uniform> globalUniforms : GlobalUniforms;
        `}},globalUniformsBitGl={name:"global-uniforms-bit",vertex:{header:`
          uniform mat3 uProjectionMatrix;
          uniform mat3 uWorldTransformMatrix;
          uniform vec4 uWorldColorAlpha;
          uniform vec2 uResolution;
        `}};function compileHighShaderGpuProgram({bits:P,name:_}){const C=compileHighShader({template:{fragment:fragmentGPUTemplate,vertex:vertexGPUTemplate},bits:[globalUniformsBit,...P]});return GpuProgram.from({name:_,vertex:{source:C.vertex,entryPoint:"main"},fragment:{source:C.fragment,entryPoint:"main"}})}function compileHighShaderGlProgram({bits:P,name:_}){return new GlProgram({name:_,...compileHighShaderGl({template:{vertex:vertexGlTemplate,fragment:fragmentGlTemplate},bits:[globalUniformsBitGl,...P]})})}const colorBit={name:"color-bit",vertex:{header:`
            @in aColor: vec4<f32>;
        `,main:`
            vColor *= vec4<f32>(aColor.rgb * aColor.a, aColor.a);
        `}},colorBitGl={name:"color-bit",vertex:{header:`
            in vec4 aColor;
        `,main:`
            vColor *= vec4(aColor.rgb * aColor.a, aColor.a);
        `}},textureBatchBitGpuCache={};function generateBindingSrc(P){const _=[];if(P===1)_.push("@group(1) @binding(0) var textureSource1: texture_2d<f32>;"),_.push("@group(1) @binding(1) var textureSampler1: sampler;");else{let C=0;for(let A=0;A<P;A++)_.push(`@group(1) @binding(${C++}) var textureSource${A+1}: texture_2d<f32>;`),_.push(`@group(1) @binding(${C++}) var textureSampler${A+1}: sampler;`)}return _.join(`
`)}function generateSampleSrc(P){const _=[];if(P===1)_.push("outColor = textureSampleGrad(textureSource1, textureSampler1, vUV, uvDx, uvDy);");else{_.push("switch vTextureId {");for(let C=0;C<P;C++)C===P-1?_.push("  default:{"):_.push(`  case ${C}:{`),_.push(`      outColor = textureSampleGrad(textureSource${C+1}, textureSampler${C+1}, vUV, uvDx, uvDy);`),_.push("      break;}");_.push("}")}return _.join(`
`)}function generateTextureBatchBit(P){return textureBatchBitGpuCache[P]||(textureBatchBitGpuCache[P]={name:"texture-batch-bit",vertex:{header:`
                @in aTextureIdAndRound: vec2<u32>;
                @out @interpolate(flat) vTextureId : u32;
            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1)
                {
                    vPosition = vec4<f32>(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
                }
            `},fragment:{header:`
                @in @interpolate(flat) vTextureId: u32;

                ${generateBindingSrc(P)}
            `,main:`
                var uvDx = dpdx(vUV);
                var uvDy = dpdy(vUV);

                ${generateSampleSrc(P)}
            `}}),textureBatchBitGpuCache[P]}const textureBatchBitGlCache={};function generateSampleGlSrc(P){const _=[];for(let C=0;C<P;C++)C>0&&_.push("else"),C<P-1&&_.push(`if(vTextureId < ${C}.5)`),_.push("{"),_.push(`	outColor = texture(uTextures[${C}], vUV);`),_.push("}");return _.join(`
`)}function generateTextureBatchBitGl(P){return textureBatchBitGlCache[P]||(textureBatchBitGlCache[P]={name:"texture-batch-bit",vertex:{header:`
                in vec2 aTextureIdAndRound;
                out float vTextureId;

            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1.)
                {
                    gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
                }
            `},fragment:{header:`
                in float vTextureId;

                uniform sampler2D uTextures[${P}];

            `,main:`

                ${generateSampleGlSrc(P)}
            `}}),textureBatchBitGlCache[P]}const roundPixelsBit={name:"round-pixels-bit",vertex:{header:`
            fn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32> 
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},roundPixelsBitGl={name:"round-pixels-bit",vertex:{header:`   
            vec2 roundPixels(vec2 position, vec2 targetSize)
            {       
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},batchSamplersUniformGroupHash={};function getBatchSamplersUniformGroup(P){let _=batchSamplersUniformGroupHash[P];if(_)return _;const C=new Int32Array(P);for(let A=0;A<P;A++)C[A]=A;return _=batchSamplersUniformGroupHash[P]=new UniformGroup({uTextures:{value:C,type:"i32",size:P}},{isStatic:!0}),_}class DefaultShader extends Shader{constructor(_){const C=compileHighShaderGlProgram({name:"batch",bits:[colorBitGl,generateTextureBatchBitGl(_),roundPixelsBitGl]}),A=compileHighShaderGpuProgram({name:"batch",bits:[colorBit,generateTextureBatchBit(_),roundPixelsBit]});super({glProgram:C,gpuProgram:A,resources:{batchSamplers:getBatchSamplersUniformGroup(_)}})}}let defaultShader=null;const _DefaultBatcher=class ae extends Batcher{constructor(){super(...arguments),this.geometry=new BatchGeometry,this.shader=defaultShader||(defaultShader=new DefaultShader(this.maxTextures)),this.name=ae.extension.name,this.vertexSize=6}packAttributes(_,C,A,T,E){const I=E<<16|_.roundPixels&65535,F=_.transform,B=F.a,G=F.b,R=F.c,z=F.d,D=F.tx,L=F.ty,{positions:O,uvs:V}=_,U=_.color,W=_.attributeOffset,X=W+_.attributeSize;for(let Y=W;Y<X;Y++){const K=Y*2,q=O[K],J=O[K+1];C[T++]=B*q+R*J+D,C[T++]=z*J+G*q+L,C[T++]=V[K],C[T++]=V[K+1],A[T++]=U,A[T++]=I}}packQuadAttributes(_,C,A,T,E){const I=_.texture,F=_.transform,B=F.a,G=F.b,R=F.c,z=F.d,D=F.tx,L=F.ty,O=_.bounds,V=O.maxX,U=O.minX,W=O.maxY,X=O.minY,Y=I.uvs,K=_.color,q=E<<16|_.roundPixels&65535;C[T+0]=B*U+R*X+D,C[T+1]=z*X+G*U+L,C[T+2]=Y.x0,C[T+3]=Y.y0,A[T+4]=K,A[T+5]=q,C[T+6]=B*V+R*X+D,C[T+7]=z*X+G*V+L,C[T+8]=Y.x1,C[T+9]=Y.y1,A[T+10]=K,A[T+11]=q,C[T+12]=B*V+R*W+D,C[T+13]=z*W+G*V+L,C[T+14]=Y.x2,C[T+15]=Y.y2,A[T+16]=K,A[T+17]=q,C[T+18]=B*U+R*W+D,C[T+19]=z*W+G*U+L,C[T+20]=Y.x3,C[T+21]=Y.y3,A[T+22]=K,A[T+23]=q}};_DefaultBatcher.extension={type:[ExtensionType.Batcher],name:"default"};let DefaultBatcher=_DefaultBatcher;function buildUvs(P,_,C,A,T,E,I,F=null){let B=0;C*=_,T*=E;const G=F.a,R=F.b,z=F.c,D=F.d,L=F.tx,O=F.ty;for(;B<I;){const V=P[C],U=P[C+1];A[T]=G*V+z*U+L,A[T+1]=R*V+D*U+O,T+=E,C+=_,B++}}function buildSimpleUvs(P,_,C,A){let T=0;for(_*=C;T<A;)P[_]=0,P[_+1]=0,_+=C,T++}function transformVertices(P,_,C,A,T){const E=_.a,I=_.b,F=_.c,B=_.d,G=_.tx,R=_.ty;C||(C=0),A||(A=2),T||(T=P.length/A-C);let z=C*A;for(let D=0;D<T;D++){const L=P[z],O=P[z+1];P[z]=E*L+F*O+G,P[z+1]=I*L+B*O+R,z+=A}}const identityMatrix=new Matrix;class BatchableGraphics{constructor(){this.packAsQuad=!1,this.batcherName="default",this.topology="triangle-list",this.applyTransform=!0,this.roundPixels=0,this._batcher=null,this._batch=null}get uvs(){return this.geometryData.uvs}get positions(){return this.geometryData.vertices}get indices(){return this.geometryData.indices}get blendMode(){return this.applyTransform?this.renderable.groupBlendMode:"normal"}get color(){const _=this.baseColor,C=_>>16|_&65280|(_&255)<<16,A=this.renderable;return A?multiplyHexColors(C,A.groupColor)+(this.alpha*A.groupAlpha*255<<24):C+(this.alpha*255<<24)}get transform(){var _;return((_=this.renderable)==null?void 0:_.groupTransform)||identityMatrix}copyTo(_){_.indexOffset=this.indexOffset,_.indexSize=this.indexSize,_.attributeOffset=this.attributeOffset,_.attributeSize=this.attributeSize,_.baseColor=this.baseColor,_.alpha=this.alpha,_.texture=this.texture,_.geometryData=this.geometryData,_.topology=this.topology}reset(){this.applyTransform=!0,this.renderable=null,this.topology="triangle-list"}}const buildCircle={extension:{type:ExtensionType.ShapeBuilder,name:"circle"},build(P,_){let C,A,T,E,I,F;if(P.type==="circle"){const K=P;C=K.x,A=K.y,I=F=K.radius,T=E=0}else if(P.type==="ellipse"){const K=P;C=K.x,A=K.y,I=K.halfWidth,F=K.halfHeight,T=E=0}else{const K=P,q=K.width/2,J=K.height/2;C=K.x+q,A=K.y+J,I=F=Math.max(0,Math.min(K.radius,Math.min(q,J))),T=q-I,E=J-F}if(!(I>=0&&F>=0&&T>=0&&E>=0))return _;const B=Math.ceil(2.3*Math.sqrt(I+F)),G=B*8+(T?4:0)+(E?4:0);if(G===0)return _;if(B===0)return _[0]=_[6]=C+T,_[1]=_[3]=A+E,_[2]=_[4]=C-T,_[5]=_[7]=A-E,_;let R=0,z=B*4+(T?2:0)+2,D=z,L=G,O=T+I,V=E,U=C+O,W=C-O,X=A+V;if(_[R++]=U,_[R++]=X,_[--z]=X,_[--z]=W,E){const K=A-V;_[D++]=W,_[D++]=K,_[--L]=K,_[--L]=U}for(let K=1;K<B;K++){const q=Math.PI/2*(K/B),J=T+Math.cos(q)*I,tt=E+Math.sin(q)*F,rt=C+J,st=C-J,nt=A+tt,at=A-tt;_[R++]=rt,_[R++]=nt,_[--z]=nt,_[--z]=st,_[D++]=st,_[D++]=at,_[--L]=at,_[--L]=rt}O=T,V=E+F,U=C+O,W=C-O,X=A+V;const Y=A-V;return _[R++]=U,_[R++]=X,_[--L]=Y,_[--L]=U,T&&(_[R++]=W,_[R++]=X,_[--L]=Y,_[--L]=W),_},triangulate(P,_,C,A,T,E){if(P.length===0)return;let I=0,F=0;for(let R=0;R<P.length;R+=2)I+=P[R],F+=P[R+1];I/=P.length/2,F/=P.length/2;let B=A;_[B*C]=I,_[B*C+1]=F;const G=B++;for(let R=0;R<P.length;R+=2)_[B*C]=P[R],_[B*C+1]=P[R+1],R>0&&(T[E++]=B,T[E++]=G,T[E++]=B-1),B++;T[E++]=G+1,T[E++]=G,T[E++]=B-1}},buildEllipse={...buildCircle,extension:{...buildCircle.extension,name:"ellipse"}},buildRoundedRectangle={...buildCircle,extension:{...buildCircle.extension,name:"roundedRectangle"}},closePointEps=1e-4,curveEps=1e-4;function getOrientationOfPoints(P){const _=P.length;if(_<6)return 1;let C=0;for(let A=0,T=P[_-2],E=P[_-1];A<_;A+=2){const I=P[A],F=P[A+1];C+=(I-T)*(F+E),T=I,E=F}return C<0?-1:1}function square(P,_,C,A,T,E,I,F){const B=P-C*T,G=_-A*T,R=P+C*E,z=_+A*E;let D,L;I?(D=A,L=-C):(D=-A,L=C);const O=B+D,V=G+L,U=R+D,W=z+L;return F.push(O,V),F.push(U,W),2}function round(P,_,C,A,T,E,I,F){const B=C-P,G=A-_;let R=Math.atan2(B,G),z=Math.atan2(T-P,E-_);F&&R<z?R+=Math.PI*2:!F&&R>z&&(z+=Math.PI*2);let D=R;const L=z-R,O=Math.abs(L),V=Math.sqrt(B*B+G*G),U=(15*O*Math.sqrt(V)/Math.PI>>0)+1,W=L/U;if(D+=W,F){I.push(P,_),I.push(C,A);for(let X=1,Y=D;X<U;X++,Y+=W)I.push(P,_),I.push(P+Math.sin(Y)*V,_+Math.cos(Y)*V);I.push(P,_),I.push(T,E)}else{I.push(C,A),I.push(P,_);for(let X=1,Y=D;X<U;X++,Y+=W)I.push(P+Math.sin(Y)*V,_+Math.cos(Y)*V),I.push(P,_);I.push(T,E),I.push(P,_)}return U*2}function buildLine(P,_,C,A,T,E){const I=closePointEps;if(P.length===0)return;const F=_;let B=F.alignment;if(_.alignment!==.5){let et=getOrientationOfPoints(P);B=(B-.5)*et+.5}const G=new Point(P[0],P[1]),R=new Point(P[P.length-2],P[P.length-1]),z=A,D=Math.abs(G.x-R.x)<I&&Math.abs(G.y-R.y)<I;if(z){P=P.slice(),D&&(P.pop(),P.pop(),R.set(P[P.length-2],P[P.length-1]));const et=(G.x+R.x)*.5,ht=(R.y+G.y)*.5;P.unshift(et,ht),P.push(et,ht)}const L=T,O=P.length/2;let V=P.length;const U=L.length/2,W=F.width/2,X=W*W,Y=F.miterLimit*F.miterLimit;let K=P[0],q=P[1],J=P[2],tt=P[3],rt=0,st=0,nt=-(q-tt),at=K-J,ot=0,ct=0,dt=Math.sqrt(nt*nt+at*at);nt/=dt,at/=dt,nt*=W,at*=W;const ut=B,Q=(1-ut)*2,it=ut*2;z||(F.cap==="round"?V+=round(K-nt*(Q-it)*.5,q-at*(Q-it)*.5,K-nt*Q,q-at*Q,K+nt*it,q+at*it,L,!0)+2:F.cap==="square"&&(V+=square(K,q,nt,at,Q,it,!0,L))),L.push(K-nt*Q,q-at*Q),L.push(K+nt*it,q+at*it);for(let et=1;et<O-1;++et){K=P[(et-1)*2],q=P[(et-1)*2+1],J=P[et*2],tt=P[et*2+1],rt=P[(et+1)*2],st=P[(et+1)*2+1],nt=-(q-tt),at=K-J,dt=Math.sqrt(nt*nt+at*at),nt/=dt,at/=dt,nt*=W,at*=W,ot=-(tt-st),ct=J-rt,dt=Math.sqrt(ot*ot+ct*ct),ot/=dt,ct/=dt,ot*=W,ct*=W;const ht=J-K,lt=q-tt,ft=J-rt,pt=st-tt,mt=ht*ft+lt*pt,gt=lt*ft-pt*ht,yt=gt<0;if(Math.abs(gt)<.001*Math.abs(mt)){L.push(J-nt*Q,tt-at*Q),L.push(J+nt*it,tt+at*it),mt>=0&&(F.join==="round"?V+=round(J,tt,J-nt*Q,tt-at*Q,J-ot*Q,tt-ct*Q,L,!1)+4:V+=2,L.push(J-ot*it,tt-ct*it),L.push(J+ot*Q,tt+ct*Q));continue}const bt=(-nt+K)*(-at+tt)-(-nt+J)*(-at+q),xt=(-ot+rt)*(-ct+tt)-(-ot+J)*(-ct+st),Et=(ht*xt-ft*bt)/gt,_t=(pt*bt-lt*xt)/gt,Tt=(Et-J)*(Et-J)+(_t-tt)*(_t-tt),At=J+(Et-J)*Q,wt=tt+(_t-tt)*Q,vt=J-(Et-J)*it,Pt=tt-(_t-tt)*it,Ct=Math.min(ht*ht+lt*lt,ft*ft+pt*pt),Bt=yt?Q:it,It=Ct+Bt*Bt*X;Tt<=It?F.join==="bevel"||Tt/X>Y?(yt?(L.push(At,wt),L.push(J+nt*it,tt+at*it),L.push(At,wt),L.push(J+ot*it,tt+ct*it)):(L.push(J-nt*Q,tt-at*Q),L.push(vt,Pt),L.push(J-ot*Q,tt-ct*Q),L.push(vt,Pt)),V+=2):F.join==="round"?yt?(L.push(At,wt),L.push(J+nt*it,tt+at*it),V+=round(J,tt,J+nt*it,tt+at*it,J+ot*it,tt+ct*it,L,!0)+4,L.push(At,wt),L.push(J+ot*it,tt+ct*it)):(L.push(J-nt*Q,tt-at*Q),L.push(vt,Pt),V+=round(J,tt,J-nt*Q,tt-at*Q,J-ot*Q,tt-ct*Q,L,!1)+4,L.push(J-ot*Q,tt-ct*Q),L.push(vt,Pt)):(L.push(At,wt),L.push(vt,Pt)):(L.push(J-nt*Q,tt-at*Q),L.push(J+nt*it,tt+at*it),F.join==="round"?yt?V+=round(J,tt,J+nt*it,tt+at*it,J+ot*it,tt+ct*it,L,!0)+2:V+=round(J,tt,J-nt*Q,tt-at*Q,J-ot*Q,tt-ct*Q,L,!1)+2:F.join==="miter"&&Tt/X<=Y&&(yt?(L.push(vt,Pt),L.push(vt,Pt)):(L.push(At,wt),L.push(At,wt)),V+=2),L.push(J-ot*Q,tt-ct*Q),L.push(J+ot*it,tt+ct*it),V+=2)}K=P[(O-2)*2],q=P[(O-2)*2+1],J=P[(O-1)*2],tt=P[(O-1)*2+1],nt=-(q-tt),at=K-J,dt=Math.sqrt(nt*nt+at*at),nt/=dt,at/=dt,nt*=W,at*=W,L.push(J-nt*Q,tt-at*Q),L.push(J+nt*it,tt+at*it),z||(F.cap==="round"?V+=round(J-nt*(Q-it)*.5,tt-at*(Q-it)*.5,J-nt*Q,tt-at*Q,J+nt*it,tt+at*it,L,!1)+2:F.cap==="square"&&(V+=square(J,tt,nt,at,Q,it,!1,L)));const Z=curveEps*curveEps;for(let et=U;et<V+U-2;++et)K=L[et*2],q=L[et*2+1],J=L[(et+1)*2],tt=L[(et+1)*2+1],rt=L[(et+2)*2],st=L[(et+2)*2+1],!(Math.abs(K*(tt-st)+J*(st-q)+rt*(q-tt))<Z)&&E.push(et,et+1,et+2)}function buildPixelLine(P,_,C,A){const T=closePointEps;if(P.length===0)return;const E=P[0],I=P[1],F=P[P.length-2],B=P[P.length-1],G=_||Math.abs(E-F)<T&&Math.abs(I-B)<T,R=C,z=P.length/2,D=R.length/2;for(let L=0;L<z;L++)R.push(P[L*2]),R.push(P[L*2+1]);for(let L=0;L<z-1;L++)A.push(D+L,D+L+1);G&&A.push(D+z-1,D)}function triangulateWithHoles(P,_,C,A,T,E,I){const F=earcut(P,_,2);if(!F)return;for(let G=0;G<F.length;G+=3)E[I++]=F[G]+T,E[I++]=F[G+1]+T,E[I++]=F[G+2]+T;let B=T*A;for(let G=0;G<P.length;G+=2)C[B]=P[G],C[B+1]=P[G+1],B+=A}const emptyArray=[],buildPolygon={extension:{type:ExtensionType.ShapeBuilder,name:"polygon"},build(P,_){for(let C=0;C<P.points.length;C++)_[C]=P.points[C];return _},triangulate(P,_,C,A,T,E){triangulateWithHoles(P,emptyArray,_,C,A,T,E)}},buildRectangle={extension:{type:ExtensionType.ShapeBuilder,name:"rectangle"},build(P,_){const C=P,A=C.x,T=C.y,E=C.width,I=C.height;return E>=0&&I>=0&&(_[0]=A,_[1]=T,_[2]=A+E,_[3]=T,_[4]=A+E,_[5]=T+I,_[6]=A,_[7]=T+I),_},triangulate(P,_,C,A,T,E){let I=0;A*=C,_[A+I]=P[0],_[A+I+1]=P[1],I+=C,_[A+I]=P[2],_[A+I+1]=P[3],I+=C,_[A+I]=P[6],_[A+I+1]=P[7],I+=C,_[A+I]=P[4],_[A+I+1]=P[5],I+=C;const F=A/C;T[E++]=F,T[E++]=F+1,T[E++]=F+2,T[E++]=F+1,T[E++]=F+3,T[E++]=F+2}},buildTriangle={extension:{type:ExtensionType.ShapeBuilder,name:"triangle"},build(P,_){return _[0]=P.x,_[1]=P.y,_[2]=P.x2,_[3]=P.y2,_[4]=P.x3,_[5]=P.y3,_},triangulate(P,_,C,A,T,E){let I=0;A*=C,_[A+I]=P[0],_[A+I+1]=P[1],I+=C,_[A+I]=P[2],_[A+I+1]=P[3],I+=C,_[A+I]=P[4],_[A+I+1]=P[5];const F=A/C;T[E++]=F,T[E++]=F+1,T[E++]=F+2}},tempTextureMatrix$1=new Matrix,tempRect$1=new Rectangle;function generateTextureMatrix(P,_,C,A){const T=_.matrix?P.copyFrom(_.matrix).invert():P.identity();if(_.textureSpace==="local"){const E=C.getBounds(tempRect$1);T.translate(-E.x,-E.y),T.scale(1/E.width,1/E.height)}else{T.translate(_.texture.frame.x,_.texture.frame.y),T.scale(1/_.texture.source.width,1/_.texture.source.height);const E=_.texture.source.style;E.addressMode==="clamp-to-edge"&&(E.addressMode="repeat",E.update())}return A&&T.append(tempTextureMatrix$1.copyFrom(A).invert()),T}const shapeBuilders={};extensions.handleByMap(ExtensionType.ShapeBuilder,shapeBuilders);extensions.add(buildRectangle,buildPolygon,buildTriangle,buildCircle,buildEllipse,buildRoundedRectangle);const tempRect=new Rectangle,tempTextureMatrix=new Matrix;function buildContextBatches(P,_){const{geometryData:C,batches:A}=_;A.length=0,C.indices.length=0,C.vertices.length=0,C.uvs.length=0;for(let T=0;T<P.instructions.length;T++){const E=P.instructions[T];if(E.action==="texture")addTextureToGeometryData(E.data,A,C);else if(E.action==="fill"||E.action==="stroke"){const I=E.action==="stroke",F=E.data.path.shapePath,B=E.data.style,G=E.data.hole;I&&G&&addShapePathToGeometryData(G.shapePath,B,!0,A,C),G&&(F.shapePrimitives[F.shapePrimitives.length-1].holes=G.shapePath.shapePrimitives),addShapePathToGeometryData(F,B,I,A,C)}}}function addTextureToGeometryData(P,_,C){const{vertices:A,uvs:T,indices:E}=C,I=E.length,F=A.length/2,B=[],G=shapeBuilders.rectangle,R=tempRect,z=P.image;R.x=P.dx,R.y=P.dy,R.width=P.dw,R.height=P.dh;const D=P.transform;G.build(R,B),D&&transformVertices(B,D),G.triangulate(B,A,2,F,E,I);const L=z.uvs;T.push(L.x0,L.y0,L.x1,L.y1,L.x3,L.y3,L.x2,L.y2);const O=BigPool.get(BatchableGraphics);O.indexOffset=I,O.indexSize=E.length-I,O.attributeOffset=F,O.attributeSize=A.length/2-F,O.baseColor=P.style,O.alpha=P.alpha,O.texture=z,O.geometryData=C,_.push(O)}function addShapePathToGeometryData(P,_,C,A,T){const{vertices:E,uvs:I,indices:F}=T;P.shapePrimitives.forEach(({shape:B,transform:G,holes:R})=>{const z=F.length,D=E.length/2,L=[],O=shapeBuilders[B.type];let V="triangle-list";if(O.build(B,L),G&&transformVertices(L,G),C){const Y=B.closePath??!0,K=_;K.pixelLine?(buildPixelLine(L,Y,E,F),V="line-list"):buildLine(L,K,!1,Y,E,F)}else if(R){const Y=[],K=L.slice();getHoleArrays(R).forEach(J=>{Y.push(K.length/2),K.push(...J)}),triangulateWithHoles(K,Y,E,2,D,F,z)}else O.triangulate(L,E,2,D,F,z);const U=I.length/2,W=_.texture;if(W!==Texture.WHITE){const Y=generateTextureMatrix(tempTextureMatrix,_,B,G);buildUvs(E,2,D,I,U,2,E.length/2-D,Y)}else buildSimpleUvs(I,U,2,E.length/2-D);const X=BigPool.get(BatchableGraphics);X.indexOffset=z,X.indexSize=F.length-z,X.attributeOffset=D,X.attributeSize=E.length/2-D,X.baseColor=_.color,X.alpha=_.alpha,X.texture=W,X.geometryData=T,X.topology=V,A.push(X)})}function getHoleArrays(P){const _=[];for(let C=0;C<P.length;C++){const A=P[C].shape,T=[];shapeBuilders[A.type].build(A,T),_.push(T)}return _}class GpuGraphicsContext{constructor(){this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}}class GraphicsContextRenderData{constructor(){this.batcher=new DefaultBatcher,this.instructions=new InstructionSet}init(){this.instructions.reset()}get geometry(){return deprecation(v8_3_4,"GraphicsContextRenderData#geometry is deprecated, please use batcher.geometry instead."),this.batcher.geometry}}const _GraphicsContextSystem=class te{constructor(_){this._gpuContextHash={},this._graphicsDataContextHash=Object.create(null),_.renderableGC.addManagedHash(this,"_gpuContextHash"),_.renderableGC.addManagedHash(this,"_graphicsDataContextHash")}init(_){te.defaultOptions.bezierSmoothness=(_==null?void 0:_.bezierSmoothness)??te.defaultOptions.bezierSmoothness}getContextRenderData(_){return this._graphicsDataContextHash[_.uid]||this._initContextRenderData(_)}updateGpuContext(_){let C=this._gpuContextHash[_.uid]||this._initContext(_);if(_.dirty){C?this._cleanGraphicsContextData(_):C=this._initContext(_),buildContextBatches(_,C);const A=_.batchMode;_.customShader||A==="no-batch"?C.isBatchable=!1:A==="auto"&&(C.isBatchable=C.geometryData.vertices.length<400),_.dirty=!1}return C}getGpuContext(_){return this._gpuContextHash[_.uid]||this._initContext(_)}_initContextRenderData(_){const C=BigPool.get(GraphicsContextRenderData),{batches:A,geometryData:T}=this._gpuContextHash[_.uid],E=T.vertices.length,I=T.indices.length;for(let R=0;R<A.length;R++)A[R].applyTransform=!1;const F=C.batcher;F.ensureAttributeBuffer(E),F.ensureIndexBuffer(I),F.begin();for(let R=0;R<A.length;R++){const z=A[R];F.add(z)}F.finish(C.instructions);const B=F.geometry;B.indexBuffer.setDataWithSize(F.indexBuffer,F.indexSize,!0),B.buffers[0].setDataWithSize(F.attributeBuffer.float32View,F.attributeSize,!0);const G=F.batches;for(let R=0;R<G.length;R++){const z=G[R];z.bindGroup=getTextureBatchBindGroup(z.textures.textures,z.textures.count)}return this._graphicsDataContextHash[_.uid]=C,C}_initContext(_){const C=new GpuGraphicsContext;return C.context=_,this._gpuContextHash[_.uid]=C,_.on("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[_.uid]}onGraphicsContextDestroy(_){this._cleanGraphicsContextData(_),_.off("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[_.uid]=null}_cleanGraphicsContextData(_){const C=this._gpuContextHash[_.uid];C.isBatchable||this._graphicsDataContextHash[_.uid]&&(BigPool.return(this.getContextRenderData(_)),this._graphicsDataContextHash[_.uid]=null),C.batches&&C.batches.forEach(A=>{BigPool.return(A)})}destroy(){for(const _ in this._gpuContextHash)this._gpuContextHash[_]&&this.onGraphicsContextDestroy(this._gpuContextHash[_].context)}};_GraphicsContextSystem.extension={type:[ExtensionType.WebGLSystem,ExtensionType.WebGPUSystem,ExtensionType.CanvasSystem],name:"graphicsContext"};_GraphicsContextSystem.defaultOptions={bezierSmoothness:.5};let GraphicsContextSystem=_GraphicsContextSystem;const RECURSION_LIMIT$1=8,FLT_EPSILON$1=11920929e-14,PATH_DISTANCE_EPSILON$1=1;function buildAdaptiveBezier(P,_,C,A,T,E,I,F,B,G){const z=Math.min(.99,Math.max(0,G??GraphicsContextSystem.defaultOptions.bezierSmoothness));let D=(PATH_DISTANCE_EPSILON$1-z)/1;return D*=D,begin$1(_,C,A,T,E,I,F,B,P,D),P}function begin$1(P,_,C,A,T,E,I,F,B,G){recursive$1(P,_,C,A,T,E,I,F,B,G,0),B.push(I,F)}function recursive$1(P,_,C,A,T,E,I,F,B,G,R){if(R>RECURSION_LIMIT$1)return;const z=(P+C)/2,D=(_+A)/2,L=(C+T)/2,O=(A+E)/2,V=(T+I)/2,U=(E+F)/2,W=(z+L)/2,X=(D+O)/2,Y=(L+V)/2,K=(O+U)/2,q=(W+Y)/2,J=(X+K)/2;if(R>0){let tt=I-P,rt=F-_;const st=Math.abs((C-I)*rt-(A-F)*tt),nt=Math.abs((T-I)*rt-(E-F)*tt);if(st>FLT_EPSILON$1&&nt>FLT_EPSILON$1){if((st+nt)*(st+nt)<=G*(tt*tt+rt*rt)){B.push(q,J);return}}else if(st>FLT_EPSILON$1){if(st*st<=G*(tt*tt+rt*rt)){B.push(q,J);return}}else if(nt>FLT_EPSILON$1){if(nt*nt<=G*(tt*tt+rt*rt)){B.push(q,J);return}}else if(tt=q-(P+I)/2,rt=J-(_+F)/2,tt*tt+rt*rt<=G){B.push(q,J);return}}recursive$1(P,_,z,D,W,X,q,J,B,G,R+1),recursive$1(q,J,Y,K,V,U,I,F,B,G,R+1)}const RECURSION_LIMIT=8,FLT_EPSILON=11920929e-14,PATH_DISTANCE_EPSILON=1;function buildAdaptiveQuadratic(P,_,C,A,T,E,I,F){const G=Math.min(.99,Math.max(0,F??GraphicsContextSystem.defaultOptions.bezierSmoothness));let R=(PATH_DISTANCE_EPSILON-G)/1;return R*=R,begin(_,C,A,T,E,I,P,R),P}function begin(P,_,C,A,T,E,I,F){recursive(I,P,_,C,A,T,E,F,0),I.push(T,E)}function recursive(P,_,C,A,T,E,I,F,B){if(B>RECURSION_LIMIT)return;const G=(_+A)/2,R=(C+T)/2,z=(A+E)/2,D=(T+I)/2,L=(G+z)/2,O=(R+D)/2;let V=E-_,U=I-C;const W=Math.abs((A-E)*U-(T-I)*V);if(W>FLT_EPSILON){if(W*W<=F*(V*V+U*U)){P.push(L,O);return}}else if(V=L-(_+E)/2,U=O-(C+I)/2,V*V+U*U<=F){P.push(L,O);return}recursive(P,_,C,G,R,L,O,F,B+1),recursive(P,L,O,z,D,E,I,F,B+1)}function buildArc(P,_,C,A,T,E,I,F){let B=Math.abs(T-E);(!I&&T>E||I&&E>T)&&(B=2*Math.PI-B),F||(F=Math.max(6,Math.floor(6*Math.pow(A,1/3)*(B/Math.PI)))),F=Math.max(F,3);let G=B/F,R=T;G*=I?-1:1;for(let z=0;z<F+1;z++){const D=Math.cos(R),L=Math.sin(R),O=_+D*A,V=C+L*A;P.push(O,V),R+=G}}function buildArcTo(P,_,C,A,T,E){const I=P[P.length-2],B=P[P.length-1]-C,G=I-_,R=T-C,z=A-_,D=Math.abs(B*z-G*R);if(D<1e-8||E===0){(P[P.length-2]!==_||P[P.length-1]!==C)&&P.push(_,C);return}const L=B*B+G*G,O=R*R+z*z,V=B*R+G*z,U=E*Math.sqrt(L)/D,W=E*Math.sqrt(O)/D,X=U*V/L,Y=W*V/O,K=U*z+W*G,q=U*R+W*B,J=G*(W+X),tt=B*(W+X),rt=z*(U+Y),st=R*(U+Y),nt=Math.atan2(tt-q,J-K),at=Math.atan2(st-q,rt-K);buildArc(P,K+_,q+C,E,nt,at,G*R>z*B)}const TAU=Math.PI*2,out={centerX:0,centerY:0,ang1:0,ang2:0},mapToEllipse=({x:P,y:_},C,A,T,E,I,F,B)=>{P*=C,_*=A;const G=T*P-E*_,R=E*P+T*_;return B.x=G+I,B.y=R+F,B};function approxUnitArc(P,_){const C=_===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(_/4),A=_===1.5707963267948966?.551915024494:C,T=Math.cos(P),E=Math.sin(P),I=Math.cos(P+_),F=Math.sin(P+_);return[{x:T-E*A,y:E+T*A},{x:I+F*A,y:F-I*A},{x:I,y:F}]}const vectorAngle=(P,_,C,A)=>{const T=P*A-_*C<0?-1:1;let E=P*C+_*A;return E>1&&(E=1),E<-1&&(E=-1),T*Math.acos(E)},getArcCenter=(P,_,C,A,T,E,I,F,B,G,R,z,D)=>{const L=Math.pow(T,2),O=Math.pow(E,2),V=Math.pow(R,2),U=Math.pow(z,2);let W=L*O-L*U-O*V;W<0&&(W=0),W/=L*U+O*V,W=Math.sqrt(W)*(I===F?-1:1);const X=W*T/E*z,Y=W*-E/T*R,K=G*X-B*Y+(P+C)/2,q=B*X+G*Y+(_+A)/2,J=(R-X)/T,tt=(z-Y)/E,rt=(-R-X)/T,st=(-z-Y)/E,nt=vectorAngle(1,0,J,tt);let at=vectorAngle(J,tt,rt,st);F===0&&at>0&&(at-=TAU),F===1&&at<0&&(at+=TAU),D.centerX=K,D.centerY=q,D.ang1=nt,D.ang2=at};function buildArcToSvg(P,_,C,A,T,E,I,F=0,B=0,G=0){if(E===0||I===0)return;const R=Math.sin(F*TAU/360),z=Math.cos(F*TAU/360),D=z*(_-A)/2+R*(C-T)/2,L=-R*(_-A)/2+z*(C-T)/2;if(D===0&&L===0)return;E=Math.abs(E),I=Math.abs(I);const O=Math.pow(D,2)/Math.pow(E,2)+Math.pow(L,2)/Math.pow(I,2);O>1&&(E*=Math.sqrt(O),I*=Math.sqrt(O)),getArcCenter(_,C,A,T,E,I,B,G,R,z,D,L,out);let{ang1:V,ang2:U}=out;const{centerX:W,centerY:X}=out;let Y=Math.abs(U)/(TAU/4);Math.abs(1-Y)<1e-7&&(Y=1);const K=Math.max(Math.ceil(Y),1);U/=K;let q=P[P.length-2],J=P[P.length-1];const tt={x:0,y:0};for(let rt=0;rt<K;rt++){const st=approxUnitArc(V,U),{x:nt,y:at}=mapToEllipse(st[0],E,I,z,R,W,X,tt),{x:ot,y:ct}=mapToEllipse(st[1],E,I,z,R,W,X,tt),{x:dt,y:ut}=mapToEllipse(st[2],E,I,z,R,W,X,tt);buildAdaptiveBezier(P,q,J,nt,at,ot,ct,dt,ut),q=dt,J=ut,V+=U}}function roundedShapeArc(P,_,C){const A=(I,F)=>{const B=F.x-I.x,G=F.y-I.y,R=Math.sqrt(B*B+G*G),z=B/R,D=G/R;return{len:R,nx:z,ny:D}},T=(I,F)=>{I===0?P.moveTo(F.x,F.y):P.lineTo(F.x,F.y)};let E=_[_.length-1];for(let I=0;I<_.length;I++){const F=_[I%_.length],B=F.radius??C;if(B<=0){T(I,F),E=F;continue}const G=_[(I+1)%_.length],R=A(F,E),z=A(F,G);if(R.len<1e-4||z.len<1e-4){T(I,F),E=F;continue}let D=Math.asin(R.nx*z.ny-R.ny*z.nx),L=1,O=!1;R.nx*z.nx-R.ny*-z.ny<0?D<0?D=Math.PI+D:(D=Math.PI-D,L=-1,O=!0):D>0&&(L=-1,O=!0);const V=D/2;let U,W=Math.abs(Math.cos(V)*B/Math.sin(V));W>Math.min(R.len/2,z.len/2)?(W=Math.min(R.len/2,z.len/2),U=Math.abs(W*Math.sin(V)/Math.cos(V))):U=B;const X=F.x+z.nx*W+-z.ny*U*L,Y=F.y+z.ny*W+z.nx*U*L,K=Math.atan2(R.ny,R.nx)+Math.PI/2*L,q=Math.atan2(z.ny,z.nx)-Math.PI/2*L;I===0&&P.moveTo(X+Math.cos(K)*U,Y+Math.sin(K)*U),P.arc(X,Y,U,K,q,O),E=F}}function roundedShapeQuadraticCurve(P,_,C,A){const T=(F,B)=>Math.sqrt((F.x-B.x)**2+(F.y-B.y)**2),E=(F,B,G)=>({x:F.x+(B.x-F.x)*G,y:F.y+(B.y-F.y)*G}),I=_.length;for(let F=0;F<I;F++){const B=_[(F+1)%I],G=B.radius??C;if(G<=0){F===0?P.moveTo(B.x,B.y):P.lineTo(B.x,B.y);continue}const R=_[F],z=_[(F+2)%I],D=T(R,B);let L;if(D<1e-4)L=B;else{const U=Math.min(D/2,G);L=E(B,R,U/D)}const O=T(z,B);let V;if(O<1e-4)V=B;else{const U=Math.min(O/2,G);V=E(B,z,U/O)}F===0?P.moveTo(L.x,L.y):P.lineTo(L.x,L.y),P.quadraticCurveTo(B.x,B.y,V.x,V.y,A)}}const tempRectangle=new Rectangle;class ShapePath{constructor(_){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new Bounds,this._graphicsPath2D=_,this.signed=_.checkForHoles}moveTo(_,C){return this.startPoly(_,C),this}lineTo(_,C){this._ensurePoly();const A=this._currentPoly.points,T=A[A.length-2],E=A[A.length-1];return(T!==_||E!==C)&&A.push(_,C),this}arc(_,C,A,T,E,I){this._ensurePoly(!1);const F=this._currentPoly.points;return buildArc(F,_,C,A,T,E,I),this}arcTo(_,C,A,T,E){this._ensurePoly();const I=this._currentPoly.points;return buildArcTo(I,_,C,A,T,E),this}arcToSvg(_,C,A,T,E,I,F){const B=this._currentPoly.points;return buildArcToSvg(B,this._currentPoly.lastX,this._currentPoly.lastY,I,F,_,C,A,T,E),this}bezierCurveTo(_,C,A,T,E,I,F){this._ensurePoly();const B=this._currentPoly;return buildAdaptiveBezier(this._currentPoly.points,B.lastX,B.lastY,_,C,A,T,E,I,F),this}quadraticCurveTo(_,C,A,T,E){this._ensurePoly();const I=this._currentPoly;return buildAdaptiveQuadratic(this._currentPoly.points,I.lastX,I.lastY,_,C,A,T,E),this}closePath(){return this.endPoly(!0),this}addPath(_,C){this.endPoly(),C&&!C.isIdentity()&&(_=_.clone(!0),_.transform(C));const A=this.shapePrimitives,T=A.length;for(let E=0;E<_.instructions.length;E++){const I=_.instructions[E];this[I.action](...I.data)}if(_.checkForHoles&&A.length-T>1){let E=null;for(let I=T;I<A.length;I++){const F=A[I];if(F.shape.type==="polygon"){const B=F.shape,G=E==null?void 0:E.shape;G&&G.containsPolygon(B)?(E.holes||(E.holes=[]),E.holes.push(F),A.copyWithin(I,I+1),A.length--,I--):E=F}}}return this}finish(_=!1){this.endPoly(_)}rect(_,C,A,T,E){return this.drawShape(new Rectangle(_,C,A,T),E),this}circle(_,C,A,T){return this.drawShape(new Circle(_,C,A),T),this}poly(_,C,A){const T=new Polygon(_);return T.closePath=C,this.drawShape(T,A),this}regularPoly(_,C,A,T,E=0,I){T=Math.max(T|0,3);const F=-1*Math.PI/2+E,B=Math.PI*2/T,G=[];for(let R=0;R<T;R++){const z=F-R*B;G.push(_+A*Math.cos(z),C+A*Math.sin(z))}return this.poly(G,!0,I),this}roundPoly(_,C,A,T,E,I=0,F){if(T=Math.max(T|0,3),E<=0)return this.regularPoly(_,C,A,T,I);const B=A*Math.sin(Math.PI/T)-.001;E=Math.min(E,B);const G=-1*Math.PI/2+I,R=Math.PI*2/T,z=(T-2)*Math.PI/T/2;for(let D=0;D<T;D++){const L=D*R+G,O=_+A*Math.cos(L),V=C+A*Math.sin(L),U=L+Math.PI+z,W=L-Math.PI-z,X=O+E*Math.cos(U),Y=V+E*Math.sin(U),K=O+E*Math.cos(W),q=V+E*Math.sin(W);D===0?this.moveTo(X,Y):this.lineTo(X,Y),this.quadraticCurveTo(O,V,K,q,F)}return this.closePath()}roundShape(_,C,A=!1,T){return _.length<3?this:(A?roundedShapeQuadraticCurve(this,_,C,T):roundedShapeArc(this,_,C),this.closePath())}filletRect(_,C,A,T,E){if(E===0)return this.rect(_,C,A,T);const I=Math.min(A,T)/2,F=Math.min(I,Math.max(-I,E)),B=_+A,G=C+T,R=F<0?-F:0,z=Math.abs(F);return this.moveTo(_,C+z).arcTo(_+R,C+R,_+z,C,z).lineTo(B-z,C).arcTo(B-R,C+R,B,C+z,z).lineTo(B,G-z).arcTo(B-R,G-R,_+A-z,G,z).lineTo(_+z,G).arcTo(_+R,G-R,_,G-z,z).closePath()}chamferRect(_,C,A,T,E,I){if(E<=0)return this.rect(_,C,A,T);const F=Math.min(E,Math.min(A,T)/2),B=_+A,G=C+T,R=[_+F,C,B-F,C,B,C+F,B,G-F,B-F,G,_+F,G,_,G-F,_,C+F];for(let z=R.length-1;z>=2;z-=2)R[z]===R[z-2]&&R[z-1]===R[z-3]&&R.splice(z-1,2);return this.poly(R,!0,I)}ellipse(_,C,A,T,E){return this.drawShape(new Ellipse(_,C,A,T),E),this}roundRect(_,C,A,T,E,I){return this.drawShape(new RoundedRectangle(_,C,A,T,E),I),this}drawShape(_,C){return this.endPoly(),this.shapePrimitives.push({shape:_,transform:C}),this}startPoly(_,C){let A=this._currentPoly;return A&&this.endPoly(),A=new Polygon,A.points.push(_,C),this._currentPoly=A,this}endPoly(_=!1){const C=this._currentPoly;return C&&C.points.length>2&&(C.closePath=_,this.shapePrimitives.push({shape:C})),this._currentPoly=null,this}_ensurePoly(_=!0){if(!this._currentPoly&&(this._currentPoly=new Polygon,_)){const C=this.shapePrimitives[this.shapePrimitives.length-1];if(C){let A=C.shape.x,T=C.shape.y;if(C.transform&&!C.transform.isIdentity()){const E=C.transform,I=A;A=E.a*A+E.c*T+E.tx,T=E.b*I+E.d*T+E.ty}this._currentPoly.points.push(A,T)}else this._currentPoly.points.push(0,0)}}buildPath(){const _=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let C=0;C<_.instructions.length;C++){const A=_.instructions[C];this[A.action](...A.data)}this.finish()}get bounds(){const _=this._bounds;_.clear();const C=this.shapePrimitives;for(let A=0;A<C.length;A++){const T=C[A],E=T.shape.getBounds(tempRectangle);T.transform?_.addRect(E,T.transform):_.addRect(E)}return _}}class GraphicsPath{constructor(_,C=!1){this.instructions=[],this.uid=uid("graphicsPath"),this._dirty=!0,this.checkForHoles=C,typeof _=="string"?parseSVGPath(_,this):this.instructions=(_==null?void 0:_.slice())??[]}get shapePath(){return this._shapePath||(this._shapePath=new ShapePath(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(_,C){return _=_.clone(),this.instructions.push({action:"addPath",data:[_,C]}),this._dirty=!0,this}arc(..._){return this.instructions.push({action:"arc",data:_}),this._dirty=!0,this}arcTo(..._){return this.instructions.push({action:"arcTo",data:_}),this._dirty=!0,this}arcToSvg(..._){return this.instructions.push({action:"arcToSvg",data:_}),this._dirty=!0,this}bezierCurveTo(..._){return this.instructions.push({action:"bezierCurveTo",data:_}),this._dirty=!0,this}bezierCurveToShort(_,C,A,T,E){const I=this.instructions[this.instructions.length-1],F=this.getLastPoint(Point.shared);let B=0,G=0;if(!I||I.action!=="bezierCurveTo")B=F.x,G=F.y;else{B=I.data[2],G=I.data[3];const R=F.x,z=F.y;B=R+(R-B),G=z+(z-G)}return this.instructions.push({action:"bezierCurveTo",data:[B,G,_,C,A,T,E]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(..._){return this.instructions.push({action:"ellipse",data:_}),this._dirty=!0,this}lineTo(..._){return this.instructions.push({action:"lineTo",data:_}),this._dirty=!0,this}moveTo(..._){return this.instructions.push({action:"moveTo",data:_}),this}quadraticCurveTo(..._){return this.instructions.push({action:"quadraticCurveTo",data:_}),this._dirty=!0,this}quadraticCurveToShort(_,C,A){const T=this.instructions[this.instructions.length-1],E=this.getLastPoint(Point.shared);let I=0,F=0;if(!T||T.action!=="quadraticCurveTo")I=E.x,F=E.y;else{I=T.data[0],F=T.data[1];const B=E.x,G=E.y;I=B+(B-I),F=G+(G-F)}return this.instructions.push({action:"quadraticCurveTo",data:[I,F,_,C,A]}),this._dirty=!0,this}rect(_,C,A,T,E){return this.instructions.push({action:"rect",data:[_,C,A,T,E]}),this._dirty=!0,this}circle(_,C,A,T){return this.instructions.push({action:"circle",data:[_,C,A,T]}),this._dirty=!0,this}roundRect(..._){return this.instructions.push({action:"roundRect",data:_}),this._dirty=!0,this}poly(..._){return this.instructions.push({action:"poly",data:_}),this._dirty=!0,this}regularPoly(..._){return this.instructions.push({action:"regularPoly",data:_}),this._dirty=!0,this}roundPoly(..._){return this.instructions.push({action:"roundPoly",data:_}),this._dirty=!0,this}roundShape(..._){return this.instructions.push({action:"roundShape",data:_}),this._dirty=!0,this}filletRect(..._){return this.instructions.push({action:"filletRect",data:_}),this._dirty=!0,this}chamferRect(..._){return this.instructions.push({action:"chamferRect",data:_}),this._dirty=!0,this}star(_,C,A,T,E,I,F){E||(E=T/2);const B=-1*Math.PI/2+I,G=A*2,R=Math.PI*2/G,z=[];for(let D=0;D<G;D++){const L=D%2?E:T,O=D*R+B;z.push(_+L*Math.cos(O),C+L*Math.sin(O))}return this.poly(z,!0,F),this}clone(_=!1){const C=new GraphicsPath;if(C.checkForHoles=this.checkForHoles,!_)C.instructions=this.instructions.slice();else for(let A=0;A<this.instructions.length;A++){const T=this.instructions[A];C.instructions.push({action:T.action,data:T.data.slice()})}return C}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(_){if(_.isIdentity())return this;const C=_.a,A=_.b,T=_.c,E=_.d,I=_.tx,F=_.ty;let B=0,G=0,R=0,z=0,D=0,L=0,O=0,V=0;for(let U=0;U<this.instructions.length;U++){const W=this.instructions[U],X=W.data;switch(W.action){case"moveTo":case"lineTo":B=X[0],G=X[1],X[0]=C*B+T*G+I,X[1]=A*B+E*G+F;break;case"bezierCurveTo":R=X[0],z=X[1],D=X[2],L=X[3],B=X[4],G=X[5],X[0]=C*R+T*z+I,X[1]=A*R+E*z+F,X[2]=C*D+T*L+I,X[3]=A*D+E*L+F,X[4]=C*B+T*G+I,X[5]=A*B+E*G+F;break;case"quadraticCurveTo":R=X[0],z=X[1],B=X[2],G=X[3],X[0]=C*R+T*z+I,X[1]=A*R+E*z+F,X[2]=C*B+T*G+I,X[3]=A*B+E*G+F;break;case"arcToSvg":B=X[5],G=X[6],O=X[0],V=X[1],X[0]=C*O+T*V,X[1]=A*O+E*V,X[5]=C*B+T*G+I,X[6]=A*B+E*G+F;break;case"circle":X[4]=adjustTransform(X[3],_);break;case"rect":X[4]=adjustTransform(X[4],_);break;case"ellipse":X[8]=adjustTransform(X[8],_);break;case"roundRect":X[5]=adjustTransform(X[5],_);break;case"addPath":X[0].transform(_);break;case"poly":X[2]=adjustTransform(X[2],_);break;default:warn("unknown transform action",W.action);break}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(_){let C=this.instructions.length-1,A=this.instructions[C];if(!A)return _.x=0,_.y=0,_;for(;A.action==="closePath";){if(C--,C<0)return _.x=0,_.y=0,_;A=this.instructions[C]}switch(A.action){case"moveTo":case"lineTo":_.x=A.data[0],_.y=A.data[1];break;case"quadraticCurveTo":_.x=A.data[2],_.y=A.data[3];break;case"bezierCurveTo":_.x=A.data[4],_.y=A.data[5];break;case"arc":case"arcToSvg":_.x=A.data[5],_.y=A.data[6];break;case"addPath":A.data[0].getLastPoint(_);break}return _}}function adjustTransform(P,_){return P?P.prepend(_):_.clone()}function parseSVGFloatAttribute(P,_,C){const A=P.getAttribute(_);return A?Number(A):C}function parseSVGDefinitions(P,_){const C=P.querySelectorAll("defs");for(let A=0;A<C.length;A++){const T=C[A];for(let E=0;E<T.children.length;E++){const I=T.children[E];switch(I.nodeName.toLowerCase()){case"lineargradient":_.defs[I.id]=parseLinearGradient(I);break;case"radialgradient":_.defs[I.id]=parseRadialGradient();break}}}}function parseLinearGradient(P){const _=parseSVGFloatAttribute(P,"x1",0),C=parseSVGFloatAttribute(P,"y1",0),A=parseSVGFloatAttribute(P,"x2",1),T=parseSVGFloatAttribute(P,"y2",0),E=P.getAttribute("gradientUnits")||"objectBoundingBox",I=new FillGradient(_,C,A,T,E==="objectBoundingBox"?"local":"global");for(let F=0;F<P.children.length;F++){const B=P.children[F],G=parseSVGFloatAttribute(B,"offset",0),R=Color.shared.setValue(B.getAttribute("stop-color")).toNumber();I.addColorStop(G,R)}return I}function parseRadialGradient(P){return warn("[SVG Parser] Radial gradients are not yet supported"),new FillGradient(0,0,1,0)}function extractSvgUrlId(P){const _=P.match(/url\s*\(\s*['"]?\s*#([^'"\s)]+)\s*['"]?\s*\)/i);return _?_[1]:""}const styleAttributes={fill:{type:"paint",default:0},"fill-opacity":{type:"number",default:1},stroke:{type:"paint",default:0},"stroke-width":{type:"number",default:1},"stroke-opacity":{type:"number",default:1},"stroke-linecap":{type:"string",default:"butt"},"stroke-linejoin":{type:"string",default:"miter"},"stroke-miterlimit":{type:"number",default:10},"stroke-dasharray":{type:"string",default:"none"},"stroke-dashoffset":{type:"number",default:0},opacity:{type:"number",default:1}};function parseSVGStyle(P,_){const C=P.getAttribute("style"),A={},T={},E={strokeStyle:A,fillStyle:T,useFill:!1,useStroke:!1};for(const I in styleAttributes){const F=P.getAttribute(I);F&&parseAttribute(_,E,I,F.trim())}if(C){const I=C.split(";");for(let F=0;F<I.length;F++){const B=I[F].trim(),[G,R]=B.split(":");styleAttributes[G]&&parseAttribute(_,E,G,R.trim())}}return{strokeStyle:E.useStroke?A:null,fillStyle:E.useFill?T:null,useFill:E.useFill,useStroke:E.useStroke}}function parseAttribute(P,_,C,A){switch(C){case"stroke":if(A!=="none"){if(A.startsWith("url(")){const T=extractSvgUrlId(A);_.strokeStyle.fill=P.defs[T]}else _.strokeStyle.color=Color.shared.setValue(A).toNumber();_.useStroke=!0}break;case"stroke-width":_.strokeStyle.width=Number(A);break;case"fill":if(A!=="none"){if(A.startsWith("url(")){const T=extractSvgUrlId(A);_.fillStyle.fill=P.defs[T]}else _.fillStyle.color=Color.shared.setValue(A).toNumber();_.useFill=!0}break;case"fill-opacity":_.fillStyle.alpha=Number(A);break;case"stroke-opacity":_.strokeStyle.alpha=Number(A);break;case"opacity":_.fillStyle.alpha=Number(A),_.strokeStyle.alpha=Number(A);break}}function SVGParser(P,_){if(typeof P=="string"){const I=document.createElement("div");I.innerHTML=P.trim(),P=I.querySelector("svg")}const C={context:_,defs:{},path:new GraphicsPath};parseSVGDefinitions(P,C);const A=P.children,{fillStyle:T,strokeStyle:E}=parseSVGStyle(P,C);for(let I=0;I<A.length;I++){const F=A[I];F.nodeName.toLowerCase()!=="defs"&&renderChildren(F,C,T,E)}return _}function renderChildren(P,_,C,A){const T=P.children,{fillStyle:E,strokeStyle:I}=parseSVGStyle(P,_);E&&C?C={...C,...E}:E&&(C=E),I&&A?A={...A,...I}:I&&(A=I);const F=!C&&!A;F&&(C={color:0});let B,G,R,z,D,L,O,V,U,W,X,Y,K,q,J,tt,rt;switch(P.nodeName.toLowerCase()){case"path":q=P.getAttribute("d"),P.getAttribute("fill-rule")==="evenodd"&&warn("SVG Evenodd fill rule not supported, your svg may render incorrectly"),J=new GraphicsPath(q,!0),_.context.path(J),C&&_.context.fill(C),A&&_.context.stroke(A);break;case"circle":O=parseSVGFloatAttribute(P,"cx",0),V=parseSVGFloatAttribute(P,"cy",0),U=parseSVGFloatAttribute(P,"r",0),_.context.ellipse(O,V,U,U),C&&_.context.fill(C),A&&_.context.stroke(A);break;case"rect":B=parseSVGFloatAttribute(P,"x",0),G=parseSVGFloatAttribute(P,"y",0),tt=parseSVGFloatAttribute(P,"width",0),rt=parseSVGFloatAttribute(P,"height",0),W=parseSVGFloatAttribute(P,"rx",0),X=parseSVGFloatAttribute(P,"ry",0),W||X?_.context.roundRect(B,G,tt,rt,W||X):_.context.rect(B,G,tt,rt),C&&_.context.fill(C),A&&_.context.stroke(A);break;case"ellipse":O=parseSVGFloatAttribute(P,"cx",0),V=parseSVGFloatAttribute(P,"cy",0),W=parseSVGFloatAttribute(P,"rx",0),X=parseSVGFloatAttribute(P,"ry",0),_.context.beginPath(),_.context.ellipse(O,V,W,X),C&&_.context.fill(C),A&&_.context.stroke(A);break;case"line":R=parseSVGFloatAttribute(P,"x1",0),z=parseSVGFloatAttribute(P,"y1",0),D=parseSVGFloatAttribute(P,"x2",0),L=parseSVGFloatAttribute(P,"y2",0),_.context.beginPath(),_.context.moveTo(R,z),_.context.lineTo(D,L),A&&_.context.stroke(A);break;case"polygon":K=P.getAttribute("points"),Y=K.match(/\d+/g).map(st=>parseInt(st,10)),_.context.poly(Y,!0),C&&_.context.fill(C),A&&_.context.stroke(A);break;case"polyline":K=P.getAttribute("points"),Y=K.match(/\d+/g).map(st=>parseInt(st,10)),_.context.poly(Y,!1),A&&_.context.stroke(A);break;case"g":case"svg":break;default:{warn(`[SVG parser] <${P.nodeName}> elements unsupported`);break}}F&&(C=null);for(let st=0;st<T.length;st++)renderChildren(T[st],_,C,A)}function isColorLike(P){return Color.isColorLike(P)}function isFillPattern(P){return P instanceof FillPattern}function isFillGradient(P){return P instanceof FillGradient}function isTexture(P){return P instanceof Texture}function handleColorLike(P,_,C){const A=Color.shared.setValue(_??0);return P.color=A.toNumber(),P.alpha=A.alpha===1?C.alpha:A.alpha,P.texture=Texture.WHITE,{...C,...P}}function handleTexture(P,_,C){return P.texture=_,{...C,...P}}function handleFillPattern(P,_,C){return P.fill=_,P.color=16777215,P.texture=_.texture,P.matrix=_.transform,{...C,...P}}function handleFillGradient(P,_,C){return _.buildGradient(),P.fill=_,P.color=16777215,P.texture=_.texture,P.matrix=_.transform,P.textureSpace=_.textureSpace,{...C,...P}}function handleFillObject(P,_){const C={..._,...P},A=Color.shared.setValue(C.color);return C.alpha*=A.alpha,C.color=A.toNumber(),C}function toFillStyle(P,_){if(P==null)return null;const C={},A=P;return isColorLike(P)?handleColorLike(C,P,_):isTexture(P)?handleTexture(C,P,_):isFillPattern(P)?handleFillPattern(C,P,_):isFillGradient(P)?handleFillGradient(C,P,_):A.fill&&isFillPattern(A.fill)?handleFillPattern(A,A.fill,_):A.fill&&isFillGradient(A.fill)?handleFillGradient(A,A.fill,_):handleFillObject(A,_)}function toStrokeStyle(P,_){const{width:C,alignment:A,miterLimit:T,cap:E,join:I,pixelLine:F,...B}=_,G=toFillStyle(P,B);return G?{width:C,alignment:A,miterLimit:T,cap:E,join:I,pixelLine:F,...G}:null}const tmpPoint=new Point,tempMatrix=new Matrix,_GraphicsContext=class zt extends EventEmitter{constructor(){super(...arguments),this.uid=uid("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this._activePath=new GraphicsPath,this._transform=new Matrix,this._fillStyle={...zt.defaultFillStyle},this._strokeStyle={...zt.defaultStrokeStyle},this._stateStack=[],this._tick=0,this._bounds=new Bounds,this._boundsDirty=!0}clone(){const _=new zt;return _.batchMode=this.batchMode,_.instructions=this.instructions.slice(),_._activePath=this._activePath.clone(),_._transform=this._transform.clone(),_._fillStyle={...this._fillStyle},_._strokeStyle={...this._strokeStyle},_._stateStack=this._stateStack.slice(),_._bounds=this._bounds.clone(),_._boundsDirty=!0,_}get fillStyle(){return this._fillStyle}set fillStyle(_){this._fillStyle=toFillStyle(_,zt.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(_){this._strokeStyle=toStrokeStyle(_,zt.defaultStrokeStyle)}setFillStyle(_){return this._fillStyle=toFillStyle(_,zt.defaultFillStyle),this}setStrokeStyle(_){return this._strokeStyle=toFillStyle(_,zt.defaultStrokeStyle),this}texture(_,C,A,T,E,I){return this.instructions.push({action:"texture",data:{image:_,dx:A||0,dy:T||0,dw:E||_.frame.width,dh:I||_.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:C?Color.shared.setValue(C).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this._activePath=new GraphicsPath,this}fill(_,C){let A;const T=this.instructions[this.instructions.length-1];return this._tick===0&&T&&T.action==="stroke"?A=T.data.path:A=this._activePath.clone(),A?(_!=null&&(C!==void 0&&typeof _=="number"&&(deprecation(v8_0_0,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),_={color:_,alpha:C}),this._fillStyle=toFillStyle(_,zt.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:A}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}_initNextPathLocation(){const{x:_,y:C}=this._activePath.getLastPoint(Point.shared);this._activePath.clear(),this._activePath.moveTo(_,C)}stroke(_){let C;const A=this.instructions[this.instructions.length-1];return this._tick===0&&A&&A.action==="fill"?C=A.data.path:C=this._activePath.clone(),C?(_!=null&&(this._strokeStyle=toStrokeStyle(_,zt.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:C}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}cut(){for(let _=0;_<2;_++){const C=this.instructions[this.instructions.length-1-_],A=this._activePath.clone();if(C&&(C.action==="stroke"||C.action==="fill"))if(C.data.hole)C.data.hole.addPath(A);else{C.data.hole=A;break}}return this._initNextPathLocation(),this}arc(_,C,A,T,E,I){this._tick++;const F=this._transform;return this._activePath.arc(F.a*_+F.c*C+F.tx,F.b*_+F.d*C+F.ty,A,T,E,I),this}arcTo(_,C,A,T,E){this._tick++;const I=this._transform;return this._activePath.arcTo(I.a*_+I.c*C+I.tx,I.b*_+I.d*C+I.ty,I.a*A+I.c*T+I.tx,I.b*A+I.d*T+I.ty,E),this}arcToSvg(_,C,A,T,E,I,F){this._tick++;const B=this._transform;return this._activePath.arcToSvg(_,C,A,T,E,B.a*I+B.c*F+B.tx,B.b*I+B.d*F+B.ty),this}bezierCurveTo(_,C,A,T,E,I,F){this._tick++;const B=this._transform;return this._activePath.bezierCurveTo(B.a*_+B.c*C+B.tx,B.b*_+B.d*C+B.ty,B.a*A+B.c*T+B.tx,B.b*A+B.d*T+B.ty,B.a*E+B.c*I+B.tx,B.b*E+B.d*I+B.ty,F),this}closePath(){var _;return this._tick++,(_=this._activePath)==null||_.closePath(),this}ellipse(_,C,A,T){return this._tick++,this._activePath.ellipse(_,C,A,T,this._transform.clone()),this}circle(_,C,A){return this._tick++,this._activePath.circle(_,C,A,this._transform.clone()),this}path(_){return this._tick++,this._activePath.addPath(_,this._transform.clone()),this}lineTo(_,C){this._tick++;const A=this._transform;return this._activePath.lineTo(A.a*_+A.c*C+A.tx,A.b*_+A.d*C+A.ty),this}moveTo(_,C){this._tick++;const A=this._transform,T=this._activePath.instructions,E=A.a*_+A.c*C+A.tx,I=A.b*_+A.d*C+A.ty;return T.length===1&&T[0].action==="moveTo"?(T[0].data[0]=E,T[0].data[1]=I,this):(this._activePath.moveTo(E,I),this)}quadraticCurveTo(_,C,A,T,E){this._tick++;const I=this._transform;return this._activePath.quadraticCurveTo(I.a*_+I.c*C+I.tx,I.b*_+I.d*C+I.ty,I.a*A+I.c*T+I.tx,I.b*A+I.d*T+I.ty,E),this}rect(_,C,A,T){return this._tick++,this._activePath.rect(_,C,A,T,this._transform.clone()),this}roundRect(_,C,A,T,E){return this._tick++,this._activePath.roundRect(_,C,A,T,E,this._transform.clone()),this}poly(_,C){return this._tick++,this._activePath.poly(_,C,this._transform.clone()),this}regularPoly(_,C,A,T,E=0,I){return this._tick++,this._activePath.regularPoly(_,C,A,T,E,I),this}roundPoly(_,C,A,T,E,I){return this._tick++,this._activePath.roundPoly(_,C,A,T,E,I),this}roundShape(_,C,A,T){return this._tick++,this._activePath.roundShape(_,C,A,T),this}filletRect(_,C,A,T,E){return this._tick++,this._activePath.filletRect(_,C,A,T,E),this}chamferRect(_,C,A,T,E,I){return this._tick++,this._activePath.chamferRect(_,C,A,T,E,I),this}star(_,C,A,T,E=0,I=0){return this._tick++,this._activePath.star(_,C,A,T,E,I,this._transform.clone()),this}svg(_){return this._tick++,SVGParser(_,this),this}restore(){const _=this._stateStack.pop();return _&&(this._transform=_.transform,this._fillStyle=_.fillStyle,this._strokeStyle=_.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(_){return this._transform.rotate(_),this}scale(_,C=_){return this._transform.scale(_,C),this}setTransform(_,C,A,T,E,I){return _ instanceof Matrix?(this._transform.set(_.a,_.b,_.c,_.d,_.tx,_.ty),this):(this._transform.set(_,C,A,T,E,I),this)}transform(_,C,A,T,E,I){return _ instanceof Matrix?(this._transform.append(_),this):(tempMatrix.set(_,C,A,T,E,I),this._transform.append(tempMatrix),this)}translate(_,C=_){return this._transform.translate(_,C),this}clear(){return this._activePath.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this.dirty||(this.emit("update",this,16),this.dirty=!0,this._boundsDirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;const _=this._bounds;_.clear();for(let C=0;C<this.instructions.length;C++){const A=this.instructions[C],T=A.action;if(T==="fill"){const E=A.data;_.addBounds(E.path.bounds)}else if(T==="texture"){const E=A.data;_.addFrame(E.dx,E.dy,E.dx+E.dw,E.dy+E.dh,E.transform)}if(T==="stroke"){const E=A.data,I=E.style.alignment,F=E.style.width*(1-I),B=E.path.bounds;_.addFrame(B.minX-F,B.minY-F,B.maxX+F,B.maxY+F)}}return _}containsPoint(_){var T;if(!this.bounds.containsPoint(_.x,_.y))return!1;const C=this.instructions;let A=!1;for(let E=0;E<C.length;E++){const I=C[E],F=I.data,B=F.path;if(!I.action||!B)continue;const G=F.style,R=B.shapePath.shapePrimitives;for(let z=0;z<R.length;z++){const D=R[z].shape;if(!G||!D)continue;const L=R[z].transform,O=L?L.applyInverse(_,tmpPoint):_;if(I.action==="fill")A=D.contains(O.x,O.y);else{const U=G;A=D.strokeContains(O.x,O.y,U.width,U.alignment)}const V=F.hole;if(V){const U=(T=V.shapePath)==null?void 0:T.shapePrimitives;if(U)for(let W=0;W<U.length;W++)U[W].shape.contains(O.x,O.y)&&(A=!1)}if(A)return!0}}return A}destroy(_=!1){if(this._stateStack.length=0,this._transform=null,this.emit("destroy",this),this.removeAllListeners(),typeof _=="boolean"?_:_==null?void 0:_.texture){const A=typeof _=="boolean"?_:_==null?void 0:_.textureSource;this._fillStyle.texture&&this._fillStyle.texture.destroy(A),this._strokeStyle.texture&&this._strokeStyle.texture.destroy(A)}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}};_GraphicsContext.defaultFillStyle={color:16777215,alpha:1,texture:Texture.WHITE,matrix:null,fill:null,textureSpace:"local"};_GraphicsContext.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:Texture.WHITE,matrix:null,fill:null,textureSpace:"local",pixelLine:!1};let GraphicsContext=_GraphicsContext;const valuesToIterateForKeys=["align","breakWords","cssOverrides","fontVariant","fontWeight","leading","letterSpacing","lineHeight","padding","textBaseline","trim","whiteSpace","wordWrap","wordWrapWidth","fontFamily","fontStyle","fontSize"];function generateTextStyleKey(P){const _=[];let C=0;for(let A=0;A<valuesToIterateForKeys.length;A++){const T=`_${valuesToIterateForKeys[A]}`;_[C++]=P[T]}return C=addFillStyleKey(P._fill,_,C),C=addStokeStyleKey(P._stroke,_,C),C=addDropShadowKey(P.dropShadow,_,C),_.join("-")}function addFillStyleKey(P,_,C){var A;return P&&(_[C++]=P.color,_[C++]=P.alpha,_[C++]=(A=P.fill)==null?void 0:A.styleKey),C}function addStokeStyleKey(P,_,C){return P&&(C=addFillStyleKey(P,_,C),_[C++]=P.width,_[C++]=P.alignment,_[C++]=P.cap,_[C++]=P.join,_[C++]=P.miterLimit),C}function addDropShadowKey(P,_,C){return P&&(_[C++]=P.alpha,_[C++]=P.angle,_[C++]=P.blur,_[C++]=P.distance,_[C++]=Color.shared.setValue(P.color).toNumber()),C}const _TextStyle=class $t extends EventEmitter{constructor(_={}){super(),convertV7Tov8Style(_);const C={...$t.defaultTextStyle,..._};for(const A in C){const T=A;this[T]=C[A]}this.update()}get align(){return this._align}set align(_){this._align=_,this.update()}get breakWords(){return this._breakWords}set breakWords(_){this._breakWords=_,this.update()}get dropShadow(){return this._dropShadow}set dropShadow(_){_!==null&&typeof _=="object"?this._dropShadow=this._createProxy({...$t.defaultDropShadow,..._}):this._dropShadow=_?this._createProxy({...$t.defaultDropShadow}):null,this.update()}get fontFamily(){return this._fontFamily}set fontFamily(_){this._fontFamily=_,this.update()}get fontSize(){return this._fontSize}set fontSize(_){typeof _=="string"?this._fontSize=parseInt(_,10):this._fontSize=_,this.update()}get fontStyle(){return this._fontStyle}set fontStyle(_){this._fontStyle=_.toLowerCase(),this.update()}get fontVariant(){return this._fontVariant}set fontVariant(_){this._fontVariant=_,this.update()}get fontWeight(){return this._fontWeight}set fontWeight(_){this._fontWeight=_,this.update()}get leading(){return this._leading}set leading(_){this._leading=_,this.update()}get letterSpacing(){return this._letterSpacing}set letterSpacing(_){this._letterSpacing=_,this.update()}get lineHeight(){return this._lineHeight}set lineHeight(_){this._lineHeight=_,this.update()}get padding(){return this._padding}set padding(_){this._padding=_,this.update()}get trim(){return this._trim}set trim(_){this._trim=_,this.update()}get textBaseline(){return this._textBaseline}set textBaseline(_){this._textBaseline=_,this.update()}get whiteSpace(){return this._whiteSpace}set whiteSpace(_){this._whiteSpace=_,this.update()}get wordWrap(){return this._wordWrap}set wordWrap(_){this._wordWrap=_,this.update()}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(_){this._wordWrapWidth=_,this.update()}get fill(){return this._originalFill}set fill(_){_!==this._originalFill&&(this._originalFill=_,this._isFillStyle(_)&&(this._originalFill=this._createProxy({...GraphicsContext.defaultFillStyle,..._},()=>{this._fill=toFillStyle({...this._originalFill},GraphicsContext.defaultFillStyle)})),this._fill=toFillStyle(_===0?"black":_,GraphicsContext.defaultFillStyle),this.update())}get stroke(){return this._originalStroke}set stroke(_){_!==this._originalStroke&&(this._originalStroke=_,this._isFillStyle(_)&&(this._originalStroke=this._createProxy({...GraphicsContext.defaultStrokeStyle,..._},()=>{this._stroke=toStrokeStyle({...this._originalStroke},GraphicsContext.defaultStrokeStyle)})),this._stroke=toStrokeStyle(_,GraphicsContext.defaultStrokeStyle),this.update())}_generateKey(){return this._styleKey=generateTextStyleKey(this),this._styleKey}update(){this._styleKey=null,this.emit("update",this)}reset(){const _=$t.defaultTextStyle;for(const C in _)this[C]=_[C]}get styleKey(){return this._styleKey||this._generateKey()}clone(){return new $t({align:this.align,breakWords:this.breakWords,dropShadow:this._dropShadow?{...this._dropShadow}:null,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,leading:this.leading,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,textBaseline:this.textBaseline,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth})}destroy(_=!1){var A,T,E,I;if(this.removeAllListeners(),typeof _=="boolean"?_:_==null?void 0:_.texture){const F=typeof _=="boolean"?_:_==null?void 0:_.textureSource;(A=this._fill)!=null&&A.texture&&this._fill.texture.destroy(F),(T=this._originalFill)!=null&&T.texture&&this._originalFill.texture.destroy(F),(E=this._stroke)!=null&&E.texture&&this._stroke.texture.destroy(F),(I=this._originalStroke)!=null&&I.texture&&this._originalStroke.texture.destroy(F)}this._fill=null,this._stroke=null,this.dropShadow=null,this._originalStroke=null,this._originalFill=null}_createProxy(_,C){return new Proxy(_,{set:(A,T,E)=>(A[T]=E,C==null||C(T,E),this.update(),!0)})}_isFillStyle(_){return(_??null)!==null&&!(Color.isColorLike(_)||_ instanceof FillGradient||_ instanceof FillPattern)}};_TextStyle.defaultDropShadow={alpha:1,angle:Math.PI/6,blur:0,color:"black",distance:5};_TextStyle.defaultTextStyle={align:"left",breakWords:!1,dropShadow:null,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,padding:0,stroke:null,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let TextStyle=_TextStyle;function convertV7Tov8Style(P){const _=P;if(typeof _.dropShadow=="boolean"&&_.dropShadow){const C=TextStyle.defaultDropShadow;P.dropShadow={alpha:_.dropShadowAlpha??C.alpha,angle:_.dropShadowAngle??C.angle,blur:_.dropShadowBlur??C.blur,color:_.dropShadowColor??C.color,distance:_.dropShadowDistance??C.distance}}if(_.strokeThickness!==void 0){deprecation(v8_0_0,"strokeThickness is now a part of stroke");const C=_.stroke;let A={};if(Color.isColorLike(C))A.color=C;else if(C instanceof FillGradient||C instanceof FillPattern)A.fill=C;else if(Object.hasOwnProperty.call(C,"color")||Object.hasOwnProperty.call(C,"fill"))A=C;else throw new Error("Invalid stroke value.");P.stroke={...A,width:_.strokeThickness}}if(Array.isArray(_.fillGradientStops)){deprecation(v8_0_0,"gradient fill is now a fill pattern: `new FillGradient(...)`");let C;P.fontSize==null?P.fontSize=TextStyle.defaultTextStyle.fontSize:typeof P.fontSize=="string"?C=parseInt(P.fontSize,10):C=P.fontSize;const A=new FillGradient({start:{x:0,y:0},end:{x:0,y:(C||0)*1.7}}),T=_.fillGradientStops.map(E=>Color.shared.setValue(E).toNumber());T.forEach((E,I)=>{const F=I/(T.length-1);A.addColorStop(F,E)}),P.fill={fill:A}}}class CanvasPoolClass{constructor(_){this._canvasPool=Object.create(null),this.canvasOptions=_||{},this.enableFullScreen=!1}_createCanvasAndContext(_,C){const A=DOMAdapter.get().createCanvas();A.width=_,A.height=C;const T=A.getContext("2d");return{canvas:A,context:T}}getOptimalCanvasAndContext(_,C,A=1){_=Math.ceil(_*A-1e-6),C=Math.ceil(C*A-1e-6),_=nextPow2(_),C=nextPow2(C);const T=(_<<17)+(C<<1);this._canvasPool[T]||(this._canvasPool[T]=[]);let E=this._canvasPool[T].pop();return E||(E=this._createCanvasAndContext(_,C)),E}returnCanvasAndContext(_){const C=_.canvas,{width:A,height:T}=C,E=(A<<17)+(T<<1);_.context.clearRect(0,0,A,T),this._canvasPool[E].push(_)}clear(){this._canvasPool={}}}const CanvasPool=new CanvasPoolClass,genericFontFamilies=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];function fontStringFromTextStyle(P){const _=typeof P.fontSize=="number"?`${P.fontSize}px`:P.fontSize;let C=P.fontFamily;Array.isArray(P.fontFamily)||(C=P.fontFamily.split(","));for(let A=C.length-1;A>=0;A--){let T=C[A].trim();!/([\"\'])[^\'\"]+\1/.test(T)&&!genericFontFamilies.includes(T)&&(T=`"${T}"`),C[A]=T}return`${P.fontStyle} ${P.fontVariant} ${P.fontWeight} ${_} ${C.join(",")}`}const contextSettings={willReadFrequently:!0},_CanvasTextMetrics=class St{static get experimentalLetterSpacingSupported(){let _=St._experimentalLetterSpacingSupported;if(_!==void 0){const C=DOMAdapter.get().getCanvasRenderingContext2D().prototype;_=St._experimentalLetterSpacingSupported="letterSpacing"in C||"textLetterSpacing"in C}return _}constructor(_,C,A,T,E,I,F,B,G){this.text=_,this.style=C,this.width=A,this.height=T,this.lines=E,this.lineWidths=I,this.lineHeight=F,this.maxLineWidth=B,this.fontProperties=G}static measureText(_=" ",C,A=St._canvas,T=C.wordWrap){var X;const E=`${_}:${C.styleKey}`;if(St._measurementCache[E])return St._measurementCache[E];const I=fontStringFromTextStyle(C),F=St.measureFont(I);F.fontSize===0&&(F.fontSize=C.fontSize,F.ascent=C.fontSize);const B=St.__context;B.font=I;const R=(T?St._wordWrap(_,C,A):_).split(/(?:\r\n|\r|\n)/),z=new Array(R.length);let D=0;for(let Y=0;Y<R.length;Y++){const K=St._measureText(R[Y],C.letterSpacing,B);z[Y]=K,D=Math.max(D,K)}const L=((X=C._stroke)==null?void 0:X.width)||0;let O=D+L;C.dropShadow&&(O+=C.dropShadow.distance);const V=C.lineHeight||F.fontSize;let U=Math.max(V,F.fontSize+L)+(R.length-1)*(V+C.leading);return C.dropShadow&&(U+=C.dropShadow.distance),new St(_,C,O,U,R,z,V+C.leading,D,F)}static _measureText(_,C,A){let T=!1;St.experimentalLetterSpacingSupported&&(St.experimentalLetterSpacing?(A.letterSpacing=`${C}px`,A.textLetterSpacing=`${C}px`,T=!0):(A.letterSpacing="0px",A.textLetterSpacing="0px"));const E=A.measureText(_);let I=E.width;const F=-E.actualBoundingBoxLeft;let G=E.actualBoundingBoxRight-F;if(I>0)if(T)I-=C,G-=C;else{const R=(St.graphemeSegmenter(_).length-1)*C;I+=R,G+=R}return Math.max(I,G)}static _wordWrap(_,C,A=St._canvas){const T=A.getContext("2d",contextSettings);let E=0,I="",F="";const B=Object.create(null),{letterSpacing:G,whiteSpace:R}=C,z=St._collapseSpaces(R),D=St._collapseNewlines(R);let L=!z;const O=C.wordWrapWidth+G,V=St._tokenize(_);for(let U=0;U<V.length;U++){let W=V[U];if(St._isNewline(W)){if(!D){F+=St._addLine(I),L=!z,I="",E=0;continue}W=" "}if(z){const Y=St.isBreakingSpace(W),K=St.isBreakingSpace(I[I.length-1]);if(Y&&K)continue}const X=St._getFromCache(W,G,B,T);if(X>O)if(I!==""&&(F+=St._addLine(I),I="",E=0),St.canBreakWords(W,C.breakWords)){const Y=St.wordWrapSplit(W);for(let K=0;K<Y.length;K++){let q=Y[K],J=q,tt=1;for(;Y[K+tt];){const st=Y[K+tt];if(!St.canBreakChars(J,st,W,K,C.breakWords))q+=st;else break;J=st,tt++}K+=tt-1;const rt=St._getFromCache(q,G,B,T);rt+E>O&&(F+=St._addLine(I),L=!1,I="",E=0),I+=q,E+=rt}}else{I.length>0&&(F+=St._addLine(I),I="",E=0);const Y=U===V.length-1;F+=St._addLine(W,!Y),L=!1,I="",E=0}else X+E>O&&(L=!1,F+=St._addLine(I),I="",E=0),(I.length>0||!St.isBreakingSpace(W)||L)&&(I+=W,E+=X)}return F+=St._addLine(I,!1),F}static _addLine(_,C=!0){return _=St._trimRight(_),_=C?`${_}
`:_,_}static _getFromCache(_,C,A,T){let E=A[_];return typeof E!="number"&&(E=St._measureText(_,C,T)+C,A[_]=E),E}static _collapseSpaces(_){return _==="normal"||_==="pre-line"}static _collapseNewlines(_){return _==="normal"}static _trimRight(_){if(typeof _!="string")return"";for(let C=_.length-1;C>=0;C--){const A=_[C];if(!St.isBreakingSpace(A))break;_=_.slice(0,-1)}return _}static _isNewline(_){return typeof _!="string"?!1:St._newlines.includes(_.charCodeAt(0))}static isBreakingSpace(_,C){return typeof _!="string"?!1:St._breakingSpaces.includes(_.charCodeAt(0))}static _tokenize(_){const C=[];let A="";if(typeof _!="string")return C;for(let T=0;T<_.length;T++){const E=_[T],I=_[T+1];if(St.isBreakingSpace(E,I)||St._isNewline(E)){A!==""&&(C.push(A),A=""),C.push(E);continue}A+=E}return A!==""&&C.push(A),C}static canBreakWords(_,C){return C}static canBreakChars(_,C,A,T,E){return!0}static wordWrapSplit(_){return St.graphemeSegmenter(_)}static measureFont(_){if(St._fonts[_])return St._fonts[_];const C=St._context;C.font=_;const A=C.measureText(St.METRICS_STRING+St.BASELINE_SYMBOL),T={ascent:A.actualBoundingBoxAscent,descent:A.actualBoundingBoxDescent,fontSize:A.actualBoundingBoxAscent+A.actualBoundingBoxDescent};return St._fonts[_]=T,T}static clearMetrics(_=""){_?delete St._fonts[_]:St._fonts={}}static get _canvas(){if(!St.__canvas){let _;try{const C=new OffscreenCanvas(0,0),A=C.getContext("2d",contextSettings);if(A!=null&&A.measureText)return St.__canvas=C,C;_=DOMAdapter.get().createCanvas()}catch{_=DOMAdapter.get().createCanvas()}_.width=_.height=10,St.__canvas=_}return St.__canvas}static get _context(){return St.__context||(St.__context=St._canvas.getContext("2d",contextSettings)),St.__context}};_CanvasTextMetrics.METRICS_STRING="|q";_CanvasTextMetrics.BASELINE_SYMBOL="M";_CanvasTextMetrics.BASELINE_MULTIPLIER=1.4;_CanvasTextMetrics.HEIGHT_MULTIPLIER=2;_CanvasTextMetrics.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const P=new Intl.Segmenter;return _=>[...P.segment(_)].map(C=>C.segment)}return P=>[...P]})();_CanvasTextMetrics.experimentalLetterSpacing=!1;_CanvasTextMetrics._fonts={};_CanvasTextMetrics._newlines=[10,13];_CanvasTextMetrics._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];_CanvasTextMetrics._measurementCache={};let CanvasTextMetrics=_CanvasTextMetrics;const PRECISION=1e5;function getCanvasFillStyle(P,_,C,A=0){if(P.texture===Texture.WHITE&&!P.fill)return Color.shared.setValue(P.color).setAlpha(P.alpha??1).toHexa();if(P.fill){if(P.fill instanceof FillPattern){const T=P.fill,E=_.createPattern(T.texture.source.resource,"repeat"),I=T.transform.copyTo(Matrix.shared);return I.scale(T.texture.frame.width,T.texture.frame.height),E.setTransform(I),E}else if(P.fill instanceof FillGradient){const T=P.fill,E=T.type==="linear",I=T.textureSpace==="local";let F=1,B=1;I&&C&&(F=C.width+A,B=C.height+A);let G,R=!1;if(E){const{start:z,end:D}=T;G=_.createLinearGradient(z.x*F,z.y*B,D.x*F,D.y*B),R=Math.abs(D.x-z.x)<Math.abs((D.y-z.y)*.1)}else{const{center:z,innerRadius:D,outerCenter:L,outerRadius:O}=T;G=_.createRadialGradient(z.x*F,z.y*B,D*F,L.x*F,L.y*B,O*F)}if(R&&I&&C){const z=C.lineHeight/B;for(let D=0;D<C.lines.length;D++){const L=(D*C.lineHeight+A/2)/B;T.colorStops.forEach(O=>{const V=L+O.offset*z;G.addColorStop(Math.floor(V*PRECISION)/PRECISION,Color.shared.setValue(O.color).toHex())})}}else T.colorStops.forEach(z=>{G.addColorStop(z.offset,Color.shared.setValue(z.color).toHex())});return G}}else{const T=_.createPattern(P.texture.source.resource,"repeat"),E=P.matrix.copyTo(Matrix.shared);return E.scale(P.texture.frame.width,P.texture.frame.height),T.setTransform(E),T}return warn("FillStyle not recognised",P),"red"}function resolveCharacters(P){if(P==="")return[];typeof P=="string"&&(P=[P]);const _=[];for(let C=0,A=P.length;C<A;C++){const T=P[C];if(Array.isArray(T)){if(T.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${T.length}.`);if(T[0].length===0||T[1].length===0)throw new Error("[BitmapFont]: Invalid character delimiter.");const E=T[0].charCodeAt(0),I=T[1].charCodeAt(0);if(I<E)throw new Error("[BitmapFont]: Invalid character range.");for(let F=E,B=I;F<=B;F++)_.push(String.fromCharCode(F))}else _.push(...Array.from(T))}if(_.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return _}const _DynamicBitmapFont=class oe extends AbstractBitmapFont{constructor(_){super(),this.resolution=1,this.pages=[],this._padding=0,this._measureCache=Object.create(null),this._currentChars=[],this._currentX=0,this._currentY=0,this._currentPageIndex=-1,this._skipKerning=!1;const C={...oe.defaultOptions,..._};this._textureSize=C.textureSize,this._mipmap=C.mipmap;const A=C.style.clone();C.overrideFill&&(A._fill.color=16777215,A._fill.alpha=1,A._fill.texture=Texture.WHITE,A._fill.fill=null),this.applyFillAsTint=C.overrideFill;const T=A.fontSize;A.fontSize=this.baseMeasurementFontSize;const E=fontStringFromTextStyle(A);C.overrideSize?A._stroke&&(A._stroke.width*=this.baseRenderedFontSize/T):A.fontSize=this.baseRenderedFontSize=T,this._style=A,this._skipKerning=C.skipKerning??!1,this.resolution=C.resolution??1,this._padding=C.padding??4,this.fontMetrics=CanvasTextMetrics.measureFont(E),this.lineHeight=A.lineHeight||this.fontMetrics.fontSize||A.fontSize}ensureCharacters(_){var U,W;const C=resolveCharacters(_).filter(X=>!this._currentChars.includes(X)).filter((X,Y,K)=>K.indexOf(X)===Y);if(!C.length)return;this._currentChars=[...this._currentChars,...C];let A;this._currentPageIndex===-1?A=this._nextPage():A=this.pages[this._currentPageIndex];let{canvas:T,context:E}=A.canvasAndContext,I=A.texture.source;const F=this._style;let B=this._currentX,G=this._currentY;const R=this.baseRenderedFontSize/this.baseMeasurementFontSize,z=this._padding*R;let D=0,L=!1;const O=T.width/this.resolution,V=T.height/this.resolution;for(let X=0;X<C.length;X++){const Y=C[X],K=CanvasTextMetrics.measureText(Y,F,T,!1);K.lineHeight=K.height;const q=K.width*R,J=Math.ceil((F.fontStyle==="italic"?2:1)*q),tt=K.height*R,rt=J+z*2,st=tt+z*2;if(L=!1,Y!==`
`&&Y!=="\r"&&Y!=="	"&&Y!==" "&&(L=!0,D=Math.ceil(Math.max(st,D))),B+rt>O&&(G+=D,D=st,B=0,G+D>V)){I.update();const at=this._nextPage();T=at.canvasAndContext.canvas,E=at.canvasAndContext.context,I=at.texture.source,G=0}const nt=q/R-(((U=F.dropShadow)==null?void 0:U.distance)??0)-(((W=F._stroke)==null?void 0:W.width)??0);if(this.chars[Y]={id:Y.codePointAt(0),xOffset:-this._padding,yOffset:-this._padding,xAdvance:nt,kerning:{}},L){this._drawGlyph(E,K,B+z,G+z,R,F);const at=I.width*R,ot=I.height*R,ct=new Rectangle(B/at*I.width,G/ot*I.height,rt/at*I.width,st/ot*I.height);this.chars[Y].texture=new Texture({source:I,frame:ct}),B+=Math.ceil(rt)}}I.update(),this._currentX=B,this._currentY=G,this._skipKerning&&this._applyKerning(C,E)}get pageTextures(){return deprecation(v8_0_0,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}_applyKerning(_,C){const A=this._measureCache;for(let T=0;T<_.length;T++){const E=_[T];for(let I=0;I<this._currentChars.length;I++){const F=this._currentChars[I];let B=A[E];B||(B=A[E]=C.measureText(E).width);let G=A[F];G||(G=A[F]=C.measureText(F).width);let R=C.measureText(E+F).width,z=R-(B+G);z&&(this.chars[E].kerning[F]=z),R=C.measureText(E+F).width,z=R-(B+G),z&&(this.chars[F].kerning[E]=z)}}}_nextPage(){this._currentPageIndex++;const _=this.resolution,C=CanvasPool.getOptimalCanvasAndContext(this._textureSize,this._textureSize,_);this._setupContext(C.context,this._style,_);const A=_*(this.baseRenderedFontSize/this.baseMeasurementFontSize),T=new Texture({source:new ImageSource({resource:C.canvas,resolution:A,alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:this._mipmap})}),E={canvasAndContext:C,texture:T};return this.pages[this._currentPageIndex]=E,E}_setupContext(_,C,A){C.fontSize=this.baseRenderedFontSize,_.scale(A,A),_.font=fontStringFromTextStyle(C),C.fontSize=this.baseMeasurementFontSize,_.textBaseline=C.textBaseline;const T=C._stroke,E=(T==null?void 0:T.width)??0;if(T&&(_.lineWidth=E,_.lineJoin=T.join,_.miterLimit=T.miterLimit,_.strokeStyle=getCanvasFillStyle(T,_)),C._fill&&(_.fillStyle=getCanvasFillStyle(C._fill,_)),C.dropShadow){const I=C.dropShadow,F=Color.shared.setValue(I.color).toArray(),B=I.blur*A,G=I.distance*A;_.shadowColor=`rgba(${F[0]*255},${F[1]*255},${F[2]*255},${I.alpha})`,_.shadowBlur=B,_.shadowOffsetX=Math.cos(I.angle)*G,_.shadowOffsetY=Math.sin(I.angle)*G}else _.shadowColor="black",_.shadowBlur=0,_.shadowOffsetX=0,_.shadowOffsetY=0}_drawGlyph(_,C,A,T,E,I){const F=C.text,B=C.fontProperties,G=I._stroke,R=((G==null?void 0:G.width)??0)*E,z=A+R/2,D=T-R/2,L=B.descent*E,O=C.lineHeight*E;I.stroke&&R&&_.strokeText(F,z,D+O-L),I._fill&&_.fillText(F,z,D+O-L)}destroy(){super.destroy();for(let _=0;_<this.pages.length;_++){const{canvasAndContext:C,texture:A}=this.pages[_];CanvasPool.returnCanvasAndContext(C),A.destroy(!0)}this.pages=null}};_DynamicBitmapFont.defaultOptions={textureSize:512,style:new TextStyle,mipmap:!0};let DynamicBitmapFont=_DynamicBitmapFont;function getBitmapTextLayout(P,_,C,A){const T={width:0,height:0,offsetY:0,scale:_.fontSize/C.baseMeasurementFontSize,lines:[{width:0,charPositions:[],spaceWidth:0,spacesIndex:[],chars:[]}]};T.offsetY=C.baseLineOffset;let E=T.lines[0],I=null,F=!0;const B={width:0,start:0,index:0,positions:[],chars:[]},G=O=>{const V=E.width;for(let U=0;U<B.index;U++){const W=O.positions[U];E.chars.push(O.chars[U]),E.charPositions.push(W+V)}E.width+=O.width,F=!1,B.width=0,B.index=0,B.chars.length=0},R=()=>{let O=E.chars.length-1;if(A){let V=E.chars[O];for(;V===" ";)E.width-=C.chars[V].xAdvance,V=E.chars[--O]}T.width=Math.max(T.width,E.width),E={width:0,charPositions:[],chars:[],spaceWidth:0,spacesIndex:[]},F=!0,T.lines.push(E),T.height+=C.lineHeight},z=C.baseMeasurementFontSize/_.fontSize,D=_.letterSpacing*z,L=_.wordWrapWidth*z;for(let O=0;O<P.length+1;O++){let V;const U=O===P.length;U||(V=P[O]);const W=C.chars[V]||C.chars[" "];if(/(?:\s)/.test(V)||V==="\r"||V===`
`||U){if(!F&&_.wordWrap&&E.width+B.width-D>L?(R(),G(B),U||E.charPositions.push(0)):(B.start=E.width,G(B),U||E.charPositions.push(0)),V==="\r"||V===`
`)E.width!==0&&R();else if(!U){const q=W.xAdvance+(W.kerning[I]||0)+D;E.width+=q,E.spaceWidth=q,E.spacesIndex.push(E.charPositions.length),E.chars.push(V)}}else{const K=W.kerning[I]||0,q=W.xAdvance+K+D;B.positions[B.index++]=B.width+K,B.chars.push(V),B.width+=q}I=V}return R(),_.align==="center"?alignCenter(T):_.align==="right"?alignRight(T):_.align==="justify"&&alignJustify(T),T}function alignCenter(P){for(let _=0;_<P.lines.length;_++){const C=P.lines[_],A=P.width/2-C.width/2;for(let T=0;T<C.charPositions.length;T++)C.charPositions[T]+=A}}function alignRight(P){for(let _=0;_<P.lines.length;_++){const C=P.lines[_],A=P.width-C.width;for(let T=0;T<C.charPositions.length;T++)C.charPositions[T]+=A}}function alignJustify(P){const _=P.width;for(let C=0;C<P.lines.length;C++){const A=P.lines[C];let T=0,E=A.spacesIndex[T++],I=0;const F=A.spacesIndex.length,G=(_-A.width)/F;for(let R=0;R<A.charPositions.length;R++)R===E&&(E=A.spacesIndex[T++],I+=G),A.charPositions[R]+=I}}let fontCount=0;class BitmapFontManagerClass{constructor(){this.ALPHA=[["a","z"],["A","Z"]," "],this.NUMERIC=[["0","9"]],this.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],this.ASCII=[[" ","~"]],this.defaultOptions={chars:this.ALPHANUMERIC,resolution:1,padding:4,skipKerning:!1}}getFont(_,C){var I;let A=`${C.fontFamily}-bitmap`,T=!0;if(C._fill.fill&&!C._stroke)A+=C._fill.fill.styleKey,T=!1;else if(C._stroke||C.dropShadow){let F=C.styleKey;F=F.substring(0,F.lastIndexOf("-")),A=`${F}-bitmap`,T=!1}if(!Cache.has(A)){const F=new DynamicBitmapFont({style:C,overrideFill:T,overrideSize:!0,...this.defaultOptions});fontCount++,fontCount>50&&warn("BitmapText",`You have dynamically created ${fontCount} bitmap fonts, this can be inefficient. Try pre installing your font styles using \`BitmapFont.install({name:"style1", style})\``),F.once("destroy",()=>{fontCount--,Cache.remove(A)}),Cache.set(A,F)}const E=Cache.get(A);return(I=E.ensureCharacters)==null||I.call(E,_),E}getLayout(_,C,A=!0){const T=this.getFont(_,C);return getBitmapTextLayout([..._],C,T,A)}measureText(_,C,A=!0){return this.getLayout(_,C,A)}install(..._){var G,R,z,D;let C=_[0];typeof C=="string"&&(C={name:C,style:_[1],chars:(G=_[2])==null?void 0:G.chars,resolution:(R=_[2])==null?void 0:R.resolution,padding:(z=_[2])==null?void 0:z.padding,skipKerning:(D=_[2])==null?void 0:D.skipKerning},deprecation(v8_0_0,"BitmapFontManager.install(name, style, options) is deprecated, use BitmapFontManager.install({name, style, ...options})"));const A=C==null?void 0:C.name;if(!A)throw new Error("[BitmapFontManager] Property `name` is required.");C={...this.defaultOptions,...C};const T=C.style,E=T instanceof TextStyle?T:new TextStyle(T),I=E._fill.fill!==null&&E._fill.fill!==void 0,F=new DynamicBitmapFont({style:E,overrideFill:I,skipKerning:C.skipKerning,padding:C.padding,resolution:C.resolution,overrideSize:!1}),B=resolveCharacters(C.chars);return F.ensureCharacters(B.join("")),Cache.set(`${A}-bitmap`,F),F.once("destroy",()=>Cache.remove(`${A}-bitmap`)),F}uninstall(_){const C=`${_}-bitmap`,A=Cache.get(C);A&&A.destroy()}}const BitmapFontManager=new BitmapFontManagerClass;class BitmapFont extends AbstractBitmapFont{constructor(_,C){super();const{textures:A,data:T}=_;Object.keys(T.pages).forEach(E=>{const I=T.pages[parseInt(E,10)],F=A[I.id];this.pages.push({texture:F})}),Object.keys(T.chars).forEach(E=>{const I=T.chars[E],{frame:F,source:B}=A[I.page],G=new Rectangle(I.x+F.x,I.y+F.y,I.width,I.height),R=new Texture({source:B,frame:G});this.chars[E]={id:E.codePointAt(0),xOffset:I.xOffset,yOffset:I.yOffset,xAdvance:I.xAdvance,kerning:I.kerning??{},texture:R}}),this.baseRenderedFontSize=T.fontSize,this.baseMeasurementFontSize=T.fontSize,this.fontMetrics={ascent:0,descent:0,fontSize:T.fontSize},this.baseLineOffset=T.baseLineOffset,this.lineHeight=T.lineHeight,this.fontFamily=T.fontFamily,this.distanceField=T.distanceField??{type:"none",range:0},this.url=C}destroy(){super.destroy();for(let _=0;_<this.pages.length;_++){const{texture:C}=this.pages[_];C.destroy(!0)}this.pages=null}static install(_){BitmapFontManager.install(_)}static uninstall(_){BitmapFontManager.uninstall(_)}}const bitmapFontTextParser={test(P){return typeof P=="string"&&P.startsWith("info face=")},parse(P){const _=P.match(/^[a-z]+\s+.+$/gm),C={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const z in _){const D=_[z].match(/^[a-z]+/gm)[0],L=_[z].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),O={};for(const V in L){const U=L[V].split("="),W=U[0],X=U[1].replace(/"/gm,""),Y=parseFloat(X),K=isNaN(Y)?X:Y;O[W]=K}C[D].push(O)}const A={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},[T]=C.info,[E]=C.common,[I]=C.distanceField??[];I&&(A.distanceField={range:parseInt(I.distanceRange,10),type:I.fieldType}),A.fontSize=parseInt(T.size,10),A.fontFamily=T.face,A.lineHeight=parseInt(E.lineHeight,10);const F=C.page;for(let z=0;z<F.length;z++)A.pages.push({id:parseInt(F[z].id,10)||0,file:F[z].file});const B={};A.baseLineOffset=A.lineHeight-parseInt(E.base,10);const G=C.char;for(let z=0;z<G.length;z++){const D=G[z],L=parseInt(D.id,10);let O=D.letter??D.char??String.fromCharCode(L);O==="space"&&(O=" "),B[L]=O,A.chars[O]={id:L,page:parseInt(D.page,10)||0,x:parseInt(D.x,10),y:parseInt(D.y,10),width:parseInt(D.width,10),height:parseInt(D.height,10),xOffset:parseInt(D.xoffset,10),yOffset:parseInt(D.yoffset,10),xAdvance:parseInt(D.xadvance,10),kerning:{}}}const R=C.kerning||[];for(let z=0;z<R.length;z++){const D=parseInt(R[z].first,10),L=parseInt(R[z].second,10),O=parseInt(R[z].amount,10);A.chars[B[L]].kerning[B[D]]=O}return A}},bitmapFontXMLParser={test(P){const _=P;return typeof _!="string"&&"getElementsByTagName"in _&&_.getElementsByTagName("page").length&&_.getElementsByTagName("info")[0].getAttribute("face")!==null},parse(P){const _={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},C=P.getElementsByTagName("info")[0],A=P.getElementsByTagName("common")[0],T=P.getElementsByTagName("distanceField")[0];T&&(_.distanceField={type:T.getAttribute("fieldType"),range:parseInt(T.getAttribute("distanceRange"),10)});const E=P.getElementsByTagName("page"),I=P.getElementsByTagName("char"),F=P.getElementsByTagName("kerning");_.fontSize=parseInt(C.getAttribute("size"),10),_.fontFamily=C.getAttribute("face"),_.lineHeight=parseInt(A.getAttribute("lineHeight"),10);for(let G=0;G<E.length;G++)_.pages.push({id:parseInt(E[G].getAttribute("id"),10)||0,file:E[G].getAttribute("file")});const B={};_.baseLineOffset=_.lineHeight-parseInt(A.getAttribute("base"),10);for(let G=0;G<I.length;G++){const R=I[G],z=parseInt(R.getAttribute("id"),10);let D=R.getAttribute("letter")??R.getAttribute("char")??String.fromCharCode(z);D==="space"&&(D=" "),B[z]=D,_.chars[D]={id:z,page:parseInt(R.getAttribute("page"),10)||0,x:parseInt(R.getAttribute("x"),10),y:parseInt(R.getAttribute("y"),10),width:parseInt(R.getAttribute("width"),10),height:parseInt(R.getAttribute("height"),10),xOffset:parseInt(R.getAttribute("xoffset"),10),yOffset:parseInt(R.getAttribute("yoffset"),10),xAdvance:parseInt(R.getAttribute("xadvance"),10),kerning:{}}}for(let G=0;G<F.length;G++){const R=parseInt(F[G].getAttribute("first"),10),z=parseInt(F[G].getAttribute("second"),10),D=parseInt(F[G].getAttribute("amount"),10);_.chars[B[z]].kerning[B[R]]=D}return _}},bitmapFontXMLStringParser={test(P){return typeof P=="string"&&P.includes("<font>")?bitmapFontXMLParser.test(DOMAdapter.get().parseXML(P)):!1},parse(P){return bitmapFontXMLParser.parse(DOMAdapter.get().parseXML(P))}},validExtensions=[".xml",".fnt"],bitmapFontCachePlugin={extension:{type:ExtensionType.CacheParser,name:"cacheBitmapFont"},test:P=>P instanceof BitmapFont,getCacheableAssets(P,_){const C={};return P.forEach(A=>{C[A]=_,C[`${A}-bitmap`]=_}),C[`${_.fontFamily}-bitmap`]=_,C}},loadBitmapFont={extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.Normal},name:"loadBitmapFont",test(P){return validExtensions.includes(path.extname(P).toLowerCase())},async testParse(P){return bitmapFontTextParser.test(P)||bitmapFontXMLStringParser.test(P)},async parse(P,_,C){const A=bitmapFontTextParser.test(P)?bitmapFontTextParser.parse(P):bitmapFontXMLStringParser.parse(P),{src:T}=_,{pages:E}=A,I=[],F=A.distanceField?{scaleMode:"linear",alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:!1,resolution:1}:{};for(let z=0;z<E.length;++z){const D=E[z].file;let L=path.join(path.dirname(T),D);L=copySearchParams(L,T),I.push({src:L,data:F})}const B=await C.load(I),G=I.map(z=>B[z.src]);return new BitmapFont({data:A,textures:G},T)},async load(P,_){return await(await DOMAdapter.get().fetch(P)).text()},async unload(P,_,C){await Promise.all(P.pages.map(A=>C.unload(A.texture.source._sourceOrigin))),P.destroy()}};class BackgroundLoader{constructor(_,C=!1){this._loader=_,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=C}add(_){_.forEach(C=>{this._assetList.push(C)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const _=[],C=Math.min(this._assetList.length,this._maxConcurrent);for(let A=0;A<C;A++)_.push(this._assetList.pop());await this._loader.load(_),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(_){this._isActive!==_&&(this._isActive=_,_&&!this._isLoading&&this._next())}}const cacheTextureArray={extension:{type:ExtensionType.CacheParser,name:"cacheTextureArray"},test:P=>Array.isArray(P)&&P.every(_=>_ instanceof Texture),getCacheableAssets:(P,_)=>{const C={};return P.forEach(A=>{_.forEach((T,E)=>{C[A+(E===0?"":E+1)]=T})}),C}};async function testImageFormat(P){if("Image"in globalThis)return new Promise(_=>{const C=new Image;C.onload=()=>{_(!0)},C.onerror=()=>{_(!1)},C.src=P});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const _=await(await fetch(P)).blob();await createImageBitmap(_)}catch{return!1}return!0}return!1}const detectAvif={extension:{type:ExtensionType.DetectionParser,priority:1},test:async()=>testImageFormat("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async P=>[...P,"avif"],remove:async P=>P.filter(_=>_!=="avif")},imageFormats=["png","jpg","jpeg"],detectDefaults={extension:{type:ExtensionType.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async P=>[...P,...imageFormats],remove:async P=>P.filter(_=>!imageFormats.includes(_))},inWorker="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function testVideoFormat(P){return inWorker?!1:document.createElement("video").canPlayType(P)!==""}const detectMp4={extension:{type:ExtensionType.DetectionParser,priority:0},test:async()=>testVideoFormat("video/mp4"),add:async P=>[...P,"mp4","m4v"],remove:async P=>P.filter(_=>_!=="mp4"&&_!=="m4v")},detectOgv={extension:{type:ExtensionType.DetectionParser,priority:0},test:async()=>testVideoFormat("video/ogg"),add:async P=>[...P,"ogv"],remove:async P=>P.filter(_=>_!=="ogv")},detectWebm={extension:{type:ExtensionType.DetectionParser,priority:0},test:async()=>testVideoFormat("video/webm"),add:async P=>[...P,"webm"],remove:async P=>P.filter(_=>_!=="webm")},detectWebp={extension:{type:ExtensionType.DetectionParser,priority:0},test:async()=>testImageFormat("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async P=>[...P,"webp"],remove:async P=>P.filter(_=>_!=="webp")};class Loader{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(_,C,A)=>(this._parsersValidated=!1,_[C]=A,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(_,C){const A={promise:null,parser:null};return A.promise=(async()=>{var I,F;let T=null,E=null;if(C.loadParser&&(E=this._parserHash[C.loadParser],E||warn(`[Assets] specified load parser "${C.loadParser}" not found while loading ${_}`)),!E){for(let B=0;B<this.parsers.length;B++){const G=this.parsers[B];if(G.load&&((I=G.test)!=null&&I.call(G,_,C,this))){E=G;break}}if(!E)return warn(`[Assets] ${_} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}T=await E.load(_,C,this),A.parser=E;for(let B=0;B<this.parsers.length;B++){const G=this.parsers[B];G.parse&&G.parse&&await((F=G.testParse)==null?void 0:F.call(G,T,C,this))&&(T=await G.parse(T,C,this)||T,A.parser=G)}return T})(),A}async load(_,C){this._parsersValidated||this._validateParsers();let A=0;const T={},E=isSingleItem(_),I=convertToList(_,G=>({alias:[G],src:G,data:{}})),F=I.length,B=I.map(async G=>{const R=path.toAbsolute(G.src);if(!T[G.src])try{this.promiseCache[R]||(this.promiseCache[R]=this._getLoadPromiseAndParser(R,G)),T[G.src]=await this.promiseCache[R].promise,C&&C(++A/F)}catch(z){throw delete this.promiseCache[R],delete T[G.src],new Error(`[Loader.load] Failed to load ${R}.
${z}`)}});return await Promise.all(B),E?T[I[0].src]:T}async unload(_){const A=convertToList(_,T=>({alias:[T],src:T})).map(async T=>{var F,B;const E=path.toAbsolute(T.src),I=this.promiseCache[E];if(I){const G=await I.promise;delete this.promiseCache[E],await((B=(F=I.parser)==null?void 0:F.unload)==null?void 0:B.call(F,G,T,this))}});await Promise.all(A)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(_=>_.name).reduce((_,C)=>(C.name?_[C.name]&&warn(`[Assets] loadParser name conflict "${C.name}"`):warn("[Assets] loadParser should have a name"),{..._,[C.name]:C}),{})}}function checkDataUrl(P,_){if(Array.isArray(_)){for(const C of _)if(P.startsWith(`data:${C}`))return!0;return!1}return P.startsWith(`data:${_}`)}function checkExtension(P,_){const C=P.split("?")[0],A=path.extname(C).toLowerCase();return Array.isArray(_)?_.includes(A):A===_}const validJSONExtension=".json",validJSONMIME="application/json",loadJson={extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.Low},name:"loadJson",test(P){return checkDataUrl(P,validJSONMIME)||checkExtension(P,validJSONExtension)},async load(P){return await(await DOMAdapter.get().fetch(P)).json()}},validTXTExtension=".txt",validTXTMIME="text/plain",loadTxt={name:"loadTxt",extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.Low,name:"loadTxt"},test(P){return checkDataUrl(P,validTXTMIME)||checkExtension(P,validTXTExtension)},async load(P){return await(await DOMAdapter.get().fetch(P)).text()}},validWeights=["normal","bold","100","200","300","400","500","600","700","800","900"],validFontExtensions=[".ttf",".otf",".woff",".woff2"],validFontMIMEs=["font/ttf","font/otf","font/woff","font/woff2"],CSS_IDENT_TOKEN_REGEX=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function getFontFamilyName(P){const _=path.extname(P),T=path.basename(P,_).replace(/(-|_)/g," ").toLowerCase().split(" ").map(F=>F.charAt(0).toUpperCase()+F.slice(1));let E=T.length>0;for(const F of T)if(!F.match(CSS_IDENT_TOKEN_REGEX)){E=!1;break}let I=T.join(" ");return E||(I=`"${I.replace(/[\\"]/g,"\\$&")}"`),I}const validURICharactersRegex=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function encodeURIWhenNeeded(P){return validURICharactersRegex.test(P)?P:encodeURI(P)}const loadWebFont={extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.Low},name:"loadWebFont",test(P){return checkDataUrl(P,validFontMIMEs)||checkExtension(P,validFontExtensions)},async load(P,_){var A,T,E;const C=DOMAdapter.get().getFontFaceSet();if(C){const I=[],F=((A=_.data)==null?void 0:A.family)??getFontFamilyName(P),B=((E=(T=_.data)==null?void 0:T.weights)==null?void 0:E.filter(R=>validWeights.includes(R)))??["normal"],G=_.data??{};for(let R=0;R<B.length;R++){const z=B[R],D=new FontFace(F,`url(${encodeURIWhenNeeded(P)})`,{...G,weight:z});await D.load(),C.add(D),I.push(D)}return Cache.set(`${F}-and-url`,{url:P,fontFaces:I}),I.length===1?I[0]:I}return warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(P){(Array.isArray(P)?P:[P]).forEach(_=>{Cache.remove(`${_.family}-and-url`),DOMAdapter.get().getFontFaceSet().delete(_)})}};function getResolutionOfUrl(P,_=1){var A;const C=(A=Resolver.RETINA_PREFIX)==null?void 0:A.exec(P);return C?parseFloat(C[1]):_}function createTexture(P,_,C){P.label=C,P._sourceOrigin=C;const A=new Texture({source:P,label:C}),T=()=>{delete _.promiseCache[C],Cache.has(C)&&Cache.remove(C)};return A.source.once("destroy",()=>{_.promiseCache[C]&&(warn("[Assets] A TextureSource managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the TextureSource."),T())}),A.once("destroy",()=>{P.destroyed||(warn("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),T())}),A}const validSVGExtension=".svg",validSVGMIME="image/svg+xml",loadSvg={extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.Low,name:"loadSVG"},name:"loadSVG",config:{crossOrigin:"anonymous",parseAsGraphicsContext:!1},test(P){return checkDataUrl(P,validSVGMIME)||checkExtension(P,validSVGExtension)},async load(P,_,C){var A;return((A=_.data)==null?void 0:A.parseAsGraphicsContext)??this.config.parseAsGraphicsContext?loadAsGraphics(P):loadAsTexture(P,_,C,this.config.crossOrigin)},unload(P){P.destroy(!0)}};async function loadAsTexture(P,_,C,A){var U,W,X;const E=await(await DOMAdapter.get().fetch(P)).blob(),I=URL.createObjectURL(E),F=new Image;F.src=I,F.crossOrigin=A,await F.decode(),URL.revokeObjectURL(I);const B=document.createElement("canvas"),G=B.getContext("2d"),R=((U=_.data)==null?void 0:U.resolution)||getResolutionOfUrl(P),z=((W=_.data)==null?void 0:W.width)??F.width,D=((X=_.data)==null?void 0:X.height)??F.height;B.width=z*R,B.height=D*R,G.drawImage(F,0,0,z*R,D*R);const{parseAsGraphicsContext:L,...O}=_.data??{},V=new ImageSource({resource:B,alphaMode:"premultiply-alpha-on-upload",resolution:R,...O});return createTexture(V,C,P)}async function loadAsGraphics(P){const C=await(await DOMAdapter.get().fetch(P)).text(),A=new GraphicsContext;return A.svg(C),A}const WORKER_CODE$1=`(function () {
    'use strict';

    const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
    async function checkImageBitmap() {
      try {
        if (typeof createImageBitmap !== "function")
          return false;
        const response = await fetch(WHITE_PNG);
        const imageBlob = await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);
        return imageBitmap.width === 1 && imageBitmap.height === 1;
      } catch (_e) {
        return false;
      }
    }
    void checkImageBitmap().then((result) => {
      self.postMessage(result);
    });

})();
`;let WORKER_URL$1=null,WorkerInstance$1=class{constructor(){WORKER_URL$1||(WORKER_URL$1=URL.createObjectURL(new Blob([WORKER_CODE$1],{type:"application/javascript"}))),this.worker=new Worker(WORKER_URL$1)}};WorkerInstance$1.revokeObjectURL=function(){WORKER_URL$1&&(URL.revokeObjectURL(WORKER_URL$1),WORKER_URL$1=null)};const WORKER_CODE=`(function () {
    'use strict';

    async function loadImageBitmap(url, alphaMode) {
      const response = await fetch(url);
      if (!response.ok) {
        throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
      }
      const imageBlob = await response.blob();
      return alphaMode === "premultiplied-alpha" ? createImageBitmap(imageBlob, { premultiplyAlpha: "none" }) : createImageBitmap(imageBlob);
    }
    self.onmessage = async (event) => {
      try {
        const imageBitmap = await loadImageBitmap(event.data.data[0], event.data.data[1]);
        self.postMessage({
          data: imageBitmap,
          uuid: event.data.uuid,
          id: event.data.id
        }, [imageBitmap]);
      } catch (e) {
        self.postMessage({
          error: e,
          uuid: event.data.uuid,
          id: event.data.id
        });
      }
    };

})();
`;let WORKER_URL=null;class WorkerInstance{constructor(){WORKER_URL||(WORKER_URL=URL.createObjectURL(new Blob([WORKER_CODE],{type:"application/javascript"}))),this.worker=new Worker(WORKER_URL)}}WorkerInstance.revokeObjectURL=function(){WORKER_URL&&(URL.revokeObjectURL(WORKER_URL),WORKER_URL=null)};let UUID=0,MAX_WORKERS;class WorkerManagerClass{constructor(){this._initialized=!1,this._createdWorkers=0,this._workerPool=[],this._queue=[],this._resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(_=>{const{worker:C}=new WorkerInstance$1;C.addEventListener("message",A=>{C.terminate(),WorkerInstance$1.revokeObjectURL(),_(A.data)})}),this._isImageBitmapSupported)}loadImageBitmap(_,C){var A;return this._run("loadImageBitmap",[_,(A=C==null?void 0:C.data)==null?void 0:A.alphaMode])}async _initWorkers(){this._initialized||(this._initialized=!0)}_getWorker(){MAX_WORKERS===void 0&&(MAX_WORKERS=navigator.hardwareConcurrency||4);let _=this._workerPool.pop();return!_&&this._createdWorkers<MAX_WORKERS&&(this._createdWorkers++,_=new WorkerInstance().worker,_.addEventListener("message",C=>{this._complete(C.data),this._returnWorker(C.target),this._next()})),_}_returnWorker(_){this._workerPool.push(_)}_complete(_){_.error!==void 0?this._resolveHash[_.uuid].reject(_.error):this._resolveHash[_.uuid].resolve(_.data),this._resolveHash[_.uuid]=null}async _run(_,C){await this._initWorkers();const A=new Promise((T,E)=>{this._queue.push({id:_,arguments:C,resolve:T,reject:E})});return this._next(),A}_next(){if(!this._queue.length)return;const _=this._getWorker();if(!_)return;const C=this._queue.pop(),A=C.id;this._resolveHash[UUID]={resolve:C.resolve,reject:C.reject},_.postMessage({data:C.arguments,uuid:UUID++,id:A})}}const WorkerManager=new WorkerManagerClass,validImageExtensions=[".jpeg",".jpg",".png",".webp",".avif"],validImageMIMEs=["image/jpeg","image/png","image/webp","image/avif"];async function loadImageBitmap(P,_){var T;const C=await DOMAdapter.get().fetch(P);if(!C.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${P}: ${C.status} ${C.statusText}`);const A=await C.blob();return((T=_==null?void 0:_.data)==null?void 0:T.alphaMode)==="premultiplied-alpha"?createImageBitmap(A,{premultiplyAlpha:"none"}):createImageBitmap(A)}const loadTextures={name:"loadTextures",extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.High,name:"loadTextures"},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(P){return checkDataUrl(P,validImageMIMEs)||checkExtension(P,validImageExtensions)},async load(P,_,C){var E;let A=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await WorkerManager.isImageBitmapSupported()?A=await WorkerManager.loadImageBitmap(P,_):A=await loadImageBitmap(P,_):A=await new Promise((I,F)=>{A=new Image,A.crossOrigin=this.config.crossOrigin,A.src=P,A.complete?I(A):(A.onload=()=>{I(A)},A.onerror=F)});const T=new ImageSource({resource:A,alphaMode:"premultiply-alpha-on-upload",resolution:((E=_.data)==null?void 0:E.resolution)||getResolutionOfUrl(P),..._.data});return createTexture(T,C,P)},unload(P){P.destroy(!0)}},validVideoExtensions=[".mp4",".m4v",".webm",".ogg",".ogv",".h264",".avi",".mov"],validVideoMIMEs=validVideoExtensions.map(P=>`video/${P.substring(1)}`);function crossOrigin(P,_,C){C===void 0&&!_.startsWith("data:")?P.crossOrigin=determineCrossOrigin(_):C!==!1&&(P.crossOrigin=typeof C=="string"?C:"anonymous")}function preloadVideo(P){return new Promise((_,C)=>{P.addEventListener("canplaythrough",A),P.addEventListener("error",T),P.load();function A(){E(),_()}function T(I){E(),C(I)}function E(){P.removeEventListener("canplaythrough",A),P.removeEventListener("error",T)}})}function determineCrossOrigin(P,_=globalThis.location){if(P.startsWith("data:"))return"";_||(_=globalThis.location);const C=new URL(P,document.baseURI);return C.hostname!==_.hostname||C.port!==_.port||C.protocol!==_.protocol?"anonymous":""}const loadVideoTextures={name:"loadVideo",extension:{type:ExtensionType.LoadParser,name:"loadVideo"},test(P){const _=checkDataUrl(P,validVideoMIMEs),C=checkExtension(P,validVideoExtensions);return _||C},async load(P,_,C){var B,G;const A={...VideoSource.defaultOptions,resolution:((B=_.data)==null?void 0:B.resolution)||getResolutionOfUrl(P),alphaMode:((G=_.data)==null?void 0:G.alphaMode)||await detectVideoAlphaMode(),..._.data},T=document.createElement("video"),E={preload:A.autoLoad!==!1?"auto":void 0,"webkit-playsinline":A.playsinline!==!1?"":void 0,playsinline:A.playsinline!==!1?"":void 0,muted:A.muted===!0?"":void 0,loop:A.loop===!0?"":void 0,autoplay:A.autoPlay!==!1?"":void 0};Object.keys(E).forEach(R=>{const z=E[R];z!==void 0&&T.setAttribute(R,z)}),A.muted===!0&&(T.muted=!0),crossOrigin(T,P,A.crossorigin);const I=document.createElement("source");let F;if(P.startsWith("data:"))F=P.slice(5,P.indexOf(";"));else if(!P.startsWith("blob:")){const R=P.split("?")[0].slice(P.lastIndexOf(".")+1).toLowerCase();F=VideoSource.MIME_TYPES[R]||`video/${R}`}return I.src=P,F&&(I.type=F),new Promise(R=>{const z=async()=>{const D=new VideoSource({...A,resource:T});T.removeEventListener("canplay",z),_.data.preload&&await preloadVideo(T),R(createTexture(D,C,P))};T.addEventListener("canplay",z),T.appendChild(I)})},unload(P){P.destroy(!0)}},resolveTextureUrl={extension:{type:ExtensionType.ResolveParser,name:"resolveTexture"},test:loadTextures.test,parse:P=>{var _;return{resolution:parseFloat(((_=Resolver.RETINA_PREFIX.exec(P))==null?void 0:_[1])??"1"),format:P.split(".").pop(),src:P}}},resolveJsonUrl={extension:{type:ExtensionType.ResolveParser,priority:-2,name:"resolveJson"},test:P=>Resolver.RETINA_PREFIX.test(P)&&P.endsWith(".json"),parse:resolveTextureUrl.parse};class AssetsClass{constructor(){this._detections=[],this._initialized=!1,this.resolver=new Resolver,this.loader=new Loader,this.cache=Cache,this._backgroundLoader=new BackgroundLoader(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(_={}){var E,I;if(this._initialized){warn("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,_.defaultSearchParams&&this.resolver.setDefaultSearchParams(_.defaultSearchParams),_.basePath&&(this.resolver.basePath=_.basePath),_.bundleIdentifier&&this.resolver.setBundleIdentifier(_.bundleIdentifier),_.manifest){let F=_.manifest;typeof F=="string"&&(F=await this.load(F)),this.resolver.addManifest(F)}const C=((E=_.texturePreference)==null?void 0:E.resolution)??1,A=typeof C=="number"?[C]:C,T=await this._detectFormats({preferredFormats:(I=_.texturePreference)==null?void 0:I.format,skipDetections:_.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:T,resolution:A}}),_.preferences&&this.setPreferences(_.preferences)}add(_){this.resolver.add(_)}async load(_,C){this._initialized||await this.init();const A=isSingleItem(_),T=convertToList(_).map(F=>{if(typeof F!="string"){const B=this.resolver.getAlias(F);return B.some(G=>!this.resolver.hasKey(G))&&this.add(F),Array.isArray(B)?B[0]:B}return this.resolver.hasKey(F)||this.add({alias:F,src:F}),F}),E=this.resolver.resolve(T),I=await this._mapLoadToResolve(E,C);return A?I[T[0]]:I}addBundle(_,C){this.resolver.addBundle(_,C)}async loadBundle(_,C){this._initialized||await this.init();let A=!1;typeof _=="string"&&(A=!0,_=[_]);const T=this.resolver.resolveBundle(_),E={},I=Object.keys(T);let F=0,B=0;const G=()=>{C==null||C(++F/B)},R=I.map(z=>{const D=T[z];return B+=Object.keys(D).length,this._mapLoadToResolve(D,G).then(L=>{E[z]=L})});return await Promise.all(R),A?E[_[0]]:E}async backgroundLoad(_){this._initialized||await this.init(),typeof _=="string"&&(_=[_]);const C=this.resolver.resolve(_);this._backgroundLoader.add(Object.values(C))}async backgroundLoadBundle(_){this._initialized||await this.init(),typeof _=="string"&&(_=[_]);const C=this.resolver.resolveBundle(_);Object.values(C).forEach(A=>{this._backgroundLoader.add(Object.values(A))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(_){if(typeof _=="string")return Cache.get(_);const C={};for(let A=0;A<_.length;A++)C[A]=Cache.get(_[A]);return C}async _mapLoadToResolve(_,C){const A=[...new Set(Object.values(_))];this._backgroundLoader.active=!1;const T=await this.loader.load(A,C);this._backgroundLoader.active=!0;const E={};return A.forEach(I=>{const F=T[I.src],B=[I.src];I.alias&&B.push(...I.alias),B.forEach(G=>{E[G]=F}),Cache.set(B,F)}),E}async unload(_){this._initialized||await this.init();const C=convertToList(_).map(T=>typeof T!="string"?T.src:T),A=this.resolver.resolve(C);await this._unloadFromResolved(A)}async unloadBundle(_){this._initialized||await this.init(),_=convertToList(_);const C=this.resolver.resolveBundle(_),A=Object.keys(C).map(T=>this._unloadFromResolved(C[T]));await Promise.all(A)}async _unloadFromResolved(_){const C=Object.values(_);C.forEach(A=>{Cache.remove(A.src)}),await this.loader.unload(C)}async _detectFormats(_){let C=[];_.preferredFormats&&(C=Array.isArray(_.preferredFormats)?_.preferredFormats:[_.preferredFormats]);for(const A of _.detections)_.skipDetections||await A.test()?C=await A.add(C):_.skipDetections||(C=await A.remove(C));return C=C.filter((A,T)=>C.indexOf(A)===T),C}get detections(){return this._detections}setPreferences(_){this.loader.parsers.forEach(C=>{C.config&&Object.keys(C.config).filter(A=>A in _).forEach(A=>{C.config[A]=_[A]})})}}const Assets=new AssetsClass;extensions.handleByList(ExtensionType.LoadParser,Assets.loader.parsers).handleByList(ExtensionType.ResolveParser,Assets.resolver.parsers).handleByList(ExtensionType.CacheParser,Assets.cache.parsers).handleByList(ExtensionType.DetectionParser,Assets.detections);extensions.add(cacheTextureArray,detectDefaults,detectAvif,detectWebp,detectMp4,detectOgv,detectWebm,loadJson,loadTxt,loadWebFont,loadSvg,loadTextures,loadVideoTextures,loadBitmapFont,bitmapFontCachePlugin,resolveTextureUrl,resolveJsonUrl);const assetKeyMap={loader:ExtensionType.LoadParser,resolver:ExtensionType.ResolveParser,cache:ExtensionType.CacheParser,detection:ExtensionType.DetectionParser};extensions.handle(ExtensionType.Asset,P=>{const _=P.ref;Object.entries(assetKeyMap).filter(([C])=>!!_[C]).forEach(([C,A])=>extensions.add(Object.assign(_[C],{extension:_[C].extension??A})))},P=>{const _=P.ref;Object.keys(assetKeyMap).filter(C=>!!_[C]).forEach(C=>extensions.remove(_[C]))});class Graphics extends ViewContainer{constructor(_){_ instanceof GraphicsContext&&(_={context:_});const{context:C,roundPixels:A,...T}=_||{};super({label:"Graphics",...T}),this.renderPipeId="graphics",C?this._context=C:this._context=this._ownedContext=new GraphicsContext,this._context.on("update",this.onViewUpdate,this),this.allowChildren=!1,this.roundPixels=A??!1}set context(_){_!==this._context&&(this._context.off("update",this.onViewUpdate,this),this._context=_,this._context.on("update",this.onViewUpdate,this),this.onViewUpdate())}get context(){return this._context}get bounds(){return this._context.bounds}updateBounds(){}containsPoint(_){return this._context.containsPoint(_)}destroy(_){this._ownedContext&&!_?this._ownedContext.destroy(_):(_===!0||(_==null?void 0:_.context)===!0)&&this._context.destroy(_),this._ownedContext=null,this._context=null,super.destroy(_)}_callContextMethod(_,C){return this.context[_](...C),this}setFillStyle(..._){return this._callContextMethod("setFillStyle",_)}setStrokeStyle(..._){return this._callContextMethod("setStrokeStyle",_)}fill(..._){return this._callContextMethod("fill",_)}stroke(..._){return this._callContextMethod("stroke",_)}texture(..._){return this._callContextMethod("texture",_)}beginPath(){return this._callContextMethod("beginPath",[])}cut(){return this._callContextMethod("cut",[])}arc(..._){return this._callContextMethod("arc",_)}arcTo(..._){return this._callContextMethod("arcTo",_)}arcToSvg(..._){return this._callContextMethod("arcToSvg",_)}bezierCurveTo(..._){return this._callContextMethod("bezierCurveTo",_)}closePath(){return this._callContextMethod("closePath",[])}ellipse(..._){return this._callContextMethod("ellipse",_)}circle(..._){return this._callContextMethod("circle",_)}path(..._){return this._callContextMethod("path",_)}lineTo(..._){return this._callContextMethod("lineTo",_)}moveTo(..._){return this._callContextMethod("moveTo",_)}quadraticCurveTo(..._){return this._callContextMethod("quadraticCurveTo",_)}rect(..._){return this._callContextMethod("rect",_)}roundRect(..._){return this._callContextMethod("roundRect",_)}poly(..._){return this._callContextMethod("poly",_)}regularPoly(..._){return this._callContextMethod("regularPoly",_)}roundPoly(..._){return this._callContextMethod("roundPoly",_)}roundShape(..._){return this._callContextMethod("roundShape",_)}filletRect(..._){return this._callContextMethod("filletRect",_)}chamferRect(..._){return this._callContextMethod("chamferRect",_)}star(..._){return this._callContextMethod("star",_)}svg(..._){return this._callContextMethod("svg",_)}restore(..._){return this._callContextMethod("restore",_)}save(){return this._callContextMethod("save",[])}getTransform(){return this.context.getTransform()}resetTransform(){return this._callContextMethod("resetTransform",[])}rotateTransform(..._){return this._callContextMethod("rotate",_)}scaleTransform(..._){return this._callContextMethod("scale",_)}setTransform(..._){return this._callContextMethod("setTransform",_)}transform(..._){return this._callContextMethod("transform",_)}translateTransform(..._){return this._callContextMethod("translate",_)}clear(){return this._callContextMethod("clear",[])}get fillStyle(){return this._context.fillStyle}set fillStyle(_){this._context.fillStyle=_}get strokeStyle(){return this._context.strokeStyle}set strokeStyle(_){this._context.strokeStyle=_}clone(_=!1){return _?new Graphics(this._context.clone()):(this._ownedContext=null,new Graphics(this._context))}lineStyle(_,C,A){deprecation(v8_0_0,"Graphics#lineStyle is no longer needed. Use Graphics#setStrokeStyle to set the stroke style.");const T={};return _&&(T.width=_),C&&(T.color=C),A&&(T.alpha=A),this.context.strokeStyle=T,this}beginFill(_,C){deprecation(v8_0_0,"Graphics#beginFill is no longer needed. Use Graphics#fill to fill the shape with the desired style.");const A={};return _!==void 0&&(A.color=_),C!==void 0&&(A.alpha=C),this.context.fillStyle=A,this}endFill(){deprecation(v8_0_0,"Graphics#endFill is no longer needed. Use Graphics#fill to fill the shape with the desired style."),this.context.fill();const _=this.context.strokeStyle;return(_.width!==GraphicsContext.defaultStrokeStyle.width||_.color!==GraphicsContext.defaultStrokeStyle.color||_.alpha!==GraphicsContext.defaultStrokeStyle.alpha)&&this.context.stroke(),this}drawCircle(..._){return deprecation(v8_0_0,"Graphics#drawCircle has been renamed to Graphics#circle"),this._callContextMethod("circle",_)}drawEllipse(..._){return deprecation(v8_0_0,"Graphics#drawEllipse has been renamed to Graphics#ellipse"),this._callContextMethod("ellipse",_)}drawPolygon(..._){return deprecation(v8_0_0,"Graphics#drawPolygon has been renamed to Graphics#poly"),this._callContextMethod("poly",_)}drawRect(..._){return deprecation(v8_0_0,"Graphics#drawRect has been renamed to Graphics#rect"),this._callContextMethod("rect",_)}drawRoundedRect(..._){return deprecation(v8_0_0,"Graphics#drawRoundedRect has been renamed to Graphics#roundRect"),this._callContextMethod("roundRect",_)}drawStar(..._){return deprecation(v8_0_0,"Graphics#drawStar has been renamed to Graphics#star"),this._callContextMethod("star",_)}}class Transform{constructor({matrix:_,observer:C}={}){this.dirty=!0,this._matrix=_??new Matrix,this.observer=C,this.position=new ObservablePoint(this,0,0),this.scale=new ObservablePoint(this,1,1),this.pivot=new ObservablePoint(this,0,0),this.skew=new ObservablePoint(this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1}get matrix(){const _=this._matrix;return this.dirty&&(_.a=this._cx*this.scale.x,_.b=this._sx*this.scale.x,_.c=this._cy*this.scale.y,_.d=this._sy*this.scale.y,_.tx=this.position.x-(this.pivot.x*_.a+this.pivot.y*_.c),_.ty=this.position.y-(this.pivot.x*_.b+this.pivot.y*_.d),this.dirty=!1),_}_onUpdate(_){var C;this.dirty=!0,_===this.skew&&this.updateSkew(),(C=this.observer)==null||C._onUpdate(this)}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this.dirty=!0}toString(){return`[pixi.js/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`}setFromMatrix(_){_.decompose(this),this.dirty=!0}get rotation(){return this._rotation}set rotation(_){this._rotation!==_&&(this._rotation=_,this._onUpdate(this.skew))}}const _TilingSprite=class qt extends ViewContainer{constructor(..._){let C=_[0]||{};C instanceof Texture&&(C={texture:C}),_.length>1&&(deprecation(v8_0_0,"use new TilingSprite({ texture, width:100, height:100 }) instead"),C.width=_[1],C.height=_[2]),C={...qt.defaultOptions,...C};const{texture:A,anchor:T,tilePosition:E,tileScale:I,tileRotation:F,width:B,height:G,applyAnchorToTexture:R,roundPixels:z,...D}=C??{};super({label:"TilingSprite",...D}),this.renderPipeId="tilingSprite",this.batched=!0,this.allowChildren=!1,this._anchor=new ObservablePoint({_onUpdate:()=>{this.onViewUpdate()}}),this.applyAnchorToTexture=R,this.texture=A,this._width=B??A.width,this._height=G??A.height,this._tileTransform=new Transform({observer:{_onUpdate:()=>this.onViewUpdate()}}),T&&(this.anchor=T),this.tilePosition=E,this.tileScale=I,this.tileRotation=F,this.roundPixels=z??!1}static from(_,C={}){return typeof _=="string"?new qt({texture:Cache.get(_),...C}):new qt({texture:_,...C})}get uvRespectAnchor(){return warn("uvRespectAnchor is deprecated, please use applyAnchorToTexture instead"),this.applyAnchorToTexture}set uvRespectAnchor(_){warn("uvRespectAnchor is deprecated, please use applyAnchorToTexture instead"),this.applyAnchorToTexture=_}get clampMargin(){return this._texture.textureMatrix.clampMargin}set clampMargin(_){this._texture.textureMatrix.clampMargin=_}get anchor(){return this._anchor}set anchor(_){typeof _=="number"?this._anchor.set(_):this._anchor.copyFrom(_)}get tilePosition(){return this._tileTransform.position}set tilePosition(_){this._tileTransform.position.copyFrom(_)}get tileScale(){return this._tileTransform.scale}set tileScale(_){typeof _=="number"?this._tileTransform.scale.set(_):this._tileTransform.scale.copyFrom(_)}set tileRotation(_){this._tileTransform.rotation=_}get tileRotation(){return this._tileTransform.rotation}get tileTransform(){return this._tileTransform}set texture(_){_||(_=Texture.EMPTY);const C=this._texture;C!==_&&(C&&C.dynamic&&C.off("update",this.onViewUpdate,this),_.dynamic&&_.on("update",this.onViewUpdate,this),this._texture=_,this.onViewUpdate())}get texture(){return this._texture}set width(_){this._width=_,this.onViewUpdate()}get width(){return this._width}set height(_){this._height=_,this.onViewUpdate()}get height(){return this._height}setSize(_,C){typeof _=="object"&&(C=_.height??_.width,_=_.width),this._width=_,this._height=C??_,this.onViewUpdate()}getSize(_){return _||(_={}),_.width=this._width,_.height=this._height,_}updateBounds(){const _=this._bounds,C=this._anchor,A=this._width,T=this._height;_.minX=-C._x*A,_.maxX=_.minX+A,_.minY=-C._y*T,_.maxY=_.minY+T}containsPoint(_){const C=this._width,A=this._height,T=-C*this._anchor._x;let E=0;return _.x>=T&&_.x<=T+C&&(E=-A*this._anchor._y,_.y>=E&&_.y<=E+A)}destroy(_=!1){if(super.destroy(_),this._anchor=null,this._tileTransform=null,this._bounds=null,typeof _=="boolean"?_:_==null?void 0:_.texture){const A=typeof _=="boolean"?_:_==null?void 0:_.textureSource;this._texture.destroy(A)}this._texture=null}};_TilingSprite.defaultOptions={texture:Texture.EMPTY,anchor:{x:0,y:0},tilePosition:{x:0,y:0},tileScale:{x:1,y:1},tileRotation:0,applyAnchorToTexture:!1};let TilingSprite=_TilingSprite;class AbstractText extends ViewContainer{constructor(_,C){const{text:A,resolution:T,style:E,anchor:I,width:F,height:B,roundPixels:G,...R}=_;super({...R}),this.batched=!0,this._resolution=null,this._autoResolution=!0,this._didTextUpdate=!0,this._styleClass=C,this.text=A??"",this.style=E,this.resolution=T??null,this.allowChildren=!1,this._anchor=new ObservablePoint({_onUpdate:()=>{this.onViewUpdate()}}),I&&(this.anchor=I),this.roundPixels=G??!1,F!==void 0&&(this.width=F),B!==void 0&&(this.height=B)}get anchor(){return this._anchor}set anchor(_){typeof _=="number"?this._anchor.set(_):this._anchor.copyFrom(_)}set text(_){_=_.toString(),this._text!==_&&(this._text=_,this.onViewUpdate())}get text(){return this._text}set resolution(_){this._autoResolution=_===null,this._resolution=_,this.onViewUpdate()}get resolution(){return this._resolution}get style(){return this._style}set style(_){var C;_||(_={}),(C=this._style)==null||C.off("update",this.onViewUpdate,this),_ instanceof this._styleClass?this._style=_:this._style=new this._styleClass(_),this._style.on("update",this.onViewUpdate,this),this.onViewUpdate()}get width(){return Math.abs(this.scale.x)*this.bounds.width}set width(_){this._setWidth(_,this.bounds.width)}get height(){return Math.abs(this.scale.y)*this.bounds.height}set height(_){this._setHeight(_,this.bounds.height)}getSize(_){return _||(_={}),_.width=Math.abs(this.scale.x)*this.bounds.width,_.height=Math.abs(this.scale.y)*this.bounds.height,_}setSize(_,C){typeof _=="object"?(C=_.height??_.width,_=_.width):C??(C=_),_!==void 0&&this._setWidth(_,this.bounds.width),C!==void 0&&this._setHeight(C,this.bounds.height)}containsPoint(_){const C=this.bounds.width,A=this.bounds.height,T=-C*this.anchor.x;let E=0;return _.x>=T&&_.x<=T+C&&(E=-A*this.anchor.y,_.y>=E&&_.y<=E+A)}onViewUpdate(){this.didViewUpdate||(this._didTextUpdate=!0),super.onViewUpdate()}_getKey(){return`${this.text}:${this._style.styleKey}:${this._resolution}`}destroy(_=!1){super.destroy(_),this.owner=null,this._bounds=null,this._anchor=null,(typeof _=="boolean"?_:_!=null&&_.style)&&this._style.destroy(_),this._style=null,this._text=null}}function ensureTextOptions(P,_){let C=P[0]??{};return(typeof C=="string"||P[1])&&(deprecation(v8_0_0,`use new ${_}({ text: "hi!", style }) instead`),C={text:C,style:P[1]}),C}class Text extends AbstractText{constructor(..._){const C=ensureTextOptions(_,"Text");super(C,TextStyle),this.renderPipeId="text"}updateBounds(){const _=this._bounds,C=this._anchor,A=CanvasTextMetrics.measureText(this._text,this._style),{width:T,height:E}=A;_.minX=-C._x*T,_.maxX=_.minX+T,_.minY=-C._y*E,_.maxY=_.minY+E}}extensions.add(browserExt,webworkerExt);const calculateStageSize=(P,_)=>{const C=Math.min(window.innerWidth,P),A=Math.min(window.innerHeight,_),T=C/P,E=A/_,I=Math.min(T,E),F=P*I,B=_*I;return{width:F,height:B,scale:I}},DEFAULT_CONFIG={GAME_WIDTH:450,GAME_HEIGHT:800};var LogLevel;(function(P){P[P.TRACE=1]="TRACE",P[P.ASSERT=2]="ASSERT",P[P.LOG=3]="LOG",P[P.DEBUG=4]="DEBUG",P[P.INFO=5]="INFO",P[P.WARN=6]="WARN",P[P.ERROR=7]="ERROR"})(LogLevel||(LogLevel={}));class Logger{static initialize(_){Logger.isInitialize||(Logger.isInitialize=!0,Logger.gameName=_)}static setLogLevel(_){Logger.logLevel=_}static setConsoleLogEnabled(_){Logger.enableConsole=_}static toggleConsoleEnable(){Logger.enableConsole=!Logger.enableConsole,console.log(`[${Logger.gameName}] Console logging is now ${Logger.enableConsole?"ENABLED":"DISABLED"}.`)}static setNetworkLogEnabled(_){Logger.enableConsole=_}static setServerUrl(_){Logger.serverUrl=_}static trace(_,...C){Logger.isInitialize&&(Logger.logLevel<=LogLevel.TRACE||(Logger.sendMessage("TRACE",_,...C),Logger.enableConsole&&console.trace(`[${Logger.gameName}] ${_}`,...C)))}static assert(_,C,...A){Logger.isInitialize&&(Logger.logLevel<=LogLevel.ASSERT||(Logger.sendMessage("ASSERT",C,...A),Logger.enableConsole&&console.assert(_,`[${Logger.gameName}] ${C}`,...A)))}static log(_,...C){Logger.isInitialize&&(Logger.logLevel<=LogLevel.LOG||(Logger.sendMessage("LOG",_,...C),Logger.enableConsole&&console.log(`[${Logger.gameName}] ${_}`,...C)))}static debug(_,...C){Logger.isInitialize&&(Logger.logLevel<=LogLevel.DEBUG||(Logger.sendMessage("DEBUG",_,...C),Logger.enableConsole&&console.debug(`[${Logger.gameName}] ${_}`,...C)))}static info(_,...C){Logger.isInitialize&&(Logger.logLevel<=LogLevel.INFO||(Logger.sendMessage("INFO",_,...C),Logger.enableConsole&&console.info(`[${Logger.gameName}] ${_}`,...C)))}static warn(_,...C){if(!Logger.isInitialize||Logger.logLevel<=LogLevel.WARN||(Logger.sendMessage("WARN",_,...C),!Logger.enableConsole))return;console.warn(`%c[${Logger.gameName}] ${_}%c`,"font-weight: bold;","",...C)}static error(_,...C){if(!Logger.isInitialize||Logger.logLevel<=LogLevel.ERROR||(Logger.sendMessage("ERROR",_,...C),!Logger.enableConsole))return;console.error(`%c[${Logger.gameName}] ${_}%c`,"color: red; font-weight: bold;","",...C)}static async sendMessage(_,C,...A){if(!Logger.enableNetwork||Logger.serverUrl==="")return;const T={gameName:Logger.gameName,logLevel:_,message:C,optionalParams:A,timestamp:new Date().toISOString()};try{const E=await fetch(Logger.serverUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(T)});E.ok||console.error("Failed to send log message:",E.statusText)}catch(E){console.error("Error sending log message:",E)}}}Object.defineProperty(Logger,"isInitialize",{enumerable:!0,configurable:!0,writable:!0,value:!1});Object.defineProperty(Logger,"gameName",{enumerable:!0,configurable:!0,writable:!0,value:""});Object.defineProperty(Logger,"logLevel",{enumerable:!0,configurable:!0,writable:!0,value:LogLevel.WARN});Object.defineProperty(Logger,"enableConsole",{enumerable:!0,configurable:!0,writable:!0,value:!1});Object.defineProperty(Logger,"enableNetwork",{enumerable:!0,configurable:!0,writable:!0,value:!1});Object.defineProperty(Logger,"serverUrl",{enumerable:!0,configurable:!0,writable:!0,value:""});var SceneType;(function(P){P.READY="READY",P.PLAYING="PLAYING",P.GAMEOVER="GAMEOVER"})(SceneType||(SceneType={}));const{GAME_WIDTH:GAME_WIDTH$7,GAME_HEIGHT:GAME_HEIGHT$5}=DEFAULT_CONFIG;class Scene extends Container{constructor(_){super(),Object.defineProperty(this,"screenWidth",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"screenHeight",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"isEnable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"isInitialized",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.screenWidth=GAME_WIDTH$7,this.screenHeight=GAME_HEIGHT$5,_.addChild(this)}initialize(){this.isInitialized=!0,this.addCommonBackground()}addCommonBackground(){const _=Sprite.from("background");_.position.set(this.screenWidth/2,this.screenHeight/2),_.anchor.set(.5),_.width=this.screenWidth,_.height=this.screenHeight,this.addChild(_)}reset(){}update(_){}pause(){this.isEnable=!1}resume(){this.isEnable=!0}}const{GAME_WIDTH:GAME_WIDTH$6,GAME_HEIGHT:GAME_HEIGHT$4}=DEFAULT_CONFIG;class ReadyScene extends Scene{initialize(){super.initialize(),this.addTitle(),this.addPlane(),this.addGround(),this.addStartButton()}reset(){this.removeChildren(),this.addCommonBackground(),this.addTitle(),this.addPlane(),this.addGround(),this.addStartButton()}addTitle(){const _=new Text({text:`FLAPPY
PLANE`,style:{fontFamily:"Chicalo",fontSize:64,fontWeight:"bold",fill:16777215,stroke:{color:3028027,width:5},align:"center",dropShadow:!0}});_.position.set(GAME_WIDTH$6/2,GAME_HEIGHT$4/3),_.anchor.set(.5),this.addChild(_)}addPlane(){const _=Sprite.from("plane");_.anchor.set(.5),_.position.set(GAME_WIDTH$6/2,GAME_HEIGHT$4/2+50),_.width=62,_.height=48,this.addChild(_)}addGround(){const _=Sprite.from("ground");_.anchor.set(0,1),_.position.set(0,GAME_HEIGHT$4),_.width=GAME_WIDTH$6,this.addChild(_)}addStartButton(){const _=new Container;_.position.set(GAME_WIDTH$6/2,GAME_HEIGHT$4-162),_.eventMode="static",_.cursor="pointer";const C=new Graphics;C.fill({color:16764928}),C.stroke({color:3028027,width:3}),C.roundRect(-146/2,-62/2,146,62,8),C.fill(),C.stroke();const A=new Text({text:"START",style:{fontFamily:"Chicalo",fontSize:36,align:"center",fill:3028027}});A.anchor.set(.5),_.addChild(C),_.addChild(A),_.on("pointerdown",this.handlePointerDown.bind(this)),this.addChild(_)}handlePointerDown(_){_.stopPropagation(),_.stopImmediatePropagation(),SceneController.getInstance().switchScene(SceneType.PLAYING)}}var matter$1={exports:{}};/*!
 * matter-js 0.20.0 by @liabru
 * http://brm.io/matter-js/
 * License MIT
 * 
 * The MIT License (MIT)
 * 
 * Copyright (c) Liam Brummitt and contributors.
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var matter=matter$1.exports,hasRequiredMatter;function requireMatter(){return hasRequiredMatter||(hasRequiredMatter=1,function(P,_){(function(A,T){P.exports=T()})(matter,function(){return function(C){var A={};function T(E){if(A[E])return A[E].exports;var I=A[E]={i:E,l:!1,exports:{}};return C[E].call(I.exports,I,I.exports,T),I.l=!0,I.exports}return T.m=C,T.c=A,T.d=function(E,I,F){T.o(E,I)||Object.defineProperty(E,I,{enumerable:!0,get:F})},T.r=function(E){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(E,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(E,"__esModule",{value:!0})},T.t=function(E,I){if(I&1&&(E=T(E)),I&8||I&4&&typeof E=="object"&&E&&E.__esModule)return E;var F=Object.create(null);if(T.r(F),Object.defineProperty(F,"default",{enumerable:!0,value:E}),I&2&&typeof E!="string")for(var B in E)T.d(F,B,(function(G){return E[G]}).bind(null,B));return F},T.n=function(E){var I=E&&E.__esModule?function(){return E.default}:function(){return E};return T.d(I,"a",I),I},T.o=function(E,I){return Object.prototype.hasOwnProperty.call(E,I)},T.p="",T(T.s=20)}([function(C,A){var T={};C.exports=T,function(){T._baseDelta=1e3/60,T._nextId=0,T._seed=0,T._nowStartTime=+new Date,T._warnedOnce={},T._decomp=null,T.extend=function(I,F){var B,G;typeof F=="boolean"?(B=2,G=F):(B=1,G=!0);for(var R=B;R<arguments.length;R++){var z=arguments[R];if(z)for(var D in z)G&&z[D]&&z[D].constructor===Object&&(!I[D]||I[D].constructor===Object)?(I[D]=I[D]||{},T.extend(I[D],G,z[D])):I[D]=z[D]}return I},T.clone=function(I,F){return T.extend({},F,I)},T.keys=function(I){if(Object.keys)return Object.keys(I);var F=[];for(var B in I)F.push(B);return F},T.values=function(I){var F=[];if(Object.keys){for(var B=Object.keys(I),G=0;G<B.length;G++)F.push(I[B[G]]);return F}for(var R in I)F.push(I[R]);return F},T.get=function(I,F,B,G){F=F.split(".").slice(B,G);for(var R=0;R<F.length;R+=1)I=I[F[R]];return I},T.set=function(I,F,B,G,R){var z=F.split(".").slice(G,R);return T.get(I,F,0,-1)[z[z.length-1]]=B,B},T.shuffle=function(I){for(var F=I.length-1;F>0;F--){var B=Math.floor(T.random()*(F+1)),G=I[F];I[F]=I[B],I[B]=G}return I},T.choose=function(I){return I[Math.floor(T.random()*I.length)]},T.isElement=function(I){return typeof HTMLElement<"u"?I instanceof HTMLElement:!!(I&&I.nodeType&&I.nodeName)},T.isArray=function(I){return Object.prototype.toString.call(I)==="[object Array]"},T.isFunction=function(I){return typeof I=="function"},T.isPlainObject=function(I){return typeof I=="object"&&I.constructor===Object},T.isString=function(I){return toString.call(I)==="[object String]"},T.clamp=function(I,F,B){return I<F?F:I>B?B:I},T.sign=function(I){return I<0?-1:1},T.now=function(){if(typeof window<"u"&&window.performance){if(window.performance.now)return window.performance.now();if(window.performance.webkitNow)return window.performance.webkitNow()}return Date.now?Date.now():new Date-T._nowStartTime},T.random=function(I,F){return I=typeof I<"u"?I:0,F=typeof F<"u"?F:1,I+E()*(F-I)};var E=function(){return T._seed=(T._seed*9301+49297)%233280,T._seed/233280};T.colorToNumber=function(I){return I=I.replace("#",""),I.length==3&&(I=I.charAt(0)+I.charAt(0)+I.charAt(1)+I.charAt(1)+I.charAt(2)+I.charAt(2)),parseInt(I,16)},T.logLevel=1,T.log=function(){console&&T.logLevel>0&&T.logLevel<=3&&console.log.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},T.info=function(){console&&T.logLevel>0&&T.logLevel<=2&&console.info.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},T.warn=function(){console&&T.logLevel>0&&T.logLevel<=3&&console.warn.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},T.warnOnce=function(){var I=Array.prototype.slice.call(arguments).join(" ");T._warnedOnce[I]||(T.warn(I),T._warnedOnce[I]=!0)},T.deprecated=function(I,F,B){I[F]=T.chain(function(){T.warnOnce(" deprecated ",B)},I[F])},T.nextId=function(){return T._nextId++},T.indexOf=function(I,F){if(I.indexOf)return I.indexOf(F);for(var B=0;B<I.length;B++)if(I[B]===F)return B;return-1},T.map=function(I,F){if(I.map)return I.map(F);for(var B=[],G=0;G<I.length;G+=1)B.push(F(I[G]));return B},T.topologicalSort=function(I){var F=[],B=[],G=[];for(var R in I)!B[R]&&!G[R]&&T._topologicalSort(R,B,G,I,F);return F},T._topologicalSort=function(I,F,B,G,R){var z=G[I]||[];B[I]=!0;for(var D=0;D<z.length;D+=1){var L=z[D];B[L]||F[L]||T._topologicalSort(L,F,B,G,R)}B[I]=!1,F[I]=!0,R.push(I)},T.chain=function(){for(var I=[],F=0;F<arguments.length;F+=1){var B=arguments[F];B._chained?I.push.apply(I,B._chained):I.push(B)}var G=function(){for(var R,z=new Array(arguments.length),D=0,L=arguments.length;D<L;D++)z[D]=arguments[D];for(D=0;D<I.length;D+=1){var O=I[D].apply(R,z);typeof O<"u"&&(R=O)}return R};return G._chained=I,G},T.chainPathBefore=function(I,F,B){return T.set(I,F,T.chain(B,T.get(I,F)))},T.chainPathAfter=function(I,F,B){return T.set(I,F,T.chain(T.get(I,F),B))},T.setDecomp=function(I){T._decomp=I},T.getDecomp=function(){var I=T._decomp;try{!I&&typeof window<"u"&&(I=window.decomp),!I&&typeof commonjsGlobal<"u"&&(I=commonjsGlobal.decomp)}catch{I=null}return I}}()},function(C,A){var T={};C.exports=T,function(){T.create=function(E){var I={min:{x:0,y:0},max:{x:0,y:0}};return E&&T.update(I,E),I},T.update=function(E,I,F){E.min.x=1/0,E.max.x=-1/0,E.min.y=1/0,E.max.y=-1/0;for(var B=0;B<I.length;B++){var G=I[B];G.x>E.max.x&&(E.max.x=G.x),G.x<E.min.x&&(E.min.x=G.x),G.y>E.max.y&&(E.max.y=G.y),G.y<E.min.y&&(E.min.y=G.y)}F&&(F.x>0?E.max.x+=F.x:E.min.x+=F.x,F.y>0?E.max.y+=F.y:E.min.y+=F.y)},T.contains=function(E,I){return I.x>=E.min.x&&I.x<=E.max.x&&I.y>=E.min.y&&I.y<=E.max.y},T.overlaps=function(E,I){return E.min.x<=I.max.x&&E.max.x>=I.min.x&&E.max.y>=I.min.y&&E.min.y<=I.max.y},T.translate=function(E,I){E.min.x+=I.x,E.max.x+=I.x,E.min.y+=I.y,E.max.y+=I.y},T.shift=function(E,I){var F=E.max.x-E.min.x,B=E.max.y-E.min.y;E.min.x=I.x,E.max.x=I.x+F,E.min.y=I.y,E.max.y=I.y+B}}()},function(C,A){var T={};C.exports=T,function(){T.create=function(E,I){return{x:E||0,y:I||0}},T.clone=function(E){return{x:E.x,y:E.y}},T.magnitude=function(E){return Math.sqrt(E.x*E.x+E.y*E.y)},T.magnitudeSquared=function(E){return E.x*E.x+E.y*E.y},T.rotate=function(E,I,F){var B=Math.cos(I),G=Math.sin(I);F||(F={});var R=E.x*B-E.y*G;return F.y=E.x*G+E.y*B,F.x=R,F},T.rotateAbout=function(E,I,F,B){var G=Math.cos(I),R=Math.sin(I);B||(B={});var z=F.x+((E.x-F.x)*G-(E.y-F.y)*R);return B.y=F.y+((E.x-F.x)*R+(E.y-F.y)*G),B.x=z,B},T.normalise=function(E){var I=T.magnitude(E);return I===0?{x:0,y:0}:{x:E.x/I,y:E.y/I}},T.dot=function(E,I){return E.x*I.x+E.y*I.y},T.cross=function(E,I){return E.x*I.y-E.y*I.x},T.cross3=function(E,I,F){return(I.x-E.x)*(F.y-E.y)-(I.y-E.y)*(F.x-E.x)},T.add=function(E,I,F){return F||(F={}),F.x=E.x+I.x,F.y=E.y+I.y,F},T.sub=function(E,I,F){return F||(F={}),F.x=E.x-I.x,F.y=E.y-I.y,F},T.mult=function(E,I){return{x:E.x*I,y:E.y*I}},T.div=function(E,I){return{x:E.x/I,y:E.y/I}},T.perp=function(E,I){return I=I===!0?-1:1,{x:I*-E.y,y:I*E.x}},T.neg=function(E){return{x:-E.x,y:-E.y}},T.angle=function(E,I){return Math.atan2(I.y-E.y,I.x-E.x)},T._temp=[T.create(),T.create(),T.create(),T.create(),T.create(),T.create()]}()},function(C,A,T){var E={};C.exports=E;var I=T(2),F=T(0);(function(){E.create=function(B,G){for(var R=[],z=0;z<B.length;z++){var D=B[z],L={x:D.x,y:D.y,index:z,body:G,isInternal:!1};R.push(L)}return R},E.fromPath=function(B,G){var R=/L?\s*([-\d.e]+)[\s,]*([-\d.e]+)*/ig,z=[];return B.replace(R,function(D,L,O){z.push({x:parseFloat(L),y:parseFloat(O)})}),E.create(z,G)},E.centre=function(B){for(var G=E.area(B,!0),R={x:0,y:0},z,D,L,O=0;O<B.length;O++)L=(O+1)%B.length,z=I.cross(B[O],B[L]),D=I.mult(I.add(B[O],B[L]),z),R=I.add(R,D);return I.div(R,6*G)},E.mean=function(B){for(var G={x:0,y:0},R=0;R<B.length;R++)G.x+=B[R].x,G.y+=B[R].y;return I.div(G,B.length)},E.area=function(B,G){for(var R=0,z=B.length-1,D=0;D<B.length;D++)R+=(B[z].x-B[D].x)*(B[z].y+B[D].y),z=D;return G?R/2:Math.abs(R)/2},E.inertia=function(B,G){for(var R=0,z=0,D=B,L,O,V=0;V<D.length;V++)O=(V+1)%D.length,L=Math.abs(I.cross(D[O],D[V])),R+=L*(I.dot(D[O],D[O])+I.dot(D[O],D[V])+I.dot(D[V],D[V])),z+=L;return G/6*(R/z)},E.translate=function(B,G,R){R=typeof R<"u"?R:1;var z=B.length,D=G.x*R,L=G.y*R,O;for(O=0;O<z;O++)B[O].x+=D,B[O].y+=L;return B},E.rotate=function(B,G,R){if(G!==0){var z=Math.cos(G),D=Math.sin(G),L=R.x,O=R.y,V=B.length,U,W,X,Y;for(Y=0;Y<V;Y++)U=B[Y],W=U.x-L,X=U.y-O,U.x=L+(W*z-X*D),U.y=O+(W*D+X*z);return B}},E.contains=function(B,G){for(var R=G.x,z=G.y,D=B.length,L=B[D-1],O,V=0;V<D;V++){if(O=B[V],(R-L.x)*(O.y-L.y)+(z-L.y)*(L.x-O.x)>0)return!1;L=O}return!0},E.scale=function(B,G,R,z){if(G===1&&R===1)return B;z=z||E.centre(B);for(var D,L,O=0;O<B.length;O++)D=B[O],L=I.sub(D,z),B[O].x=z.x+L.x*G,B[O].y=z.y+L.y*R;return B},E.chamfer=function(B,G,R,z,D){typeof G=="number"?G=[G]:G=G||[8],R=typeof R<"u"?R:-1,z=z||2,D=D||14;for(var L=[],O=0;O<B.length;O++){var V=B[O-1>=0?O-1:B.length-1],U=B[O],W=B[(O+1)%B.length],X=G[O<G.length?O:G.length-1];if(X===0){L.push(U);continue}var Y=I.normalise({x:U.y-V.y,y:V.x-U.x}),K=I.normalise({x:W.y-U.y,y:U.x-W.x}),q=Math.sqrt(2*Math.pow(X,2)),J=I.mult(F.clone(Y),X),tt=I.normalise(I.mult(I.add(Y,K),.5)),rt=I.sub(U,I.mult(tt,q)),st=R;R===-1&&(st=Math.pow(X,.32)*1.75),st=F.clamp(st,z,D),st%2===1&&(st+=1);for(var nt=Math.acos(I.dot(Y,K)),at=nt/st,ot=0;ot<st;ot++)L.push(I.add(I.rotate(J,at*ot),rt))}return L},E.clockwiseSort=function(B){var G=E.mean(B);return B.sort(function(R,z){return I.angle(G,R)-I.angle(G,z)}),B},E.isConvex=function(B){var G=0,R=B.length,z,D,L,O;if(R<3)return null;for(z=0;z<R;z++)if(D=(z+1)%R,L=(z+2)%R,O=(B[D].x-B[z].x)*(B[L].y-B[D].y),O-=(B[D].y-B[z].y)*(B[L].x-B[D].x),O<0?G|=1:O>0&&(G|=2),G===3)return!1;return G!==0?!0:null},E.hull=function(B){var G=[],R=[],z,D;for(B=B.slice(0),B.sort(function(L,O){var V=L.x-O.x;return V!==0?V:L.y-O.y}),D=0;D<B.length;D+=1){for(z=B[D];R.length>=2&&I.cross3(R[R.length-2],R[R.length-1],z)<=0;)R.pop();R.push(z)}for(D=B.length-1;D>=0;D-=1){for(z=B[D];G.length>=2&&I.cross3(G[G.length-2],G[G.length-1],z)<=0;)G.pop();G.push(z)}return G.pop(),R.pop(),G.concat(R)}})()},function(C,A,T){var E={};C.exports=E;var I=T(3),F=T(2),B=T(7),G=T(0),R=T(1),z=T(11);(function(){E._timeCorrection=!0,E._inertiaScale=4,E._nextCollidingGroupId=1,E._nextNonCollidingGroupId=-1,E._nextCategory=1,E._baseDelta=1e3/60,E.create=function(L){var O={id:G.nextId(),type:"body",label:"Body",parts:[],plugin:{},angle:0,vertices:I.fromPath("L 0 0 L 40 0 L 40 40 L 0 40"),position:{x:0,y:0},force:{x:0,y:0},torque:0,positionImpulse:{x:0,y:0},constraintImpulse:{x:0,y:0,angle:0},totalContacts:0,speed:0,angularSpeed:0,velocity:{x:0,y:0},angularVelocity:0,isSensor:!1,isStatic:!1,isSleeping:!1,motion:0,sleepThreshold:60,density:.001,restitution:0,friction:.1,frictionStatic:.5,frictionAir:.01,collisionFilter:{category:1,mask:4294967295,group:0},slop:.05,timeScale:1,render:{visible:!0,opacity:1,strokeStyle:null,fillStyle:null,lineWidth:null,sprite:{xScale:1,yScale:1,xOffset:0,yOffset:0}},events:null,bounds:null,chamfer:null,circleRadius:0,positionPrev:null,anglePrev:0,parent:null,axes:null,area:0,mass:0,inertia:0,deltaTime:16.666666666666668,_original:null},V=G.extend(O,L);return D(V,L),V},E.nextGroup=function(L){return L?E._nextNonCollidingGroupId--:E._nextCollidingGroupId++},E.nextCategory=function(){return E._nextCategory=E._nextCategory<<1,E._nextCategory};var D=function(L,O){O=O||{},E.set(L,{bounds:L.bounds||R.create(L.vertices),positionPrev:L.positionPrev||F.clone(L.position),anglePrev:L.anglePrev||L.angle,vertices:L.vertices,parts:L.parts||[L],isStatic:L.isStatic,isSleeping:L.isSleeping,parent:L.parent||L}),I.rotate(L.vertices,L.angle,L.position),z.rotate(L.axes,L.angle),R.update(L.bounds,L.vertices,L.velocity),E.set(L,{axes:O.axes||L.axes,area:O.area||L.area,mass:O.mass||L.mass,inertia:O.inertia||L.inertia});var V=L.isStatic?"#14151f":G.choose(["#f19648","#f5d259","#f55a3c","#063e7b","#ececd1"]),U=L.isStatic?"#555":"#ccc",W=L.isStatic&&L.render.fillStyle===null?1:0;L.render.fillStyle=L.render.fillStyle||V,L.render.strokeStyle=L.render.strokeStyle||U,L.render.lineWidth=L.render.lineWidth||W,L.render.sprite.xOffset+=-(L.bounds.min.x-L.position.x)/(L.bounds.max.x-L.bounds.min.x),L.render.sprite.yOffset+=-(L.bounds.min.y-L.position.y)/(L.bounds.max.y-L.bounds.min.y)};E.set=function(L,O,V){var U;typeof O=="string"&&(U=O,O={},O[U]=V);for(U in O)if(Object.prototype.hasOwnProperty.call(O,U))switch(V=O[U],U){case"isStatic":E.setStatic(L,V);break;case"isSleeping":B.set(L,V);break;case"mass":E.setMass(L,V);break;case"density":E.setDensity(L,V);break;case"inertia":E.setInertia(L,V);break;case"vertices":E.setVertices(L,V);break;case"position":E.setPosition(L,V);break;case"angle":E.setAngle(L,V);break;case"velocity":E.setVelocity(L,V);break;case"angularVelocity":E.setAngularVelocity(L,V);break;case"speed":E.setSpeed(L,V);break;case"angularSpeed":E.setAngularSpeed(L,V);break;case"parts":E.setParts(L,V);break;case"centre":E.setCentre(L,V);break;default:L[U]=V}},E.setStatic=function(L,O){for(var V=0;V<L.parts.length;V++){var U=L.parts[V];O?(U.isStatic||(U._original={restitution:U.restitution,friction:U.friction,mass:U.mass,inertia:U.inertia,density:U.density,inverseMass:U.inverseMass,inverseInertia:U.inverseInertia}),U.restitution=0,U.friction=1,U.mass=U.inertia=U.density=1/0,U.inverseMass=U.inverseInertia=0,U.positionPrev.x=U.position.x,U.positionPrev.y=U.position.y,U.anglePrev=U.angle,U.angularVelocity=0,U.speed=0,U.angularSpeed=0,U.motion=0):U._original&&(U.restitution=U._original.restitution,U.friction=U._original.friction,U.mass=U._original.mass,U.inertia=U._original.inertia,U.density=U._original.density,U.inverseMass=U._original.inverseMass,U.inverseInertia=U._original.inverseInertia,U._original=null),U.isStatic=O}},E.setMass=function(L,O){var V=L.inertia/(L.mass/6);L.inertia=V*(O/6),L.inverseInertia=1/L.inertia,L.mass=O,L.inverseMass=1/L.mass,L.density=L.mass/L.area},E.setDensity=function(L,O){E.setMass(L,O*L.area),L.density=O},E.setInertia=function(L,O){L.inertia=O,L.inverseInertia=1/L.inertia},E.setVertices=function(L,O){O[0].body===L?L.vertices=O:L.vertices=I.create(O,L),L.axes=z.fromVertices(L.vertices),L.area=I.area(L.vertices),E.setMass(L,L.density*L.area);var V=I.centre(L.vertices);I.translate(L.vertices,V,-1),E.setInertia(L,E._inertiaScale*I.inertia(L.vertices,L.mass)),I.translate(L.vertices,L.position),R.update(L.bounds,L.vertices,L.velocity)},E.setParts=function(L,O,V){var U;for(O=O.slice(0),L.parts.length=0,L.parts.push(L),L.parent=L,U=0;U<O.length;U++){var W=O[U];W!==L&&(W.parent=L,L.parts.push(W))}if(L.parts.length!==1){if(V=typeof V<"u"?V:!0,V){var X=[];for(U=0;U<O.length;U++)X=X.concat(O[U].vertices);I.clockwiseSort(X);var Y=I.hull(X),K=I.centre(Y);E.setVertices(L,Y),I.translate(L.vertices,K)}var q=E._totalProperties(L);L.area=q.area,L.parent=L,L.position.x=q.centre.x,L.position.y=q.centre.y,L.positionPrev.x=q.centre.x,L.positionPrev.y=q.centre.y,E.setMass(L,q.mass),E.setInertia(L,q.inertia),E.setPosition(L,q.centre)}},E.setCentre=function(L,O,V){V?(L.positionPrev.x+=O.x,L.positionPrev.y+=O.y,L.position.x+=O.x,L.position.y+=O.y):(L.positionPrev.x=O.x-(L.position.x-L.positionPrev.x),L.positionPrev.y=O.y-(L.position.y-L.positionPrev.y),L.position.x=O.x,L.position.y=O.y)},E.setPosition=function(L,O,V){var U=F.sub(O,L.position);V?(L.positionPrev.x=L.position.x,L.positionPrev.y=L.position.y,L.velocity.x=U.x,L.velocity.y=U.y,L.speed=F.magnitude(U)):(L.positionPrev.x+=U.x,L.positionPrev.y+=U.y);for(var W=0;W<L.parts.length;W++){var X=L.parts[W];X.position.x+=U.x,X.position.y+=U.y,I.translate(X.vertices,U),R.update(X.bounds,X.vertices,L.velocity)}},E.setAngle=function(L,O,V){var U=O-L.angle;V?(L.anglePrev=L.angle,L.angularVelocity=U,L.angularSpeed=Math.abs(U)):L.anglePrev+=U;for(var W=0;W<L.parts.length;W++){var X=L.parts[W];X.angle+=U,I.rotate(X.vertices,U,L.position),z.rotate(X.axes,U),R.update(X.bounds,X.vertices,L.velocity),W>0&&F.rotateAbout(X.position,U,L.position,X.position)}},E.setVelocity=function(L,O){var V=L.deltaTime/E._baseDelta;L.positionPrev.x=L.position.x-O.x*V,L.positionPrev.y=L.position.y-O.y*V,L.velocity.x=(L.position.x-L.positionPrev.x)/V,L.velocity.y=(L.position.y-L.positionPrev.y)/V,L.speed=F.magnitude(L.velocity)},E.getVelocity=function(L){var O=E._baseDelta/L.deltaTime;return{x:(L.position.x-L.positionPrev.x)*O,y:(L.position.y-L.positionPrev.y)*O}},E.getSpeed=function(L){return F.magnitude(E.getVelocity(L))},E.setSpeed=function(L,O){E.setVelocity(L,F.mult(F.normalise(E.getVelocity(L)),O))},E.setAngularVelocity=function(L,O){var V=L.deltaTime/E._baseDelta;L.anglePrev=L.angle-O*V,L.angularVelocity=(L.angle-L.anglePrev)/V,L.angularSpeed=Math.abs(L.angularVelocity)},E.getAngularVelocity=function(L){return(L.angle-L.anglePrev)*E._baseDelta/L.deltaTime},E.getAngularSpeed=function(L){return Math.abs(E.getAngularVelocity(L))},E.setAngularSpeed=function(L,O){E.setAngularVelocity(L,G.sign(E.getAngularVelocity(L))*O)},E.translate=function(L,O,V){E.setPosition(L,F.add(L.position,O),V)},E.rotate=function(L,O,V,U){if(!V)E.setAngle(L,L.angle+O,U);else{var W=Math.cos(O),X=Math.sin(O),Y=L.position.x-V.x,K=L.position.y-V.y;E.setPosition(L,{x:V.x+(Y*W-K*X),y:V.y+(Y*X+K*W)},U),E.setAngle(L,L.angle+O,U)}},E.scale=function(L,O,V,U){var W=0,X=0;U=U||L.position;for(var Y=0;Y<L.parts.length;Y++){var K=L.parts[Y];I.scale(K.vertices,O,V,U),K.axes=z.fromVertices(K.vertices),K.area=I.area(K.vertices),E.setMass(K,L.density*K.area),I.translate(K.vertices,{x:-K.position.x,y:-K.position.y}),E.setInertia(K,E._inertiaScale*I.inertia(K.vertices,K.mass)),I.translate(K.vertices,{x:K.position.x,y:K.position.y}),Y>0&&(W+=K.area,X+=K.inertia),K.position.x=U.x+(K.position.x-U.x)*O,K.position.y=U.y+(K.position.y-U.y)*V,R.update(K.bounds,K.vertices,L.velocity)}L.parts.length>1&&(L.area=W,L.isStatic||(E.setMass(L,L.density*W),E.setInertia(L,X))),L.circleRadius&&(O===V?L.circleRadius*=O:L.circleRadius=null)},E.update=function(L,O){O=(typeof O<"u"?O:1e3/60)*L.timeScale;var V=O*O,U=E._timeCorrection?O/(L.deltaTime||O):1,W=1-L.frictionAir*(O/G._baseDelta),X=(L.position.x-L.positionPrev.x)*U,Y=(L.position.y-L.positionPrev.y)*U;L.velocity.x=X*W+L.force.x/L.mass*V,L.velocity.y=Y*W+L.force.y/L.mass*V,L.positionPrev.x=L.position.x,L.positionPrev.y=L.position.y,L.position.x+=L.velocity.x,L.position.y+=L.velocity.y,L.deltaTime=O,L.angularVelocity=(L.angle-L.anglePrev)*W*U+L.torque/L.inertia*V,L.anglePrev=L.angle,L.angle+=L.angularVelocity;for(var K=0;K<L.parts.length;K++){var q=L.parts[K];I.translate(q.vertices,L.velocity),K>0&&(q.position.x+=L.velocity.x,q.position.y+=L.velocity.y),L.angularVelocity!==0&&(I.rotate(q.vertices,L.angularVelocity,L.position),z.rotate(q.axes,L.angularVelocity),K>0&&F.rotateAbout(q.position,L.angularVelocity,L.position,q.position)),R.update(q.bounds,q.vertices,L.velocity)}},E.updateVelocities=function(L){var O=E._baseDelta/L.deltaTime,V=L.velocity;V.x=(L.position.x-L.positionPrev.x)*O,V.y=(L.position.y-L.positionPrev.y)*O,L.speed=Math.sqrt(V.x*V.x+V.y*V.y),L.angularVelocity=(L.angle-L.anglePrev)*O,L.angularSpeed=Math.abs(L.angularVelocity)},E.applyForce=function(L,O,V){var U={x:O.x-L.position.x,y:O.y-L.position.y};L.force.x+=V.x,L.force.y+=V.y,L.torque+=U.x*V.y-U.y*V.x},E._totalProperties=function(L){for(var O={mass:0,area:0,inertia:0,centre:{x:0,y:0}},V=L.parts.length===1?0:1;V<L.parts.length;V++){var U=L.parts[V],W=U.mass!==1/0?U.mass:1;O.mass+=W,O.area+=U.area,O.inertia+=U.inertia,O.centre=F.add(O.centre,F.mult(U.position,W))}return O.centre=F.div(O.centre,O.mass),O}})()},function(C,A,T){var E={};C.exports=E;var I=T(0);(function(){E.on=function(F,B,G){for(var R=B.split(" "),z,D=0;D<R.length;D++)z=R[D],F.events=F.events||{},F.events[z]=F.events[z]||[],F.events[z].push(G);return G},E.off=function(F,B,G){if(!B){F.events={};return}typeof B=="function"&&(G=B,B=I.keys(F.events).join(" "));for(var R=B.split(" "),z=0;z<R.length;z++){var D=F.events[R[z]],L=[];if(G&&D)for(var O=0;O<D.length;O++)D[O]!==G&&L.push(D[O]);F.events[R[z]]=L}},E.trigger=function(F,B,G){var R,z,D,L,O=F.events;if(O&&I.keys(O).length>0){G||(G={}),R=B.split(" ");for(var V=0;V<R.length;V++)if(z=R[V],D=O[z],D){L=I.clone(G,!1),L.name=z,L.source=F;for(var U=0;U<D.length;U++)D[U].apply(F,[L])}}}})()},function(C,A,T){var E={};C.exports=E;var I=T(5),F=T(0),B=T(1),G=T(4);(function(){E.create=function(R){return F.extend({id:F.nextId(),type:"composite",parent:null,isModified:!1,bodies:[],constraints:[],composites:[],label:"Composite",plugin:{},cache:{allBodies:null,allConstraints:null,allComposites:null}},R)},E.setModified=function(R,z,D,L){if(R.isModified=z,z&&R.cache&&(R.cache.allBodies=null,R.cache.allConstraints=null,R.cache.allComposites=null),D&&R.parent&&E.setModified(R.parent,z,D,L),L)for(var O=0;O<R.composites.length;O++){var V=R.composites[O];E.setModified(V,z,D,L)}},E.add=function(R,z){var D=[].concat(z);I.trigger(R,"beforeAdd",{object:z});for(var L=0;L<D.length;L++){var O=D[L];switch(O.type){case"body":if(O.parent!==O){F.warn("Composite.add: skipped adding a compound body part (you must add its parent instead)");break}E.addBody(R,O);break;case"constraint":E.addConstraint(R,O);break;case"composite":E.addComposite(R,O);break;case"mouseConstraint":E.addConstraint(R,O.constraint);break}}return I.trigger(R,"afterAdd",{object:z}),R},E.remove=function(R,z,D){var L=[].concat(z);I.trigger(R,"beforeRemove",{object:z});for(var O=0;O<L.length;O++){var V=L[O];switch(V.type){case"body":E.removeBody(R,V,D);break;case"constraint":E.removeConstraint(R,V,D);break;case"composite":E.removeComposite(R,V,D);break;case"mouseConstraint":E.removeConstraint(R,V.constraint);break}}return I.trigger(R,"afterRemove",{object:z}),R},E.addComposite=function(R,z){return R.composites.push(z),z.parent=R,E.setModified(R,!0,!0,!1),R},E.removeComposite=function(R,z,D){var L=F.indexOf(R.composites,z);if(L!==-1){var O=E.allBodies(z);E.removeCompositeAt(R,L);for(var V=0;V<O.length;V++)O[V].sleepCounter=0}if(D)for(var V=0;V<R.composites.length;V++)E.removeComposite(R.composites[V],z,!0);return R},E.removeCompositeAt=function(R,z){return R.composites.splice(z,1),E.setModified(R,!0,!0,!1),R},E.addBody=function(R,z){return R.bodies.push(z),E.setModified(R,!0,!0,!1),R},E.removeBody=function(R,z,D){var L=F.indexOf(R.bodies,z);if(L!==-1&&(E.removeBodyAt(R,L),z.sleepCounter=0),D)for(var O=0;O<R.composites.length;O++)E.removeBody(R.composites[O],z,!0);return R},E.removeBodyAt=function(R,z){return R.bodies.splice(z,1),E.setModified(R,!0,!0,!1),R},E.addConstraint=function(R,z){return R.constraints.push(z),E.setModified(R,!0,!0,!1),R},E.removeConstraint=function(R,z,D){var L=F.indexOf(R.constraints,z);if(L!==-1&&E.removeConstraintAt(R,L),D)for(var O=0;O<R.composites.length;O++)E.removeConstraint(R.composites[O],z,!0);return R},E.removeConstraintAt=function(R,z){return R.constraints.splice(z,1),E.setModified(R,!0,!0,!1),R},E.clear=function(R,z,D){if(D)for(var L=0;L<R.composites.length;L++)E.clear(R.composites[L],z,!0);return z?R.bodies=R.bodies.filter(function(O){return O.isStatic}):R.bodies.length=0,R.constraints.length=0,R.composites.length=0,E.setModified(R,!0,!0,!1),R},E.allBodies=function(R){if(R.cache&&R.cache.allBodies)return R.cache.allBodies;for(var z=[].concat(R.bodies),D=0;D<R.composites.length;D++)z=z.concat(E.allBodies(R.composites[D]));return R.cache&&(R.cache.allBodies=z),z},E.allConstraints=function(R){if(R.cache&&R.cache.allConstraints)return R.cache.allConstraints;for(var z=[].concat(R.constraints),D=0;D<R.composites.length;D++)z=z.concat(E.allConstraints(R.composites[D]));return R.cache&&(R.cache.allConstraints=z),z},E.allComposites=function(R){if(R.cache&&R.cache.allComposites)return R.cache.allComposites;for(var z=[].concat(R.composites),D=0;D<R.composites.length;D++)z=z.concat(E.allComposites(R.composites[D]));return R.cache&&(R.cache.allComposites=z),z},E.get=function(R,z,D){var L,O;switch(D){case"body":L=E.allBodies(R);break;case"constraint":L=E.allConstraints(R);break;case"composite":L=E.allComposites(R).concat(R);break}return L?(O=L.filter(function(V){return V.id.toString()===z.toString()}),O.length===0?null:O[0]):null},E.move=function(R,z,D){return E.remove(R,z),E.add(D,z),R},E.rebase=function(R){for(var z=E.allBodies(R).concat(E.allConstraints(R)).concat(E.allComposites(R)),D=0;D<z.length;D++)z[D].id=F.nextId();return R},E.translate=function(R,z,D){for(var L=D?E.allBodies(R):R.bodies,O=0;O<L.length;O++)G.translate(L[O],z);return R},E.rotate=function(R,z,D,L){for(var O=Math.cos(z),V=Math.sin(z),U=L?E.allBodies(R):R.bodies,W=0;W<U.length;W++){var X=U[W],Y=X.position.x-D.x,K=X.position.y-D.y;G.setPosition(X,{x:D.x+(Y*O-K*V),y:D.y+(Y*V+K*O)}),G.rotate(X,z)}return R},E.scale=function(R,z,D,L,O){for(var V=O?E.allBodies(R):R.bodies,U=0;U<V.length;U++){var W=V[U],X=W.position.x-L.x,Y=W.position.y-L.y;G.setPosition(W,{x:L.x+X*z,y:L.y+Y*D}),G.scale(W,z,D)}return R},E.bounds=function(R){for(var z=E.allBodies(R),D=[],L=0;L<z.length;L+=1){var O=z[L];D.push(O.bounds.min,O.bounds.max)}return B.create(D)}})()},function(C,A,T){var E={};C.exports=E;var I=T(4),F=T(5),B=T(0);(function(){E._motionWakeThreshold=.18,E._motionSleepThreshold=.08,E._minBias=.9,E.update=function(G,R){for(var z=R/B._baseDelta,D=E._motionSleepThreshold,L=0;L<G.length;L++){var O=G[L],V=I.getSpeed(O),U=I.getAngularSpeed(O),W=V*V+U*U;if(O.force.x!==0||O.force.y!==0){E.set(O,!1);continue}var X=Math.min(O.motion,W),Y=Math.max(O.motion,W);O.motion=E._minBias*X+(1-E._minBias)*Y,O.sleepThreshold>0&&O.motion<D?(O.sleepCounter+=1,O.sleepCounter>=O.sleepThreshold/z&&E.set(O,!0)):O.sleepCounter>0&&(O.sleepCounter-=1)}},E.afterCollisions=function(G){for(var R=E._motionSleepThreshold,z=0;z<G.length;z++){var D=G[z];if(D.isActive){var L=D.collision,O=L.bodyA.parent,V=L.bodyB.parent;if(!(O.isSleeping&&V.isSleeping||O.isStatic||V.isStatic)&&(O.isSleeping||V.isSleeping)){var U=O.isSleeping&&!O.isStatic?O:V,W=U===O?V:O;!U.isStatic&&W.motion>R&&E.set(U,!1)}}}},E.set=function(G,R){var z=G.isSleeping;R?(G.isSleeping=!0,G.sleepCounter=G.sleepThreshold,G.positionImpulse.x=0,G.positionImpulse.y=0,G.positionPrev.x=G.position.x,G.positionPrev.y=G.position.y,G.anglePrev=G.angle,G.speed=0,G.angularSpeed=0,G.motion=0,z||F.trigger(G,"sleepStart")):(G.isSleeping=!1,G.sleepCounter=0,z&&F.trigger(G,"sleepEnd"))}})()},function(C,A,T){var E={};C.exports=E;var I=T(3),F=T(9);(function(){var B=[],G={overlap:0,axis:null},R={overlap:0,axis:null};E.create=function(z,D){return{pair:null,collided:!1,bodyA:z,bodyB:D,parentA:z.parent,parentB:D.parent,depth:0,normal:{x:0,y:0},tangent:{x:0,y:0},penetration:{x:0,y:0},supports:[null,null],supportCount:0}},E.collides=function(z,D,L){if(E._overlapAxes(G,z.vertices,D.vertices,z.axes),G.overlap<=0||(E._overlapAxes(R,D.vertices,z.vertices,D.axes),R.overlap<=0))return null;var O=L&&L.table[F.id(z,D)],V;O?V=O.collision:(V=E.create(z,D),V.collided=!0,V.bodyA=z.id<D.id?z:D,V.bodyB=z.id<D.id?D:z,V.parentA=V.bodyA.parent,V.parentB=V.bodyB.parent),z=V.bodyA,D=V.bodyB;var U;G.overlap<R.overlap?U=G:U=R;var W=V.normal,X=V.tangent,Y=V.penetration,K=V.supports,q=U.overlap,J=U.axis,tt=J.x,rt=J.y,st=D.position.x-z.position.x,nt=D.position.y-z.position.y;tt*st+rt*nt>=0&&(tt=-tt,rt=-rt),W.x=tt,W.y=rt,X.x=-rt,X.y=tt,Y.x=tt*q,Y.y=rt*q,V.depth=q;var at=E._findSupports(z,D,W,1),ot=0;if(I.contains(z.vertices,at[0])&&(K[ot++]=at[0]),I.contains(z.vertices,at[1])&&(K[ot++]=at[1]),ot<2){var ct=E._findSupports(D,z,W,-1);I.contains(D.vertices,ct[0])&&(K[ot++]=ct[0]),ot<2&&I.contains(D.vertices,ct[1])&&(K[ot++]=ct[1])}return ot===0&&(K[ot++]=at[0]),V.supportCount=ot,V},E._overlapAxes=function(z,D,L,O){var V=D.length,U=L.length,W=D[0].x,X=D[0].y,Y=L[0].x,K=L[0].y,q=O.length,J=Number.MAX_VALUE,tt=0,rt,st,nt,at,ot,ct;for(ot=0;ot<q;ot++){var dt=O[ot],ut=dt.x,Q=dt.y,it=W*ut+X*Q,Z=Y*ut+K*Q,et=it,ht=Z;for(ct=1;ct<V;ct+=1)at=D[ct].x*ut+D[ct].y*Q,at>et?et=at:at<it&&(it=at);for(ct=1;ct<U;ct+=1)at=L[ct].x*ut+L[ct].y*Q,at>ht?ht=at:at<Z&&(Z=at);if(st=et-Z,nt=ht-it,rt=st<nt?st:nt,rt<J&&(J=rt,tt=ot,rt<=0))break}z.axis=O[tt],z.overlap=J},E._findSupports=function(z,D,L,O){var V=D.vertices,U=V.length,W=z.position.x,X=z.position.y,Y=L.x*O,K=L.y*O,q=V[0],J=q,tt=Y*(W-J.x)+K*(X-J.y),rt,st,nt;for(nt=1;nt<U;nt+=1)J=V[nt],st=Y*(W-J.x)+K*(X-J.y),st<tt&&(tt=st,q=J);return rt=V[(U+q.index-1)%U],tt=Y*(W-rt.x)+K*(X-rt.y),J=V[(q.index+1)%U],Y*(W-J.x)+K*(X-J.y)<tt?(B[0]=q,B[1]=J,B):(B[0]=q,B[1]=rt,B)}})()},function(C,A,T){var E={};C.exports=E;var I=T(16);(function(){E.create=function(F,B){var G=F.bodyA,R=F.bodyB,z={id:E.id(G,R),bodyA:G,bodyB:R,collision:F,contacts:[I.create(),I.create()],contactCount:0,separation:0,isActive:!0,isSensor:G.isSensor||R.isSensor,timeCreated:B,timeUpdated:B,inverseMass:0,friction:0,frictionStatic:0,restitution:0,slop:0};return E.update(z,F,B),z},E.update=function(F,B,G){var R=B.supports,z=B.supportCount,D=F.contacts,L=B.parentA,O=B.parentB;F.isActive=!0,F.timeUpdated=G,F.collision=B,F.separation=B.depth,F.inverseMass=L.inverseMass+O.inverseMass,F.friction=L.friction<O.friction?L.friction:O.friction,F.frictionStatic=L.frictionStatic>O.frictionStatic?L.frictionStatic:O.frictionStatic,F.restitution=L.restitution>O.restitution?L.restitution:O.restitution,F.slop=L.slop>O.slop?L.slop:O.slop,F.contactCount=z,B.pair=F;var V=R[0],U=D[0],W=R[1],X=D[1];(X.vertex===V||U.vertex===W)&&(D[1]=U,D[0]=U=X,X=D[1]),U.vertex=V,X.vertex=W},E.setActive=function(F,B,G){B?(F.isActive=!0,F.timeUpdated=G):(F.isActive=!1,F.contactCount=0)},E.id=function(F,B){return F.id<B.id?F.id.toString(36)+":"+B.id.toString(36):B.id.toString(36)+":"+F.id.toString(36)}})()},function(C,A,T){var E={};C.exports=E;var I=T(3),F=T(2),B=T(7),G=T(1),R=T(11),z=T(0);(function(){E._warming=.4,E._torqueDampen=1,E._minLength=1e-6,E.create=function(D){var L=D;L.bodyA&&!L.pointA&&(L.pointA={x:0,y:0}),L.bodyB&&!L.pointB&&(L.pointB={x:0,y:0});var O=L.bodyA?F.add(L.bodyA.position,L.pointA):L.pointA,V=L.bodyB?F.add(L.bodyB.position,L.pointB):L.pointB,U=F.magnitude(F.sub(O,V));L.length=typeof L.length<"u"?L.length:U,L.id=L.id||z.nextId(),L.label=L.label||"Constraint",L.type="constraint",L.stiffness=L.stiffness||(L.length>0?1:.7),L.damping=L.damping||0,L.angularStiffness=L.angularStiffness||0,L.angleA=L.bodyA?L.bodyA.angle:L.angleA,L.angleB=L.bodyB?L.bodyB.angle:L.angleB,L.plugin={};var W={visible:!0,lineWidth:2,strokeStyle:"#ffffff",type:"line",anchors:!0};return L.length===0&&L.stiffness>.1?(W.type="pin",W.anchors=!1):L.stiffness<.9&&(W.type="spring"),L.render=z.extend(W,L.render),L},E.preSolveAll=function(D){for(var L=0;L<D.length;L+=1){var O=D[L],V=O.constraintImpulse;O.isStatic||V.x===0&&V.y===0&&V.angle===0||(O.position.x+=V.x,O.position.y+=V.y,O.angle+=V.angle)}},E.solveAll=function(D,L){for(var O=z.clamp(L/z._baseDelta,0,1),V=0;V<D.length;V+=1){var U=D[V],W=!U.bodyA||U.bodyA&&U.bodyA.isStatic,X=!U.bodyB||U.bodyB&&U.bodyB.isStatic;(W||X)&&E.solve(D[V],O)}for(V=0;V<D.length;V+=1)U=D[V],W=!U.bodyA||U.bodyA&&U.bodyA.isStatic,X=!U.bodyB||U.bodyB&&U.bodyB.isStatic,!W&&!X&&E.solve(D[V],O)},E.solve=function(D,L){var O=D.bodyA,V=D.bodyB,U=D.pointA,W=D.pointB;if(!(!O&&!V)){O&&!O.isStatic&&(F.rotate(U,O.angle-D.angleA,U),D.angleA=O.angle),V&&!V.isStatic&&(F.rotate(W,V.angle-D.angleB,W),D.angleB=V.angle);var X=U,Y=W;if(O&&(X=F.add(O.position,U)),V&&(Y=F.add(V.position,W)),!(!X||!Y)){var K=F.sub(X,Y),q=F.magnitude(K);q<E._minLength&&(q=E._minLength);var J=(q-D.length)/q,tt=D.stiffness>=1||D.length===0,rt=tt?D.stiffness*L:D.stiffness*L*L,st=D.damping*L,nt=F.mult(K,J*rt),at=(O?O.inverseMass:0)+(V?V.inverseMass:0),ot=(O?O.inverseInertia:0)+(V?V.inverseInertia:0),ct=at+ot,dt,ut,Q,it,Z;if(st>0){var et=F.create();Q=F.div(K,q),Z=F.sub(V&&F.sub(V.position,V.positionPrev)||et,O&&F.sub(O.position,O.positionPrev)||et),it=F.dot(Q,Z)}O&&!O.isStatic&&(ut=O.inverseMass/at,O.constraintImpulse.x-=nt.x*ut,O.constraintImpulse.y-=nt.y*ut,O.position.x-=nt.x*ut,O.position.y-=nt.y*ut,st>0&&(O.positionPrev.x-=st*Q.x*it*ut,O.positionPrev.y-=st*Q.y*it*ut),dt=F.cross(U,nt)/ct*E._torqueDampen*O.inverseInertia*(1-D.angularStiffness),O.constraintImpulse.angle-=dt,O.angle-=dt),V&&!V.isStatic&&(ut=V.inverseMass/at,V.constraintImpulse.x+=nt.x*ut,V.constraintImpulse.y+=nt.y*ut,V.position.x+=nt.x*ut,V.position.y+=nt.y*ut,st>0&&(V.positionPrev.x+=st*Q.x*it*ut,V.positionPrev.y+=st*Q.y*it*ut),dt=F.cross(W,nt)/ct*E._torqueDampen*V.inverseInertia*(1-D.angularStiffness),V.constraintImpulse.angle+=dt,V.angle+=dt)}}},E.postSolveAll=function(D){for(var L=0;L<D.length;L++){var O=D[L],V=O.constraintImpulse;if(!(O.isStatic||V.x===0&&V.y===0&&V.angle===0)){B.set(O,!1);for(var U=0;U<O.parts.length;U++){var W=O.parts[U];I.translate(W.vertices,V),U>0&&(W.position.x+=V.x,W.position.y+=V.y),V.angle!==0&&(I.rotate(W.vertices,V.angle,O.position),R.rotate(W.axes,V.angle),U>0&&F.rotateAbout(W.position,V.angle,O.position,W.position)),G.update(W.bounds,W.vertices,O.velocity)}V.angle*=E._warming,V.x*=E._warming,V.y*=E._warming}}},E.pointAWorld=function(D){return{x:(D.bodyA?D.bodyA.position.x:0)+(D.pointA?D.pointA.x:0),y:(D.bodyA?D.bodyA.position.y:0)+(D.pointA?D.pointA.y:0)}},E.pointBWorld=function(D){return{x:(D.bodyB?D.bodyB.position.x:0)+(D.pointB?D.pointB.x:0),y:(D.bodyB?D.bodyB.position.y:0)+(D.pointB?D.pointB.y:0)}},E.currentLength=function(D){var L=(D.bodyA?D.bodyA.position.x:0)+(D.pointA?D.pointA.x:0),O=(D.bodyA?D.bodyA.position.y:0)+(D.pointA?D.pointA.y:0),V=(D.bodyB?D.bodyB.position.x:0)+(D.pointB?D.pointB.x:0),U=(D.bodyB?D.bodyB.position.y:0)+(D.pointB?D.pointB.y:0),W=L-V,X=O-U;return Math.sqrt(W*W+X*X)}})()},function(C,A,T){var E={};C.exports=E;var I=T(2),F=T(0);(function(){E.fromVertices=function(B){for(var G={},R=0;R<B.length;R++){var z=(R+1)%B.length,D=I.normalise({x:B[z].y-B[R].y,y:B[R].x-B[z].x}),L=D.y===0?1/0:D.x/D.y;L=L.toFixed(3).toString(),G[L]=D}return F.values(G)},E.rotate=function(B,G){if(G!==0)for(var R=Math.cos(G),z=Math.sin(G),D=0;D<B.length;D++){var L=B[D],O;O=L.x*R-L.y*z,L.y=L.x*z+L.y*R,L.x=O}}})()},function(C,A,T){var E={};C.exports=E;var I=T(3),F=T(0),B=T(4),G=T(1),R=T(2);(function(){E.rectangle=function(z,D,L,O,V){V=V||{};var U={label:"Rectangle Body",position:{x:z,y:D},vertices:I.fromPath("L 0 0 L "+L+" 0 L "+L+" "+O+" L 0 "+O)};if(V.chamfer){var W=V.chamfer;U.vertices=I.chamfer(U.vertices,W.radius,W.quality,W.qualityMin,W.qualityMax),delete V.chamfer}return B.create(F.extend({},U,V))},E.trapezoid=function(z,D,L,O,V,U){U=U||{},V>=1&&F.warn("Bodies.trapezoid: slope parameter must be < 1."),V*=.5;var W=(1-V*2)*L,X=L*V,Y=X+W,K=Y+X,q;V<.5?q="L 0 0 L "+X+" "+-O+" L "+Y+" "+-O+" L "+K+" 0":q="L 0 0 L "+Y+" "+-O+" L "+K+" 0";var J={label:"Trapezoid Body",position:{x:z,y:D},vertices:I.fromPath(q)};if(U.chamfer){var tt=U.chamfer;J.vertices=I.chamfer(J.vertices,tt.radius,tt.quality,tt.qualityMin,tt.qualityMax),delete U.chamfer}return B.create(F.extend({},J,U))},E.circle=function(z,D,L,O,V){O=O||{};var U={label:"Circle Body",circleRadius:L};V=V||25;var W=Math.ceil(Math.max(10,Math.min(V,L)));return W%2===1&&(W+=1),E.polygon(z,D,W,L,F.extend({},U,O))},E.polygon=function(z,D,L,O,V){if(V=V||{},L<3)return E.circle(z,D,O,V);for(var U=2*Math.PI/L,W="",X=U*.5,Y=0;Y<L;Y+=1){var K=X+Y*U,q=Math.cos(K)*O,J=Math.sin(K)*O;W+="L "+q.toFixed(3)+" "+J.toFixed(3)+" "}var tt={label:"Polygon Body",position:{x:z,y:D},vertices:I.fromPath(W)};if(V.chamfer){var rt=V.chamfer;tt.vertices=I.chamfer(tt.vertices,rt.radius,rt.quality,rt.qualityMin,rt.qualityMax),delete V.chamfer}return B.create(F.extend({},tt,V))},E.fromVertices=function(z,D,L,O,V,U,W,X){var Y=F.getDecomp(),K,q,J,tt,rt,st,nt,at,ot,ct,dt;for(K=!!(Y&&Y.quickDecomp),O=O||{},J=[],V=typeof V<"u"?V:!1,U=typeof U<"u"?U:.01,W=typeof W<"u"?W:10,X=typeof X<"u"?X:.01,F.isArray(L[0])||(L=[L]),ct=0;ct<L.length;ct+=1)if(st=L[ct],tt=I.isConvex(st),rt=!tt,rt&&!K&&F.warnOnce("Bodies.fromVertices: Install the 'poly-decomp' library and use Common.setDecomp or provide 'decomp' as a global to decompose concave vertices."),tt||!K)tt?st=I.clockwiseSort(st):st=I.hull(st),J.push({position:{x:z,y:D},vertices:st});else{var ut=st.map(function(yt){return[yt.x,yt.y]});Y.makeCCW(ut),U!==!1&&Y.removeCollinearPoints(ut,U),X!==!1&&Y.removeDuplicatePoints&&Y.removeDuplicatePoints(ut,X);var Q=Y.quickDecomp(ut);for(nt=0;nt<Q.length;nt++){var it=Q[nt],Z=it.map(function(yt){return{x:yt[0],y:yt[1]}});W>0&&I.area(Z)<W||J.push({position:I.centre(Z),vertices:Z})}}for(nt=0;nt<J.length;nt++)J[nt]=B.create(F.extend(J[nt],O));if(V){var et=5;for(nt=0;nt<J.length;nt++){var ht=J[nt];for(at=nt+1;at<J.length;at++){var lt=J[at];if(G.overlaps(ht.bounds,lt.bounds)){var ft=ht.vertices,pt=lt.vertices;for(ot=0;ot<ht.vertices.length;ot++)for(dt=0;dt<lt.vertices.length;dt++){var mt=R.magnitudeSquared(R.sub(ft[(ot+1)%ft.length],pt[dt])),gt=R.magnitudeSquared(R.sub(ft[ot],pt[(dt+1)%pt.length]));mt<et&&gt<et&&(ft[ot].isInternal=!0,pt[dt].isInternal=!0)}}}}}return J.length>1?(q=B.create(F.extend({parts:J.slice(0)},O)),B.setPosition(q,{x:z,y:D}),q):J[0]}})()},function(C,A,T){var E={};C.exports=E;var I=T(0),F=T(8);(function(){E.create=function(B){var G={bodies:[],collisions:[],pairs:null};return I.extend(G,B)},E.setBodies=function(B,G){B.bodies=G.slice(0)},E.clear=function(B){B.bodies=[],B.collisions=[]},E.collisions=function(B){var G=B.pairs,R=B.bodies,z=R.length,D=E.canCollide,L=F.collides,O=B.collisions,V=0,U,W;for(R.sort(E._compareBoundsX),U=0;U<z;U++){var X=R[U],Y=X.bounds,K=X.bounds.max.x,q=X.bounds.max.y,J=X.bounds.min.y,tt=X.isStatic||X.isSleeping,rt=X.parts.length,st=rt===1;for(W=U+1;W<z;W++){var nt=R[W],at=nt.bounds;if(at.min.x>K)break;if(!(q<at.min.y||J>at.max.y)&&!(tt&&(nt.isStatic||nt.isSleeping))&&D(X.collisionFilter,nt.collisionFilter)){var ot=nt.parts.length;if(st&&ot===1){var ct=L(X,nt,G);ct&&(O[V++]=ct)}else for(var dt=rt>1?1:0,ut=ot>1?1:0,Q=dt;Q<rt;Q++)for(var it=X.parts[Q],Y=it.bounds,Z=ut;Z<ot;Z++){var et=nt.parts[Z],at=et.bounds;if(!(Y.min.x>at.max.x||Y.max.x<at.min.x||Y.max.y<at.min.y||Y.min.y>at.max.y)){var ct=L(it,et,G);ct&&(O[V++]=ct)}}}}}return O.length!==V&&(O.length=V),O},E.canCollide=function(B,G){return B.group===G.group&&B.group!==0?B.group>0:(B.mask&G.category)!==0&&(G.mask&B.category)!==0},E._compareBoundsX=function(B,G){return B.bounds.min.x-G.bounds.min.x}})()},function(C,A,T){var E={};C.exports=E;var I=T(0);(function(){E.create=function(F){var B={};return F||I.log("Mouse.create: element was undefined, defaulting to document.body","warn"),B.element=F||document.body,B.absolute={x:0,y:0},B.position={x:0,y:0},B.mousedownPosition={x:0,y:0},B.mouseupPosition={x:0,y:0},B.offset={x:0,y:0},B.scale={x:1,y:1},B.wheelDelta=0,B.button=-1,B.pixelRatio=parseInt(B.element.getAttribute("data-pixel-ratio"),10)||1,B.sourceEvents={mousemove:null,mousedown:null,mouseup:null,mousewheel:null},B.mousemove=function(G){var R=E._getRelativeMousePosition(G,B.element,B.pixelRatio),z=G.changedTouches;z&&(B.button=0,G.preventDefault()),B.absolute.x=R.x,B.absolute.y=R.y,B.position.x=B.absolute.x*B.scale.x+B.offset.x,B.position.y=B.absolute.y*B.scale.y+B.offset.y,B.sourceEvents.mousemove=G},B.mousedown=function(G){var R=E._getRelativeMousePosition(G,B.element,B.pixelRatio),z=G.changedTouches;z?(B.button=0,G.preventDefault()):B.button=G.button,B.absolute.x=R.x,B.absolute.y=R.y,B.position.x=B.absolute.x*B.scale.x+B.offset.x,B.position.y=B.absolute.y*B.scale.y+B.offset.y,B.mousedownPosition.x=B.position.x,B.mousedownPosition.y=B.position.y,B.sourceEvents.mousedown=G},B.mouseup=function(G){var R=E._getRelativeMousePosition(G,B.element,B.pixelRatio),z=G.changedTouches;z&&G.preventDefault(),B.button=-1,B.absolute.x=R.x,B.absolute.y=R.y,B.position.x=B.absolute.x*B.scale.x+B.offset.x,B.position.y=B.absolute.y*B.scale.y+B.offset.y,B.mouseupPosition.x=B.position.x,B.mouseupPosition.y=B.position.y,B.sourceEvents.mouseup=G},B.mousewheel=function(G){B.wheelDelta=Math.max(-1,Math.min(1,G.wheelDelta||-G.detail)),G.preventDefault(),B.sourceEvents.mousewheel=G},E.setElement(B,B.element),B},E.setElement=function(F,B){F.element=B,B.addEventListener("mousemove",F.mousemove,{passive:!0}),B.addEventListener("mousedown",F.mousedown,{passive:!0}),B.addEventListener("mouseup",F.mouseup,{passive:!0}),B.addEventListener("wheel",F.mousewheel,{passive:!1}),B.addEventListener("touchmove",F.mousemove,{passive:!1}),B.addEventListener("touchstart",F.mousedown,{passive:!1}),B.addEventListener("touchend",F.mouseup,{passive:!1})},E.clearSourceEvents=function(F){F.sourceEvents.mousemove=null,F.sourceEvents.mousedown=null,F.sourceEvents.mouseup=null,F.sourceEvents.mousewheel=null,F.wheelDelta=0},E.setOffset=function(F,B){F.offset.x=B.x,F.offset.y=B.y,F.position.x=F.absolute.x*F.scale.x+F.offset.x,F.position.y=F.absolute.y*F.scale.y+F.offset.y},E.setScale=function(F,B){F.scale.x=B.x,F.scale.y=B.y,F.position.x=F.absolute.x*F.scale.x+F.offset.x,F.position.y=F.absolute.y*F.scale.y+F.offset.y},E._getRelativeMousePosition=function(F,B,G){var R=B.getBoundingClientRect(),z=document.documentElement||document.body.parentNode||document.body,D=window.pageXOffset!==void 0?window.pageXOffset:z.scrollLeft,L=window.pageYOffset!==void 0?window.pageYOffset:z.scrollTop,O=F.changedTouches,V,U;return O?(V=O[0].pageX-R.left-D,U=O[0].pageY-R.top-L):(V=F.pageX-R.left-D,U=F.pageY-R.top-L),{x:V/(B.clientWidth/(B.width||B.clientWidth)*G),y:U/(B.clientHeight/(B.height||B.clientHeight)*G)}}})()},function(C,A,T){var E={};C.exports=E;var I=T(0);(function(){E._registry={},E.register=function(F){if(E.isPlugin(F)||I.warn("Plugin.register:",E.toString(F),"does not implement all required fields."),F.name in E._registry){var B=E._registry[F.name],G=E.versionParse(F.version).number,R=E.versionParse(B.version).number;G>R?(I.warn("Plugin.register:",E.toString(B),"was upgraded to",E.toString(F)),E._registry[F.name]=F):G<R?I.warn("Plugin.register:",E.toString(B),"can not be downgraded to",E.toString(F)):F!==B&&I.warn("Plugin.register:",E.toString(F),"is already registered to different plugin object")}else E._registry[F.name]=F;return F},E.resolve=function(F){return E._registry[E.dependencyParse(F).name]},E.toString=function(F){return typeof F=="string"?F:(F.name||"anonymous")+"@"+(F.version||F.range||"0.0.0")},E.isPlugin=function(F){return F&&F.name&&F.version&&F.install},E.isUsed=function(F,B){return F.used.indexOf(B)>-1},E.isFor=function(F,B){var G=F.for&&E.dependencyParse(F.for);return!F.for||B.name===G.name&&E.versionSatisfies(B.version,G.range)},E.use=function(F,B){if(F.uses=(F.uses||[]).concat(B||[]),F.uses.length===0){I.warn("Plugin.use:",E.toString(F),"does not specify any dependencies to install.");return}for(var G=E.dependencies(F),R=I.topologicalSort(G),z=[],D=0;D<R.length;D+=1)if(R[D]!==F.name){var L=E.resolve(R[D]);if(!L){z.push(" "+R[D]);continue}E.isUsed(F,L.name)||(E.isFor(L,F)||(I.warn("Plugin.use:",E.toString(L),"is for",L.for,"but installed on",E.toString(F)+"."),L._warned=!0),L.install?L.install(F):(I.warn("Plugin.use:",E.toString(L),"does not specify an install function."),L._warned=!0),L._warned?(z.push(" "+E.toString(L)),delete L._warned):z.push(" "+E.toString(L)),F.used.push(L.name))}z.length>0&&I.info(z.join("  "))},E.dependencies=function(F,B){var G=E.dependencyParse(F),R=G.name;if(B=B||{},!(R in B)){F=E.resolve(F)||F,B[R]=I.map(F.uses||[],function(D){E.isPlugin(D)&&E.register(D);var L=E.dependencyParse(D),O=E.resolve(D);return O&&!E.versionSatisfies(O.version,L.range)?(I.warn("Plugin.dependencies:",E.toString(O),"does not satisfy",E.toString(L),"used by",E.toString(G)+"."),O._warned=!0,F._warned=!0):O||(I.warn("Plugin.dependencies:",E.toString(D),"used by",E.toString(G),"could not be resolved."),F._warned=!0),L.name});for(var z=0;z<B[R].length;z+=1)E.dependencies(B[R][z],B);return B}},E.dependencyParse=function(F){if(I.isString(F)){var B=/^[\w-]+(@(\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-+]+)?))?$/;return B.test(F)||I.warn("Plugin.dependencyParse:",F,"is not a valid dependency string."),{name:F.split("@")[0],range:F.split("@")[1]||"*"}}return{name:F.name,range:F.range||F.version}},E.versionParse=function(F){var B=/^(\*)|(\^|~|>=|>)?\s*((\d+)\.(\d+)\.(\d+))(-[0-9A-Za-z-+]+)?$/;B.test(F)||I.warn("Plugin.versionParse:",F,"is not a valid version or range.");var G=B.exec(F),R=Number(G[4]),z=Number(G[5]),D=Number(G[6]);return{isRange:!!(G[1]||G[2]),version:G[3],range:F,operator:G[1]||G[2]||"",major:R,minor:z,patch:D,parts:[R,z,D],prerelease:G[7],number:R*1e8+z*1e4+D}},E.versionSatisfies=function(F,B){B=B||"*";var G=E.versionParse(B),R=E.versionParse(F);if(G.isRange){if(G.operator==="*"||F==="*")return!0;if(G.operator===">")return R.number>G.number;if(G.operator===">=")return R.number>=G.number;if(G.operator==="~")return R.major===G.major&&R.minor===G.minor&&R.patch>=G.patch;if(G.operator==="^")return G.major>0?R.major===G.major&&R.number>=G.number:G.minor>0?R.minor===G.minor&&R.patch>=G.patch:R.patch===G.patch}return F===B||F==="*"}})()},function(C,A){var T={};C.exports=T,function(){T.create=function(E){return{vertex:E,normalImpulse:0,tangentImpulse:0}}}()},function(C,A,T){var E={};C.exports=E;var I=T(7),F=T(18),B=T(13),G=T(19),R=T(5),z=T(6),D=T(10),L=T(0),O=T(4);(function(){E._deltaMax=1e3/60,E.create=function(V){V=V||{};var U={positionIterations:6,velocityIterations:4,constraintIterations:2,enableSleeping:!1,events:[],plugin:{},gravity:{x:0,y:1,scale:.001},timing:{timestamp:0,timeScale:1,lastDelta:0,lastElapsed:0,lastUpdatesPerFrame:0}},W=L.extend(U,V);return W.world=V.world||z.create({label:"World"}),W.pairs=V.pairs||G.create(),W.detector=V.detector||B.create(),W.detector.pairs=W.pairs,W.grid={buckets:[]},W.world.gravity=W.gravity,W.broadphase=W.grid,W.metrics={},W},E.update=function(V,U){var W=L.now(),X=V.world,Y=V.detector,K=V.pairs,q=V.timing,J=q.timestamp,tt;U>E._deltaMax&&L.warnOnce("Matter.Engine.update: delta argument is recommended to be less than or equal to",E._deltaMax.toFixed(3),"ms."),U=typeof U<"u"?U:L._baseDelta,U*=q.timeScale,q.timestamp+=U,q.lastDelta=U;var rt={timestamp:q.timestamp,delta:U};R.trigger(V,"beforeUpdate",rt);var st=z.allBodies(X),nt=z.allConstraints(X);for(X.isModified&&(B.setBodies(Y,st),z.setModified(X,!1,!1,!0)),V.enableSleeping&&I.update(st,U),E._bodiesApplyGravity(st,V.gravity),U>0&&E._bodiesUpdate(st,U),R.trigger(V,"beforeSolve",rt),D.preSolveAll(st),tt=0;tt<V.constraintIterations;tt++)D.solveAll(nt,U);D.postSolveAll(st);var at=B.collisions(Y);G.update(K,at,J),V.enableSleeping&&I.afterCollisions(K.list),K.collisionStart.length>0&&R.trigger(V,"collisionStart",{pairs:K.collisionStart,timestamp:q.timestamp,delta:U});var ot=L.clamp(20/V.positionIterations,0,1);for(F.preSolvePosition(K.list),tt=0;tt<V.positionIterations;tt++)F.solvePosition(K.list,U,ot);for(F.postSolvePosition(st),D.preSolveAll(st),tt=0;tt<V.constraintIterations;tt++)D.solveAll(nt,U);for(D.postSolveAll(st),F.preSolveVelocity(K.list),tt=0;tt<V.velocityIterations;tt++)F.solveVelocity(K.list,U);return E._bodiesUpdateVelocities(st),K.collisionActive.length>0&&R.trigger(V,"collisionActive",{pairs:K.collisionActive,timestamp:q.timestamp,delta:U}),K.collisionEnd.length>0&&R.trigger(V,"collisionEnd",{pairs:K.collisionEnd,timestamp:q.timestamp,delta:U}),E._bodiesClearForces(st),R.trigger(V,"afterUpdate",rt),V.timing.lastElapsed=L.now()-W,V},E.merge=function(V,U){if(L.extend(V,U),U.world){V.world=U.world,E.clear(V);for(var W=z.allBodies(V.world),X=0;X<W.length;X++){var Y=W[X];I.set(Y,!1),Y.id=L.nextId()}}},E.clear=function(V){G.clear(V.pairs),B.clear(V.detector)},E._bodiesClearForces=function(V){for(var U=V.length,W=0;W<U;W++){var X=V[W];X.force.x=0,X.force.y=0,X.torque=0}},E._bodiesApplyGravity=function(V,U){var W=typeof U.scale<"u"?U.scale:.001,X=V.length;if(!(U.x===0&&U.y===0||W===0))for(var Y=0;Y<X;Y++){var K=V[Y];K.isStatic||K.isSleeping||(K.force.y+=K.mass*U.y*W,K.force.x+=K.mass*U.x*W)}},E._bodiesUpdate=function(V,U){for(var W=V.length,X=0;X<W;X++){var Y=V[X];Y.isStatic||Y.isSleeping||O.update(Y,U)}},E._bodiesUpdateVelocities=function(V){for(var U=V.length,W=0;W<U;W++)O.updateVelocities(V[W])}})()},function(C,A,T){var E={};C.exports=E;var I=T(3),F=T(0),B=T(1);(function(){E._restingThresh=2,E._restingThreshTangent=Math.sqrt(6),E._positionDampen=.9,E._positionWarming=.8,E._frictionNormalMultiplier=5,E._frictionMaxStatic=Number.MAX_VALUE,E.preSolvePosition=function(G){var R,z,D,L=G.length;for(R=0;R<L;R++)z=G[R],z.isActive&&(D=z.contactCount,z.collision.parentA.totalContacts+=D,z.collision.parentB.totalContacts+=D)},E.solvePosition=function(G,R,z){var D,L,O,V,U,W,X,Y,K=E._positionDampen*(z||1),q=F.clamp(R/F._baseDelta,0,1),J=G.length;for(D=0;D<J;D++)L=G[D],!(!L.isActive||L.isSensor)&&(O=L.collision,V=O.parentA,U=O.parentB,W=O.normal,L.separation=O.depth+W.x*(U.positionImpulse.x-V.positionImpulse.x)+W.y*(U.positionImpulse.y-V.positionImpulse.y));for(D=0;D<J;D++)L=G[D],!(!L.isActive||L.isSensor)&&(O=L.collision,V=O.parentA,U=O.parentB,W=O.normal,Y=L.separation-L.slop*q,(V.isStatic||U.isStatic)&&(Y*=2),V.isStatic||V.isSleeping||(X=K/V.totalContacts,V.positionImpulse.x+=W.x*Y*X,V.positionImpulse.y+=W.y*Y*X),U.isStatic||U.isSleeping||(X=K/U.totalContacts,U.positionImpulse.x-=W.x*Y*X,U.positionImpulse.y-=W.y*Y*X))},E.postSolvePosition=function(G){for(var R=E._positionWarming,z=G.length,D=I.translate,L=B.update,O=0;O<z;O++){var V=G[O],U=V.positionImpulse,W=U.x,X=U.y,Y=V.velocity;if(V.totalContacts=0,W!==0||X!==0){for(var K=0;K<V.parts.length;K++){var q=V.parts[K];D(q.vertices,U),L(q.bounds,q.vertices,Y),q.position.x+=W,q.position.y+=X}V.positionPrev.x+=W,V.positionPrev.y+=X,W*Y.x+X*Y.y<0?(U.x=0,U.y=0):(U.x*=R,U.y*=R)}}},E.preSolveVelocity=function(G){var R=G.length,z,D;for(z=0;z<R;z++){var L=G[z];if(!(!L.isActive||L.isSensor)){var O=L.contacts,V=L.contactCount,U=L.collision,W=U.parentA,X=U.parentB,Y=U.normal,K=U.tangent;for(D=0;D<V;D++){var q=O[D],J=q.vertex,tt=q.normalImpulse,rt=q.tangentImpulse;if(tt!==0||rt!==0){var st=Y.x*tt+K.x*rt,nt=Y.y*tt+K.y*rt;W.isStatic||W.isSleeping||(W.positionPrev.x+=st*W.inverseMass,W.positionPrev.y+=nt*W.inverseMass,W.anglePrev+=W.inverseInertia*((J.x-W.position.x)*nt-(J.y-W.position.y)*st)),X.isStatic||X.isSleeping||(X.positionPrev.x-=st*X.inverseMass,X.positionPrev.y-=nt*X.inverseMass,X.anglePrev-=X.inverseInertia*((J.x-X.position.x)*nt-(J.y-X.position.y)*st))}}}}},E.solveVelocity=function(G,R){var z=R/F._baseDelta,D=z*z,L=D*z,O=-E._restingThresh*z,V=E._restingThreshTangent,U=E._frictionNormalMultiplier*z,W=E._frictionMaxStatic,X=G.length,Y,K,q,J;for(q=0;q<X;q++){var tt=G[q];if(!(!tt.isActive||tt.isSensor)){var rt=tt.collision,st=rt.parentA,nt=rt.parentB,at=rt.normal.x,ot=rt.normal.y,ct=rt.tangent.x,dt=rt.tangent.y,ut=tt.inverseMass,Q=tt.friction*tt.frictionStatic*U,it=tt.contacts,Z=tt.contactCount,et=1/Z,ht=st.position.x-st.positionPrev.x,lt=st.position.y-st.positionPrev.y,ft=st.angle-st.anglePrev,pt=nt.position.x-nt.positionPrev.x,mt=nt.position.y-nt.positionPrev.y,gt=nt.angle-nt.anglePrev;for(J=0;J<Z;J++){var yt=it[J],bt=yt.vertex,xt=bt.x-st.position.x,Et=bt.y-st.position.y,_t=bt.x-nt.position.x,Tt=bt.y-nt.position.y,At=ht-Et*ft,wt=lt+xt*ft,vt=pt-Tt*gt,Pt=mt+_t*gt,Ct=At-vt,Bt=wt-Pt,It=at*Ct+ot*Bt,Mt=ct*Ct+dt*Bt,Gt=tt.separation+It,kt=Math.min(Gt,1);kt=Gt<0?0:kt;var Dt=kt*Q;Mt<-Dt||Mt>Dt?(K=Mt>0?Mt:-Mt,Y=tt.friction*(Mt>0?1:-1)*L,Y<-K?Y=-K:Y>K&&(Y=K)):(Y=Mt,K=W);var Vt=xt*ot-Et*at,Rt=_t*ot-Tt*at,Ot=et/(ut+st.inverseInertia*Vt*Vt+nt.inverseInertia*Rt*Rt),Ft=(1+tt.restitution)*It*Ot;if(Y*=Ot,It<O)yt.normalImpulse=0;else{var Ht=yt.normalImpulse;yt.normalImpulse+=Ft,yt.normalImpulse>0&&(yt.normalImpulse=0),Ft=yt.normalImpulse-Ht}if(Mt<-V||Mt>V)yt.tangentImpulse=0;else{var Ut=yt.tangentImpulse;yt.tangentImpulse+=Y,yt.tangentImpulse<-K&&(yt.tangentImpulse=-K),yt.tangentImpulse>K&&(yt.tangentImpulse=K),Y=yt.tangentImpulse-Ut}var Nt=at*Ft+ct*Y,Wt=ot*Ft+dt*Y;st.isStatic||st.isSleeping||(st.positionPrev.x+=Nt*st.inverseMass,st.positionPrev.y+=Wt*st.inverseMass,st.anglePrev+=(xt*Wt-Et*Nt)*st.inverseInertia),nt.isStatic||nt.isSleeping||(nt.positionPrev.x-=Nt*nt.inverseMass,nt.positionPrev.y-=Wt*nt.inverseMass,nt.anglePrev-=(_t*Wt-Tt*Nt)*nt.inverseInertia)}}}}})()},function(C,A,T){var E={};C.exports=E;var I=T(9),F=T(0);(function(){E.create=function(B){return F.extend({table:{},list:[],collisionStart:[],collisionActive:[],collisionEnd:[]},B)},E.update=function(B,G,R){var z=I.update,D=I.create,L=I.setActive,O=B.table,V=B.list,U=V.length,W=U,X=B.collisionStart,Y=B.collisionEnd,K=B.collisionActive,q=G.length,J=0,tt=0,rt=0,st,nt,at;for(at=0;at<q;at++)st=G[at],nt=st.pair,nt?(nt.isActive&&(K[rt++]=nt),z(nt,st,R)):(nt=D(st,R),O[nt.id]=nt,X[J++]=nt,V[W++]=nt);for(W=0,U=V.length,at=0;at<U;at++)nt=V[at],nt.timeUpdated>=R?V[W++]=nt:(L(nt,!1,R),nt.collision.bodyA.sleepCounter>0&&nt.collision.bodyB.sleepCounter>0?V[W++]=nt:(Y[tt++]=nt,delete O[nt.id]));V.length!==W&&(V.length=W),X.length!==J&&(X.length=J),Y.length!==tt&&(Y.length=tt),K.length!==rt&&(K.length=rt)},E.clear=function(B){return B.table={},B.list.length=0,B.collisionStart.length=0,B.collisionActive.length=0,B.collisionEnd.length=0,B}})()},function(C,A,T){var E=C.exports=T(21);E.Axes=T(11),E.Bodies=T(12),E.Body=T(4),E.Bounds=T(1),E.Collision=T(8),E.Common=T(0),E.Composite=T(6),E.Composites=T(22),E.Constraint=T(10),E.Contact=T(16),E.Detector=T(13),E.Engine=T(17),E.Events=T(5),E.Grid=T(23),E.Mouse=T(14),E.MouseConstraint=T(24),E.Pair=T(9),E.Pairs=T(19),E.Plugin=T(15),E.Query=T(25),E.Render=T(26),E.Resolver=T(18),E.Runner=T(27),E.SAT=T(28),E.Sleeping=T(7),E.Svg=T(29),E.Vector=T(2),E.Vertices=T(3),E.World=T(30),E.Engine.run=E.Runner.run,E.Common.deprecated(E.Engine,"run","Engine.run  use Matter.Runner.run(engine) instead")},function(C,A,T){var E={};C.exports=E;var I=T(15),F=T(0);(function(){E.name="matter-js",E.version="0.20.0",E.uses=[],E.used=[],E.use=function(){I.use(E,Array.prototype.slice.call(arguments))},E.before=function(B,G){return B=B.replace(/^Matter./,""),F.chainPathBefore(E,B,G)},E.after=function(B,G){return B=B.replace(/^Matter./,""),F.chainPathAfter(E,B,G)}})()},function(C,A,T){var E={};C.exports=E;var I=T(6),F=T(10),B=T(0),G=T(4),R=T(12),z=B.deprecated;(function(){E.stack=function(D,L,O,V,U,W,X){for(var Y=I.create({label:"Stack"}),K=D,q=L,J,tt=0,rt=0;rt<V;rt++){for(var st=0,nt=0;nt<O;nt++){var at=X(K,q,nt,rt,J,tt);if(at){var ot=at.bounds.max.y-at.bounds.min.y,ct=at.bounds.max.x-at.bounds.min.x;ot>st&&(st=ot),G.translate(at,{x:ct*.5,y:ot*.5}),K=at.bounds.max.x+U,I.addBody(Y,at),J=at,tt+=1}else K+=U}q+=st+W,K=D}return Y},E.chain=function(D,L,O,V,U,W){for(var X=D.bodies,Y=1;Y<X.length;Y++){var K=X[Y-1],q=X[Y],J=K.bounds.max.y-K.bounds.min.y,tt=K.bounds.max.x-K.bounds.min.x,rt=q.bounds.max.y-q.bounds.min.y,st=q.bounds.max.x-q.bounds.min.x,nt={bodyA:K,pointA:{x:tt*L,y:J*O},bodyB:q,pointB:{x:st*V,y:rt*U}},at=B.extend(nt,W);I.addConstraint(D,F.create(at))}return D.label+=" Chain",D},E.mesh=function(D,L,O,V,U){var W=D.bodies,X,Y,K,q,J;for(X=0;X<O;X++){for(Y=1;Y<L;Y++)K=W[Y-1+X*L],q=W[Y+X*L],I.addConstraint(D,F.create(B.extend({bodyA:K,bodyB:q},U)));if(X>0)for(Y=0;Y<L;Y++)K=W[Y+(X-1)*L],q=W[Y+X*L],I.addConstraint(D,F.create(B.extend({bodyA:K,bodyB:q},U))),V&&Y>0&&(J=W[Y-1+(X-1)*L],I.addConstraint(D,F.create(B.extend({bodyA:J,bodyB:q},U)))),V&&Y<L-1&&(J=W[Y+1+(X-1)*L],I.addConstraint(D,F.create(B.extend({bodyA:J,bodyB:q},U))))}return D.label+=" Mesh",D},E.pyramid=function(D,L,O,V,U,W,X){return E.stack(D,L,O,V,U,W,function(Y,K,q,J,tt,rt){var st=Math.min(V,Math.ceil(O/2)),nt=tt?tt.bounds.max.x-tt.bounds.min.x:0;if(!(J>st)){J=st-J;var at=J,ot=O-1-J;if(!(q<at||q>ot)){rt===1&&G.translate(tt,{x:(q+(O%2===1?1:-1))*nt,y:0});var ct=tt?q*nt:0;return X(D+ct+q*U,K,q,J,tt,rt)}}})},E.newtonsCradle=function(D,L,O,V,U){for(var W=I.create({label:"Newtons Cradle"}),X=0;X<O;X++){var Y=1.9,K=R.circle(D+X*(V*Y),L+U,V,{inertia:1/0,restitution:1,friction:0,frictionAir:1e-4,slop:1}),q=F.create({pointA:{x:D+X*(V*Y),y:L},bodyB:K});I.addBody(W,K),I.addConstraint(W,q)}return W},z(E,"newtonsCradle","Composites.newtonsCradle  moved to newtonsCradle example"),E.car=function(D,L,O,V,U){var W=G.nextGroup(!0),X=20,Y=-O*.5+X,K=O*.5-X,q=0,J=I.create({label:"Car"}),tt=R.rectangle(D,L,O,V,{collisionFilter:{group:W},chamfer:{radius:V*.5},density:2e-4}),rt=R.circle(D+Y,L+q,U,{collisionFilter:{group:W},friction:.8}),st=R.circle(D+K,L+q,U,{collisionFilter:{group:W},friction:.8}),nt=F.create({bodyB:tt,pointB:{x:Y,y:q},bodyA:rt,stiffness:1,length:0}),at=F.create({bodyB:tt,pointB:{x:K,y:q},bodyA:st,stiffness:1,length:0});return I.addBody(J,tt),I.addBody(J,rt),I.addBody(J,st),I.addConstraint(J,nt),I.addConstraint(J,at),J},z(E,"car","Composites.car  moved to car example"),E.softBody=function(D,L,O,V,U,W,X,Y,K,q){K=B.extend({inertia:1/0},K),q=B.extend({stiffness:.2,render:{type:"line",anchors:!1}},q);var J=E.stack(D,L,O,V,U,W,function(tt,rt){return R.circle(tt,rt,Y,K)});return E.mesh(J,O,V,X,q),J.label="Soft Body",J},z(E,"softBody","Composites.softBody  moved to softBody and cloth examples")})()},function(C,A,T){var E={};C.exports=E;var I=T(9),F=T(0),B=F.deprecated;(function(){E.create=function(G){var R={buckets:{},pairs:{},pairsList:[],bucketWidth:48,bucketHeight:48};return F.extend(R,G)},E.update=function(G,R,z,D){var L,O,V,U=z.world,W=G.buckets,X,Y,K=!1;for(L=0;L<R.length;L++){var q=R[L];if(!(q.isSleeping&&!D)&&!(U.bounds&&(q.bounds.max.x<U.bounds.min.x||q.bounds.min.x>U.bounds.max.x||q.bounds.max.y<U.bounds.min.y||q.bounds.min.y>U.bounds.max.y))){var J=E._getRegion(G,q);if(!q.region||J.id!==q.region.id||D){(!q.region||D)&&(q.region=J);var tt=E._regionUnion(J,q.region);for(O=tt.startCol;O<=tt.endCol;O++)for(V=tt.startRow;V<=tt.endRow;V++){Y=E._getBucketId(O,V),X=W[Y];var rt=O>=J.startCol&&O<=J.endCol&&V>=J.startRow&&V<=J.endRow,st=O>=q.region.startCol&&O<=q.region.endCol&&V>=q.region.startRow&&V<=q.region.endRow;!rt&&st&&st&&X&&E._bucketRemoveBody(G,X,q),(q.region===J||rt&&!st||D)&&(X||(X=E._createBucket(W,Y)),E._bucketAddBody(G,X,q))}q.region=J,K=!0}}}K&&(G.pairsList=E._createActivePairsList(G))},B(E,"update","Grid.update  replaced by Matter.Detector"),E.clear=function(G){G.buckets={},G.pairs={},G.pairsList=[]},B(E,"clear","Grid.clear  replaced by Matter.Detector"),E._regionUnion=function(G,R){var z=Math.min(G.startCol,R.startCol),D=Math.max(G.endCol,R.endCol),L=Math.min(G.startRow,R.startRow),O=Math.max(G.endRow,R.endRow);return E._createRegion(z,D,L,O)},E._getRegion=function(G,R){var z=R.bounds,D=Math.floor(z.min.x/G.bucketWidth),L=Math.floor(z.max.x/G.bucketWidth),O=Math.floor(z.min.y/G.bucketHeight),V=Math.floor(z.max.y/G.bucketHeight);return E._createRegion(D,L,O,V)},E._createRegion=function(G,R,z,D){return{id:G+","+R+","+z+","+D,startCol:G,endCol:R,startRow:z,endRow:D}},E._getBucketId=function(G,R){return"C"+G+"R"+R},E._createBucket=function(G,R){var z=G[R]=[];return z},E._bucketAddBody=function(G,R,z){var D=G.pairs,L=I.id,O=R.length,V;for(V=0;V<O;V++){var U=R[V];if(!(z.id===U.id||z.isStatic&&U.isStatic)){var W=L(z,U),X=D[W];X?X[2]+=1:D[W]=[z,U,1]}}R.push(z)},E._bucketRemoveBody=function(G,R,z){var D=G.pairs,L=I.id,O;R.splice(F.indexOf(R,z),1);var V=R.length;for(O=0;O<V;O++){var U=D[L(z,R[O])];U&&(U[2]-=1)}},E._createActivePairsList=function(G){var R,z=G.pairs,D=F.keys(z),L=D.length,O=[],V;for(V=0;V<L;V++)R=z[D[V]],R[2]>0?O.push(R):delete z[D[V]];return O}})()},function(C,A,T){var E={};C.exports=E;var I=T(3),F=T(7),B=T(14),G=T(5),R=T(13),z=T(10),D=T(6),L=T(0),O=T(1);(function(){E.create=function(V,U){var W=(V?V.mouse:null)||(U?U.mouse:null);W||(V&&V.render&&V.render.canvas?W=B.create(V.render.canvas):U&&U.element?W=B.create(U.element):(W=B.create(),L.warn("MouseConstraint.create: options.mouse was undefined, options.element was undefined, may not function as expected")));var X=z.create({label:"Mouse Constraint",pointA:W.position,pointB:{x:0,y:0},length:.01,stiffness:.1,angularStiffness:1,render:{strokeStyle:"#90EE90",lineWidth:3}}),Y={type:"mouseConstraint",mouse:W,element:null,body:null,constraint:X,collisionFilter:{category:1,mask:4294967295,group:0}},K=L.extend(Y,U);return G.on(V,"beforeUpdate",function(){var q=D.allBodies(V.world);E.update(K,q),E._triggerEvents(K)}),K},E.update=function(V,U){var W=V.mouse,X=V.constraint,Y=V.body;if(W.button===0){if(X.bodyB)F.set(X.bodyB,!1),X.pointA=W.position;else for(var K=0;K<U.length;K++)if(Y=U[K],O.contains(Y.bounds,W.position)&&R.canCollide(Y.collisionFilter,V.collisionFilter))for(var q=Y.parts.length>1?1:0;q<Y.parts.length;q++){var J=Y.parts[q];if(I.contains(J.vertices,W.position)){X.pointA=W.position,X.bodyB=V.body=Y,X.pointB={x:W.position.x-Y.position.x,y:W.position.y-Y.position.y},X.angleB=Y.angle,F.set(Y,!1),G.trigger(V,"startdrag",{mouse:W,body:Y});break}}}else X.bodyB=V.body=null,X.pointB=null,Y&&G.trigger(V,"enddrag",{mouse:W,body:Y})},E._triggerEvents=function(V){var U=V.mouse,W=U.sourceEvents;W.mousemove&&G.trigger(V,"mousemove",{mouse:U}),W.mousedown&&G.trigger(V,"mousedown",{mouse:U}),W.mouseup&&G.trigger(V,"mouseup",{mouse:U}),B.clearSourceEvents(U)}})()},function(C,A,T){var E={};C.exports=E;var I=T(2),F=T(8),B=T(1),G=T(12),R=T(3);(function(){E.collides=function(z,D){for(var L=[],O=D.length,V=z.bounds,U=F.collides,W=B.overlaps,X=0;X<O;X++){var Y=D[X],K=Y.parts.length,q=K===1?0:1;if(W(Y.bounds,V))for(var J=q;J<K;J++){var tt=Y.parts[J];if(W(tt.bounds,V)){var rt=U(tt,z);if(rt){L.push(rt);break}}}}return L},E.ray=function(z,D,L,O){O=O||1e-100;for(var V=I.angle(D,L),U=I.magnitude(I.sub(D,L)),W=(L.x+D.x)*.5,X=(L.y+D.y)*.5,Y=G.rectangle(W,X,U,O,{angle:V}),K=E.collides(Y,z),q=0;q<K.length;q+=1){var J=K[q];J.body=J.bodyB=J.bodyA}return K},E.region=function(z,D,L){for(var O=[],V=0;V<z.length;V++){var U=z[V],W=B.overlaps(U.bounds,D);(W&&!L||!W&&L)&&O.push(U)}return O},E.point=function(z,D){for(var L=[],O=0;O<z.length;O++){var V=z[O];if(B.contains(V.bounds,D))for(var U=V.parts.length===1?0:1;U<V.parts.length;U++){var W=V.parts[U];if(B.contains(W.bounds,D)&&R.contains(W.vertices,D)){L.push(V);break}}}return L}})()},function(C,A,T){var E={};C.exports=E;var I=T(4),F=T(0),B=T(6),G=T(1),R=T(5),z=T(2),D=T(14);(function(){var L,O;typeof window<"u"&&(L=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(q){window.setTimeout(function(){q(F.now())},1e3/60)},O=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),E._goodFps=30,E._goodDelta=1e3/60,E.create=function(q){var J={engine:null,element:null,canvas:null,mouse:null,frameRequestId:null,timing:{historySize:60,delta:0,deltaHistory:[],lastTime:0,lastTimestamp:0,lastElapsed:0,timestampElapsed:0,timestampElapsedHistory:[],engineDeltaHistory:[],engineElapsedHistory:[],engineUpdatesHistory:[],elapsedHistory:[]},options:{width:800,height:600,pixelRatio:1,background:"#14151f",wireframeBackground:"#14151f",wireframeStrokeStyle:"#bbb",hasBounds:!!q.bounds,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showStats:!1,showPerformance:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showSeparations:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showVertexNumbers:!1,showConvexHulls:!1,showInternalEdges:!1,showMousePosition:!1}},tt=F.extend(J,q);return tt.canvas&&(tt.canvas.width=tt.options.width||tt.canvas.width,tt.canvas.height=tt.options.height||tt.canvas.height),tt.mouse=q.mouse,tt.engine=q.engine,tt.canvas=tt.canvas||W(tt.options.width,tt.options.height),tt.context=tt.canvas.getContext("2d"),tt.textures={},tt.bounds=tt.bounds||{min:{x:0,y:0},max:{x:tt.canvas.width,y:tt.canvas.height}},tt.controller=E,tt.options.showBroadphase=!1,tt.options.pixelRatio!==1&&E.setPixelRatio(tt,tt.options.pixelRatio),F.isElement(tt.element)&&tt.element.appendChild(tt.canvas),tt},E.run=function(q){(function J(tt){q.frameRequestId=L(J),V(q,tt),E.world(q,tt),q.context.setTransform(q.options.pixelRatio,0,0,q.options.pixelRatio,0,0),(q.options.showStats||q.options.showDebug)&&E.stats(q,q.context,tt),(q.options.showPerformance||q.options.showDebug)&&E.performance(q,q.context,tt),q.context.setTransform(1,0,0,1,0,0)})()},E.stop=function(q){O(q.frameRequestId)},E.setPixelRatio=function(q,J){var tt=q.options,rt=q.canvas;J==="auto"&&(J=X(rt)),tt.pixelRatio=J,rt.setAttribute("data-pixel-ratio",J),rt.width=tt.width*J,rt.height=tt.height*J,rt.style.width=tt.width+"px",rt.style.height=tt.height+"px"},E.setSize=function(q,J,tt){q.options.width=J,q.options.height=tt,q.bounds.max.x=q.bounds.min.x+J,q.bounds.max.y=q.bounds.min.y+tt,q.options.pixelRatio!==1?E.setPixelRatio(q,q.options.pixelRatio):(q.canvas.width=J,q.canvas.height=tt)},E.lookAt=function(q,J,tt,rt){rt=typeof rt<"u"?rt:!0,J=F.isArray(J)?J:[J],tt=tt||{x:0,y:0};for(var st={min:{x:1/0,y:1/0},max:{x:-1/0,y:-1/0}},nt=0;nt<J.length;nt+=1){var at=J[nt],ot=at.bounds?at.bounds.min:at.min||at.position||at,ct=at.bounds?at.bounds.max:at.max||at.position||at;ot&&ct&&(ot.x<st.min.x&&(st.min.x=ot.x),ct.x>st.max.x&&(st.max.x=ct.x),ot.y<st.min.y&&(st.min.y=ot.y),ct.y>st.max.y&&(st.max.y=ct.y))}var dt=st.max.x-st.min.x+2*tt.x,ut=st.max.y-st.min.y+2*tt.y,Q=q.canvas.height,it=q.canvas.width,Z=it/Q,et=dt/ut,ht=1,lt=1;et>Z?lt=et/Z:ht=Z/et,q.options.hasBounds=!0,q.bounds.min.x=st.min.x,q.bounds.max.x=st.min.x+dt*ht,q.bounds.min.y=st.min.y,q.bounds.max.y=st.min.y+ut*lt,rt&&(q.bounds.min.x+=dt*.5-dt*ht*.5,q.bounds.max.x+=dt*.5-dt*ht*.5,q.bounds.min.y+=ut*.5-ut*lt*.5,q.bounds.max.y+=ut*.5-ut*lt*.5),q.bounds.min.x-=tt.x,q.bounds.max.x-=tt.x,q.bounds.min.y-=tt.y,q.bounds.max.y-=tt.y,q.mouse&&(D.setScale(q.mouse,{x:(q.bounds.max.x-q.bounds.min.x)/q.canvas.width,y:(q.bounds.max.y-q.bounds.min.y)/q.canvas.height}),D.setOffset(q.mouse,q.bounds.min))},E.startViewTransform=function(q){var J=q.bounds.max.x-q.bounds.min.x,tt=q.bounds.max.y-q.bounds.min.y,rt=J/q.options.width,st=tt/q.options.height;q.context.setTransform(q.options.pixelRatio/rt,0,0,q.options.pixelRatio/st,0,0),q.context.translate(-q.bounds.min.x,-q.bounds.min.y)},E.endViewTransform=function(q){q.context.setTransform(q.options.pixelRatio,0,0,q.options.pixelRatio,0,0)},E.world=function(q,J){var tt=F.now(),rt=q.engine,st=rt.world,nt=q.canvas,at=q.context,ot=q.options,ct=q.timing,dt=B.allBodies(st),ut=B.allConstraints(st),Q=ot.wireframes?ot.wireframeBackground:ot.background,it=[],Z=[],et,ht={timestamp:rt.timing.timestamp};if(R.trigger(q,"beforeRender",ht),q.currentBackground!==Q&&K(q,Q),at.globalCompositeOperation="source-in",at.fillStyle="transparent",at.fillRect(0,0,nt.width,nt.height),at.globalCompositeOperation="source-over",ot.hasBounds){for(et=0;et<dt.length;et++){var lt=dt[et];G.overlaps(lt.bounds,q.bounds)&&it.push(lt)}for(et=0;et<ut.length;et++){var ft=ut[et],pt=ft.bodyA,mt=ft.bodyB,gt=ft.pointA,yt=ft.pointB;pt&&(gt=z.add(pt.position,ft.pointA)),mt&&(yt=z.add(mt.position,ft.pointB)),!(!gt||!yt)&&(G.contains(q.bounds,gt)||G.contains(q.bounds,yt))&&Z.push(ft)}E.startViewTransform(q),q.mouse&&(D.setScale(q.mouse,{x:(q.bounds.max.x-q.bounds.min.x)/q.options.width,y:(q.bounds.max.y-q.bounds.min.y)/q.options.height}),D.setOffset(q.mouse,q.bounds.min))}else Z=ut,it=dt,q.options.pixelRatio!==1&&q.context.setTransform(q.options.pixelRatio,0,0,q.options.pixelRatio,0,0);!ot.wireframes||rt.enableSleeping&&ot.showSleeping?E.bodies(q,it,at):(ot.showConvexHulls&&E.bodyConvexHulls(q,it,at),E.bodyWireframes(q,it,at)),ot.showBounds&&E.bodyBounds(q,it,at),(ot.showAxes||ot.showAngleIndicator)&&E.bodyAxes(q,it,at),ot.showPositions&&E.bodyPositions(q,it,at),ot.showVelocity&&E.bodyVelocity(q,it,at),ot.showIds&&E.bodyIds(q,it,at),ot.showSeparations&&E.separations(q,rt.pairs.list,at),ot.showCollisions&&E.collisions(q,rt.pairs.list,at),ot.showVertexNumbers&&E.vertexNumbers(q,it,at),ot.showMousePosition&&E.mousePosition(q,q.mouse,at),E.constraints(Z,at),ot.hasBounds&&E.endViewTransform(q),R.trigger(q,"afterRender",ht),ct.lastElapsed=F.now()-tt},E.stats=function(q,J,tt){for(var rt=q.engine,st=rt.world,nt=B.allBodies(st),at=0,ot=55,ct=44,dt=0,ut=0,Q=0;Q<nt.length;Q+=1)at+=nt[Q].parts.length;var it={Part:at,Body:nt.length,Cons:B.allConstraints(st).length,Comp:B.allComposites(st).length,Pair:rt.pairs.list.length};J.fillStyle="#0e0f19",J.fillRect(dt,ut,ot*5.5,ct),J.font="12px Arial",J.textBaseline="top",J.textAlign="right";for(var Z in it){var et=it[Z];J.fillStyle="#aaa",J.fillText(Z,dt+ot,ut+8),J.fillStyle="#eee",J.fillText(et,dt+ot,ut+26),dt+=ot}},E.performance=function(q,J){var tt=q.engine,rt=q.timing,st=rt.deltaHistory,nt=rt.elapsedHistory,at=rt.timestampElapsedHistory,ot=rt.engineDeltaHistory,ct=rt.engineUpdatesHistory,dt=rt.engineElapsedHistory,ut=tt.timing.lastUpdatesPerFrame,Q=tt.timing.lastDelta,it=U(st),Z=U(nt),et=U(ot),ht=U(ct),lt=U(dt),ft=U(at),pt=ft/it||0,mt=Math.round(it/Q),gt=1e3/it||0,yt=4,bt=12,xt=60,Et=34,_t=10,Tt=69;J.fillStyle="#0e0f19",J.fillRect(0,50,bt*5+xt*6+22,Et),E.status(J,_t,Tt,xt,yt,st.length,Math.round(gt)+" fps",gt/E._goodFps,function(At){return st[At]/it-1}),E.status(J,_t+bt+xt,Tt,xt,yt,ot.length,Q.toFixed(2)+" dt",E._goodDelta/Q,function(At){return ot[At]/et-1}),E.status(J,_t+(bt+xt)*2,Tt,xt,yt,ct.length,ut+" upf",Math.pow(F.clamp(ht/mt||1,0,1),4),function(At){return ct[At]/ht-1}),E.status(J,_t+(bt+xt)*3,Tt,xt,yt,dt.length,lt.toFixed(2)+" ut",1-ut*lt/E._goodFps,function(At){return dt[At]/lt-1}),E.status(J,_t+(bt+xt)*4,Tt,xt,yt,nt.length,Z.toFixed(2)+" rt",1-Z/E._goodFps,function(At){return nt[At]/Z-1}),E.status(J,_t+(bt+xt)*5,Tt,xt,yt,at.length,pt.toFixed(2)+" x",pt*pt*pt,function(At){return(at[At]/st[At]/pt||0)-1})},E.status=function(q,J,tt,rt,st,nt,at,ot,ct){q.strokeStyle="#888",q.fillStyle="#444",q.lineWidth=1,q.fillRect(J,tt+7,rt,1),q.beginPath(),q.moveTo(J,tt+7-st*F.clamp(.4*ct(0),-2,2));for(var dt=0;dt<rt;dt+=1)q.lineTo(J+dt,tt+7-(dt<nt?st*F.clamp(.4*ct(dt),-2,2):0));q.stroke(),q.fillStyle="hsl("+F.clamp(25+95*ot,0,120)+",100%,60%)",q.fillRect(J,tt-7,4,4),q.font="12px Arial",q.textBaseline="middle",q.textAlign="right",q.fillStyle="#eee",q.fillText(at,J+rt,tt-5)},E.constraints=function(q,J){for(var tt=J,rt=0;rt<q.length;rt++){var st=q[rt];if(!(!st.render.visible||!st.pointA||!st.pointB)){var nt=st.bodyA,at=st.bodyB,ot,ct;if(nt?ot=z.add(nt.position,st.pointA):ot=st.pointA,st.render.type==="pin")tt.beginPath(),tt.arc(ot.x,ot.y,3,0,2*Math.PI),tt.closePath();else{if(at?ct=z.add(at.position,st.pointB):ct=st.pointB,tt.beginPath(),tt.moveTo(ot.x,ot.y),st.render.type==="spring")for(var dt=z.sub(ct,ot),ut=z.perp(z.normalise(dt)),Q=Math.ceil(F.clamp(st.length/5,12,20)),it,Z=1;Z<Q;Z+=1)it=Z%2===0?1:-1,tt.lineTo(ot.x+dt.x*(Z/Q)+ut.x*it*4,ot.y+dt.y*(Z/Q)+ut.y*it*4);tt.lineTo(ct.x,ct.y)}st.render.lineWidth&&(tt.lineWidth=st.render.lineWidth,tt.strokeStyle=st.render.strokeStyle,tt.stroke()),st.render.anchors&&(tt.fillStyle=st.render.strokeStyle,tt.beginPath(),tt.arc(ot.x,ot.y,3,0,2*Math.PI),tt.arc(ct.x,ct.y,3,0,2*Math.PI),tt.closePath(),tt.fill())}}},E.bodies=function(q,J,tt){var rt=tt;q.engine;var st=q.options,nt=st.showInternalEdges||!st.wireframes,at,ot,ct,dt;for(ct=0;ct<J.length;ct++)if(at=J[ct],!!at.render.visible){for(dt=at.parts.length>1?1:0;dt<at.parts.length;dt++)if(ot=at.parts[dt],!!ot.render.visible){if(st.showSleeping&&at.isSleeping?rt.globalAlpha=.5*ot.render.opacity:ot.render.opacity!==1&&(rt.globalAlpha=ot.render.opacity),ot.render.sprite&&ot.render.sprite.texture&&!st.wireframes){var ut=ot.render.sprite,Q=Y(q,ut.texture);rt.translate(ot.position.x,ot.position.y),rt.rotate(ot.angle),rt.drawImage(Q,Q.width*-ut.xOffset*ut.xScale,Q.height*-ut.yOffset*ut.yScale,Q.width*ut.xScale,Q.height*ut.yScale),rt.rotate(-ot.angle),rt.translate(-ot.position.x,-ot.position.y)}else{if(ot.circleRadius)rt.beginPath(),rt.arc(ot.position.x,ot.position.y,ot.circleRadius,0,2*Math.PI);else{rt.beginPath(),rt.moveTo(ot.vertices[0].x,ot.vertices[0].y);for(var it=1;it<ot.vertices.length;it++)!ot.vertices[it-1].isInternal||nt?rt.lineTo(ot.vertices[it].x,ot.vertices[it].y):rt.moveTo(ot.vertices[it].x,ot.vertices[it].y),ot.vertices[it].isInternal&&!nt&&rt.moveTo(ot.vertices[(it+1)%ot.vertices.length].x,ot.vertices[(it+1)%ot.vertices.length].y);rt.lineTo(ot.vertices[0].x,ot.vertices[0].y),rt.closePath()}st.wireframes?(rt.lineWidth=1,rt.strokeStyle=q.options.wireframeStrokeStyle,rt.stroke()):(rt.fillStyle=ot.render.fillStyle,ot.render.lineWidth&&(rt.lineWidth=ot.render.lineWidth,rt.strokeStyle=ot.render.strokeStyle,rt.stroke()),rt.fill())}rt.globalAlpha=1}}},E.bodyWireframes=function(q,J,tt){var rt=tt,st=q.options.showInternalEdges,nt,at,ot,ct,dt;for(rt.beginPath(),ot=0;ot<J.length;ot++)if(nt=J[ot],!!nt.render.visible)for(dt=nt.parts.length>1?1:0;dt<nt.parts.length;dt++){for(at=nt.parts[dt],rt.moveTo(at.vertices[0].x,at.vertices[0].y),ct=1;ct<at.vertices.length;ct++)!at.vertices[ct-1].isInternal||st?rt.lineTo(at.vertices[ct].x,at.vertices[ct].y):rt.moveTo(at.vertices[ct].x,at.vertices[ct].y),at.vertices[ct].isInternal&&!st&&rt.moveTo(at.vertices[(ct+1)%at.vertices.length].x,at.vertices[(ct+1)%at.vertices.length].y);rt.lineTo(at.vertices[0].x,at.vertices[0].y)}rt.lineWidth=1,rt.strokeStyle=q.options.wireframeStrokeStyle,rt.stroke()},E.bodyConvexHulls=function(q,J,tt){var rt=tt,st,nt,at;for(rt.beginPath(),nt=0;nt<J.length;nt++)if(st=J[nt],!(!st.render.visible||st.parts.length===1)){for(rt.moveTo(st.vertices[0].x,st.vertices[0].y),at=1;at<st.vertices.length;at++)rt.lineTo(st.vertices[at].x,st.vertices[at].y);rt.lineTo(st.vertices[0].x,st.vertices[0].y)}rt.lineWidth=1,rt.strokeStyle="rgba(255,255,255,0.2)",rt.stroke()},E.vertexNumbers=function(q,J,tt){var rt=tt,st,nt,at;for(st=0;st<J.length;st++){var ot=J[st].parts;for(at=ot.length>1?1:0;at<ot.length;at++){var ct=ot[at];for(nt=0;nt<ct.vertices.length;nt++)rt.fillStyle="rgba(255,255,255,0.2)",rt.fillText(st+"_"+nt,ct.position.x+(ct.vertices[nt].x-ct.position.x)*.8,ct.position.y+(ct.vertices[nt].y-ct.position.y)*.8)}}},E.mousePosition=function(q,J,tt){var rt=tt;rt.fillStyle="rgba(255,255,255,0.8)",rt.fillText(J.position.x+"  "+J.position.y,J.position.x+5,J.position.y-5)},E.bodyBounds=function(q,J,tt){var rt=tt;q.engine;var st=q.options;rt.beginPath();for(var nt=0;nt<J.length;nt++){var at=J[nt];if(at.render.visible)for(var ot=J[nt].parts,ct=ot.length>1?1:0;ct<ot.length;ct++){var dt=ot[ct];rt.rect(dt.bounds.min.x,dt.bounds.min.y,dt.bounds.max.x-dt.bounds.min.x,dt.bounds.max.y-dt.bounds.min.y)}}st.wireframes?rt.strokeStyle="rgba(255,255,255,0.08)":rt.strokeStyle="rgba(0,0,0,0.1)",rt.lineWidth=1,rt.stroke()},E.bodyAxes=function(q,J,tt){var rt=tt;q.engine;var st=q.options,nt,at,ot,ct;for(rt.beginPath(),at=0;at<J.length;at++){var dt=J[at],ut=dt.parts;if(dt.render.visible)if(st.showAxes)for(ot=ut.length>1?1:0;ot<ut.length;ot++)for(nt=ut[ot],ct=0;ct<nt.axes.length;ct++){var Q=nt.axes[ct];rt.moveTo(nt.position.x,nt.position.y),rt.lineTo(nt.position.x+Q.x*20,nt.position.y+Q.y*20)}else for(ot=ut.length>1?1:0;ot<ut.length;ot++)for(nt=ut[ot],ct=0;ct<nt.axes.length;ct++)rt.moveTo(nt.position.x,nt.position.y),rt.lineTo((nt.vertices[0].x+nt.vertices[nt.vertices.length-1].x)/2,(nt.vertices[0].y+nt.vertices[nt.vertices.length-1].y)/2)}st.wireframes?(rt.strokeStyle="indianred",rt.lineWidth=1):(rt.strokeStyle="rgba(255, 255, 255, 0.4)",rt.globalCompositeOperation="overlay",rt.lineWidth=2),rt.stroke(),rt.globalCompositeOperation="source-over"},E.bodyPositions=function(q,J,tt){var rt=tt;q.engine;var st=q.options,nt,at,ot,ct;for(rt.beginPath(),ot=0;ot<J.length;ot++)if(nt=J[ot],!!nt.render.visible)for(ct=0;ct<nt.parts.length;ct++)at=nt.parts[ct],rt.arc(at.position.x,at.position.y,3,0,2*Math.PI,!1),rt.closePath();for(st.wireframes?rt.fillStyle="indianred":rt.fillStyle="rgba(0,0,0,0.5)",rt.fill(),rt.beginPath(),ot=0;ot<J.length;ot++)nt=J[ot],nt.render.visible&&(rt.arc(nt.positionPrev.x,nt.positionPrev.y,2,0,2*Math.PI,!1),rt.closePath());rt.fillStyle="rgba(255,165,0,0.8)",rt.fill()},E.bodyVelocity=function(q,J,tt){var rt=tt;rt.beginPath();for(var st=0;st<J.length;st++){var nt=J[st];if(nt.render.visible){var at=I.getVelocity(nt);rt.moveTo(nt.position.x,nt.position.y),rt.lineTo(nt.position.x+at.x,nt.position.y+at.y)}}rt.lineWidth=3,rt.strokeStyle="cornflowerblue",rt.stroke()},E.bodyIds=function(q,J,tt){var rt=tt,st,nt;for(st=0;st<J.length;st++)if(J[st].render.visible){var at=J[st].parts;for(nt=at.length>1?1:0;nt<at.length;nt++){var ot=at[nt];rt.font="12px Arial",rt.fillStyle="rgba(255,255,255,0.5)",rt.fillText(ot.id,ot.position.x+10,ot.position.y-10)}}},E.collisions=function(q,J,tt){var rt=tt,st=q.options,nt,at,ot,ct;for(rt.beginPath(),ot=0;ot<J.length;ot++)if(nt=J[ot],!!nt.isActive)for(at=nt.collision,ct=0;ct<nt.contactCount;ct++){var dt=nt.contacts[ct],ut=dt.vertex;rt.rect(ut.x-1.5,ut.y-1.5,3.5,3.5)}for(st.wireframes?rt.fillStyle="rgba(255,255,255,0.7)":rt.fillStyle="orange",rt.fill(),rt.beginPath(),ot=0;ot<J.length;ot++)if(nt=J[ot],!!nt.isActive&&(at=nt.collision,nt.contactCount>0)){var Q=nt.contacts[0].vertex.x,it=nt.contacts[0].vertex.y;nt.contactCount===2&&(Q=(nt.contacts[0].vertex.x+nt.contacts[1].vertex.x)/2,it=(nt.contacts[0].vertex.y+nt.contacts[1].vertex.y)/2),at.bodyB===at.supports[0].body||at.bodyA.isStatic===!0?rt.moveTo(Q-at.normal.x*8,it-at.normal.y*8):rt.moveTo(Q+at.normal.x*8,it+at.normal.y*8),rt.lineTo(Q,it)}st.wireframes?rt.strokeStyle="rgba(255,165,0,0.7)":rt.strokeStyle="orange",rt.lineWidth=1,rt.stroke()},E.separations=function(q,J,tt){var rt=tt,st=q.options,nt,at,ot,ct,dt;for(rt.beginPath(),dt=0;dt<J.length;dt++)if(nt=J[dt],!!nt.isActive){at=nt.collision,ot=at.bodyA,ct=at.bodyB;var ut=1;!ct.isStatic&&!ot.isStatic&&(ut=.5),ct.isStatic&&(ut=0),rt.moveTo(ct.position.x,ct.position.y),rt.lineTo(ct.position.x-at.penetration.x*ut,ct.position.y-at.penetration.y*ut),ut=1,!ct.isStatic&&!ot.isStatic&&(ut=.5),ot.isStatic&&(ut=0),rt.moveTo(ot.position.x,ot.position.y),rt.lineTo(ot.position.x+at.penetration.x*ut,ot.position.y+at.penetration.y*ut)}st.wireframes?rt.strokeStyle="rgba(255,165,0,0.5)":rt.strokeStyle="orange",rt.stroke()},E.inspector=function(q,J){q.engine;var tt=q.selected,rt=q.render,st=rt.options,nt;if(st.hasBounds){var at=rt.bounds.max.x-rt.bounds.min.x,ot=rt.bounds.max.y-rt.bounds.min.y,ct=at/rt.options.width,dt=ot/rt.options.height;J.scale(1/ct,1/dt),J.translate(-rt.bounds.min.x,-rt.bounds.min.y)}for(var ut=0;ut<tt.length;ut++){var Q=tt[ut].data;switch(J.translate(.5,.5),J.lineWidth=1,J.strokeStyle="rgba(255,165,0,0.9)",J.setLineDash([1,2]),Q.type){case"body":nt=Q.bounds,J.beginPath(),J.rect(Math.floor(nt.min.x-3),Math.floor(nt.min.y-3),Math.floor(nt.max.x-nt.min.x+6),Math.floor(nt.max.y-nt.min.y+6)),J.closePath(),J.stroke();break;case"constraint":var it=Q.pointA;Q.bodyA&&(it=Q.pointB),J.beginPath(),J.arc(it.x,it.y,10,0,2*Math.PI),J.closePath(),J.stroke();break}J.setLineDash([]),J.translate(-.5,-.5)}q.selectStart!==null&&(J.translate(.5,.5),J.lineWidth=1,J.strokeStyle="rgba(255,165,0,0.6)",J.fillStyle="rgba(255,165,0,0.1)",nt=q.selectBounds,J.beginPath(),J.rect(Math.floor(nt.min.x),Math.floor(nt.min.y),Math.floor(nt.max.x-nt.min.x),Math.floor(nt.max.y-nt.min.y)),J.closePath(),J.stroke(),J.fill(),J.translate(-.5,-.5)),st.hasBounds&&J.setTransform(1,0,0,1,0,0)};var V=function(q,J){var tt=q.engine,rt=q.timing,st=rt.historySize,nt=tt.timing.timestamp;rt.delta=J-rt.lastTime||E._goodDelta,rt.lastTime=J,rt.timestampElapsed=nt-rt.lastTimestamp||0,rt.lastTimestamp=nt,rt.deltaHistory.unshift(rt.delta),rt.deltaHistory.length=Math.min(rt.deltaHistory.length,st),rt.engineDeltaHistory.unshift(tt.timing.lastDelta),rt.engineDeltaHistory.length=Math.min(rt.engineDeltaHistory.length,st),rt.timestampElapsedHistory.unshift(rt.timestampElapsed),rt.timestampElapsedHistory.length=Math.min(rt.timestampElapsedHistory.length,st),rt.engineUpdatesHistory.unshift(tt.timing.lastUpdatesPerFrame),rt.engineUpdatesHistory.length=Math.min(rt.engineUpdatesHistory.length,st),rt.engineElapsedHistory.unshift(tt.timing.lastElapsed),rt.engineElapsedHistory.length=Math.min(rt.engineElapsedHistory.length,st),rt.elapsedHistory.unshift(rt.lastElapsed),rt.elapsedHistory.length=Math.min(rt.elapsedHistory.length,st)},U=function(q){for(var J=0,tt=0;tt<q.length;tt+=1)J+=q[tt];return J/q.length||0},W=function(q,J){var tt=document.createElement("canvas");return tt.width=q,tt.height=J,tt.oncontextmenu=function(){return!1},tt.onselectstart=function(){return!1},tt},X=function(q){var J=q.getContext("2d"),tt=window.devicePixelRatio||1,rt=J.webkitBackingStorePixelRatio||J.mozBackingStorePixelRatio||J.msBackingStorePixelRatio||J.oBackingStorePixelRatio||J.backingStorePixelRatio||1;return tt/rt},Y=function(q,J){var tt=q.textures[J];return tt||(tt=q.textures[J]=new Image,tt.src=J,tt)},K=function(q,J){var tt=J;/(jpg|gif|png)$/.test(J)&&(tt="url("+J+")"),q.canvas.style.background=tt,q.canvas.style.backgroundSize="contain",q.currentBackground=J}})()},function(C,A,T){var E={};C.exports=E;var I=T(5),F=T(17),B=T(0);(function(){E._maxFrameDelta=1e3/15,E._frameDeltaFallback=1e3/60,E._timeBufferMargin=1.5,E._elapsedNextEstimate=1,E._smoothingLowerBound=.1,E._smoothingUpperBound=.9,E.create=function(R){var z={delta:16.666666666666668,frameDelta:null,frameDeltaSmoothing:!0,frameDeltaSnapping:!0,frameDeltaHistory:[],frameDeltaHistorySize:100,frameRequestId:null,timeBuffer:0,timeLastTick:null,maxUpdates:null,maxFrameTime:33.333333333333336,lastUpdatesDeferred:0,enabled:!0},D=B.extend(z,R);return D.fps=0,D},E.run=function(R,z){return R.timeBuffer=E._frameDeltaFallback,function D(L){R.frameRequestId=E._onNextFrame(R,D),L&&R.enabled&&E.tick(R,z,L)}(),R},E.tick=function(R,z,D){var L=B.now(),O=R.delta,V=0,U=D-R.timeLastTick;if((!U||!R.timeLastTick||U>Math.max(E._maxFrameDelta,R.maxFrameTime))&&(U=R.frameDelta||E._frameDeltaFallback),R.frameDeltaSmoothing){R.frameDeltaHistory.push(U),R.frameDeltaHistory=R.frameDeltaHistory.slice(-R.frameDeltaHistorySize);var W=R.frameDeltaHistory.slice(0).sort(),X=R.frameDeltaHistory.slice(W.length*E._smoothingLowerBound,W.length*E._smoothingUpperBound),Y=G(X);U=Y||U}R.frameDeltaSnapping&&(U=1e3/Math.round(1e3/U)),R.frameDelta=U,R.timeLastTick=D,R.timeBuffer+=R.frameDelta,R.timeBuffer=B.clamp(R.timeBuffer,0,R.frameDelta+O*E._timeBufferMargin),R.lastUpdatesDeferred=0;var K=R.maxUpdates||Math.ceil(R.maxFrameTime/O),q={timestamp:z.timing.timestamp};I.trigger(R,"beforeTick",q),I.trigger(R,"tick",q);for(var J=B.now();O>0&&R.timeBuffer>=O*E._timeBufferMargin;){I.trigger(R,"beforeUpdate",q),F.update(z,O),I.trigger(R,"afterUpdate",q),R.timeBuffer-=O,V+=1;var tt=B.now()-L,rt=B.now()-J,st=tt+E._elapsedNextEstimate*rt/V;if(V>=K||st>R.maxFrameTime){R.lastUpdatesDeferred=Math.round(Math.max(0,R.timeBuffer/O-E._timeBufferMargin));break}}z.timing.lastUpdatesPerFrame=V,I.trigger(R,"afterTick",q),R.frameDeltaHistory.length>=100&&(R.lastUpdatesDeferred&&Math.round(R.frameDelta/O)>K?B.warnOnce("Matter.Runner: runner reached runner.maxUpdates, see docs."):R.lastUpdatesDeferred&&B.warnOnce("Matter.Runner: runner reached runner.maxFrameTime, see docs."),typeof R.isFixed<"u"&&B.warnOnce("Matter.Runner: runner.isFixed is now redundant, see docs."),(R.deltaMin||R.deltaMax)&&B.warnOnce("Matter.Runner: runner.deltaMin and runner.deltaMax were removed, see docs."),R.fps!==0&&B.warnOnce("Matter.Runner: runner.fps was replaced by runner.delta, see docs."))},E.stop=function(R){E._cancelNextFrame(R)},E._onNextFrame=function(R,z){if(typeof window<"u"&&window.requestAnimationFrame)R.frameRequestId=window.requestAnimationFrame(z);else throw new Error("Matter.Runner: missing required global window.requestAnimationFrame.");return R.frameRequestId},E._cancelNextFrame=function(R){if(typeof window<"u"&&window.cancelAnimationFrame)window.cancelAnimationFrame(R.frameRequestId);else throw new Error("Matter.Runner: missing required global window.cancelAnimationFrame.")};var G=function(R){for(var z=0,D=R.length,L=0;L<D;L+=1)z+=R[L];return z/D||0}})()},function(C,A,T){var E={};C.exports=E;var I=T(8),F=T(0),B=F.deprecated;(function(){E.collides=function(G,R){return I.collides(G,R)},B(E,"collides","SAT.collides  replaced by Collision.collides")})()},function(C,A,T){var E={};C.exports=E,T(1);var I=T(0);(function(){E.pathToVertices=function(F,B){typeof window<"u"&&!("SVGPathSeg"in window)&&I.warn("Svg.pathToVertices: SVGPathSeg not defined, a polyfill is required.");var G,R,z,D,L,O,V,U,W,X,Y=[],K,q,J=0,tt=0,rt=0;B=B||15;var st=function(at,ot,ct){var dt=ct%2===1&&ct>1;if(!W||at!=W.x||ot!=W.y){W&&dt?(K=W.x,q=W.y):(K=0,q=0);var ut={x:K+at,y:q+ot};(dt||!W)&&(W=ut),Y.push(ut),tt=K+at,rt=q+ot}},nt=function(at){var ot=at.pathSegTypeAsLetter.toUpperCase();if(ot!=="Z"){switch(ot){case"M":case"L":case"T":case"C":case"S":case"Q":tt=at.x,rt=at.y;break;case"H":tt=at.x;break;case"V":rt=at.y;break}st(tt,rt,at.pathSegType)}};for(E._svgPathToAbsolute(F),z=F.getTotalLength(),O=[],G=0;G<F.pathSegList.numberOfItems;G+=1)O.push(F.pathSegList.getItem(G));for(V=O.concat();J<z;){if(X=F.getPathSegAtLength(J),L=O[X],L!=U){for(;V.length&&V[0]!=L;)nt(V.shift());U=L}switch(L.pathSegTypeAsLetter.toUpperCase()){case"C":case"T":case"S":case"Q":case"A":D=F.getPointAtLength(J),st(D.x,D.y,0);break}J+=B}for(G=0,R=V.length;G<R;++G)nt(V[G]);return Y},E._svgPathToAbsolute=function(F){for(var B,G,R,z,D,L,O=F.pathSegList,V=0,U=0,W=O.numberOfItems,X=0;X<W;++X){var Y=O.getItem(X),K=Y.pathSegTypeAsLetter;if(/[MLHVCSQTA]/.test(K))"x"in Y&&(V=Y.x),"y"in Y&&(U=Y.y);else switch("x1"in Y&&(R=V+Y.x1),"x2"in Y&&(D=V+Y.x2),"y1"in Y&&(z=U+Y.y1),"y2"in Y&&(L=U+Y.y2),"x"in Y&&(V+=Y.x),"y"in Y&&(U+=Y.y),K){case"m":O.replaceItem(F.createSVGPathSegMovetoAbs(V,U),X);break;case"l":O.replaceItem(F.createSVGPathSegLinetoAbs(V,U),X);break;case"h":O.replaceItem(F.createSVGPathSegLinetoHorizontalAbs(V),X);break;case"v":O.replaceItem(F.createSVGPathSegLinetoVerticalAbs(U),X);break;case"c":O.replaceItem(F.createSVGPathSegCurvetoCubicAbs(V,U,R,z,D,L),X);break;case"s":O.replaceItem(F.createSVGPathSegCurvetoCubicSmoothAbs(V,U,D,L),X);break;case"q":O.replaceItem(F.createSVGPathSegCurvetoQuadraticAbs(V,U,R,z),X);break;case"t":O.replaceItem(F.createSVGPathSegCurvetoQuadraticSmoothAbs(V,U),X);break;case"a":O.replaceItem(F.createSVGPathSegArcAbs(V,U,Y.r1,Y.r2,Y.angle,Y.largeArcFlag,Y.sweepFlag),X);break;case"z":case"Z":V=B,U=G;break}(K=="M"||K=="m")&&(B=V,G=U)}}})()},function(C,A,T){var E={};C.exports=E;var I=T(6);T(0),function(){E.create=I.create,E.add=I.add,E.remove=I.remove,E.clear=I.clear,E.addComposite=I.addComposite,E.addBody=I.addBody,E.addConstraint=I.addConstraint}()}])})}(matter$1)),matter$1.exports}var matterExports=requireMatter();class SoundPlayer{constructor(){Object.defineProperty(this,"sounds",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"isMuted",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.init()}static getInstance(){return SoundPlayer.instance||(SoundPlayer.instance=new SoundPlayer),SoundPlayer.instance}init(){const _=new Audio("./assets/sounds/levelup.wav"),C=new Audio("./assets/sounds/gameover.wav"),A=new Audio("./assets/sounds/pass.wav");this.sounds.set("levelup",_),this.sounds.set("gameover",C),this.sounds.set("pass",A),this.preloadAudio()}preloadAudio(){this.sounds.forEach(_=>{_.load()})}play(_){if(this.isMuted)return;const C=this.sounds.get(_);if(!C)return;const A=new Audio(C.src);A.volume=C.volume,A.play().catch(T=>console.error(`  : ${_}`,T))}toggleMute(){return this.isMuted=!this.isMuted,this.isMuted}isSoundMuted(){return this.isMuted}}class ScoreManager extends EventEmitter{constructor(){super(),Object.defineProperty(this,"score",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"highScore",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"SCORE_KEY",{enumerable:!0,configurable:!0,writable:!0,value:"flappyBird_score"}),Object.defineProperty(this,"HIGH_SCORE_KEY",{enumerable:!0,configurable:!0,writable:!0,value:"flappyBird_highScore"}),Object.defineProperty(this,"soundPlayer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.loadScoresFromStorage(),this.soundPlayer=SoundPlayer.getInstance()}static getInstance(){return ScoreManager.instance||(ScoreManager.instance=new ScoreManager),ScoreManager.instance}loadScoresFromStorage(){try{const _=localStorage.getItem(this.HIGH_SCORE_KEY);_&&(this.highScore=parseInt(_,10))}catch(_){console.error("      :",_)}}saveScoresToStorage(){try{localStorage.setItem(this.SCORE_KEY,this.score.toString()),localStorage.setItem(this.HIGH_SCORE_KEY,this.highScore.toString())}catch(_){console.error("      :",_)}}getScore(){return this.score}getHighScore(){return this.highScore}setScore(_){this.score=_,this.updateHighScore(),this.saveScoresToStorage(),this.emit("scoreChanged",this.score),this.emit("highScoreChanged",this.highScore)}incrementScore(){this.score+=1,this.score%5===0&&this.soundPlayer.play("levelup"),this.updateHighScore(),this.saveScoresToStorage(),this.emit("scoreChanged",this.score),this.emit("highScoreChanged",this.highScore)}updateHighScore(){this.score>this.highScore&&(this.highScore=this.score)}resetScore(){this.score=0,this.saveScoresToStorage(),this.emit("scoreChanged",this.score)}}const{GAME_WIDTH:GAME_WIDTH$5}=DEFAULT_CONFIG;class GameController extends EventEmitter{constructor(){super(),Object.defineProperty(this,"engine",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"runner",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"isPhysicsStarted",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"isGameOver",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"player",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"ground",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"obstacleManager",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"scoreManager",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"soundPlayer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.engine=matterExports.Engine.create({gravity:{x:0,y:.5}}),this.runner=matterExports.Runner.create(),this.scoreManager=ScoreManager.getInstance(),this.soundPlayer=SoundPlayer.getInstance(),this.setupCollisionEvents()}static getInstance(){return GameController.instance||(GameController.instance=new GameController),GameController.instance}setPlayer(_){this.player=_}setGround(_){this.ground=_}setObstacleManager(_){this.obstacleManager=_}setupCollisionEvents(){matterExports.Events.on(this.engine,"collisionStart",_=>{if(this.isGameOver)return;const C=_.pairs;for(let A=0;A<C.length;A++){const T=C[A];this.isPlayerGroundCollision(T.bodyA,T.bodyB)&&(console.log(":  "),this.handleGameOver()),this.isPlayerObstacleCollision(T.bodyA,T.bodyB)&&(console.log(":  "),this.handleGameOver())}})}handleGameOver(){if(this.isGameOver)return;this.isGameOver=!0,this.player&&this.player.die(),this.soundPlayer.play("gameover");const _=this.scoreManager.getScore();this.emit("gameOver",_),setTimeout(()=>{this.stopPhysics(),SceneController.getInstance().switchScene(SceneType.GAMEOVER)},2e3)}resetGame(){this.isGameOver=!1,this.ground&&console.log("ground reset"),this.scoreManager.resetScore(),this.resetPhysics(),this.obstacleManager&&this.obstacleManager.reset()}resetPhysics(){this.isPhysicsStarted&&(matterExports.Runner.stop(this.runner),this.isPhysicsStarted=!1),this.engine=matterExports.Engine.create({gravity:{x:0,y:.5}}),this.runner=matterExports.Runner.create(),this.setupCollisionEvents()}isPlayerGroundCollision(_,C){return _.label==="player"&&C.label==="ground"||C.label==="player"&&_.label==="ground"}isPlayerObstacleCollision(_,C){return _.label==="player"&&(C.label==="obstacle-top"||C.label==="obstacle-bottom")||C.label==="player"&&(_.label==="obstacle-top"||_.label==="obstacle-bottom")}checkObstaclePassed(){if(!this.obstacleManager||this.isGameOver)return;const _=this.obstacleManager.getObstacles(),C=GAME_WIDTH$5*.3;for(const A of _)if(A.isActive()&&!A.isPassed()){const T=A.getCenterX()-A.getWidth()/2*.5;C>T&&(this.soundPlayer.play("pass"),A.setPassed(!0),this.scoreManager.incrementScore())}}update(){this.checkObstaclePassed()}startPhysics(){this.isPhysicsStarted||(matterExports.Runner.run(this.runner,this.engine),this.isPhysicsStarted=!0)}stopPhysics(){this.isPhysicsStarted&&(matterExports.Runner.stop(this.runner),this.isPhysicsStarted=!1)}addBody(_){matterExports.Composite.add(this.engine.world,_)}removeBody(_){matterExports.Composite.remove(this.engine.world,_)}getEngine(){return this.engine}}const{GAME_WIDTH:GAME_WIDTH$4,GAME_HEIGHT:GAME_HEIGHT$3}=DEFAULT_CONFIG;class Ground extends Container{constructor(){super(),Object.defineProperty(this,"tilingGround",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tilingTop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"groundHeight",{enumerable:!0,configurable:!0,writable:!0,value:70}),Object.defineProperty(this,"topHeight",{enumerable:!0,configurable:!0,writable:!0,value:70}),Object.defineProperty(this,"scrollSpeed",{enumerable:!0,configurable:!0,writable:!0,value:2}),Object.defineProperty(this,"physicsBody",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topPhysicsBody",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const _=Texture.from("groundBottom");this.tilingGround=new TilingSprite({texture:_,width:GAME_WIDTH$4,height:this.groundHeight}),this.tilingGround.anchor.set(0,1),this.tilingGround.position.set(0,GAME_HEIGHT$3);const C=Texture.from("groundTop");this.tilingTop=new TilingSprite({texture:C,width:GAME_WIDTH$4,height:this.topHeight}),this.tilingTop.anchor.set(0,0),this.tilingTop.position.set(0,0),this.addChild(this.tilingGround,this.tilingTop),this.createPhysicsBody()}createPhysicsBody(){this.physicsBody=matterExports.Bodies.rectangle(GAME_WIDTH$4/2,GAME_HEIGHT$3-this.groundHeight/2,GAME_WIDTH$4,this.groundHeight,{isStatic:!0,label:"ground",friction:.3}),this.topPhysicsBody=matterExports.Bodies.rectangle(GAME_WIDTH$4/2,this.topHeight/2,GAME_WIDTH$4,this.topHeight,{isStatic:!0,label:"ceiling",friction:.3}),GameController.getInstance().addBody(this.physicsBody),GameController.getInstance().addBody(this.topPhysicsBody)}update(_){this.tilingGround.tilePosition.x-=this.scrollSpeed*_,this.tilingTop.tilePosition.x-=this.scrollSpeed*_}getTopY(){return GAME_HEIGHT$3-this.groundHeight}}const{GAME_WIDTH:GAME_WIDTH$3,GAME_HEIGHT:GAME_HEIGHT$2}=DEFAULT_CONFIG;class Obstacle extends Container{constructor(){super(),Object.defineProperty(this,"topRock",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"bottomRock",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"debugGraphics",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"positionX",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"active",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"passed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"topBody",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"bottomBody",{enumerable:!0,configurable:!0,writable:!0,value:null}),this.debugGraphics=new Graphics,this.debugGraphics.visible=!1,this.topRock=Sprite.from("rockTop"),this.topRock.anchor.set(.5,0),this.topRock.visible=!1,this.bottomRock=Sprite.from("rockBottom"),this.bottomRock.anchor.set(.5,1),this.bottomRock.visible=!1,this.addChild(this.topRock,this.bottomRock,this.debugGraphics)}activate(_){this.active=!0,this.passed=!1,this.positionX=GAME_WIDTH$3+100;const C=GAME_HEIGHT$2-_,A=.3+Math.random()*.4,T=C*A,E=C-T;this.topRock.y=0,this.topRock.height=T,this.bottomRock.y=GAME_HEIGHT$2,this.bottomRock.height=E,this.topRock.visible=!0,this.bottomRock.visible=!0,this.x=this.positionX,this.createPhysicsBodies()}createPhysicsBodies(){const _=this.topRock.width,C=this.topRock.height,A=_*(2/3)-_/2,T=[{x:-_/2,y:0},{x:_/2,y:0},{x:A,y:C}],E=this.bottomRock.width,I=this.bottomRock.height,F=E*(2/3)-E/2,B=[{x:-E/2,y:0},{x:E/2,y:0},{x:F,y:-I}];this.topBody&&GameController.getInstance().removeBody(this.topBody),this.bottomBody&&GameController.getInstance().removeBody(this.bottomBody),this.topBody=matterExports.Bodies.fromVertices(this.positionX,this.topRock.y+C/3,[T],{isStatic:!0,label:"obstacle-top",isSensor:!0},!0),this.bottomBody=matterExports.Bodies.fromVertices(this.positionX,this.bottomRock.y-I/3,[B],{isStatic:!0,label:"obstacle-bottom",isSensor:!0},!0);const G=GameController.getInstance();G.addBody(this.topBody),G.addBody(this.bottomBody),this.updateDebugGraphics()}updateDebugGraphics(){if(this.debugGraphics.clear(),this.topBody){const _=this.topBody.vertices;this.debugGraphics.setStrokeStyle({width:2,color:16711680,alpha:.8}),this.debugGraphics.fill({color:16711680,alpha:.2}),this.debugGraphics.moveTo(_[0].x,_[0].y),this.debugGraphics.moveTo(_[0].x-this.x,_[0].y-this.y);for(let C=1;C<_.length;C++)this.debugGraphics.lineTo(_[C].x-this.x,_[C].y-this.y);this.debugGraphics.lineTo(_[0].x-this.x,_[0].y-this.y),this.debugGraphics.fill()}if(this.bottomBody){const _=this.bottomBody.vertices;this.debugGraphics.setStrokeStyle({width:2,color:255,alpha:.8}),this.debugGraphics.fill({color:255,alpha:.2}),this.debugGraphics.moveTo(_[0].x-this.x,_[0].y-this.y);for(let C=1;C<_.length;C++)this.debugGraphics.lineTo(_[C].x-this.x,_[C].y-this.y);this.debugGraphics.lineTo(_[0].x-this.x,_[0].y-this.y),this.debugGraphics.fill()}}update(_,C){this.active&&(this.positionX-=_*C,this.x=this.positionX,this.topBody&&matterExports.Body.setPosition(this.topBody,{x:this.positionX,y:this.topBody.position.y}),this.bottomBody&&matterExports.Body.setPosition(this.bottomBody,{x:this.positionX,y:this.bottomBody.position.y}),this.updateDebugGraphics())}deactivate(){this.active=!1,this.passed=!1,this.topRock.visible=!1,this.bottomRock.visible=!1,this.topBody&&(GameController.getInstance().removeBody(this.topBody),this.topBody=null),this.bottomBody&&(GameController.getInstance().removeBody(this.bottomBody),this.bottomBody=null),this.debugGraphics.clear()}isOffScreen(){return this.positionX<-100}isActive(){return this.active}isPassed(){return this.passed}setPassed(_){this.passed=_}getCenterX(){return this.positionX}getWidth(){return this.topRock.width}setDebugGraphicsVisibility(_){this.debugGraphics.visible=_}}class ObstacleManager extends Container{constructor(){super(),Object.defineProperty(this,"obstacles",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"POOL_SIZE",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"currentSpeed",{enumerable:!0,configurable:!0,writable:!0,value:10}),Object.defineProperty(this,"currentGapSize",{enumerable:!0,configurable:!0,writable:!0,value:200}),Object.defineProperty(this,"spawnTimer",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"spawnInterval",{enumerable:!0,configurable:!0,writable:!0,value:160}),this.initializePool()}initializePool(){for(let _=0;_<this.POOL_SIZE;_++){const C=new Obstacle;this.obstacles.push(C),this.addChild(C)}this.obstacles.length>0&&this.obstacles[0].activate(this.currentGapSize)}update(_,C){this.spawnTimer+=_,this.updateGapSize(C),this.updateSpawnInterval(C),this.updateSpeed(C),this.activateObstacleIfNeeded(),this.updateActiveObstacles(_)}activateObstacleIfNeeded(){if(this.spawnTimer>=this.spawnInterval){const _=this.obstacles.find(C=>!C.isActive());_&&(_.activate(this.currentGapSize),this.spawnTimer=0)}}updateActiveObstacles(_){for(const C of this.obstacles)C.isActive()&&(C.update(this.currentSpeed,_),C.isOffScreen()&&C.deactivate())}getObstacles(){return this.obstacles}reset(){for(const _ of this.obstacles)_.deactivate();this.spawnTimer=0,this.currentSpeed=10,this.currentGapSize=200,this.spawnInterval=160}updateGapSize(_){_>=20?this.currentGapSize=120:_>=15?this.currentGapSize=140:_>=10?this.currentGapSize=160:_>=5?this.currentGapSize=180:this.currentGapSize=200}updateSpawnInterval(_){_>=20?this.spawnInterval=80:_>=15?this.spawnInterval=100:_>=10?this.spawnInterval=120:_>=5?this.spawnInterval=140:this.spawnInterval=160}updateSpeed(_){if(_>=30){const C=Math.floor((_-20)/10)*.5;this.currentSpeed=2+C,this.currentSpeed=Math.min(this.currentSpeed,5)}else this.currentSpeed=2}setDebugGraphicsVisibility(_){for(const C of this.obstacles)C.setDebugGraphicsVisibility(_)}}const{GAME_WIDTH:GAME_WIDTH$2}=DEFAULT_CONFIG;class Player extends Sprite{constructor(){super(Sprite.from("plane").texture),Object.defineProperty(this,"JUMP_FORCE",{enumerable:!0,configurable:!0,writable:!0,value:.03}),Object.defineProperty(this,"ROTATION_SPEED",{enumerable:!0,configurable:!0,writable:!0,value:.1}),Object.defineProperty(this,"MAX_ROTATION",{enumerable:!0,configurable:!0,writable:!0,value:.5}),Object.defineProperty(this,"MIN_ROTATION",{enumerable:!0,configurable:!0,writable:!0,value:-.5}),Object.defineProperty(this,"MAX_UPWARD_VELOCITY",{enumerable:!0,configurable:!0,writable:!0,value:-10}),Object.defineProperty(this,"isAlive",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"physicsBody",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"canJump",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"isJumpBlocked",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.width=62,this.height=48,this.anchor.set(.5),this.x=GAME_WIDTH$2*.3,this.y=250,this.createPhysicsBody(),this.setupEventListeners()}setupEventListeners(){document.addEventListener("pointerdown",()=>{this.canJump&&!this.isJumpBlocked&&this.jump()}),document.addEventListener("keydown",_=>{this.canJump&&!this.isJumpBlocked&&_.code==="Space"&&this.jump()}),document.addEventListener("touchstart",_=>{this.canJump&&!this.isJumpBlocked&&(_.preventDefault(),this.jump())})}createPhysicsBody(){this.physicsBody=matterExports.Bodies.circle(this.x,this.y,this.width/2*.7,{label:"player",restitution:.3,friction:.1,density:.001}),GameController.getInstance().addBody(this.physicsBody)}jump(){if(!this.isAlive)return;if(this.physicsBody.velocity.y<=this.MAX_UPWARD_VELOCITY){const C=this.JUMP_FORCE*.3;matterExports.Body.applyForce(this.physicsBody,{x:this.physicsBody.position.x,y:this.physicsBody.position.y},{x:0,y:-C})}else matterExports.Body.applyForce(this.physicsBody,{x:this.physicsBody.position.x,y:this.physicsBody.position.y},{x:0,y:-this.JUMP_FORCE});this.rotation=this.MIN_ROTATION}die(){this.isAlive=!1,matterExports.Body.setVelocity(this.physicsBody,{x:0,y:5}),matterExports.Body.setAngularVelocity(this.physicsBody,.2)}update(_){this.isAlive?(this.y=this.physicsBody.position.y,this.x=GAME_WIDTH$2*.3,matterExports.Body.setPosition(this.physicsBody,{x:GAME_WIDTH$2*.3,y:this.physicsBody.position.y}),this.physicsBody.velocity.y>0&&(this.rotation+=this.ROTATION_SPEED*_,this.rotation>this.MAX_ROTATION&&(this.rotation=this.MAX_ROTATION))):(this.x=this.physicsBody.position.x,this.y=this.physicsBody.position.y,this.rotation=this.physicsBody.angle,matterExports.Body.setVelocity(this.physicsBody,{x:this.physicsBody.velocity.x,y:this.physicsBody.velocity.y+.3*_}),matterExports.Body.setAngularVelocity(this.physicsBody,this.physicsBody.angularVelocity*1.01))}reset(){this.x=GAME_WIDTH$2*.3,this.y=250,this.rotation=0,this.isAlive=!0,this.canJump=!1,this.physicsBody&&(matterExports.Body.setPosition(this.physicsBody,{x:this.x,y:this.y}),matterExports.Body.setVelocity(this.physicsBody,{x:0,y:0}))}enableJumping(){this.canJump=!0}}var lottie$2={exports:{}},lottie$1=lottie$2.exports,hasRequiredLottie;function requireLottie(){return hasRequiredLottie||(hasRequiredLottie=1,function(module,exports){typeof navigator<"u"&&function(P,_){module.exports=_()}(lottie$1,function(){var svgNS="http://www.w3.org/2000/svg",locationHref="",_useWebWorker=!1,initialDefaultFrame=-999999,setWebWorker=function(_){_useWebWorker=!!_},getWebWorker=function(){return _useWebWorker},setLocationHref=function(_){locationHref=_},getLocationHref=function(){return locationHref};function createTag(P){return document.createElement(P)}function extendPrototype(P,_){var C,A=P.length,T;for(C=0;C<A;C+=1){T=P[C].prototype;for(var E in T)Object.prototype.hasOwnProperty.call(T,E)&&(_.prototype[E]=T[E])}}function getDescriptor(P,_){return Object.getOwnPropertyDescriptor(P,_)}function createProxyFunction(P){function _(){}return _.prototype=P,_}var audioControllerFactory=function(){function P(_){this.audios=[],this.audioFactory=_,this._volume=1,this._isMuted=!1}return P.prototype={addAudio:function(C){this.audios.push(C)},pause:function(){var C,A=this.audios.length;for(C=0;C<A;C+=1)this.audios[C].pause()},resume:function(){var C,A=this.audios.length;for(C=0;C<A;C+=1)this.audios[C].resume()},setRate:function(C){var A,T=this.audios.length;for(A=0;A<T;A+=1)this.audios[A].setRate(C)},createAudio:function(C){return this.audioFactory?this.audioFactory(C):window.Howl?new window.Howl({src:[C]}):{isPlaying:!1,play:function(){this.isPlaying=!0},seek:function(){this.isPlaying=!1},playing:function(){},rate:function(){},setVolume:function(){}}},setAudioFactory:function(C){this.audioFactory=C},setVolume:function(C){this._volume=C,this._updateVolume()},mute:function(){this._isMuted=!0,this._updateVolume()},unmute:function(){this._isMuted=!1,this._updateVolume()},getVolume:function(){return this._volume},_updateVolume:function(){var C,A=this.audios.length;for(C=0;C<A;C+=1)this.audios[C].volume(this._volume*(this._isMuted?0:1))}},function(){return new P}}(),createTypedArray=function(){function P(C,A){var T=0,E=[],I;switch(C){case"int16":case"uint8c":I=1;break;default:I=1.1;break}for(T=0;T<A;T+=1)E.push(I);return E}function _(C,A){return C==="float32"?new Float32Array(A):C==="int16"?new Int16Array(A):C==="uint8c"?new Uint8ClampedArray(A):P(C,A)}return typeof Uint8ClampedArray=="function"&&typeof Float32Array=="function"?_:P}();function createSizedArray(P){return Array.apply(null,{length:P})}function _typeof$6(P){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?_typeof$6=function(C){return typeof C}:_typeof$6=function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C},_typeof$6(P)}var subframeEnabled=!0,expressionsPlugin=null,expressionsInterfaces=null,idPrefix$1="",isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),bmPow=Math.pow,bmSqrt=Math.sqrt,bmFloor=Math.floor,bmMax=Math.max,bmMin=Math.min,BMMath={};(function(){var P=["abs","acos","acosh","asin","asinh","atan","atanh","atan2","ceil","cbrt","expm1","clz32","cos","cosh","exp","floor","fround","hypot","imul","log","log1p","log2","log10","max","min","pow","random","round","sign","sin","sinh","sqrt","tan","tanh","trunc","E","LN10","LN2","LOG10E","LOG2E","PI","SQRT1_2","SQRT2"],_,C=P.length;for(_=0;_<C;_+=1)BMMath[P[_]]=Math[P[_]]})(),BMMath.random=Math.random,BMMath.abs=function(P){var _=_typeof$6(P);if(_==="object"&&P.length){var C=createSizedArray(P.length),A,T=P.length;for(A=0;A<T;A+=1)C[A]=Math.abs(P[A]);return C}return Math.abs(P)};var defaultCurveSegments=150,degToRads=Math.PI/180,roundCorner=.5519;function styleDiv(P){P.style.position="absolute",P.style.top=0,P.style.left=0,P.style.display="block",P.style.transformOrigin="0 0",P.style.webkitTransformOrigin="0 0",P.style.backfaceVisibility="visible",P.style.webkitBackfaceVisibility="visible",P.style.transformStyle="preserve-3d",P.style.webkitTransformStyle="preserve-3d",P.style.mozTransformStyle="preserve-3d"}function BMEnterFrameEvent(P,_,C,A){this.type=P,this.currentTime=_,this.totalTime=C,this.direction=A<0?-1:1}function BMCompleteEvent(P,_){this.type=P,this.direction=_<0?-1:1}function BMCompleteLoopEvent(P,_,C,A){this.type=P,this.currentLoop=C,this.totalLoops=_,this.direction=A<0?-1:1}function BMSegmentStartEvent(P,_,C){this.type=P,this.firstFrame=_,this.totalFrames=C}function BMDestroyEvent(P,_){this.type=P,this.target=_}function BMRenderFrameErrorEvent(P,_){this.type="renderFrameError",this.nativeError=P,this.currentTime=_}function BMConfigErrorEvent(P){this.type="configError",this.nativeError=P}var createElementID=function(){var P=0;return function(){return P+=1,idPrefix$1+"__lottie_element_"+P}}();function HSVtoRGB(P,_,C){var A,T,E,I,F,B,G,R;switch(I=Math.floor(P*6),F=P*6-I,B=C*(1-_),G=C*(1-F*_),R=C*(1-(1-F)*_),I%6){case 0:A=C,T=R,E=B;break;case 1:A=G,T=C,E=B;break;case 2:A=B,T=C,E=R;break;case 3:A=B,T=G,E=C;break;case 4:A=R,T=B,E=C;break;case 5:A=C,T=B,E=G;break}return[A,T,E]}function RGBtoHSV(P,_,C){var A=Math.max(P,_,C),T=Math.min(P,_,C),E=A-T,I,F=A===0?0:E/A,B=A/255;switch(A){case T:I=0;break;case P:I=_-C+E*(_<C?6:0),I/=6*E;break;case _:I=C-P+E*2,I/=6*E;break;case C:I=P-_+E*4,I/=6*E;break}return[I,F,B]}function addSaturationToRGB(P,_){var C=RGBtoHSV(P[0]*255,P[1]*255,P[2]*255);return C[1]+=_,C[1]>1?C[1]=1:C[1]<=0&&(C[1]=0),HSVtoRGB(C[0],C[1],C[2])}function addBrightnessToRGB(P,_){var C=RGBtoHSV(P[0]*255,P[1]*255,P[2]*255);return C[2]+=_,C[2]>1?C[2]=1:C[2]<0&&(C[2]=0),HSVtoRGB(C[0],C[1],C[2])}function addHueToRGB(P,_){var C=RGBtoHSV(P[0]*255,P[1]*255,P[2]*255);return C[0]+=_/360,C[0]>1?C[0]-=1:C[0]<0&&(C[0]+=1),HSVtoRGB(C[0],C[1],C[2])}var rgbToHex=function(){var P=[],_,C;for(_=0;_<256;_+=1)C=_.toString(16),P[_]=C.length===1?"0"+C:C;return function(A,T,E){return A<0&&(A=0),T<0&&(T=0),E<0&&(E=0),"#"+P[A]+P[T]+P[E]}}(),setSubframeEnabled=function(_){subframeEnabled=!!_},getSubframeEnabled=function(){return subframeEnabled},setExpressionsPlugin=function(_){expressionsPlugin=_},getExpressionsPlugin=function(){return expressionsPlugin},setExpressionInterfaces=function(_){expressionsInterfaces=_},getExpressionInterfaces=function(){return expressionsInterfaces},setDefaultCurveSegments=function(_){defaultCurveSegments=_},getDefaultCurveSegments=function(){return defaultCurveSegments},setIdPrefix=function(_){idPrefix$1=_};function createNS(P){return document.createElementNS(svgNS,P)}function _typeof$5(P){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?_typeof$5=function(C){return typeof C}:_typeof$5=function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C},_typeof$5(P)}var dataManager=function(){var P=1,_=[],C,A,T={onmessage:function(){},postMessage:function(L){C({data:L})}},E={postMessage:function(L){T.onmessage({data:L})}};function I(D){if(window.Worker&&window.Blob&&getWebWorker()){var L=new Blob(["var _workerSelf = self; self.onmessage = ",D.toString()],{type:"text/javascript"}),O=URL.createObjectURL(L);return new Worker(O)}return C=D,T}function F(){A||(A=I(function(L){function O(){function U(ut,Q){var it,Z,et=ut.length,ht,lt,ft,pt;for(Z=0;Z<et;Z+=1)if(it=ut[Z],"ks"in it&&!it.completed){if(it.completed=!0,it.hasMask){var mt=it.masksProperties;for(lt=mt.length,ht=0;ht<lt;ht+=1)if(mt[ht].pt.k.i)q(mt[ht].pt.k);else for(pt=mt[ht].pt.k.length,ft=0;ft<pt;ft+=1)mt[ht].pt.k[ft].s&&q(mt[ht].pt.k[ft].s[0]),mt[ht].pt.k[ft].e&&q(mt[ht].pt.k[ft].e[0])}it.ty===0?(it.layers=Y(it.refId,Q),U(it.layers,Q)):it.ty===4?K(it.shapes):it.ty===5&&ct(it)}}function W(ut,Q){if(ut){var it=0,Z=ut.length;for(it=0;it<Z;it+=1)ut[it].t===1&&(ut[it].data.layers=Y(ut[it].data.refId,Q),U(ut[it].data.layers,Q))}}function X(ut,Q){for(var it=0,Z=Q.length;it<Z;){if(Q[it].id===ut)return Q[it];it+=1}return null}function Y(ut,Q){var it=X(ut,Q);return it?it.layers.__used?JSON.parse(JSON.stringify(it.layers)):(it.layers.__used=!0,it.layers):null}function K(ut){var Q,it=ut.length,Z,et;for(Q=it-1;Q>=0;Q-=1)if(ut[Q].ty==="sh")if(ut[Q].ks.k.i)q(ut[Q].ks.k);else for(et=ut[Q].ks.k.length,Z=0;Z<et;Z+=1)ut[Q].ks.k[Z].s&&q(ut[Q].ks.k[Z].s[0]),ut[Q].ks.k[Z].e&&q(ut[Q].ks.k[Z].e[0]);else ut[Q].ty==="gr"&&K(ut[Q].it)}function q(ut){var Q,it=ut.i.length;for(Q=0;Q<it;Q+=1)ut.i[Q][0]+=ut.v[Q][0],ut.i[Q][1]+=ut.v[Q][1],ut.o[Q][0]+=ut.v[Q][0],ut.o[Q][1]+=ut.v[Q][1]}function J(ut,Q){var it=Q?Q.split("."):[100,100,100];return ut[0]>it[0]?!0:it[0]>ut[0]?!1:ut[1]>it[1]?!0:it[1]>ut[1]?!1:ut[2]>it[2]?!0:it[2]>ut[2]?!1:null}var tt=function(){var ut=[4,4,14];function Q(Z){var et=Z.t.d;Z.t.d={k:[{s:et,t:0}]}}function it(Z){var et,ht=Z.length;for(et=0;et<ht;et+=1)Z[et].ty===5&&Q(Z[et])}return function(Z){if(J(ut,Z.v)&&(it(Z.layers),Z.assets)){var et,ht=Z.assets.length;for(et=0;et<ht;et+=1)Z.assets[et].layers&&it(Z.assets[et].layers)}}}(),rt=function(){var ut=[4,7,99];return function(Q){if(Q.chars&&!J(ut,Q.v)){var it,Z=Q.chars.length;for(it=0;it<Z;it+=1){var et=Q.chars[it];et.data&&et.data.shapes&&(K(et.data.shapes),et.data.ip=0,et.data.op=99999,et.data.st=0,et.data.sr=1,et.data.ks={p:{k:[0,0],a:0},s:{k:[100,100],a:0},a:{k:[0,0],a:0},r:{k:0,a:0},o:{k:100,a:0}},Q.chars[it].t||(et.data.shapes.push({ty:"no"}),et.data.shapes[0].it.push({p:{k:[0,0],a:0},s:{k:[100,100],a:0},a:{k:[0,0],a:0},r:{k:0,a:0},o:{k:100,a:0},sk:{k:0,a:0},sa:{k:0,a:0},ty:"tr"})))}}}}(),st=function(){var ut=[5,7,15];function Q(Z){var et=Z.t.p;typeof et.a=="number"&&(et.a={a:0,k:et.a}),typeof et.p=="number"&&(et.p={a:0,k:et.p}),typeof et.r=="number"&&(et.r={a:0,k:et.r})}function it(Z){var et,ht=Z.length;for(et=0;et<ht;et+=1)Z[et].ty===5&&Q(Z[et])}return function(Z){if(J(ut,Z.v)&&(it(Z.layers),Z.assets)){var et,ht=Z.assets.length;for(et=0;et<ht;et+=1)Z.assets[et].layers&&it(Z.assets[et].layers)}}}(),nt=function(){var ut=[4,1,9];function Q(Z){var et,ht=Z.length,lt,ft;for(et=0;et<ht;et+=1)if(Z[et].ty==="gr")Q(Z[et].it);else if(Z[et].ty==="fl"||Z[et].ty==="st")if(Z[et].c.k&&Z[et].c.k[0].i)for(ft=Z[et].c.k.length,lt=0;lt<ft;lt+=1)Z[et].c.k[lt].s&&(Z[et].c.k[lt].s[0]/=255,Z[et].c.k[lt].s[1]/=255,Z[et].c.k[lt].s[2]/=255,Z[et].c.k[lt].s[3]/=255),Z[et].c.k[lt].e&&(Z[et].c.k[lt].e[0]/=255,Z[et].c.k[lt].e[1]/=255,Z[et].c.k[lt].e[2]/=255,Z[et].c.k[lt].e[3]/=255);else Z[et].c.k[0]/=255,Z[et].c.k[1]/=255,Z[et].c.k[2]/=255,Z[et].c.k[3]/=255}function it(Z){var et,ht=Z.length;for(et=0;et<ht;et+=1)Z[et].ty===4&&Q(Z[et].shapes)}return function(Z){if(J(ut,Z.v)&&(it(Z.layers),Z.assets)){var et,ht=Z.assets.length;for(et=0;et<ht;et+=1)Z.assets[et].layers&&it(Z.assets[et].layers)}}}(),at=function(){var ut=[4,4,18];function Q(Z){var et,ht=Z.length,lt,ft;for(et=ht-1;et>=0;et-=1)if(Z[et].ty==="sh")if(Z[et].ks.k.i)Z[et].ks.k.c=Z[et].closed;else for(ft=Z[et].ks.k.length,lt=0;lt<ft;lt+=1)Z[et].ks.k[lt].s&&(Z[et].ks.k[lt].s[0].c=Z[et].closed),Z[et].ks.k[lt].e&&(Z[et].ks.k[lt].e[0].c=Z[et].closed);else Z[et].ty==="gr"&&Q(Z[et].it)}function it(Z){var et,ht,lt=Z.length,ft,pt,mt,gt;for(ht=0;ht<lt;ht+=1){if(et=Z[ht],et.hasMask){var yt=et.masksProperties;for(pt=yt.length,ft=0;ft<pt;ft+=1)if(yt[ft].pt.k.i)yt[ft].pt.k.c=yt[ft].cl;else for(gt=yt[ft].pt.k.length,mt=0;mt<gt;mt+=1)yt[ft].pt.k[mt].s&&(yt[ft].pt.k[mt].s[0].c=yt[ft].cl),yt[ft].pt.k[mt].e&&(yt[ft].pt.k[mt].e[0].c=yt[ft].cl)}et.ty===4&&Q(et.shapes)}}return function(Z){if(J(ut,Z.v)&&(it(Z.layers),Z.assets)){var et,ht=Z.assets.length;for(et=0;et<ht;et+=1)Z.assets[et].layers&&it(Z.assets[et].layers)}}}();function ot(ut){ut.__complete||(nt(ut),tt(ut),rt(ut),st(ut),at(ut),U(ut.layers,ut.assets),W(ut.chars,ut.assets),ut.__complete=!0)}function ct(ut){ut.t.a.length===0&&"m"in ut.t.p}var dt={};return dt.completeData=ot,dt.checkColors=nt,dt.checkChars=rt,dt.checkPathProperties=st,dt.checkShapes=at,dt.completeLayers=U,dt}if(E.dataManager||(E.dataManager=O()),E.assetLoader||(E.assetLoader=function(){function U(X){var Y=X.getResponseHeader("content-type");return Y&&X.responseType==="json"&&Y.indexOf("json")!==-1||X.response&&_typeof$5(X.response)==="object"?X.response:X.response&&typeof X.response=="string"?JSON.parse(X.response):X.responseText?JSON.parse(X.responseText):null}function W(X,Y,K,q){var J,tt=new XMLHttpRequest;try{tt.responseType="json"}catch{}tt.onreadystatechange=function(){if(tt.readyState===4)if(tt.status===200)J=U(tt),K(J);else try{J=U(tt),K(J)}catch(rt){q&&q(rt)}};try{tt.open(["G","E","T"].join(""),X,!0)}catch{tt.open(["G","E","T"].join(""),Y+"/"+X,!0)}tt.send()}return{load:W}}()),L.data.type==="loadAnimation")E.assetLoader.load(L.data.path,L.data.fullPath,function(U){E.dataManager.completeData(U),E.postMessage({id:L.data.id,payload:U,status:"success"})},function(){E.postMessage({id:L.data.id,status:"error"})});else if(L.data.type==="complete"){var V=L.data.animation;E.dataManager.completeData(V),E.postMessage({id:L.data.id,payload:V,status:"success"})}else L.data.type==="loadData"&&E.assetLoader.load(L.data.path,L.data.fullPath,function(U){E.postMessage({id:L.data.id,payload:U,status:"success"})},function(){E.postMessage({id:L.data.id,status:"error"})})}),A.onmessage=function(D){var L=D.data,O=L.id,V=_[O];_[O]=null,L.status==="success"?V.onComplete(L.payload):V.onError&&V.onError()})}function B(D,L){P+=1;var O="processId_"+P;return _[O]={onComplete:D,onError:L},O}function G(D,L,O){F();var V=B(L,O);A.postMessage({type:"loadAnimation",path:D,fullPath:window.location.origin+window.location.pathname,id:V})}function R(D,L,O){F();var V=B(L,O);A.postMessage({type:"loadData",path:D,fullPath:window.location.origin+window.location.pathname,id:V})}function z(D,L,O){F();var V=B(L,O);A.postMessage({type:"complete",animation:D,id:V})}return{loadAnimation:G,loadData:R,completeAnimation:z}}(),ImagePreloader=function(){var P=function(){var W=createTag("canvas");W.width=1,W.height=1;var X=W.getContext("2d");return X.fillStyle="rgba(0,0,0,0)",X.fillRect(0,0,1,1),W}();function _(){this.loadedAssets+=1,this.loadedAssets===this.totalImages&&this.loadedFootagesCount===this.totalFootages&&this.imagesLoadedCb&&this.imagesLoadedCb(null)}function C(){this.loadedFootagesCount+=1,this.loadedAssets===this.totalImages&&this.loadedFootagesCount===this.totalFootages&&this.imagesLoadedCb&&this.imagesLoadedCb(null)}function A(W,X,Y){var K="";if(W.e)K=W.p;else if(X){var q=W.p;q.indexOf("images/")!==-1&&(q=q.split("/")[1]),K=X+q}else K=Y,K+=W.u?W.u:"",K+=W.p;return K}function T(W){var X=0,Y=setInterval((function(){var K=W.getBBox();(K.width||X>500)&&(this._imageLoaded(),clearInterval(Y)),X+=1}).bind(this),50)}function E(W){var X=A(W,this.assetsPath,this.path),Y=createNS("image");isSafari?this.testImageLoaded(Y):Y.addEventListener("load",this._imageLoaded,!1),Y.addEventListener("error",(function(){K.img=P,this._imageLoaded()}).bind(this),!1),Y.setAttributeNS("http://www.w3.org/1999/xlink","href",X),this._elementHelper.append?this._elementHelper.append(Y):this._elementHelper.appendChild(Y);var K={img:Y,assetData:W};return K}function I(W){var X=A(W,this.assetsPath,this.path),Y=createTag("img");Y.crossOrigin="anonymous",Y.addEventListener("load",this._imageLoaded,!1),Y.addEventListener("error",(function(){K.img=P,this._imageLoaded()}).bind(this),!1),Y.src=X;var K={img:Y,assetData:W};return K}function F(W){var X={assetData:W},Y=A(W,this.assetsPath,this.path);return dataManager.loadData(Y,(function(K){X.img=K,this._footageLoaded()}).bind(this),(function(){X.img={},this._footageLoaded()}).bind(this)),X}function B(W,X){this.imagesLoadedCb=X;var Y,K=W.length;for(Y=0;Y<K;Y+=1)W[Y].layers||(!W[Y].t||W[Y].t==="seq"?(this.totalImages+=1,this.images.push(this._createImageData(W[Y]))):W[Y].t===3&&(this.totalFootages+=1,this.images.push(this.createFootageData(W[Y]))))}function G(W){this.path=W||""}function R(W){this.assetsPath=W||""}function z(W){for(var X=0,Y=this.images.length;X<Y;){if(this.images[X].assetData===W)return this.images[X].img;X+=1}return null}function D(){this.imagesLoadedCb=null,this.images.length=0}function L(){return this.totalImages===this.loadedAssets}function O(){return this.totalFootages===this.loadedFootagesCount}function V(W,X){W==="svg"?(this._elementHelper=X,this._createImageData=this.createImageData.bind(this)):this._createImageData=this.createImgData.bind(this)}function U(){this._imageLoaded=_.bind(this),this._footageLoaded=C.bind(this),this.testImageLoaded=T.bind(this),this.createFootageData=F.bind(this),this.assetsPath="",this.path="",this.totalImages=0,this.totalFootages=0,this.loadedAssets=0,this.loadedFootagesCount=0,this.imagesLoadedCb=null,this.images=[]}return U.prototype={loadAssets:B,setAssetsPath:R,setPath:G,loadedImages:L,loadedFootages:O,destroy:D,getAsset:z,createImgData:I,createImageData:E,imageLoaded:_,footageLoaded:C,setCacheType:V},U}();function BaseEvent(){}BaseEvent.prototype={triggerEvent:function(_,C){if(this._cbs[_])for(var A=this._cbs[_],T=0;T<A.length;T+=1)A[T](C)},addEventListener:function(_,C){return this._cbs[_]||(this._cbs[_]=[]),this._cbs[_].push(C),(function(){this.removeEventListener(_,C)}).bind(this)},removeEventListener:function(_,C){if(!C)this._cbs[_]=null;else if(this._cbs[_]){for(var A=0,T=this._cbs[_].length;A<T;)this._cbs[_][A]===C&&(this._cbs[_].splice(A,1),A-=1,T-=1),A+=1;this._cbs[_].length||(this._cbs[_]=null)}}};var markerParser=function(){function P(_){for(var C=_.split(`\r
`),A={},T,E=0,I=0;I<C.length;I+=1)T=C[I].split(":"),T.length===2&&(A[T[0]]=T[1].trim(),E+=1);if(E===0)throw new Error;return A}return function(_){for(var C=[],A=0;A<_.length;A+=1){var T=_[A],E={time:T.tm,duration:T.dr};try{E.payload=JSON.parse(_[A].cm)}catch{try{E.payload=P(_[A].cm)}catch{E.payload={name:_[A].cm}}}C.push(E)}return C}}(),ProjectInterface=function(){function P(_){this.compositions.push(_)}return function(){function _(C){for(var A=0,T=this.compositions.length;A<T;){if(this.compositions[A].data&&this.compositions[A].data.nm===C)return this.compositions[A].prepareFrame&&this.compositions[A].data.xt&&this.compositions[A].prepareFrame(this.currentFrame),this.compositions[A].compInterface;A+=1}return null}return _.compositions=[],_.currentFrame=0,_.registerComposition=P,_}}(),renderers={},registerRenderer=function(_,C){renderers[_]=C};function getRenderer(P){return renderers[P]}function getRegisteredRenderer(){if(renderers.canvas)return"canvas";for(var P in renderers)if(renderers[P])return P;return""}function _typeof$4(P){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?_typeof$4=function(C){return typeof C}:_typeof$4=function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C},_typeof$4(P)}var AnimationItem=function(){this._cbs=[],this.name="",this.path="",this.isLoaded=!1,this.currentFrame=0,this.currentRawFrame=0,this.firstFrame=0,this.totalFrames=0,this.frameRate=0,this.frameMult=0,this.playSpeed=1,this.playDirection=1,this.playCount=0,this.animationData={},this.assets=[],this.isPaused=!0,this.autoplay=!1,this.loop=!0,this.renderer=null,this.animationID=createElementID(),this.assetsPath="",this.timeCompleted=0,this.segmentPos=0,this.isSubframeEnabled=getSubframeEnabled(),this.segments=[],this._idle=!0,this._completedLoop=!1,this.projectInterface=ProjectInterface(),this.imagePreloader=new ImagePreloader,this.audioController=audioControllerFactory(),this.markers=[],this.configAnimation=this.configAnimation.bind(this),this.onSetupError=this.onSetupError.bind(this),this.onSegmentComplete=this.onSegmentComplete.bind(this),this.drawnFrameEvent=new BMEnterFrameEvent("drawnFrame",0,0,0),this.expressionsPlugin=getExpressionsPlugin()};extendPrototype([BaseEvent],AnimationItem),AnimationItem.prototype.setParams=function(P){(P.wrapper||P.container)&&(this.wrapper=P.wrapper||P.container);var _="svg";P.animType?_=P.animType:P.renderer&&(_=P.renderer);var C=getRenderer(_);this.renderer=new C(this,P.rendererSettings),this.imagePreloader.setCacheType(_,this.renderer.globalData.defs),this.renderer.setProjectInterface(this.projectInterface),this.animType=_,P.loop===""||P.loop===null||P.loop===void 0||P.loop===!0?this.loop=!0:P.loop===!1?this.loop=!1:this.loop=parseInt(P.loop,10),this.autoplay="autoplay"in P?P.autoplay:!0,this.name=P.name?P.name:"",this.autoloadSegments=Object.prototype.hasOwnProperty.call(P,"autoloadSegments")?P.autoloadSegments:!0,this.assetsPath=P.assetsPath,this.initialSegment=P.initialSegment,P.audioFactory&&this.audioController.setAudioFactory(P.audioFactory),P.animationData?this.setupAnimation(P.animationData):P.path&&(P.path.lastIndexOf("\\")!==-1?this.path=P.path.substr(0,P.path.lastIndexOf("\\")+1):this.path=P.path.substr(0,P.path.lastIndexOf("/")+1),this.fileName=P.path.substr(P.path.lastIndexOf("/")+1),this.fileName=this.fileName.substr(0,this.fileName.lastIndexOf(".json")),dataManager.loadAnimation(P.path,this.configAnimation,this.onSetupError))},AnimationItem.prototype.onSetupError=function(){this.trigger("data_failed")},AnimationItem.prototype.setupAnimation=function(P){dataManager.completeAnimation(P,this.configAnimation)},AnimationItem.prototype.setData=function(P,_){_&&_typeof$4(_)!=="object"&&(_=JSON.parse(_));var C={wrapper:P,animationData:_},A=P.attributes;C.path=A.getNamedItem("data-animation-path")?A.getNamedItem("data-animation-path").value:A.getNamedItem("data-bm-path")?A.getNamedItem("data-bm-path").value:A.getNamedItem("bm-path")?A.getNamedItem("bm-path").value:"",C.animType=A.getNamedItem("data-anim-type")?A.getNamedItem("data-anim-type").value:A.getNamedItem("data-bm-type")?A.getNamedItem("data-bm-type").value:A.getNamedItem("bm-type")?A.getNamedItem("bm-type").value:A.getNamedItem("data-bm-renderer")?A.getNamedItem("data-bm-renderer").value:A.getNamedItem("bm-renderer")?A.getNamedItem("bm-renderer").value:getRegisteredRenderer()||"canvas";var T=A.getNamedItem("data-anim-loop")?A.getNamedItem("data-anim-loop").value:A.getNamedItem("data-bm-loop")?A.getNamedItem("data-bm-loop").value:A.getNamedItem("bm-loop")?A.getNamedItem("bm-loop").value:"";T==="false"?C.loop=!1:T==="true"?C.loop=!0:T!==""&&(C.loop=parseInt(T,10));var E=A.getNamedItem("data-anim-autoplay")?A.getNamedItem("data-anim-autoplay").value:A.getNamedItem("data-bm-autoplay")?A.getNamedItem("data-bm-autoplay").value:A.getNamedItem("bm-autoplay")?A.getNamedItem("bm-autoplay").value:!0;C.autoplay=E!=="false",C.name=A.getNamedItem("data-name")?A.getNamedItem("data-name").value:A.getNamedItem("data-bm-name")?A.getNamedItem("data-bm-name").value:A.getNamedItem("bm-name")?A.getNamedItem("bm-name").value:"";var I=A.getNamedItem("data-anim-prerender")?A.getNamedItem("data-anim-prerender").value:A.getNamedItem("data-bm-prerender")?A.getNamedItem("data-bm-prerender").value:A.getNamedItem("bm-prerender")?A.getNamedItem("bm-prerender").value:"";I==="false"&&(C.prerender=!1),C.path?this.setParams(C):this.trigger("destroy")},AnimationItem.prototype.includeLayers=function(P){P.op>this.animationData.op&&(this.animationData.op=P.op,this.totalFrames=Math.floor(P.op-this.animationData.ip));var _=this.animationData.layers,C,A=_.length,T=P.layers,E,I=T.length;for(E=0;E<I;E+=1)for(C=0;C<A;){if(_[C].id===T[E].id){_[C]=T[E];break}C+=1}if((P.chars||P.fonts)&&(this.renderer.globalData.fontManager.addChars(P.chars),this.renderer.globalData.fontManager.addFonts(P.fonts,this.renderer.globalData.defs)),P.assets)for(A=P.assets.length,C=0;C<A;C+=1)this.animationData.assets.push(P.assets[C]);this.animationData.__complete=!1,dataManager.completeAnimation(this.animationData,this.onSegmentComplete)},AnimationItem.prototype.onSegmentComplete=function(P){this.animationData=P;var _=getExpressionsPlugin();_&&_.initExpressions(this),this.loadNextSegment()},AnimationItem.prototype.loadNextSegment=function(){var P=this.animationData.segments;if(!P||P.length===0||!this.autoloadSegments){this.trigger("data_ready"),this.timeCompleted=this.totalFrames;return}var _=P.shift();this.timeCompleted=_.time*this.frameRate;var C=this.path+this.fileName+"_"+this.segmentPos+".json";this.segmentPos+=1,dataManager.loadData(C,this.includeLayers.bind(this),(function(){this.trigger("data_failed")}).bind(this))},AnimationItem.prototype.loadSegments=function(){var P=this.animationData.segments;P||(this.timeCompleted=this.totalFrames),this.loadNextSegment()},AnimationItem.prototype.imagesLoaded=function(){this.trigger("loaded_images"),this.checkLoaded()},AnimationItem.prototype.preloadImages=function(){this.imagePreloader.setAssetsPath(this.assetsPath),this.imagePreloader.setPath(this.path),this.imagePreloader.loadAssets(this.animationData.assets,this.imagesLoaded.bind(this))},AnimationItem.prototype.configAnimation=function(P){if(this.renderer)try{this.animationData=P,this.initialSegment?(this.totalFrames=Math.floor(this.initialSegment[1]-this.initialSegment[0]),this.firstFrame=Math.round(this.initialSegment[0])):(this.totalFrames=Math.floor(this.animationData.op-this.animationData.ip),this.firstFrame=Math.round(this.animationData.ip)),this.renderer.configAnimation(P),P.assets||(P.assets=[]),this.assets=this.animationData.assets,this.frameRate=this.animationData.fr,this.frameMult=this.animationData.fr/1e3,this.renderer.searchExtraCompositions(P.assets),this.markers=markerParser(P.markers||[]),this.trigger("config_ready"),this.preloadImages(),this.loadSegments(),this.updaFrameModifier(),this.waitForFontsLoaded(),this.isPaused&&this.audioController.pause()}catch(_){this.triggerConfigError(_)}},AnimationItem.prototype.waitForFontsLoaded=function(){this.renderer&&(this.renderer.globalData.fontManager.isLoaded?this.checkLoaded():setTimeout(this.waitForFontsLoaded.bind(this),20))},AnimationItem.prototype.checkLoaded=function(){if(!this.isLoaded&&this.renderer.globalData.fontManager.isLoaded&&(this.imagePreloader.loadedImages()||this.renderer.rendererType!=="canvas")&&this.imagePreloader.loadedFootages()){this.isLoaded=!0;var P=getExpressionsPlugin();P&&P.initExpressions(this),this.renderer.initItems(),setTimeout((function(){this.trigger("DOMLoaded")}).bind(this),0),this.gotoFrame(),this.autoplay&&this.play()}},AnimationItem.prototype.resize=function(P,_){var C=typeof P=="number"?P:void 0,A=typeof _=="number"?_:void 0;this.renderer.updateContainerSize(C,A)},AnimationItem.prototype.setSubframe=function(P){this.isSubframeEnabled=!!P},AnimationItem.prototype.gotoFrame=function(){this.currentFrame=this.isSubframeEnabled?this.currentRawFrame:~~this.currentRawFrame,this.timeCompleted!==this.totalFrames&&this.currentFrame>this.timeCompleted&&(this.currentFrame=this.timeCompleted),this.trigger("enterFrame"),this.renderFrame(),this.trigger("drawnFrame")},AnimationItem.prototype.renderFrame=function(){if(!(this.isLoaded===!1||!this.renderer))try{this.expressionsPlugin&&this.expressionsPlugin.resetFrame(),this.renderer.renderFrame(this.currentFrame+this.firstFrame)}catch(P){this.triggerRenderFrameError(P)}},AnimationItem.prototype.play=function(P){P&&this.name!==P||this.isPaused===!0&&(this.isPaused=!1,this.trigger("_play"),this.audioController.resume(),this._idle&&(this._idle=!1,this.trigger("_active")))},AnimationItem.prototype.pause=function(P){P&&this.name!==P||this.isPaused===!1&&(this.isPaused=!0,this.trigger("_pause"),this._idle=!0,this.trigger("_idle"),this.audioController.pause())},AnimationItem.prototype.togglePause=function(P){P&&this.name!==P||(this.isPaused===!0?this.play():this.pause())},AnimationItem.prototype.stop=function(P){P&&this.name!==P||(this.pause(),this.playCount=0,this._completedLoop=!1,this.setCurrentRawFrameValue(0))},AnimationItem.prototype.getMarkerData=function(P){for(var _,C=0;C<this.markers.length;C+=1)if(_=this.markers[C],_.payload&&_.payload.name===P)return _;return null},AnimationItem.prototype.goToAndStop=function(P,_,C){if(!(C&&this.name!==C)){var A=Number(P);if(isNaN(A)){var T=this.getMarkerData(P);T&&this.goToAndStop(T.time,!0)}else _?this.setCurrentRawFrameValue(P):this.setCurrentRawFrameValue(P*this.frameModifier);this.pause()}},AnimationItem.prototype.goToAndPlay=function(P,_,C){if(!(C&&this.name!==C)){var A=Number(P);if(isNaN(A)){var T=this.getMarkerData(P);T&&(T.duration?this.playSegments([T.time,T.time+T.duration],!0):this.goToAndStop(T.time,!0))}else this.goToAndStop(A,_,C);this.play()}},AnimationItem.prototype.advanceTime=function(P){if(!(this.isPaused===!0||this.isLoaded===!1)){var _=this.currentRawFrame+P*this.frameModifier,C=!1;_>=this.totalFrames-1&&this.frameModifier>0?!this.loop||this.playCount===this.loop?this.checkSegments(_>this.totalFrames?_%this.totalFrames:0)||(C=!0,_=this.totalFrames-1):_>=this.totalFrames?(this.playCount+=1,this.checkSegments(_%this.totalFrames)||(this.setCurrentRawFrameValue(_%this.totalFrames),this._completedLoop=!0,this.trigger("loopComplete"))):this.setCurrentRawFrameValue(_):_<0?this.checkSegments(_%this.totalFrames)||(this.loop&&!(this.playCount--<=0&&this.loop!==!0)?(this.setCurrentRawFrameValue(this.totalFrames+_%this.totalFrames),this._completedLoop?this.trigger("loopComplete"):this._completedLoop=!0):(C=!0,_=0)):this.setCurrentRawFrameValue(_),C&&(this.setCurrentRawFrameValue(_),this.pause(),this.trigger("complete"))}},AnimationItem.prototype.adjustSegment=function(P,_){this.playCount=0,P[1]<P[0]?(this.frameModifier>0&&(this.playSpeed<0?this.setSpeed(-this.playSpeed):this.setDirection(-1)),this.totalFrames=P[0]-P[1],this.timeCompleted=this.totalFrames,this.firstFrame=P[1],this.setCurrentRawFrameValue(this.totalFrames-.001-_)):P[1]>P[0]&&(this.frameModifier<0&&(this.playSpeed<0?this.setSpeed(-this.playSpeed):this.setDirection(1)),this.totalFrames=P[1]-P[0],this.timeCompleted=this.totalFrames,this.firstFrame=P[0],this.setCurrentRawFrameValue(.001+_)),this.trigger("segmentStart")},AnimationItem.prototype.setSegment=function(P,_){var C=-1;this.isPaused&&(this.currentRawFrame+this.firstFrame<P?C=P:this.currentRawFrame+this.firstFrame>_&&(C=_-P)),this.firstFrame=P,this.totalFrames=_-P,this.timeCompleted=this.totalFrames,C!==-1&&this.goToAndStop(C,!0)},AnimationItem.prototype.playSegments=function(P,_){if(_&&(this.segments.length=0),_typeof$4(P[0])==="object"){var C,A=P.length;for(C=0;C<A;C+=1)this.segments.push(P[C])}else this.segments.push(P);this.segments.length&&_&&this.adjustSegment(this.segments.shift(),0),this.isPaused&&this.play()},AnimationItem.prototype.resetSegments=function(P){this.segments.length=0,this.segments.push([this.animationData.ip,this.animationData.op]),P&&this.checkSegments(0)},AnimationItem.prototype.checkSegments=function(P){return this.segments.length?(this.adjustSegment(this.segments.shift(),P),!0):!1},AnimationItem.prototype.destroy=function(P){P&&this.name!==P||!this.renderer||(this.renderer.destroy(),this.imagePreloader.destroy(),this.trigger("destroy"),this._cbs=null,this.onEnterFrame=null,this.onLoopComplete=null,this.onComplete=null,this.onSegmentStart=null,this.onDestroy=null,this.renderer=null,this.expressionsPlugin=null,this.imagePreloader=null,this.projectInterface=null)},AnimationItem.prototype.setCurrentRawFrameValue=function(P){this.currentRawFrame=P,this.gotoFrame()},AnimationItem.prototype.setSpeed=function(P){this.playSpeed=P,this.updaFrameModifier()},AnimationItem.prototype.setDirection=function(P){this.playDirection=P<0?-1:1,this.updaFrameModifier()},AnimationItem.prototype.setLoop=function(P){this.loop=P},AnimationItem.prototype.setVolume=function(P,_){_&&this.name!==_||this.audioController.setVolume(P)},AnimationItem.prototype.getVolume=function(){return this.audioController.getVolume()},AnimationItem.prototype.mute=function(P){P&&this.name!==P||this.audioController.mute()},AnimationItem.prototype.unmute=function(P){P&&this.name!==P||this.audioController.unmute()},AnimationItem.prototype.updaFrameModifier=function(){this.frameModifier=this.frameMult*this.playSpeed*this.playDirection,this.audioController.setRate(this.playSpeed*this.playDirection)},AnimationItem.prototype.getPath=function(){return this.path},AnimationItem.prototype.getAssetsPath=function(P){var _="";if(P.e)_=P.p;else if(this.assetsPath){var C=P.p;C.indexOf("images/")!==-1&&(C=C.split("/")[1]),_=this.assetsPath+C}else _=this.path,_+=P.u?P.u:"",_+=P.p;return _},AnimationItem.prototype.getAssetData=function(P){for(var _=0,C=this.assets.length;_<C;){if(P===this.assets[_].id)return this.assets[_];_+=1}return null},AnimationItem.prototype.hide=function(){this.renderer.hide()},AnimationItem.prototype.show=function(){this.renderer.show()},AnimationItem.prototype.getDuration=function(P){return P?this.totalFrames:this.totalFrames/this.frameRate},AnimationItem.prototype.updateDocumentData=function(P,_,C){try{var A=this.renderer.getElementByPath(P);A.updateDocumentData(_,C)}catch{}},AnimationItem.prototype.trigger=function(P){if(this._cbs&&this._cbs[P])switch(P){case"enterFrame":this.triggerEvent(P,new BMEnterFrameEvent(P,this.currentFrame,this.totalFrames,this.frameModifier));break;case"drawnFrame":this.drawnFrameEvent.currentTime=this.currentFrame,this.drawnFrameEvent.totalTime=this.totalFrames,this.drawnFrameEvent.direction=this.frameModifier,this.triggerEvent(P,this.drawnFrameEvent);break;case"loopComplete":this.triggerEvent(P,new BMCompleteLoopEvent(P,this.loop,this.playCount,this.frameMult));break;case"complete":this.triggerEvent(P,new BMCompleteEvent(P,this.frameMult));break;case"segmentStart":this.triggerEvent(P,new BMSegmentStartEvent(P,this.firstFrame,this.totalFrames));break;case"destroy":this.triggerEvent(P,new BMDestroyEvent(P,this));break;default:this.triggerEvent(P)}P==="enterFrame"&&this.onEnterFrame&&this.onEnterFrame.call(this,new BMEnterFrameEvent(P,this.currentFrame,this.totalFrames,this.frameMult)),P==="loopComplete"&&this.onLoopComplete&&this.onLoopComplete.call(this,new BMCompleteLoopEvent(P,this.loop,this.playCount,this.frameMult)),P==="complete"&&this.onComplete&&this.onComplete.call(this,new BMCompleteEvent(P,this.frameMult)),P==="segmentStart"&&this.onSegmentStart&&this.onSegmentStart.call(this,new BMSegmentStartEvent(P,this.firstFrame,this.totalFrames)),P==="destroy"&&this.onDestroy&&this.onDestroy.call(this,new BMDestroyEvent(P,this))},AnimationItem.prototype.triggerRenderFrameError=function(P){var _=new BMRenderFrameErrorEvent(P,this.currentFrame);this.triggerEvent("error",_),this.onError&&this.onError.call(this,_)},AnimationItem.prototype.triggerConfigError=function(P){var _=new BMConfigErrorEvent(P,this.currentFrame);this.triggerEvent("error",_),this.onError&&this.onError.call(this,_)};var animationManager=function(){var P={},_=[],C=0,A=0,T=0,E=!0,I=!1;function F(Q){for(var it=0,Z=Q.target;it<A;)_[it].animation===Z&&(_.splice(it,1),it-=1,A-=1,Z.isPaused||z()),it+=1}function B(Q,it){if(!Q)return null;for(var Z=0;Z<A;){if(_[Z].elem===Q&&_[Z].elem!==null)return _[Z].animation;Z+=1}var et=new AnimationItem;return D(et,Q),et.setData(Q,it),et}function G(){var Q,it=_.length,Z=[];for(Q=0;Q<it;Q+=1)Z.push(_[Q].animation);return Z}function R(){T+=1,nt()}function z(){T-=1}function D(Q,it){Q.addEventListener("destroy",F),Q.addEventListener("_active",R),Q.addEventListener("_idle",z),_.push({elem:it,animation:Q}),A+=1}function L(Q){var it=new AnimationItem;return D(it,null),it.setParams(Q),it}function O(Q,it){var Z;for(Z=0;Z<A;Z+=1)_[Z].animation.setSpeed(Q,it)}function V(Q,it){var Z;for(Z=0;Z<A;Z+=1)_[Z].animation.setDirection(Q,it)}function U(Q){var it;for(it=0;it<A;it+=1)_[it].animation.play(Q)}function W(Q){var it=Q-C,Z;for(Z=0;Z<A;Z+=1)_[Z].animation.advanceTime(it);C=Q,T&&!I?window.requestAnimationFrame(W):E=!0}function X(Q){C=Q,window.requestAnimationFrame(W)}function Y(Q){var it;for(it=0;it<A;it+=1)_[it].animation.pause(Q)}function K(Q,it,Z){var et;for(et=0;et<A;et+=1)_[et].animation.goToAndStop(Q,it,Z)}function q(Q){var it;for(it=0;it<A;it+=1)_[it].animation.stop(Q)}function J(Q){var it;for(it=0;it<A;it+=1)_[it].animation.togglePause(Q)}function tt(Q){var it;for(it=A-1;it>=0;it-=1)_[it].animation.destroy(Q)}function rt(Q,it,Z){var et=[].concat([].slice.call(document.getElementsByClassName("lottie")),[].slice.call(document.getElementsByClassName("bodymovin"))),ht,lt=et.length;for(ht=0;ht<lt;ht+=1)Z&&et[ht].setAttribute("data-bm-type",Z),B(et[ht],Q);if(it&&lt===0){Z||(Z="svg");var ft=document.getElementsByTagName("body")[0];ft.innerText="";var pt=createTag("div");pt.style.width="100%",pt.style.height="100%",pt.setAttribute("data-bm-type",Z),ft.appendChild(pt),B(pt,Q)}}function st(){var Q;for(Q=0;Q<A;Q+=1)_[Q].animation.resize()}function nt(){!I&&T&&E&&(window.requestAnimationFrame(X),E=!1)}function at(){I=!0}function ot(){I=!1,nt()}function ct(Q,it){var Z;for(Z=0;Z<A;Z+=1)_[Z].animation.setVolume(Q,it)}function dt(Q){var it;for(it=0;it<A;it+=1)_[it].animation.mute(Q)}function ut(Q){var it;for(it=0;it<A;it+=1)_[it].animation.unmute(Q)}return P.registerAnimation=B,P.loadAnimation=L,P.setSpeed=O,P.setDirection=V,P.play=U,P.pause=Y,P.stop=q,P.togglePause=J,P.searchAnimations=rt,P.resize=st,P.goToAndStop=K,P.destroy=tt,P.freeze=at,P.unfreeze=ot,P.setVolume=ct,P.mute=dt,P.unmute=ut,P.getRegisteredAnimations=G,P}(),BezierFactory=function(){var P={};P.getBezierEasing=C;var _={};function C(X,Y,K,q,J){var tt=J||("bez_"+X+"_"+Y+"_"+K+"_"+q).replace(/\./g,"p");if(_[tt])return _[tt];var rt=new W([X,Y,K,q]);return _[tt]=rt,rt}var A=4,T=.001,E=1e-7,I=10,F=11,B=1/(F-1),G=typeof Float32Array=="function";function R(X,Y){return 1-3*Y+3*X}function z(X,Y){return 3*Y-6*X}function D(X){return 3*X}function L(X,Y,K){return((R(Y,K)*X+z(Y,K))*X+D(Y))*X}function O(X,Y,K){return 3*R(Y,K)*X*X+2*z(Y,K)*X+D(Y)}function V(X,Y,K,q,J){var tt,rt,st=0;do rt=Y+(K-Y)/2,tt=L(rt,q,J)-X,tt>0?K=rt:Y=rt;while(Math.abs(tt)>E&&++st<I);return rt}function U(X,Y,K,q){for(var J=0;J<A;++J){var tt=O(Y,K,q);if(tt===0)return Y;var rt=L(Y,K,q)-X;Y-=rt/tt}return Y}function W(X){this._p=X,this._mSampleValues=G?new Float32Array(F):new Array(F),this._precomputed=!1,this.get=this.get.bind(this)}return W.prototype={get:function(Y){var K=this._p[0],q=this._p[1],J=this._p[2],tt=this._p[3];return this._precomputed||this._precompute(),K===q&&J===tt?Y:Y===0?0:Y===1?1:L(this._getTForX(Y),q,tt)},_precompute:function(){var Y=this._p[0],K=this._p[1],q=this._p[2],J=this._p[3];this._precomputed=!0,(Y!==K||q!==J)&&this._calcSampleValues()},_calcSampleValues:function(){for(var Y=this._p[0],K=this._p[2],q=0;q<F;++q)this._mSampleValues[q]=L(q*B,Y,K)},_getTForX:function(Y){for(var K=this._p[0],q=this._p[2],J=this._mSampleValues,tt=0,rt=1,st=F-1;rt!==st&&J[rt]<=Y;++rt)tt+=B;--rt;var nt=(Y-J[rt])/(J[rt+1]-J[rt]),at=tt+nt*B,ot=O(at,K,q);return ot>=T?U(Y,at,K,q):ot===0?at:V(Y,tt,tt+B,K,q)}},P}(),pooling=function(){function P(_){return _.concat(createSizedArray(_.length))}return{double:P}}(),poolFactory=function(){return function(P,_,C){var A=0,T=P,E=createSizedArray(T),I={newElement:F,release:B};function F(){var G;return A?(A-=1,G=E[A]):G=_(),G}function B(G){A===T&&(E=pooling.double(E),T*=2),C&&C(G),E[A]=G,A+=1}return I}}(),bezierLengthPool=function(){function P(){return{addedLength:0,percents:createTypedArray("float32",getDefaultCurveSegments()),lengths:createTypedArray("float32",getDefaultCurveSegments())}}return poolFactory(8,P)}(),segmentsLengthPool=function(){function P(){return{lengths:[],totalLength:0}}function _(C){var A,T=C.lengths.length;for(A=0;A<T;A+=1)bezierLengthPool.release(C.lengths[A]);C.lengths.length=0}return poolFactory(8,P,_)}();function bezFunction(){var P=Math;function _(D,L,O,V,U,W){var X=D*V+L*U+O*W-U*V-W*D-O*L;return X>-.001&&X<.001}function C(D,L,O,V,U,W,X,Y,K){if(O===0&&W===0&&K===0)return _(D,L,V,U,X,Y);var q=P.sqrt(P.pow(V-D,2)+P.pow(U-L,2)+P.pow(W-O,2)),J=P.sqrt(P.pow(X-D,2)+P.pow(Y-L,2)+P.pow(K-O,2)),tt=P.sqrt(P.pow(X-V,2)+P.pow(Y-U,2)+P.pow(K-W,2)),rt;return q>J?q>tt?rt=q-J-tt:rt=tt-J-q:tt>J?rt=tt-J-q:rt=J-q-tt,rt>-1e-4&&rt<1e-4}var A=function(){return function(D,L,O,V){var U=getDefaultCurveSegments(),W,X,Y,K,q,J=0,tt,rt=[],st=[],nt=bezierLengthPool.newElement();for(Y=O.length,W=0;W<U;W+=1){for(q=W/(U-1),tt=0,X=0;X<Y;X+=1)K=bmPow(1-q,3)*D[X]+3*bmPow(1-q,2)*q*O[X]+3*(1-q)*bmPow(q,2)*V[X]+bmPow(q,3)*L[X],rt[X]=K,st[X]!==null&&(tt+=bmPow(rt[X]-st[X],2)),st[X]=rt[X];tt&&(tt=bmSqrt(tt),J+=tt),nt.percents[W]=q,nt.lengths[W]=J}return nt.addedLength=J,nt}}();function T(D){var L=segmentsLengthPool.newElement(),O=D.c,V=D.v,U=D.o,W=D.i,X,Y=D._length,K=L.lengths,q=0;for(X=0;X<Y-1;X+=1)K[X]=A(V[X],V[X+1],U[X],W[X+1]),q+=K[X].addedLength;return O&&Y&&(K[X]=A(V[X],V[0],U[X],W[0]),q+=K[X].addedLength),L.totalLength=q,L}function E(D){this.segmentLength=0,this.points=new Array(D)}function I(D,L){this.partialLength=D,this.point=L}var F=function(){var D={};return function(L,O,V,U){var W=(L[0]+"_"+L[1]+"_"+O[0]+"_"+O[1]+"_"+V[0]+"_"+V[1]+"_"+U[0]+"_"+U[1]).replace(/\./g,"p");if(!D[W]){var X=getDefaultCurveSegments(),Y,K,q,J,tt,rt=0,st,nt,at=null;L.length===2&&(L[0]!==O[0]||L[1]!==O[1])&&_(L[0],L[1],O[0],O[1],L[0]+V[0],L[1]+V[1])&&_(L[0],L[1],O[0],O[1],O[0]+U[0],O[1]+U[1])&&(X=2);var ot=new E(X);for(q=V.length,Y=0;Y<X;Y+=1){for(nt=createSizedArray(q),tt=Y/(X-1),st=0,K=0;K<q;K+=1)J=bmPow(1-tt,3)*L[K]+3*bmPow(1-tt,2)*tt*(L[K]+V[K])+3*(1-tt)*bmPow(tt,2)*(O[K]+U[K])+bmPow(tt,3)*O[K],nt[K]=J,at!==null&&(st+=bmPow(nt[K]-at[K],2));st=bmSqrt(st),rt+=st,ot.points[Y]=new I(st,nt),at=nt}ot.segmentLength=rt,D[W]=ot}return D[W]}}();function B(D,L){var O=L.percents,V=L.lengths,U=O.length,W=bmFloor((U-1)*D),X=D*L.addedLength,Y=0;if(W===U-1||W===0||X===V[W])return O[W];for(var K=V[W]>X?-1:1,q=!0;q;)if(V[W]<=X&&V[W+1]>X?(Y=(X-V[W])/(V[W+1]-V[W]),q=!1):W+=K,W<0||W>=U-1){if(W===U-1)return O[W];q=!1}return O[W]+(O[W+1]-O[W])*Y}function G(D,L,O,V,U,W){var X=B(U,W),Y=1-X,K=P.round((Y*Y*Y*D[0]+(X*Y*Y+Y*X*Y+Y*Y*X)*O[0]+(X*X*Y+Y*X*X+X*Y*X)*V[0]+X*X*X*L[0])*1e3)/1e3,q=P.round((Y*Y*Y*D[1]+(X*Y*Y+Y*X*Y+Y*Y*X)*O[1]+(X*X*Y+Y*X*X+X*Y*X)*V[1]+X*X*X*L[1])*1e3)/1e3;return[K,q]}var R=createTypedArray("float32",8);function z(D,L,O,V,U,W,X){U<0?U=0:U>1&&(U=1);var Y=B(U,X);W=W>1?1:W;var K=B(W,X),q,J=D.length,tt=1-Y,rt=1-K,st=tt*tt*tt,nt=Y*tt*tt*3,at=Y*Y*tt*3,ot=Y*Y*Y,ct=tt*tt*rt,dt=Y*tt*rt+tt*Y*rt+tt*tt*K,ut=Y*Y*rt+tt*Y*K+Y*tt*K,Q=Y*Y*K,it=tt*rt*rt,Z=Y*rt*rt+tt*K*rt+tt*rt*K,et=Y*K*rt+tt*K*K+Y*rt*K,ht=Y*K*K,lt=rt*rt*rt,ft=K*rt*rt+rt*K*rt+rt*rt*K,pt=K*K*rt+rt*K*K+K*rt*K,mt=K*K*K;for(q=0;q<J;q+=1)R[q*4]=P.round((st*D[q]+nt*O[q]+at*V[q]+ot*L[q])*1e3)/1e3,R[q*4+1]=P.round((ct*D[q]+dt*O[q]+ut*V[q]+Q*L[q])*1e3)/1e3,R[q*4+2]=P.round((it*D[q]+Z*O[q]+et*V[q]+ht*L[q])*1e3)/1e3,R[q*4+3]=P.round((lt*D[q]+ft*O[q]+pt*V[q]+mt*L[q])*1e3)/1e3;return R}return{getSegmentsLength:T,getNewSegment:z,getPointInSegment:G,buildBezierData:F,pointOnLine2D:_,pointOnLine3D:C}}var bez=bezFunction(),initFrame=initialDefaultFrame,mathAbs=Math.abs;function interpolateValue(P,_){var C=this.offsetTime,A;this.propType==="multidimensional"&&(A=createTypedArray("float32",this.pv.length));for(var T=_.lastIndex,E=T,I=this.keyframes.length-1,F=!0,B,G,R;F;){if(B=this.keyframes[E],G=this.keyframes[E+1],E===I-1&&P>=G.t-C){B.h&&(B=G),T=0;break}if(G.t-C>P){T=E;break}E<I-1?E+=1:(T=0,F=!1)}R=this.keyframesMetadata[E]||{};var z,D,L,O,V,U,W=G.t-C,X=B.t-C,Y;if(B.to){R.bezierData||(R.bezierData=bez.buildBezierData(B.s,G.s||B.e,B.to,B.ti));var K=R.bezierData;if(P>=W||P<X){var q=P>=W?K.points.length-1:0;for(D=K.points[q].point.length,z=0;z<D;z+=1)A[z]=K.points[q].point[z]}else{R.__fnct?U=R.__fnct:(U=BezierFactory.getBezierEasing(B.o.x,B.o.y,B.i.x,B.i.y,B.n).get,R.__fnct=U),L=U((P-X)/(W-X));var J=K.segmentLength*L,tt,rt=_.lastFrame<P&&_._lastKeyframeIndex===E?_._lastAddedLength:0;for(V=_.lastFrame<P&&_._lastKeyframeIndex===E?_._lastPoint:0,F=!0,O=K.points.length;F;){if(rt+=K.points[V].partialLength,J===0||L===0||V===K.points.length-1){for(D=K.points[V].point.length,z=0;z<D;z+=1)A[z]=K.points[V].point[z];break}else if(J>=rt&&J<rt+K.points[V+1].partialLength){for(tt=(J-rt)/K.points[V+1].partialLength,D=K.points[V].point.length,z=0;z<D;z+=1)A[z]=K.points[V].point[z]+(K.points[V+1].point[z]-K.points[V].point[z])*tt;break}V<O-1?V+=1:F=!1}_._lastPoint=V,_._lastAddedLength=rt-K.points[V].partialLength,_._lastKeyframeIndex=E}}else{var st,nt,at,ot,ct;if(I=B.s.length,Y=G.s||B.e,this.sh&&B.h!==1)if(P>=W)A[0]=Y[0],A[1]=Y[1],A[2]=Y[2];else if(P<=X)A[0]=B.s[0],A[1]=B.s[1],A[2]=B.s[2];else{var dt=createQuaternion(B.s),ut=createQuaternion(Y),Q=(P-X)/(W-X);quaternionToEuler(A,slerp(dt,ut,Q))}else for(E=0;E<I;E+=1)B.h!==1&&(P>=W?L=1:P<X?L=0:(B.o.x.constructor===Array?(R.__fnct||(R.__fnct=[]),R.__fnct[E]?U=R.__fnct[E]:(st=B.o.x[E]===void 0?B.o.x[0]:B.o.x[E],nt=B.o.y[E]===void 0?B.o.y[0]:B.o.y[E],at=B.i.x[E]===void 0?B.i.x[0]:B.i.x[E],ot=B.i.y[E]===void 0?B.i.y[0]:B.i.y[E],U=BezierFactory.getBezierEasing(st,nt,at,ot).get,R.__fnct[E]=U)):R.__fnct?U=R.__fnct:(st=B.o.x,nt=B.o.y,at=B.i.x,ot=B.i.y,U=BezierFactory.getBezierEasing(st,nt,at,ot).get,B.keyframeMetadata=U),L=U((P-X)/(W-X)))),Y=G.s||B.e,ct=B.h===1?B.s[E]:B.s[E]+(Y[E]-B.s[E])*L,this.propType==="multidimensional"?A[E]=ct:A=ct}return _.lastIndex=T,A}function slerp(P,_,C){var A=[],T=P[0],E=P[1],I=P[2],F=P[3],B=_[0],G=_[1],R=_[2],z=_[3],D,L,O,V,U;return L=T*B+E*G+I*R+F*z,L<0&&(L=-L,B=-B,G=-G,R=-R,z=-z),1-L>1e-6?(D=Math.acos(L),O=Math.sin(D),V=Math.sin((1-C)*D)/O,U=Math.sin(C*D)/O):(V=1-C,U=C),A[0]=V*T+U*B,A[1]=V*E+U*G,A[2]=V*I+U*R,A[3]=V*F+U*z,A}function quaternionToEuler(P,_){var C=_[0],A=_[1],T=_[2],E=_[3],I=Math.atan2(2*A*E-2*C*T,1-2*A*A-2*T*T),F=Math.asin(2*C*A+2*T*E),B=Math.atan2(2*C*E-2*A*T,1-2*C*C-2*T*T);P[0]=I/degToRads,P[1]=F/degToRads,P[2]=B/degToRads}function createQuaternion(P){var _=P[0]*degToRads,C=P[1]*degToRads,A=P[2]*degToRads,T=Math.cos(_/2),E=Math.cos(C/2),I=Math.cos(A/2),F=Math.sin(_/2),B=Math.sin(C/2),G=Math.sin(A/2),R=T*E*I-F*B*G,z=F*B*I+T*E*G,D=F*E*I+T*B*G,L=T*B*I-F*E*G;return[z,D,L,R]}function getValueAtCurrentTime(){var P=this.comp.renderedFrame-this.offsetTime,_=this.keyframes[0].t-this.offsetTime,C=this.keyframes[this.keyframes.length-1].t-this.offsetTime;if(!(P===this._caching.lastFrame||this._caching.lastFrame!==initFrame&&(this._caching.lastFrame>=C&&P>=C||this._caching.lastFrame<_&&P<_))){this._caching.lastFrame>=P&&(this._caching._lastKeyframeIndex=-1,this._caching.lastIndex=0);var A=this.interpolateValue(P,this._caching);this.pv=A}return this._caching.lastFrame=P,this.pv}function setVValue(P){var _;if(this.propType==="unidimensional")_=P*this.mult,mathAbs(this.v-_)>1e-5&&(this.v=_,this._mdf=!0);else for(var C=0,A=this.v.length;C<A;)_=P[C]*this.mult,mathAbs(this.v[C]-_)>1e-5&&(this.v[C]=_,this._mdf=!0),C+=1}function processEffectsSequence(){if(!(this.elem.globalData.frameId===this.frameId||!this.effectsSequence.length)){if(this.lock){this.setVValue(this.pv);return}this.lock=!0,this._mdf=this._isFirstFrame;var P,_=this.effectsSequence.length,C=this.kf?this.pv:this.data.k;for(P=0;P<_;P+=1)C=this.effectsSequence[P](C);this.setVValue(C),this._isFirstFrame=!1,this.lock=!1,this.frameId=this.elem.globalData.frameId}}function addEffect(P){this.effectsSequence.push(P),this.container.addDynamicProperty(this)}function ValueProperty(P,_,C,A){this.propType="unidimensional",this.mult=C||1,this.data=_,this.v=C?_.k*C:_.k,this.pv=_.k,this._mdf=!1,this.elem=P,this.container=A,this.comp=P.comp,this.k=!1,this.kf=!1,this.vel=0,this.effectsSequence=[],this._isFirstFrame=!0,this.getValue=processEffectsSequence,this.setVValue=setVValue,this.addEffect=addEffect}function MultiDimensionalProperty(P,_,C,A){this.propType="multidimensional",this.mult=C||1,this.data=_,this._mdf=!1,this.elem=P,this.container=A,this.comp=P.comp,this.k=!1,this.kf=!1,this.frameId=-1;var T,E=_.k.length;for(this.v=createTypedArray("float32",E),this.pv=createTypedArray("float32",E),this.vel=createTypedArray("float32",E),T=0;T<E;T+=1)this.v[T]=_.k[T]*this.mult,this.pv[T]=_.k[T];this._isFirstFrame=!0,this.effectsSequence=[],this.getValue=processEffectsSequence,this.setVValue=setVValue,this.addEffect=addEffect}function KeyframedValueProperty(P,_,C,A){this.propType="unidimensional",this.keyframes=_.k,this.keyframesMetadata=[],this.offsetTime=P.data.st,this.frameId=-1,this._caching={lastFrame:initFrame,lastIndex:0,value:0,_lastKeyframeIndex:-1},this.k=!0,this.kf=!0,this.data=_,this.mult=C||1,this.elem=P,this.container=A,this.comp=P.comp,this.v=initFrame,this.pv=initFrame,this._isFirstFrame=!0,this.getValue=processEffectsSequence,this.setVValue=setVValue,this.interpolateValue=interpolateValue,this.effectsSequence=[getValueAtCurrentTime.bind(this)],this.addEffect=addEffect}function KeyframedMultidimensionalProperty(P,_,C,A){this.propType="multidimensional";var T,E=_.k.length,I,F,B,G;for(T=0;T<E-1;T+=1)_.k[T].to&&_.k[T].s&&_.k[T+1]&&_.k[T+1].s&&(I=_.k[T].s,F=_.k[T+1].s,B=_.k[T].to,G=_.k[T].ti,(I.length===2&&!(I[0]===F[0]&&I[1]===F[1])&&bez.pointOnLine2D(I[0],I[1],F[0],F[1],I[0]+B[0],I[1]+B[1])&&bez.pointOnLine2D(I[0],I[1],F[0],F[1],F[0]+G[0],F[1]+G[1])||I.length===3&&!(I[0]===F[0]&&I[1]===F[1]&&I[2]===F[2])&&bez.pointOnLine3D(I[0],I[1],I[2],F[0],F[1],F[2],I[0]+B[0],I[1]+B[1],I[2]+B[2])&&bez.pointOnLine3D(I[0],I[1],I[2],F[0],F[1],F[2],F[0]+G[0],F[1]+G[1],F[2]+G[2]))&&(_.k[T].to=null,_.k[T].ti=null),I[0]===F[0]&&I[1]===F[1]&&B[0]===0&&B[1]===0&&G[0]===0&&G[1]===0&&(I.length===2||I[2]===F[2]&&B[2]===0&&G[2]===0)&&(_.k[T].to=null,_.k[T].ti=null));this.effectsSequence=[getValueAtCurrentTime.bind(this)],this.data=_,this.keyframes=_.k,this.keyframesMetadata=[],this.offsetTime=P.data.st,this.k=!0,this.kf=!0,this._isFirstFrame=!0,this.mult=C||1,this.elem=P,this.container=A,this.comp=P.comp,this.getValue=processEffectsSequence,this.setVValue=setVValue,this.interpolateValue=interpolateValue,this.frameId=-1;var R=_.k[0].s.length;for(this.v=createTypedArray("float32",R),this.pv=createTypedArray("float32",R),T=0;T<R;T+=1)this.v[T]=initFrame,this.pv[T]=initFrame;this._caching={lastFrame:initFrame,lastIndex:0,value:createTypedArray("float32",R)},this.addEffect=addEffect}var PropertyFactory=function(){function P(C,A,T,E,I){A.sid&&(A=C.globalData.slotManager.getProp(A));var F;if(!A.k.length)F=new ValueProperty(C,A,E,I);else if(typeof A.k[0]=="number")F=new MultiDimensionalProperty(C,A,E,I);else switch(T){case 0:F=new KeyframedValueProperty(C,A,E,I);break;case 1:F=new KeyframedMultidimensionalProperty(C,A,E,I);break}return F.effectsSequence.length&&I.addDynamicProperty(F),F}var _={getProp:P};return _}();function DynamicPropertyContainer(){}DynamicPropertyContainer.prototype={addDynamicProperty:function(_){this.dynamicProperties.indexOf(_)===-1&&(this.dynamicProperties.push(_),this.container.addDynamicProperty(this),this._isAnimated=!0)},iterateDynamicProperties:function(){this._mdf=!1;var _,C=this.dynamicProperties.length;for(_=0;_<C;_+=1)this.dynamicProperties[_].getValue(),this.dynamicProperties[_]._mdf&&(this._mdf=!0)},initDynamicPropertyContainer:function(_){this.container=_,this.dynamicProperties=[],this._mdf=!1,this._isAnimated=!1}};var pointPool=function(){function P(){return createTypedArray("float32",2)}return poolFactory(8,P)}();function ShapePath(){this.c=!1,this._length=0,this._maxLength=8,this.v=createSizedArray(this._maxLength),this.o=createSizedArray(this._maxLength),this.i=createSizedArray(this._maxLength)}ShapePath.prototype.setPathData=function(P,_){this.c=P,this.setLength(_);for(var C=0;C<_;)this.v[C]=pointPool.newElement(),this.o[C]=pointPool.newElement(),this.i[C]=pointPool.newElement(),C+=1},ShapePath.prototype.setLength=function(P){for(;this._maxLength<P;)this.doubleArrayLength();this._length=P},ShapePath.prototype.doubleArrayLength=function(){this.v=this.v.concat(createSizedArray(this._maxLength)),this.i=this.i.concat(createSizedArray(this._maxLength)),this.o=this.o.concat(createSizedArray(this._maxLength)),this._maxLength*=2},ShapePath.prototype.setXYAt=function(P,_,C,A,T){var E;switch(this._length=Math.max(this._length,A+1),this._length>=this._maxLength&&this.doubleArrayLength(),C){case"v":E=this.v;break;case"i":E=this.i;break;case"o":E=this.o;break;default:E=[];break}(!E[A]||E[A]&&!T)&&(E[A]=pointPool.newElement()),E[A][0]=P,E[A][1]=_},ShapePath.prototype.setTripleAt=function(P,_,C,A,T,E,I,F){this.setXYAt(P,_,"v",I,F),this.setXYAt(C,A,"o",I,F),this.setXYAt(T,E,"i",I,F)},ShapePath.prototype.reverse=function(){var P=new ShapePath;P.setPathData(this.c,this._length);var _=this.v,C=this.o,A=this.i,T=0;this.c&&(P.setTripleAt(_[0][0],_[0][1],A[0][0],A[0][1],C[0][0],C[0][1],0,!1),T=1);var E=this._length-1,I=this._length,F;for(F=T;F<I;F+=1)P.setTripleAt(_[E][0],_[E][1],A[E][0],A[E][1],C[E][0],C[E][1],F,!1),E-=1;return P},ShapePath.prototype.length=function(){return this._length};var shapePool=function(){function P(){return new ShapePath}function _(T){var E=T._length,I;for(I=0;I<E;I+=1)pointPool.release(T.v[I]),pointPool.release(T.i[I]),pointPool.release(T.o[I]),T.v[I]=null,T.i[I]=null,T.o[I]=null;T._length=0,T.c=!1}function C(T){var E=A.newElement(),I,F=T._length===void 0?T.v.length:T._length;for(E.setLength(F),E.c=T.c,I=0;I<F;I+=1)E.setTripleAt(T.v[I][0],T.v[I][1],T.o[I][0],T.o[I][1],T.i[I][0],T.i[I][1],I);return E}var A=poolFactory(4,P,_);return A.clone=C,A}();function ShapeCollection(){this._length=0,this._maxLength=4,this.shapes=createSizedArray(this._maxLength)}ShapeCollection.prototype.addShape=function(P){this._length===this._maxLength&&(this.shapes=this.shapes.concat(createSizedArray(this._maxLength)),this._maxLength*=2),this.shapes[this._length]=P,this._length+=1},ShapeCollection.prototype.releaseShapes=function(){var P;for(P=0;P<this._length;P+=1)shapePool.release(this.shapes[P]);this._length=0};var shapeCollectionPool=function(){var P={newShapeCollection:T,release:E},_=0,C=4,A=createSizedArray(C);function T(){var I;return _?(_-=1,I=A[_]):I=new ShapeCollection,I}function E(I){var F,B=I._length;for(F=0;F<B;F+=1)shapePool.release(I.shapes[F]);I._length=0,_===C&&(A=pooling.double(A),C*=2),A[_]=I,_+=1}return P}(),ShapePropertyFactory=function(){var P=-999999;function _(W,X,Y){var K=Y.lastIndex,q,J,tt,rt,st,nt,at,ot,ct,dt=this.keyframes;if(W<dt[0].t-this.offsetTime)q=dt[0].s[0],tt=!0,K=0;else if(W>=dt[dt.length-1].t-this.offsetTime)q=dt[dt.length-1].s?dt[dt.length-1].s[0]:dt[dt.length-2].e[0],tt=!0;else{for(var ut=K,Q=dt.length-1,it=!0,Z,et,ht;it&&(Z=dt[ut],et=dt[ut+1],!(et.t-this.offsetTime>W));)ut<Q-1?ut+=1:it=!1;if(ht=this.keyframesMetadata[ut]||{},tt=Z.h===1,K=ut,!tt){if(W>=et.t-this.offsetTime)ot=1;else if(W<Z.t-this.offsetTime)ot=0;else{var lt;ht.__fnct?lt=ht.__fnct:(lt=BezierFactory.getBezierEasing(Z.o.x,Z.o.y,Z.i.x,Z.i.y).get,ht.__fnct=lt),ot=lt((W-(Z.t-this.offsetTime))/(et.t-this.offsetTime-(Z.t-this.offsetTime)))}J=et.s?et.s[0]:Z.e[0]}q=Z.s[0]}for(nt=X._length,at=q.i[0].length,Y.lastIndex=K,rt=0;rt<nt;rt+=1)for(st=0;st<at;st+=1)ct=tt?q.i[rt][st]:q.i[rt][st]+(J.i[rt][st]-q.i[rt][st])*ot,X.i[rt][st]=ct,ct=tt?q.o[rt][st]:q.o[rt][st]+(J.o[rt][st]-q.o[rt][st])*ot,X.o[rt][st]=ct,ct=tt?q.v[rt][st]:q.v[rt][st]+(J.v[rt][st]-q.v[rt][st])*ot,X.v[rt][st]=ct}function C(){var W=this.comp.renderedFrame-this.offsetTime,X=this.keyframes[0].t-this.offsetTime,Y=this.keyframes[this.keyframes.length-1].t-this.offsetTime,K=this._caching.lastFrame;return K!==P&&(K<X&&W<X||K>Y&&W>Y)||(this._caching.lastIndex=K<W?this._caching.lastIndex:0,this.interpolateShape(W,this.pv,this._caching)),this._caching.lastFrame=W,this.pv}function A(){this.paths=this.localShapeCollection}function T(W,X){if(W._length!==X._length||W.c!==X.c)return!1;var Y,K=W._length;for(Y=0;Y<K;Y+=1)if(W.v[Y][0]!==X.v[Y][0]||W.v[Y][1]!==X.v[Y][1]||W.o[Y][0]!==X.o[Y][0]||W.o[Y][1]!==X.o[Y][1]||W.i[Y][0]!==X.i[Y][0]||W.i[Y][1]!==X.i[Y][1])return!1;return!0}function E(W){T(this.v,W)||(this.v=shapePool.clone(W),this.localShapeCollection.releaseShapes(),this.localShapeCollection.addShape(this.v),this._mdf=!0,this.paths=this.localShapeCollection)}function I(){if(this.elem.globalData.frameId!==this.frameId){if(!this.effectsSequence.length){this._mdf=!1;return}if(this.lock){this.setVValue(this.pv);return}this.lock=!0,this._mdf=!1;var W;this.kf?W=this.pv:this.data.ks?W=this.data.ks.k:W=this.data.pt.k;var X,Y=this.effectsSequence.length;for(X=0;X<Y;X+=1)W=this.effectsSequence[X](W);this.setVValue(W),this.lock=!1,this.frameId=this.elem.globalData.frameId}}function F(W,X,Y){this.propType="shape",this.comp=W.comp,this.container=W,this.elem=W,this.data=X,this.k=!1,this.kf=!1,this._mdf=!1;var K=Y===3?X.pt.k:X.ks.k;this.v=shapePool.clone(K),this.pv=shapePool.clone(this.v),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.paths.addShape(this.v),this.reset=A,this.effectsSequence=[]}function B(W){this.effectsSequence.push(W),this.container.addDynamicProperty(this)}F.prototype.interpolateShape=_,F.prototype.getValue=I,F.prototype.setVValue=E,F.prototype.addEffect=B;function G(W,X,Y){this.propType="shape",this.comp=W.comp,this.elem=W,this.container=W,this.offsetTime=W.data.st,this.keyframes=Y===3?X.pt.k:X.ks.k,this.keyframesMetadata=[],this.k=!0,this.kf=!0;var K=this.keyframes[0].s[0].i.length;this.v=shapePool.newElement(),this.v.setPathData(this.keyframes[0].s[0].c,K),this.pv=shapePool.clone(this.v),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.paths.addShape(this.v),this.lastFrame=P,this.reset=A,this._caching={lastFrame:P,lastIndex:0},this.effectsSequence=[C.bind(this)]}G.prototype.getValue=I,G.prototype.interpolateShape=_,G.prototype.setVValue=E,G.prototype.addEffect=B;var R=function(){var W=roundCorner;function X(Y,K){this.v=shapePool.newElement(),this.v.setPathData(!0,4),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.localShapeCollection.addShape(this.v),this.d=K.d,this.elem=Y,this.comp=Y.comp,this.frameId=-1,this.initDynamicPropertyContainer(Y),this.p=PropertyFactory.getProp(Y,K.p,1,0,this),this.s=PropertyFactory.getProp(Y,K.s,1,0,this),this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertEllToPath())}return X.prototype={reset:A,getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertEllToPath())},convertEllToPath:function(){var K=this.p.v[0],q=this.p.v[1],J=this.s.v[0]/2,tt=this.s.v[1]/2,rt=this.d!==3,st=this.v;st.v[0][0]=K,st.v[0][1]=q-tt,st.v[1][0]=rt?K+J:K-J,st.v[1][1]=q,st.v[2][0]=K,st.v[2][1]=q+tt,st.v[3][0]=rt?K-J:K+J,st.v[3][1]=q,st.i[0][0]=rt?K-J*W:K+J*W,st.i[0][1]=q-tt,st.i[1][0]=rt?K+J:K-J,st.i[1][1]=q-tt*W,st.i[2][0]=rt?K+J*W:K-J*W,st.i[2][1]=q+tt,st.i[3][0]=rt?K-J:K+J,st.i[3][1]=q+tt*W,st.o[0][0]=rt?K+J*W:K-J*W,st.o[0][1]=q-tt,st.o[1][0]=rt?K+J:K-J,st.o[1][1]=q+tt*W,st.o[2][0]=rt?K-J*W:K+J*W,st.o[2][1]=q+tt,st.o[3][0]=rt?K-J:K+J,st.o[3][1]=q-tt*W}},extendPrototype([DynamicPropertyContainer],X),X}(),z=function(){function W(X,Y){this.v=shapePool.newElement(),this.v.setPathData(!0,0),this.elem=X,this.comp=X.comp,this.data=Y,this.frameId=-1,this.d=Y.d,this.initDynamicPropertyContainer(X),Y.sy===1?(this.ir=PropertyFactory.getProp(X,Y.ir,0,0,this),this.is=PropertyFactory.getProp(X,Y.is,0,.01,this),this.convertToPath=this.convertStarToPath):this.convertToPath=this.convertPolygonToPath,this.pt=PropertyFactory.getProp(X,Y.pt,0,0,this),this.p=PropertyFactory.getProp(X,Y.p,1,0,this),this.r=PropertyFactory.getProp(X,Y.r,0,degToRads,this),this.or=PropertyFactory.getProp(X,Y.or,0,0,this),this.os=PropertyFactory.getProp(X,Y.os,0,.01,this),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.localShapeCollection.addShape(this.v),this.paths=this.localShapeCollection,this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertToPath())}return W.prototype={reset:A,getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertToPath())},convertStarToPath:function(){var Y=Math.floor(this.pt.v)*2,K=Math.PI*2/Y,q=!0,J=this.or.v,tt=this.ir.v,rt=this.os.v,st=this.is.v,nt=2*Math.PI*J/(Y*2),at=2*Math.PI*tt/(Y*2),ot,ct,dt,ut,Q=-Math.PI/2;Q+=this.r.v;var it=this.data.d===3?-1:1;for(this.v._length=0,ot=0;ot<Y;ot+=1){ct=q?J:tt,dt=q?rt:st,ut=q?nt:at;var Z=ct*Math.cos(Q),et=ct*Math.sin(Q),ht=Z===0&&et===0?0:et/Math.sqrt(Z*Z+et*et),lt=Z===0&&et===0?0:-Z/Math.sqrt(Z*Z+et*et);Z+=+this.p.v[0],et+=+this.p.v[1],this.v.setTripleAt(Z,et,Z-ht*ut*dt*it,et-lt*ut*dt*it,Z+ht*ut*dt*it,et+lt*ut*dt*it,ot,!0),q=!q,Q+=K*it}},convertPolygonToPath:function(){var Y=Math.floor(this.pt.v),K=Math.PI*2/Y,q=this.or.v,J=this.os.v,tt=2*Math.PI*q/(Y*4),rt,st=-Math.PI*.5,nt=this.data.d===3?-1:1;for(st+=this.r.v,this.v._length=0,rt=0;rt<Y;rt+=1){var at=q*Math.cos(st),ot=q*Math.sin(st),ct=at===0&&ot===0?0:ot/Math.sqrt(at*at+ot*ot),dt=at===0&&ot===0?0:-at/Math.sqrt(at*at+ot*ot);at+=+this.p.v[0],ot+=+this.p.v[1],this.v.setTripleAt(at,ot,at-ct*tt*J*nt,ot-dt*tt*J*nt,at+ct*tt*J*nt,ot+dt*tt*J*nt,rt,!0),st+=K*nt}this.paths.length=0,this.paths[0]=this.v}},extendPrototype([DynamicPropertyContainer],W),W}(),D=function(){function W(X,Y){this.v=shapePool.newElement(),this.v.c=!0,this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.localShapeCollection.addShape(this.v),this.paths=this.localShapeCollection,this.elem=X,this.comp=X.comp,this.frameId=-1,this.d=Y.d,this.initDynamicPropertyContainer(X),this.p=PropertyFactory.getProp(X,Y.p,1,0,this),this.s=PropertyFactory.getProp(X,Y.s,1,0,this),this.r=PropertyFactory.getProp(X,Y.r,0,0,this),this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertRectToPath())}return W.prototype={convertRectToPath:function(){var Y=this.p.v[0],K=this.p.v[1],q=this.s.v[0]/2,J=this.s.v[1]/2,tt=bmMin(q,J,this.r.v),rt=tt*(1-roundCorner);this.v._length=0,this.d===2||this.d===1?(this.v.setTripleAt(Y+q,K-J+tt,Y+q,K-J+tt,Y+q,K-J+rt,0,!0),this.v.setTripleAt(Y+q,K+J-tt,Y+q,K+J-rt,Y+q,K+J-tt,1,!0),tt!==0?(this.v.setTripleAt(Y+q-tt,K+J,Y+q-tt,K+J,Y+q-rt,K+J,2,!0),this.v.setTripleAt(Y-q+tt,K+J,Y-q+rt,K+J,Y-q+tt,K+J,3,!0),this.v.setTripleAt(Y-q,K+J-tt,Y-q,K+J-tt,Y-q,K+J-rt,4,!0),this.v.setTripleAt(Y-q,K-J+tt,Y-q,K-J+rt,Y-q,K-J+tt,5,!0),this.v.setTripleAt(Y-q+tt,K-J,Y-q+tt,K-J,Y-q+rt,K-J,6,!0),this.v.setTripleAt(Y+q-tt,K-J,Y+q-rt,K-J,Y+q-tt,K-J,7,!0)):(this.v.setTripleAt(Y-q,K+J,Y-q+rt,K+J,Y-q,K+J,2),this.v.setTripleAt(Y-q,K-J,Y-q,K-J+rt,Y-q,K-J,3))):(this.v.setTripleAt(Y+q,K-J+tt,Y+q,K-J+rt,Y+q,K-J+tt,0,!0),tt!==0?(this.v.setTripleAt(Y+q-tt,K-J,Y+q-tt,K-J,Y+q-rt,K-J,1,!0),this.v.setTripleAt(Y-q+tt,K-J,Y-q+rt,K-J,Y-q+tt,K-J,2,!0),this.v.setTripleAt(Y-q,K-J+tt,Y-q,K-J+tt,Y-q,K-J+rt,3,!0),this.v.setTripleAt(Y-q,K+J-tt,Y-q,K+J-rt,Y-q,K+J-tt,4,!0),this.v.setTripleAt(Y-q+tt,K+J,Y-q+tt,K+J,Y-q+rt,K+J,5,!0),this.v.setTripleAt(Y+q-tt,K+J,Y+q-rt,K+J,Y+q-tt,K+J,6,!0),this.v.setTripleAt(Y+q,K+J-tt,Y+q,K+J-tt,Y+q,K+J-rt,7,!0)):(this.v.setTripleAt(Y-q,K-J,Y-q+rt,K-J,Y-q,K-J,1,!0),this.v.setTripleAt(Y-q,K+J,Y-q,K+J-rt,Y-q,K+J,2,!0),this.v.setTripleAt(Y+q,K+J,Y+q-rt,K+J,Y+q,K+J,3,!0)))},getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertRectToPath())},reset:A},extendPrototype([DynamicPropertyContainer],W),W}();function L(W,X,Y){var K;if(Y===3||Y===4){var q=Y===3?X.pt:X.ks,J=q.k;J.length?K=new G(W,X,Y):K=new F(W,X,Y)}else Y===5?K=new D(W,X):Y===6?K=new R(W,X):Y===7&&(K=new z(W,X));return K.k&&W.addDynamicProperty(K),K}function O(){return F}function V(){return G}var U={};return U.getShapeProp=L,U.getConstructorFunction=O,U.getKeyframedConstructorFunction=V,U}();/*!
 Transformation Matrix v2.0
 (c) Epistemex 2014-2015
 www.epistemex.com
 By Ken Fyrstenberg
 Contributions by leeoniya.
 License: MIT, header required.
 */var Matrix=function(){var P=Math.cos,_=Math.sin,C=Math.tan,A=Math.round;function T(){return this.props[0]=1,this.props[1]=0,this.props[2]=0,this.props[3]=0,this.props[4]=0,this.props[5]=1,this.props[6]=0,this.props[7]=0,this.props[8]=0,this.props[9]=0,this.props[10]=1,this.props[11]=0,this.props[12]=0,this.props[13]=0,this.props[14]=0,this.props[15]=1,this}function E(Z){if(Z===0)return this;var et=P(Z),ht=_(Z);return this._t(et,-ht,0,0,ht,et,0,0,0,0,1,0,0,0,0,1)}function I(Z){if(Z===0)return this;var et=P(Z),ht=_(Z);return this._t(1,0,0,0,0,et,-ht,0,0,ht,et,0,0,0,0,1)}function F(Z){if(Z===0)return this;var et=P(Z),ht=_(Z);return this._t(et,0,ht,0,0,1,0,0,-ht,0,et,0,0,0,0,1)}function B(Z){if(Z===0)return this;var et=P(Z),ht=_(Z);return this._t(et,-ht,0,0,ht,et,0,0,0,0,1,0,0,0,0,1)}function G(Z,et){return this._t(1,et,Z,1,0,0)}function R(Z,et){return this.shear(C(Z),C(et))}function z(Z,et){var ht=P(et),lt=_(et);return this._t(ht,lt,0,0,-lt,ht,0,0,0,0,1,0,0,0,0,1)._t(1,0,0,0,C(Z),1,0,0,0,0,1,0,0,0,0,1)._t(ht,-lt,0,0,lt,ht,0,0,0,0,1,0,0,0,0,1)}function D(Z,et,ht){return!ht&&ht!==0&&(ht=1),Z===1&&et===1&&ht===1?this:this._t(Z,0,0,0,0,et,0,0,0,0,ht,0,0,0,0,1)}function L(Z,et,ht,lt,ft,pt,mt,gt,yt,bt,xt,Et,_t,Tt,At,wt){return this.props[0]=Z,this.props[1]=et,this.props[2]=ht,this.props[3]=lt,this.props[4]=ft,this.props[5]=pt,this.props[6]=mt,this.props[7]=gt,this.props[8]=yt,this.props[9]=bt,this.props[10]=xt,this.props[11]=Et,this.props[12]=_t,this.props[13]=Tt,this.props[14]=At,this.props[15]=wt,this}function O(Z,et,ht){return ht=ht||0,Z!==0||et!==0||ht!==0?this._t(1,0,0,0,0,1,0,0,0,0,1,0,Z,et,ht,1):this}function V(Z,et,ht,lt,ft,pt,mt,gt,yt,bt,xt,Et,_t,Tt,At,wt){var vt=this.props;if(Z===1&&et===0&&ht===0&&lt===0&&ft===0&&pt===1&&mt===0&&gt===0&&yt===0&&bt===0&&xt===1&&Et===0)return vt[12]=vt[12]*Z+vt[15]*_t,vt[13]=vt[13]*pt+vt[15]*Tt,vt[14]=vt[14]*xt+vt[15]*At,vt[15]*=wt,this._identityCalculated=!1,this;var Pt=vt[0],Ct=vt[1],Bt=vt[2],It=vt[3],Mt=vt[4],Gt=vt[5],kt=vt[6],Dt=vt[7],Vt=vt[8],Rt=vt[9],Ot=vt[10],Ft=vt[11],Ht=vt[12],Ut=vt[13],Nt=vt[14],Wt=vt[15];return vt[0]=Pt*Z+Ct*ft+Bt*yt+It*_t,vt[1]=Pt*et+Ct*pt+Bt*bt+It*Tt,vt[2]=Pt*ht+Ct*mt+Bt*xt+It*At,vt[3]=Pt*lt+Ct*gt+Bt*Et+It*wt,vt[4]=Mt*Z+Gt*ft+kt*yt+Dt*_t,vt[5]=Mt*et+Gt*pt+kt*bt+Dt*Tt,vt[6]=Mt*ht+Gt*mt+kt*xt+Dt*At,vt[7]=Mt*lt+Gt*gt+kt*Et+Dt*wt,vt[8]=Vt*Z+Rt*ft+Ot*yt+Ft*_t,vt[9]=Vt*et+Rt*pt+Ot*bt+Ft*Tt,vt[10]=Vt*ht+Rt*mt+Ot*xt+Ft*At,vt[11]=Vt*lt+Rt*gt+Ot*Et+Ft*wt,vt[12]=Ht*Z+Ut*ft+Nt*yt+Wt*_t,vt[13]=Ht*et+Ut*pt+Nt*bt+Wt*Tt,vt[14]=Ht*ht+Ut*mt+Nt*xt+Wt*At,vt[15]=Ht*lt+Ut*gt+Nt*Et+Wt*wt,this._identityCalculated=!1,this}function U(Z){var et=Z.props;return this.transform(et[0],et[1],et[2],et[3],et[4],et[5],et[6],et[7],et[8],et[9],et[10],et[11],et[12],et[13],et[14],et[15])}function W(){return this._identityCalculated||(this._identity=!(this.props[0]!==1||this.props[1]!==0||this.props[2]!==0||this.props[3]!==0||this.props[4]!==0||this.props[5]!==1||this.props[6]!==0||this.props[7]!==0||this.props[8]!==0||this.props[9]!==0||this.props[10]!==1||this.props[11]!==0||this.props[12]!==0||this.props[13]!==0||this.props[14]!==0||this.props[15]!==1),this._identityCalculated=!0),this._identity}function X(Z){for(var et=0;et<16;){if(Z.props[et]!==this.props[et])return!1;et+=1}return!0}function Y(Z){var et;for(et=0;et<16;et+=1)Z.props[et]=this.props[et];return Z}function K(Z){var et;for(et=0;et<16;et+=1)this.props[et]=Z[et]}function q(Z,et,ht){return{x:Z*this.props[0]+et*this.props[4]+ht*this.props[8]+this.props[12],y:Z*this.props[1]+et*this.props[5]+ht*this.props[9]+this.props[13],z:Z*this.props[2]+et*this.props[6]+ht*this.props[10]+this.props[14]}}function J(Z,et,ht){return Z*this.props[0]+et*this.props[4]+ht*this.props[8]+this.props[12]}function tt(Z,et,ht){return Z*this.props[1]+et*this.props[5]+ht*this.props[9]+this.props[13]}function rt(Z,et,ht){return Z*this.props[2]+et*this.props[6]+ht*this.props[10]+this.props[14]}function st(){var Z=this.props[0]*this.props[5]-this.props[1]*this.props[4],et=this.props[5]/Z,ht=-this.props[1]/Z,lt=-this.props[4]/Z,ft=this.props[0]/Z,pt=(this.props[4]*this.props[13]-this.props[5]*this.props[12])/Z,mt=-(this.props[0]*this.props[13]-this.props[1]*this.props[12])/Z,gt=new Matrix;return gt.props[0]=et,gt.props[1]=ht,gt.props[4]=lt,gt.props[5]=ft,gt.props[12]=pt,gt.props[13]=mt,gt}function nt(Z){var et=this.getInverseMatrix();return et.applyToPointArray(Z[0],Z[1],Z[2]||0)}function at(Z){var et,ht=Z.length,lt=[];for(et=0;et<ht;et+=1)lt[et]=nt(Z[et]);return lt}function ot(Z,et,ht){var lt=createTypedArray("float32",6);if(this.isIdentity())lt[0]=Z[0],lt[1]=Z[1],lt[2]=et[0],lt[3]=et[1],lt[4]=ht[0],lt[5]=ht[1];else{var ft=this.props[0],pt=this.props[1],mt=this.props[4],gt=this.props[5],yt=this.props[12],bt=this.props[13];lt[0]=Z[0]*ft+Z[1]*mt+yt,lt[1]=Z[0]*pt+Z[1]*gt+bt,lt[2]=et[0]*ft+et[1]*mt+yt,lt[3]=et[0]*pt+et[1]*gt+bt,lt[4]=ht[0]*ft+ht[1]*mt+yt,lt[5]=ht[0]*pt+ht[1]*gt+bt}return lt}function ct(Z,et,ht){var lt;return this.isIdentity()?lt=[Z,et,ht]:lt=[Z*this.props[0]+et*this.props[4]+ht*this.props[8]+this.props[12],Z*this.props[1]+et*this.props[5]+ht*this.props[9]+this.props[13],Z*this.props[2]+et*this.props[6]+ht*this.props[10]+this.props[14]],lt}function dt(Z,et){if(this.isIdentity())return Z+","+et;var ht=this.props;return Math.round((Z*ht[0]+et*ht[4]+ht[12])*100)/100+","+Math.round((Z*ht[1]+et*ht[5]+ht[13])*100)/100}function ut(){for(var Z=0,et=this.props,ht="matrix3d(",lt=1e4;Z<16;)ht+=A(et[Z]*lt)/lt,ht+=Z===15?")":",",Z+=1;return ht}function Q(Z){var et=1e4;return Z<1e-6&&Z>0||Z>-1e-6&&Z<0?A(Z*et)/et:Z}function it(){var Z=this.props,et=Q(Z[0]),ht=Q(Z[1]),lt=Q(Z[4]),ft=Q(Z[5]),pt=Q(Z[12]),mt=Q(Z[13]);return"matrix("+et+","+ht+","+lt+","+ft+","+pt+","+mt+")"}return function(){this.reset=T,this.rotate=E,this.rotateX=I,this.rotateY=F,this.rotateZ=B,this.skew=R,this.skewFromAxis=z,this.shear=G,this.scale=D,this.setTransform=L,this.translate=O,this.transform=V,this.multiply=U,this.applyToPoint=q,this.applyToX=J,this.applyToY=tt,this.applyToZ=rt,this.applyToPointArray=ct,this.applyToTriplePoints=ot,this.applyToPointStringified=dt,this.toCSS=ut,this.to2dCSS=it,this.clone=Y,this.cloneFromProps=K,this.equals=X,this.inversePoints=at,this.inversePoint=nt,this.getInverseMatrix=st,this._t=this.transform,this.isIdentity=W,this._identity=!0,this._identityCalculated=!1,this.props=createTypedArray("float32",16),this.reset()}}();function _typeof$3(P){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?_typeof$3=function(C){return typeof C}:_typeof$3=function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C},_typeof$3(P)}var lottie={};function setLocation(P){setLocationHref(P)}function searchAnimations(){animationManager.searchAnimations()}function setSubframeRendering(P){setSubframeEnabled(P)}function setPrefix(P){setIdPrefix(P)}function loadAnimation(P){return animationManager.loadAnimation(P)}function setQuality(P){if(typeof P=="string")switch(P){case"high":setDefaultCurveSegments(200);break;default:case"medium":setDefaultCurveSegments(50);break;case"low":setDefaultCurveSegments(10);break}else!isNaN(P)&&P>1&&setDefaultCurveSegments(P)}function inBrowser(){return typeof navigator<"u"}function installPlugin(P,_){P==="expressions"&&setExpressionsPlugin(_)}function getFactory(P){switch(P){case"propertyFactory":return PropertyFactory;case"shapePropertyFactory":return ShapePropertyFactory;case"matrix":return Matrix;default:return null}}lottie.play=animationManager.play,lottie.pause=animationManager.pause,lottie.setLocationHref=setLocation,lottie.togglePause=animationManager.togglePause,lottie.setSpeed=animationManager.setSpeed,lottie.setDirection=animationManager.setDirection,lottie.stop=animationManager.stop,lottie.searchAnimations=searchAnimations,lottie.registerAnimation=animationManager.registerAnimation,lottie.loadAnimation=loadAnimation,lottie.setSubframeRendering=setSubframeRendering,lottie.resize=animationManager.resize,lottie.goToAndStop=animationManager.goToAndStop,lottie.destroy=animationManager.destroy,lottie.setQuality=setQuality,lottie.inBrowser=inBrowser,lottie.installPlugin=installPlugin,lottie.freeze=animationManager.freeze,lottie.unfreeze=animationManager.unfreeze,lottie.setVolume=animationManager.setVolume,lottie.mute=animationManager.mute,lottie.unmute=animationManager.unmute,lottie.getRegisteredAnimations=animationManager.getRegisteredAnimations,lottie.useWebWorker=setWebWorker,lottie.setIDPrefix=setPrefix,lottie.__getFactory=getFactory,lottie.version="5.12.2";function checkReady(){document.readyState==="complete"&&(clearInterval(readyStateCheckInterval),searchAnimations())}function getQueryVariable(P){for(var _=queryString.split("&"),C=0;C<_.length;C+=1){var A=_[C].split("=");if(decodeURIComponent(A[0])==P)return decodeURIComponent(A[1])}return null}var queryString="";{var scripts=document.getElementsByTagName("script"),index=scripts.length-1,myScript=scripts[index]||{src:""};queryString=myScript.src?myScript.src.replace(/^[^\?]+\??/,""):"",getQueryVariable("renderer")}var readyStateCheckInterval=setInterval(checkReady,100);try{_typeof$3(exports)!=="object"&&(window.bodymovin=lottie)}catch(P){}var ShapeModifiers=function(){var P={},_={};P.registerModifier=C,P.getModifier=A;function C(T,E){_[T]||(_[T]=E)}function A(T,E,I){return new _[T](E,I)}return P}();function ShapeModifier(){}ShapeModifier.prototype.initModifierProperties=function(){},ShapeModifier.prototype.addShapeToModifier=function(){},ShapeModifier.prototype.addShape=function(P){if(!this.closed){P.sh.container.addDynamicProperty(P.sh);var _={shape:P.sh,data:P,localShapeCollection:shapeCollectionPool.newShapeCollection()};this.shapes.push(_),this.addShapeToModifier(_),this._isAnimated&&P.setAsAnimated()}},ShapeModifier.prototype.init=function(P,_){this.shapes=[],this.elem=P,this.initDynamicPropertyContainer(P),this.initModifierProperties(P,_),this.frameId=initialDefaultFrame,this.closed=!1,this.k=!1,this.dynamicProperties.length?this.k=!0:this.getValue(!0)},ShapeModifier.prototype.processKeys=function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties())},extendPrototype([DynamicPropertyContainer],ShapeModifier);function TrimModifier(){}extendPrototype([ShapeModifier],TrimModifier),TrimModifier.prototype.initModifierProperties=function(P,_){this.s=PropertyFactory.getProp(P,_.s,0,.01,this),this.e=PropertyFactory.getProp(P,_.e,0,.01,this),this.o=PropertyFactory.getProp(P,_.o,0,0,this),this.sValue=0,this.eValue=0,this.getValue=this.processKeys,this.m=_.m,this._isAnimated=!!this.s.effectsSequence.length||!!this.e.effectsSequence.length||!!this.o.effectsSequence.length},TrimModifier.prototype.addShapeToModifier=function(P){P.pathsData=[]},TrimModifier.prototype.calculateShapeEdges=function(P,_,C,A,T){var E=[];_<=1?E.push({s:P,e:_}):P>=1?E.push({s:P-1,e:_-1}):(E.push({s:P,e:1}),E.push({s:0,e:_-1}));var I=[],F,B=E.length,G;for(F=0;F<B;F+=1)if(G=E[F],!(G.e*T<A||G.s*T>A+C)){var R,z;G.s*T<=A?R=0:R=(G.s*T-A)/C,G.e*T>=A+C?z=1:z=(G.e*T-A)/C,I.push([R,z])}return I.length||I.push([0,0]),I},TrimModifier.prototype.releasePathsData=function(P){var _,C=P.length;for(_=0;_<C;_+=1)segmentsLengthPool.release(P[_]);return P.length=0,P},TrimModifier.prototype.processShapes=function(P){var _,C;if(this._mdf||P){var A=this.o.v%360/360;if(A<0&&(A+=1),this.s.v>1?_=1+A:this.s.v<0?_=0+A:_=this.s.v+A,this.e.v>1?C=1+A:this.e.v<0?C=0+A:C=this.e.v+A,_>C){var T=_;_=C,C=T}_=Math.round(_*1e4)*1e-4,C=Math.round(C*1e4)*1e-4,this.sValue=_,this.eValue=C}else _=this.sValue,C=this.eValue;var E,I,F=this.shapes.length,B,G,R,z,D,L=0;if(C===_)for(I=0;I<F;I+=1)this.shapes[I].localShapeCollection.releaseShapes(),this.shapes[I].shape._mdf=!0,this.shapes[I].shape.paths=this.shapes[I].localShapeCollection,this._mdf&&(this.shapes[I].pathsData.length=0);else if(C===1&&_===0||C===0&&_===1){if(this._mdf)for(I=0;I<F;I+=1)this.shapes[I].pathsData.length=0,this.shapes[I].shape._mdf=!0}else{var O=[],V,U;for(I=0;I<F;I+=1)if(V=this.shapes[I],!V.shape._mdf&&!this._mdf&&!P&&this.m!==2)V.shape.paths=V.localShapeCollection;else{if(E=V.shape.paths,G=E._length,D=0,!V.shape._mdf&&V.pathsData.length)D=V.totalShapeLength;else{for(R=this.releasePathsData(V.pathsData),B=0;B<G;B+=1)z=bez.getSegmentsLength(E.shapes[B]),R.push(z),D+=z.totalLength;V.totalShapeLength=D,V.pathsData=R}L+=D,V.shape._mdf=!0}var W=_,X=C,Y=0,K;for(I=F-1;I>=0;I-=1)if(V=this.shapes[I],V.shape._mdf){for(U=V.localShapeCollection,U.releaseShapes(),this.m===2&&F>1?(K=this.calculateShapeEdges(_,C,V.totalShapeLength,Y,L),Y+=V.totalShapeLength):K=[[W,X]],G=K.length,B=0;B<G;B+=1){W=K[B][0],X=K[B][1],O.length=0,X<=1?O.push({s:V.totalShapeLength*W,e:V.totalShapeLength*X}):W>=1?O.push({s:V.totalShapeLength*(W-1),e:V.totalShapeLength*(X-1)}):(O.push({s:V.totalShapeLength*W,e:V.totalShapeLength}),O.push({s:0,e:V.totalShapeLength*(X-1)}));var q=this.addShapes(V,O[0]);if(O[0].s!==O[0].e){if(O.length>1){var J=V.shape.paths.shapes[V.shape.paths._length-1];if(J.c){var tt=q.pop();this.addPaths(q,U),q=this.addShapes(V,O[1],tt)}else this.addPaths(q,U),q=this.addShapes(V,O[1])}this.addPaths(q,U)}}V.shape.paths=U}}},TrimModifier.prototype.addPaths=function(P,_){var C,A=P.length;for(C=0;C<A;C+=1)_.addShape(P[C])},TrimModifier.prototype.addSegment=function(P,_,C,A,T,E,I){T.setXYAt(_[0],_[1],"o",E),T.setXYAt(C[0],C[1],"i",E+1),I&&T.setXYAt(P[0],P[1],"v",E),T.setXYAt(A[0],A[1],"v",E+1)},TrimModifier.prototype.addSegmentFromArray=function(P,_,C,A){_.setXYAt(P[1],P[5],"o",C),_.setXYAt(P[2],P[6],"i",C+1),A&&_.setXYAt(P[0],P[4],"v",C),_.setXYAt(P[3],P[7],"v",C+1)},TrimModifier.prototype.addShapes=function(P,_,C){var A=P.pathsData,T=P.shape.paths.shapes,E,I=P.shape.paths._length,F,B,G=0,R,z,D,L,O=[],V,U=!0;for(C?(z=C._length,V=C._length):(C=shapePool.newElement(),z=0,V=0),O.push(C),E=0;E<I;E+=1){for(D=A[E].lengths,C.c=T[E].c,B=T[E].c?D.length:D.length+1,F=1;F<B;F+=1)if(R=D[F-1],G+R.addedLength<_.s)G+=R.addedLength,C.c=!1;else if(G>_.e){C.c=!1;break}else _.s<=G&&_.e>=G+R.addedLength?(this.addSegment(T[E].v[F-1],T[E].o[F-1],T[E].i[F],T[E].v[F],C,z,U),U=!1):(L=bez.getNewSegment(T[E].v[F-1],T[E].v[F],T[E].o[F-1],T[E].i[F],(_.s-G)/R.addedLength,(_.e-G)/R.addedLength,D[F-1]),this.addSegmentFromArray(L,C,z,U),U=!1,C.c=!1),G+=R.addedLength,z+=1;if(T[E].c&&D.length){if(R=D[F-1],G<=_.e){var W=D[F-1].addedLength;_.s<=G&&_.e>=G+W?(this.addSegment(T[E].v[F-1],T[E].o[F-1],T[E].i[0],T[E].v[0],C,z,U),U=!1):(L=bez.getNewSegment(T[E].v[F-1],T[E].v[0],T[E].o[F-1],T[E].i[0],(_.s-G)/W,(_.e-G)/W,D[F-1]),this.addSegmentFromArray(L,C,z,U),U=!1,C.c=!1)}else C.c=!1;G+=R.addedLength,z+=1}if(C._length&&(C.setXYAt(C.v[V][0],C.v[V][1],"i",V),C.setXYAt(C.v[C._length-1][0],C.v[C._length-1][1],"o",C._length-1)),G>_.e)break;E<I-1&&(C=shapePool.newElement(),U=!0,O.push(C),z=0)}return O};function PuckerAndBloatModifier(){}extendPrototype([ShapeModifier],PuckerAndBloatModifier),PuckerAndBloatModifier.prototype.initModifierProperties=function(P,_){this.getValue=this.processKeys,this.amount=PropertyFactory.getProp(P,_.a,0,null,this),this._isAnimated=!!this.amount.effectsSequence.length},PuckerAndBloatModifier.prototype.processPath=function(P,_){var C=_/100,A=[0,0],T=P._length,E=0;for(E=0;E<T;E+=1)A[0]+=P.v[E][0],A[1]+=P.v[E][1];A[0]/=T,A[1]/=T;var I=shapePool.newElement();I.c=P.c;var F,B,G,R,z,D;for(E=0;E<T;E+=1)F=P.v[E][0]+(A[0]-P.v[E][0])*C,B=P.v[E][1]+(A[1]-P.v[E][1])*C,G=P.o[E][0]+(A[0]-P.o[E][0])*-C,R=P.o[E][1]+(A[1]-P.o[E][1])*-C,z=P.i[E][0]+(A[0]-P.i[E][0])*-C,D=P.i[E][1]+(A[1]-P.i[E][1])*-C,I.setTripleAt(F,B,G,R,z,D,E);return I},PuckerAndBloatModifier.prototype.processShapes=function(P){var _,C,A=this.shapes.length,T,E,I=this.amount.v;if(I!==0){var F,B;for(C=0;C<A;C+=1){if(F=this.shapes[C],B=F.localShapeCollection,!(!F.shape._mdf&&!this._mdf&&!P))for(B.releaseShapes(),F.shape._mdf=!0,_=F.shape.paths.shapes,E=F.shape.paths._length,T=0;T<E;T+=1)B.addShape(this.processPath(_[T],I));F.shape.paths=F.localShapeCollection}}this.dynamicProperties.length||(this._mdf=!1)};var TransformPropertyFactory=function(){var P=[0,0];function _(B){var G=this._mdf;this.iterateDynamicProperties(),this._mdf=this._mdf||G,this.a&&B.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.s&&B.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.sk&&B.skewFromAxis(-this.sk.v,this.sa.v),this.r?B.rotate(-this.r.v):B.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.data.p.s?this.data.p.z?B.translate(this.px.v,this.py.v,-this.pz.v):B.translate(this.px.v,this.py.v,0):B.translate(this.p.v[0],this.p.v[1],-this.p.v[2])}function C(B){if(this.elem.globalData.frameId!==this.frameId){if(this._isDirty&&(this.precalculateMatrix(),this._isDirty=!1),this.iterateDynamicProperties(),this._mdf||B){var G;if(this.v.cloneFromProps(this.pre.props),this.appliedTransformations<1&&this.v.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.appliedTransformations<2&&this.v.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.sk&&this.appliedTransformations<3&&this.v.skewFromAxis(-this.sk.v,this.sa.v),this.r&&this.appliedTransformations<4?this.v.rotate(-this.r.v):!this.r&&this.appliedTransformations<4&&this.v.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.autoOriented){var R,z;if(G=this.elem.globalData.frameRate,this.p&&this.p.keyframes&&this.p.getValueAtTime)this.p._caching.lastFrame+this.p.offsetTime<=this.p.keyframes[0].t?(R=this.p.getValueAtTime((this.p.keyframes[0].t+.01)/G,0),z=this.p.getValueAtTime(this.p.keyframes[0].t/G,0)):this.p._caching.lastFrame+this.p.offsetTime>=this.p.keyframes[this.p.keyframes.length-1].t?(R=this.p.getValueAtTime(this.p.keyframes[this.p.keyframes.length-1].t/G,0),z=this.p.getValueAtTime((this.p.keyframes[this.p.keyframes.length-1].t-.05)/G,0)):(R=this.p.pv,z=this.p.getValueAtTime((this.p._caching.lastFrame+this.p.offsetTime-.01)/G,this.p.offsetTime));else if(this.px&&this.px.keyframes&&this.py.keyframes&&this.px.getValueAtTime&&this.py.getValueAtTime){R=[],z=[];var D=this.px,L=this.py;D._caching.lastFrame+D.offsetTime<=D.keyframes[0].t?(R[0]=D.getValueAtTime((D.keyframes[0].t+.01)/G,0),R[1]=L.getValueAtTime((L.keyframes[0].t+.01)/G,0),z[0]=D.getValueAtTime(D.keyframes[0].t/G,0),z[1]=L.getValueAtTime(L.keyframes[0].t/G,0)):D._caching.lastFrame+D.offsetTime>=D.keyframes[D.keyframes.length-1].t?(R[0]=D.getValueAtTime(D.keyframes[D.keyframes.length-1].t/G,0),R[1]=L.getValueAtTime(L.keyframes[L.keyframes.length-1].t/G,0),z[0]=D.getValueAtTime((D.keyframes[D.keyframes.length-1].t-.01)/G,0),z[1]=L.getValueAtTime((L.keyframes[L.keyframes.length-1].t-.01)/G,0)):(R=[D.pv,L.pv],z[0]=D.getValueAtTime((D._caching.lastFrame+D.offsetTime-.01)/G,D.offsetTime),z[1]=L.getValueAtTime((L._caching.lastFrame+L.offsetTime-.01)/G,L.offsetTime))}else z=P,R=z;this.v.rotate(-Math.atan2(R[1]-z[1],R[0]-z[0]))}this.data.p&&this.data.p.s?this.data.p.z?this.v.translate(this.px.v,this.py.v,-this.pz.v):this.v.translate(this.px.v,this.py.v,0):this.v.translate(this.p.v[0],this.p.v[1],-this.p.v[2])}this.frameId=this.elem.globalData.frameId}}function A(){if(this.appliedTransformations=0,this.pre.reset(),!this.a.effectsSequence.length)this.pre.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.appliedTransformations=1;else return;if(!this.s.effectsSequence.length)this.pre.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.appliedTransformations=2;else return;if(this.sk)if(!this.sk.effectsSequence.length&&!this.sa.effectsSequence.length)this.pre.skewFromAxis(-this.sk.v,this.sa.v),this.appliedTransformations=3;else return;this.r?this.r.effectsSequence.length||(this.pre.rotate(-this.r.v),this.appliedTransformations=4):!this.rz.effectsSequence.length&&!this.ry.effectsSequence.length&&!this.rx.effectsSequence.length&&!this.or.effectsSequence.length&&(this.pre.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.appliedTransformations=4)}function T(){}function E(B){this._addDynamicProperty(B),this.elem.addDynamicProperty(B),this._isDirty=!0}function I(B,G,R){if(this.elem=B,this.frameId=-1,this.propType="transform",this.data=G,this.v=new Matrix,this.pre=new Matrix,this.appliedTransformations=0,this.initDynamicPropertyContainer(R||B),G.p&&G.p.s?(this.px=PropertyFactory.getProp(B,G.p.x,0,0,this),this.py=PropertyFactory.getProp(B,G.p.y,0,0,this),G.p.z&&(this.pz=PropertyFactory.getProp(B,G.p.z,0,0,this))):this.p=PropertyFactory.getProp(B,G.p||{k:[0,0,0]},1,0,this),G.rx){if(this.rx=PropertyFactory.getProp(B,G.rx,0,degToRads,this),this.ry=PropertyFactory.getProp(B,G.ry,0,degToRads,this),this.rz=PropertyFactory.getProp(B,G.rz,0,degToRads,this),G.or.k[0].ti){var z,D=G.or.k.length;for(z=0;z<D;z+=1)G.or.k[z].to=null,G.or.k[z].ti=null}this.or=PropertyFactory.getProp(B,G.or,1,degToRads,this),this.or.sh=!0}else this.r=PropertyFactory.getProp(B,G.r||{k:0},0,degToRads,this);G.sk&&(this.sk=PropertyFactory.getProp(B,G.sk,0,degToRads,this),this.sa=PropertyFactory.getProp(B,G.sa,0,degToRads,this)),this.a=PropertyFactory.getProp(B,G.a||{k:[0,0,0]},1,0,this),this.s=PropertyFactory.getProp(B,G.s||{k:[100,100,100]},1,.01,this),G.o?this.o=PropertyFactory.getProp(B,G.o,0,.01,B):this.o={_mdf:!1,v:1},this._isDirty=!0,this.dynamicProperties.length||this.getValue(!0)}I.prototype={applyToMatrix:_,getValue:C,precalculateMatrix:A,autoOrient:T},extendPrototype([DynamicPropertyContainer],I),I.prototype.addDynamicProperty=E,I.prototype._addDynamicProperty=DynamicPropertyContainer.prototype.addDynamicProperty;function F(B,G,R){return new I(B,G,R)}return{getTransformProperty:F}}();function RepeaterModifier(){}extendPrototype([ShapeModifier],RepeaterModifier),RepeaterModifier.prototype.initModifierProperties=function(P,_){this.getValue=this.processKeys,this.c=PropertyFactory.getProp(P,_.c,0,null,this),this.o=PropertyFactory.getProp(P,_.o,0,null,this),this.tr=TransformPropertyFactory.getTransformProperty(P,_.tr,this),this.so=PropertyFactory.getProp(P,_.tr.so,0,.01,this),this.eo=PropertyFactory.getProp(P,_.tr.eo,0,.01,this),this.data=_,this.dynamicProperties.length||this.getValue(!0),this._isAnimated=!!this.dynamicProperties.length,this.pMatrix=new Matrix,this.rMatrix=new Matrix,this.sMatrix=new Matrix,this.tMatrix=new Matrix,this.matrix=new Matrix},RepeaterModifier.prototype.applyTransforms=function(P,_,C,A,T,E){var I=E?-1:1,F=A.s.v[0]+(1-A.s.v[0])*(1-T),B=A.s.v[1]+(1-A.s.v[1])*(1-T);P.translate(A.p.v[0]*I*T,A.p.v[1]*I*T,A.p.v[2]),_.translate(-A.a.v[0],-A.a.v[1],A.a.v[2]),_.rotate(-A.r.v*I*T),_.translate(A.a.v[0],A.a.v[1],A.a.v[2]),C.translate(-A.a.v[0],-A.a.v[1],A.a.v[2]),C.scale(E?1/F:F,E?1/B:B),C.translate(A.a.v[0],A.a.v[1],A.a.v[2])},RepeaterModifier.prototype.init=function(P,_,C,A){for(this.elem=P,this.arr=_,this.pos=C,this.elemsData=A,this._currentCopies=0,this._elements=[],this._groups=[],this.frameId=-1,this.initDynamicPropertyContainer(P),this.initModifierProperties(P,_[C]);C>0;)C-=1,this._elements.unshift(_[C]);this.dynamicProperties.length?this.k=!0:this.getValue(!0)},RepeaterModifier.prototype.resetElements=function(P){var _,C=P.length;for(_=0;_<C;_+=1)P[_]._processed=!1,P[_].ty==="gr"&&this.resetElements(P[_].it)},RepeaterModifier.prototype.cloneElements=function(P){var _=JSON.parse(JSON.stringify(P));return this.resetElements(_),_},RepeaterModifier.prototype.changeGroupRender=function(P,_){var C,A=P.length;for(C=0;C<A;C+=1)P[C]._render=_,P[C].ty==="gr"&&this.changeGroupRender(P[C].it,_)},RepeaterModifier.prototype.processShapes=function(P){var _,C,A,T,E,I=!1;if(this._mdf||P){var F=Math.ceil(this.c.v);if(this._groups.length<F){for(;this._groups.length<F;){var B={it:this.cloneElements(this._elements),ty:"gr"};B.it.push({a:{a:0,ix:1,k:[0,0]},nm:"Transform",o:{a:0,ix:7,k:100},p:{a:0,ix:2,k:[0,0]},r:{a:1,ix:6,k:[{s:0,e:0,t:0},{s:0,e:0,t:1}]},s:{a:0,ix:3,k:[100,100]},sa:{a:0,ix:5,k:0},sk:{a:0,ix:4,k:0},ty:"tr"}),this.arr.splice(0,0,B),this._groups.splice(0,0,B),this._currentCopies+=1}this.elem.reloadShapes(),I=!0}E=0;var G;for(A=0;A<=this._groups.length-1;A+=1){if(G=E<F,this._groups[A]._render=G,this.changeGroupRender(this._groups[A].it,G),!G){var R=this.elemsData[A].it,z=R[R.length-1];z.transform.op.v!==0?(z.transform.op._mdf=!0,z.transform.op.v=0):z.transform.op._mdf=!1}E+=1}this._currentCopies=F;var D=this.o.v,L=D%1,O=D>0?Math.floor(D):Math.ceil(D),V=this.pMatrix.props,U=this.rMatrix.props,W=this.sMatrix.props;this.pMatrix.reset(),this.rMatrix.reset(),this.sMatrix.reset(),this.tMatrix.reset(),this.matrix.reset();var X=0;if(D>0){for(;X<O;)this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!1),X+=1;L&&(this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,L,!1),X+=L)}else if(D<0){for(;X>O;)this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!0),X-=1;L&&(this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,-L,!0),X-=L)}A=this.data.m===1?0:this._currentCopies-1,T=this.data.m===1?1:-1,E=this._currentCopies;for(var Y,K;E;){if(_=this.elemsData[A].it,C=_[_.length-1].transform.mProps.v.props,K=C.length,_[_.length-1].transform.mProps._mdf=!0,_[_.length-1].transform.op._mdf=!0,_[_.length-1].transform.op.v=this._currentCopies===1?this.so.v:this.so.v+(this.eo.v-this.so.v)*(A/(this._currentCopies-1)),X!==0){for((A!==0&&T===1||A!==this._currentCopies-1&&T===-1)&&this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!1),this.matrix.transform(U[0],U[1],U[2],U[3],U[4],U[5],U[6],U[7],U[8],U[9],U[10],U[11],U[12],U[13],U[14],U[15]),this.matrix.transform(W[0],W[1],W[2],W[3],W[4],W[5],W[6],W[7],W[8],W[9],W[10],W[11],W[12],W[13],W[14],W[15]),this.matrix.transform(V[0],V[1],V[2],V[3],V[4],V[5],V[6],V[7],V[8],V[9],V[10],V[11],V[12],V[13],V[14],V[15]),Y=0;Y<K;Y+=1)C[Y]=this.matrix.props[Y];this.matrix.reset()}else for(this.matrix.reset(),Y=0;Y<K;Y+=1)C[Y]=this.matrix.props[Y];X+=1,E-=1,A+=T}}else for(E=this._currentCopies,A=0,T=1;E;)_=this.elemsData[A].it,C=_[_.length-1].transform.mProps.v.props,_[_.length-1].transform.mProps._mdf=!1,_[_.length-1].transform.op._mdf=!1,E-=1,A+=T;return I},RepeaterModifier.prototype.addShape=function(){};function RoundCornersModifier(){}extendPrototype([ShapeModifier],RoundCornersModifier),RoundCornersModifier.prototype.initModifierProperties=function(P,_){this.getValue=this.processKeys,this.rd=PropertyFactory.getProp(P,_.r,0,null,this),this._isAnimated=!!this.rd.effectsSequence.length},RoundCornersModifier.prototype.processPath=function(P,_){var C=shapePool.newElement();C.c=P.c;var A,T=P._length,E,I,F,B,G,R,z=0,D,L,O,V,U,W;for(A=0;A<T;A+=1)E=P.v[A],F=P.o[A],I=P.i[A],E[0]===F[0]&&E[1]===F[1]&&E[0]===I[0]&&E[1]===I[1]?(A===0||A===T-1)&&!P.c?(C.setTripleAt(E[0],E[1],F[0],F[1],I[0],I[1],z),z+=1):(A===0?B=P.v[T-1]:B=P.v[A-1],G=Math.sqrt(Math.pow(E[0]-B[0],2)+Math.pow(E[1]-B[1],2)),R=G?Math.min(G/2,_)/G:0,U=E[0]+(B[0]-E[0])*R,D=U,W=E[1]-(E[1]-B[1])*R,L=W,O=D-(D-E[0])*roundCorner,V=L-(L-E[1])*roundCorner,C.setTripleAt(D,L,O,V,U,W,z),z+=1,A===T-1?B=P.v[0]:B=P.v[A+1],G=Math.sqrt(Math.pow(E[0]-B[0],2)+Math.pow(E[1]-B[1],2)),R=G?Math.min(G/2,_)/G:0,O=E[0]+(B[0]-E[0])*R,D=O,V=E[1]+(B[1]-E[1])*R,L=V,U=D-(D-E[0])*roundCorner,W=L-(L-E[1])*roundCorner,C.setTripleAt(D,L,O,V,U,W,z),z+=1):(C.setTripleAt(P.v[A][0],P.v[A][1],P.o[A][0],P.o[A][1],P.i[A][0],P.i[A][1],z),z+=1);return C},RoundCornersModifier.prototype.processShapes=function(P){var _,C,A=this.shapes.length,T,E,I=this.rd.v;if(I!==0){var F,B;for(C=0;C<A;C+=1){if(F=this.shapes[C],B=F.localShapeCollection,!(!F.shape._mdf&&!this._mdf&&!P))for(B.releaseShapes(),F.shape._mdf=!0,_=F.shape.paths.shapes,E=F.shape.paths._length,T=0;T<E;T+=1)B.addShape(this.processPath(_[T],I));F.shape.paths=F.localShapeCollection}}this.dynamicProperties.length||(this._mdf=!1)};function floatEqual(P,_){return Math.abs(P-_)*1e5<=Math.min(Math.abs(P),Math.abs(_))}function floatZero(P){return Math.abs(P)<=1e-5}function lerp(P,_,C){return P*(1-C)+_*C}function lerpPoint(P,_,C){return[lerp(P[0],_[0],C),lerp(P[1],_[1],C)]}function quadRoots(P,_,C){if(P===0)return[];var A=_*_-4*P*C;if(A<0)return[];var T=-_/(2*P);if(A===0)return[T];var E=Math.sqrt(A)/(2*P);return[T-E,T+E]}function polynomialCoefficients(P,_,C,A){return[-P+3*_-3*C+A,3*P-6*_+3*C,-3*P+3*_,P]}function singlePoint(P){return new PolynomialBezier(P,P,P,P,!1)}function PolynomialBezier(P,_,C,A,T){T&&pointEqual(P,_)&&(_=lerpPoint(P,A,1/3)),T&&pointEqual(C,A)&&(C=lerpPoint(P,A,2/3));var E=polynomialCoefficients(P[0],_[0],C[0],A[0]),I=polynomialCoefficients(P[1],_[1],C[1],A[1]);this.a=[E[0],I[0]],this.b=[E[1],I[1]],this.c=[E[2],I[2]],this.d=[E[3],I[3]],this.points=[P,_,C,A]}PolynomialBezier.prototype.point=function(P){return[((this.a[0]*P+this.b[0])*P+this.c[0])*P+this.d[0],((this.a[1]*P+this.b[1])*P+this.c[1])*P+this.d[1]]},PolynomialBezier.prototype.derivative=function(P){return[(3*P*this.a[0]+2*this.b[0])*P+this.c[0],(3*P*this.a[1]+2*this.b[1])*P+this.c[1]]},PolynomialBezier.prototype.tangentAngle=function(P){var _=this.derivative(P);return Math.atan2(_[1],_[0])},PolynomialBezier.prototype.normalAngle=function(P){var _=this.derivative(P);return Math.atan2(_[0],_[1])},PolynomialBezier.prototype.inflectionPoints=function(){var P=this.a[1]*this.b[0]-this.a[0]*this.b[1];if(floatZero(P))return[];var _=-.5*(this.a[1]*this.c[0]-this.a[0]*this.c[1])/P,C=_*_-1/3*(this.b[1]*this.c[0]-this.b[0]*this.c[1])/P;if(C<0)return[];var A=Math.sqrt(C);return floatZero(A)?A>0&&A<1?[_]:[]:[_-A,_+A].filter(function(T){return T>0&&T<1})},PolynomialBezier.prototype.split=function(P){if(P<=0)return[singlePoint(this.points[0]),this];if(P>=1)return[this,singlePoint(this.points[this.points.length-1])];var _=lerpPoint(this.points[0],this.points[1],P),C=lerpPoint(this.points[1],this.points[2],P),A=lerpPoint(this.points[2],this.points[3],P),T=lerpPoint(_,C,P),E=lerpPoint(C,A,P),I=lerpPoint(T,E,P);return[new PolynomialBezier(this.points[0],_,T,I,!0),new PolynomialBezier(I,E,A,this.points[3],!0)]};function extrema(P,_){var C=P.points[0][_],A=P.points[P.points.length-1][_];if(C>A){var T=A;A=C,C=T}for(var E=quadRoots(3*P.a[_],2*P.b[_],P.c[_]),I=0;I<E.length;I+=1)if(E[I]>0&&E[I]<1){var F=P.point(E[I])[_];F<C?C=F:F>A&&(A=F)}return{min:C,max:A}}PolynomialBezier.prototype.bounds=function(){return{x:extrema(this,0),y:extrema(this,1)}},PolynomialBezier.prototype.boundingBox=function(){var P=this.bounds();return{left:P.x.min,right:P.x.max,top:P.y.min,bottom:P.y.max,width:P.x.max-P.x.min,height:P.y.max-P.y.min,cx:(P.x.max+P.x.min)/2,cy:(P.y.max+P.y.min)/2}};function intersectData(P,_,C){var A=P.boundingBox();return{cx:A.cx,cy:A.cy,width:A.width,height:A.height,bez:P,t:(_+C)/2,t1:_,t2:C}}function splitData(P){var _=P.bez.split(.5);return[intersectData(_[0],P.t1,P.t),intersectData(_[1],P.t,P.t2)]}function boxIntersect(P,_){return Math.abs(P.cx-_.cx)*2<P.width+_.width&&Math.abs(P.cy-_.cy)*2<P.height+_.height}function intersectsImpl(P,_,C,A,T,E){if(boxIntersect(P,_)){if(C>=E||P.width<=A&&P.height<=A&&_.width<=A&&_.height<=A){T.push([P.t,_.t]);return}var I=splitData(P),F=splitData(_);intersectsImpl(I[0],F[0],C+1,A,T,E),intersectsImpl(I[0],F[1],C+1,A,T,E),intersectsImpl(I[1],F[0],C+1,A,T,E),intersectsImpl(I[1],F[1],C+1,A,T,E)}}PolynomialBezier.prototype.intersections=function(P,_,C){_===void 0&&(_=2),C===void 0&&(C=7);var A=[];return intersectsImpl(intersectData(this,0,1),intersectData(P,0,1),0,_,A,C),A},PolynomialBezier.shapeSegment=function(P,_){var C=(_+1)%P.length();return new PolynomialBezier(P.v[_],P.o[_],P.i[C],P.v[C],!0)},PolynomialBezier.shapeSegmentInverted=function(P,_){var C=(_+1)%P.length();return new PolynomialBezier(P.v[C],P.i[C],P.o[_],P.v[_],!0)};function crossProduct(P,_){return[P[1]*_[2]-P[2]*_[1],P[2]*_[0]-P[0]*_[2],P[0]*_[1]-P[1]*_[0]]}function lineIntersection(P,_,C,A){var T=[P[0],P[1],1],E=[_[0],_[1],1],I=[C[0],C[1],1],F=[A[0],A[1],1],B=crossProduct(crossProduct(T,E),crossProduct(I,F));return floatZero(B[2])?null:[B[0]/B[2],B[1]/B[2]]}function polarOffset(P,_,C){return[P[0]+Math.cos(_)*C,P[1]-Math.sin(_)*C]}function pointDistance(P,_){return Math.hypot(P[0]-_[0],P[1]-_[1])}function pointEqual(P,_){return floatEqual(P[0],_[0])&&floatEqual(P[1],_[1])}function ZigZagModifier(){}extendPrototype([ShapeModifier],ZigZagModifier),ZigZagModifier.prototype.initModifierProperties=function(P,_){this.getValue=this.processKeys,this.amplitude=PropertyFactory.getProp(P,_.s,0,null,this),this.frequency=PropertyFactory.getProp(P,_.r,0,null,this),this.pointsType=PropertyFactory.getProp(P,_.pt,0,null,this),this._isAnimated=this.amplitude.effectsSequence.length!==0||this.frequency.effectsSequence.length!==0||this.pointsType.effectsSequence.length!==0};function setPoint(P,_,C,A,T,E,I){var F=C-Math.PI/2,B=C+Math.PI/2,G=_[0]+Math.cos(C)*A*T,R=_[1]-Math.sin(C)*A*T;P.setTripleAt(G,R,G+Math.cos(F)*E,R-Math.sin(F)*E,G+Math.cos(B)*I,R-Math.sin(B)*I,P.length())}function getPerpendicularVector(P,_){var C=[_[0]-P[0],_[1]-P[1]],A=-Math.PI*.5,T=[Math.cos(A)*C[0]-Math.sin(A)*C[1],Math.sin(A)*C[0]+Math.cos(A)*C[1]];return T}function getProjectingAngle(P,_){var C=_===0?P.length()-1:_-1,A=(_+1)%P.length(),T=P.v[C],E=P.v[A],I=getPerpendicularVector(T,E);return Math.atan2(0,1)-Math.atan2(I[1],I[0])}function zigZagCorner(P,_,C,A,T,E,I){var F=getProjectingAngle(_,C),B=_.v[C%_._length],G=_.v[C===0?_._length-1:C-1],R=_.v[(C+1)%_._length],z=E===2?Math.sqrt(Math.pow(B[0]-G[0],2)+Math.pow(B[1]-G[1],2)):0,D=E===2?Math.sqrt(Math.pow(B[0]-R[0],2)+Math.pow(B[1]-R[1],2)):0;setPoint(P,_.v[C%_._length],F,I,A,D/((T+1)*2),z/((T+1)*2))}function zigZagSegment(P,_,C,A,T,E){for(var I=0;I<A;I+=1){var F=(I+1)/(A+1),B=T===2?Math.sqrt(Math.pow(_.points[3][0]-_.points[0][0],2)+Math.pow(_.points[3][1]-_.points[0][1],2)):0,G=_.normalAngle(F),R=_.point(F);setPoint(P,R,G,E,C,B/((A+1)*2),B/((A+1)*2)),E=-E}return E}ZigZagModifier.prototype.processPath=function(P,_,C,A){var T=P._length,E=shapePool.newElement();if(E.c=P.c,P.c||(T-=1),T===0)return E;var I=-1,F=PolynomialBezier.shapeSegment(P,0);zigZagCorner(E,P,0,_,C,A,I);for(var B=0;B<T;B+=1)I=zigZagSegment(E,F,_,C,A,-I),B===T-1&&!P.c?F=null:F=PolynomialBezier.shapeSegment(P,(B+1)%T),zigZagCorner(E,P,B+1,_,C,A,I);return E},ZigZagModifier.prototype.processShapes=function(P){var _,C,A=this.shapes.length,T,E,I=this.amplitude.v,F=Math.max(0,Math.round(this.frequency.v)),B=this.pointsType.v;if(I!==0){var G,R;for(C=0;C<A;C+=1){if(G=this.shapes[C],R=G.localShapeCollection,!(!G.shape._mdf&&!this._mdf&&!P))for(R.releaseShapes(),G.shape._mdf=!0,_=G.shape.paths.shapes,E=G.shape.paths._length,T=0;T<E;T+=1)R.addShape(this.processPath(_[T],I,F,B));G.shape.paths=G.localShapeCollection}}this.dynamicProperties.length||(this._mdf=!1)};function linearOffset(P,_,C){var A=Math.atan2(_[0]-P[0],_[1]-P[1]);return[polarOffset(P,A,C),polarOffset(_,A,C)]}function offsetSegment(P,_){var C,A,T,E,I,F,B;B=linearOffset(P.points[0],P.points[1],_),C=B[0],A=B[1],B=linearOffset(P.points[1],P.points[2],_),T=B[0],E=B[1],B=linearOffset(P.points[2],P.points[3],_),I=B[0],F=B[1];var G=lineIntersection(C,A,T,E);G===null&&(G=A);var R=lineIntersection(I,F,T,E);return R===null&&(R=I),new PolynomialBezier(C,G,R,F)}function joinLines(P,_,C,A,T){var E=_.points[3],I=C.points[0];if(A===3||pointEqual(E,I))return E;if(A===2){var F=-_.tangentAngle(1),B=-C.tangentAngle(0)+Math.PI,G=lineIntersection(E,polarOffset(E,F+Math.PI/2,100),I,polarOffset(I,F+Math.PI/2,100)),R=G?pointDistance(G,E):pointDistance(E,I)/2,z=polarOffset(E,F,2*R*roundCorner);return P.setXYAt(z[0],z[1],"o",P.length()-1),z=polarOffset(I,B,2*R*roundCorner),P.setTripleAt(I[0],I[1],I[0],I[1],z[0],z[1],P.length()),I}var D=pointEqual(E,_.points[2])?_.points[0]:_.points[2],L=pointEqual(I,C.points[1])?C.points[3]:C.points[1],O=lineIntersection(D,E,I,L);return O&&pointDistance(O,E)<T?(P.setTripleAt(O[0],O[1],O[0],O[1],O[0],O[1],P.length()),O):E}function getIntersection(P,_){var C=P.intersections(_);return C.length&&floatEqual(C[0][0],1)&&C.shift(),C.length?C[0]:null}function pruneSegmentIntersection(P,_){var C=P.slice(),A=_.slice(),T=getIntersection(P[P.length-1],_[0]);return T&&(C[P.length-1]=P[P.length-1].split(T[0])[0],A[0]=_[0].split(T[1])[1]),P.length>1&&_.length>1&&(T=getIntersection(P[0],_[_.length-1]),T)?[[P[0].split(T[0])[0]],[_[_.length-1].split(T[1])[1]]]:[C,A]}function pruneIntersections(P){for(var _,C=1;C<P.length;C+=1)_=pruneSegmentIntersection(P[C-1],P[C]),P[C-1]=_[0],P[C]=_[1];return P.length>1&&(_=pruneSegmentIntersection(P[P.length-1],P[0]),P[P.length-1]=_[0],P[0]=_[1]),P}function offsetSegmentSplit(P,_){var C=P.inflectionPoints(),A,T,E,I;if(C.length===0)return[offsetSegment(P,_)];if(C.length===1||floatEqual(C[1],1))return E=P.split(C[0]),A=E[0],T=E[1],[offsetSegment(A,_),offsetSegment(T,_)];E=P.split(C[0]),A=E[0];var F=(C[1]-C[0])/(1-C[0]);return E=E[1].split(F),I=E[0],T=E[1],[offsetSegment(A,_),offsetSegment(I,_),offsetSegment(T,_)]}function OffsetPathModifier(){}extendPrototype([ShapeModifier],OffsetPathModifier),OffsetPathModifier.prototype.initModifierProperties=function(P,_){this.getValue=this.processKeys,this.amount=PropertyFactory.getProp(P,_.a,0,null,this),this.miterLimit=PropertyFactory.getProp(P,_.ml,0,null,this),this.lineJoin=_.lj,this._isAnimated=this.amount.effectsSequence.length!==0},OffsetPathModifier.prototype.processPath=function(P,_,C,A){var T=shapePool.newElement();T.c=P.c;var E=P.length();P.c||(E-=1);var I,F,B,G=[];for(I=0;I<E;I+=1)B=PolynomialBezier.shapeSegment(P,I),G.push(offsetSegmentSplit(B,_));if(!P.c)for(I=E-1;I>=0;I-=1)B=PolynomialBezier.shapeSegmentInverted(P,I),G.push(offsetSegmentSplit(B,_));G=pruneIntersections(G);var R=null,z=null;for(I=0;I<G.length;I+=1){var D=G[I];for(z&&(R=joinLines(T,z,D[0],C,A)),z=D[D.length-1],F=0;F<D.length;F+=1)B=D[F],R&&pointEqual(B.points[0],R)?T.setXYAt(B.points[1][0],B.points[1][1],"o",T.length()-1):T.setTripleAt(B.points[0][0],B.points[0][1],B.points[1][0],B.points[1][1],B.points[0][0],B.points[0][1],T.length()),T.setTripleAt(B.points[3][0],B.points[3][1],B.points[3][0],B.points[3][1],B.points[2][0],B.points[2][1],T.length()),R=B.points[3]}return G.length&&joinLines(T,z,G[0][0],C,A),T},OffsetPathModifier.prototype.processShapes=function(P){var _,C,A=this.shapes.length,T,E,I=this.amount.v,F=this.miterLimit.v,B=this.lineJoin;if(I!==0){var G,R;for(C=0;C<A;C+=1){if(G=this.shapes[C],R=G.localShapeCollection,!(!G.shape._mdf&&!this._mdf&&!P))for(R.releaseShapes(),G.shape._mdf=!0,_=G.shape.paths.shapes,E=G.shape.paths._length,T=0;T<E;T+=1)R.addShape(this.processPath(_[T],I,B,F));G.shape.paths=G.localShapeCollection}}this.dynamicProperties.length||(this._mdf=!1)};function getFontProperties(P){for(var _=P.fStyle?P.fStyle.split(" "):[],C="normal",A="normal",T=_.length,E,I=0;I<T;I+=1)switch(E=_[I].toLowerCase(),E){case"italic":A="italic";break;case"bold":C="700";break;case"black":C="900";break;case"medium":C="500";break;case"regular":case"normal":C="400";break;case"light":case"thin":C="200";break}return{style:A,weight:P.fWeight||C}}var FontManager=function(){var P=5e3,_={w:0,size:0,shapes:[],data:{shapes:[]}},C=[];C=C.concat([2304,2305,2306,2307,2362,2363,2364,2364,2366,2367,2368,2369,2370,2371,2372,2373,2374,2375,2376,2377,2378,2379,2380,2381,2382,2383,2387,2388,2389,2390,2391,2402,2403]);var A=127988,T=917631,E=917601,I=917626,F=65039,B=8205,G=127462,R=127487,z=["d83cdffb","d83cdffc","d83cdffd","d83cdffe","d83cdfff"];function D(Q){var it=Q.split(","),Z,et=it.length,ht=[];for(Z=0;Z<et;Z+=1)it[Z]!=="sans-serif"&&it[Z]!=="monospace"&&ht.push(it[Z]);return ht.join(",")}function L(Q,it){var Z=createTag("span");Z.setAttribute("aria-hidden",!0),Z.style.fontFamily=it;var et=createTag("span");et.innerText="giItT1WQy@!-/#",Z.style.position="absolute",Z.style.left="-10000px",Z.style.top="-10000px",Z.style.fontSize="300px",Z.style.fontVariant="normal",Z.style.fontStyle="normal",Z.style.fontWeight="normal",Z.style.letterSpacing="0",Z.appendChild(et),document.body.appendChild(Z);var ht=et.offsetWidth;return et.style.fontFamily=D(Q)+", "+it,{node:et,w:ht,parent:Z}}function O(){var Q,it=this.fonts.length,Z,et,ht=it;for(Q=0;Q<it;Q+=1)this.fonts[Q].loaded?ht-=1:this.fonts[Q].fOrigin==="n"||this.fonts[Q].origin===0?this.fonts[Q].loaded=!0:(Z=this.fonts[Q].monoCase.node,et=this.fonts[Q].monoCase.w,Z.offsetWidth!==et?(ht-=1,this.fonts[Q].loaded=!0):(Z=this.fonts[Q].sansCase.node,et=this.fonts[Q].sansCase.w,Z.offsetWidth!==et&&(ht-=1,this.fonts[Q].loaded=!0)),this.fonts[Q].loaded&&(this.fonts[Q].sansCase.parent.parentNode.removeChild(this.fonts[Q].sansCase.parent),this.fonts[Q].monoCase.parent.parentNode.removeChild(this.fonts[Q].monoCase.parent)));ht!==0&&Date.now()-this.initTime<P?setTimeout(this.checkLoadedFontsBinded,20):setTimeout(this.setIsLoadedBinded,10)}function V(Q,it){var Z=document.body&&it?"svg":"canvas",et,ht=getFontProperties(Q);if(Z==="svg"){var lt=createNS("text");lt.style.fontSize="100px",lt.setAttribute("font-family",Q.fFamily),lt.setAttribute("font-style",ht.style),lt.setAttribute("font-weight",ht.weight),lt.textContent="1",Q.fClass?(lt.style.fontFamily="inherit",lt.setAttribute("class",Q.fClass)):lt.style.fontFamily=Q.fFamily,it.appendChild(lt),et=lt}else{var ft=new OffscreenCanvas(500,500).getContext("2d");ft.font=ht.style+" "+ht.weight+" 100px "+Q.fFamily,et=ft}function pt(mt){return Z==="svg"?(et.textContent=mt,et.getComputedTextLength()):et.measureText(mt).width}return{measureText:pt}}function U(Q,it){if(!Q){this.isLoaded=!0;return}if(this.chars){this.isLoaded=!0,this.fonts=Q.list;return}if(!document.body){this.isLoaded=!0,Q.list.forEach(function(xt){xt.helper=V(xt),xt.cache={}}),this.fonts=Q.list;return}var Z=Q.list,et,ht=Z.length,lt=ht;for(et=0;et<ht;et+=1){var ft=!0,pt,mt;if(Z[et].loaded=!1,Z[et].monoCase=L(Z[et].fFamily,"monospace"),Z[et].sansCase=L(Z[et].fFamily,"sans-serif"),!Z[et].fPath)Z[et].loaded=!0,lt-=1;else if(Z[et].fOrigin==="p"||Z[et].origin===3){if(pt=document.querySelectorAll('style[f-forigin="p"][f-family="'+Z[et].fFamily+'"], style[f-origin="3"][f-family="'+Z[et].fFamily+'"]'),pt.length>0&&(ft=!1),ft){var gt=createTag("style");gt.setAttribute("f-forigin",Z[et].fOrigin),gt.setAttribute("f-origin",Z[et].origin),gt.setAttribute("f-family",Z[et].fFamily),gt.type="text/css",gt.innerText="@font-face {font-family: "+Z[et].fFamily+"; font-style: normal; src: url('"+Z[et].fPath+"');}",it.appendChild(gt)}}else if(Z[et].fOrigin==="g"||Z[et].origin===1){for(pt=document.querySelectorAll('link[f-forigin="g"], link[f-origin="1"]'),mt=0;mt<pt.length;mt+=1)pt[mt].href.indexOf(Z[et].fPath)!==-1&&(ft=!1);if(ft){var yt=createTag("link");yt.setAttribute("f-forigin",Z[et].fOrigin),yt.setAttribute("f-origin",Z[et].origin),yt.type="text/css",yt.rel="stylesheet",yt.href=Z[et].fPath,document.body.appendChild(yt)}}else if(Z[et].fOrigin==="t"||Z[et].origin===2){for(pt=document.querySelectorAll('script[f-forigin="t"], script[f-origin="2"]'),mt=0;mt<pt.length;mt+=1)Z[et].fPath===pt[mt].src&&(ft=!1);if(ft){var bt=createTag("link");bt.setAttribute("f-forigin",Z[et].fOrigin),bt.setAttribute("f-origin",Z[et].origin),bt.setAttribute("rel","stylesheet"),bt.setAttribute("href",Z[et].fPath),it.appendChild(bt)}}Z[et].helper=V(Z[et],it),Z[et].cache={},this.fonts.push(Z[et])}lt===0?this.isLoaded=!0:setTimeout(this.checkLoadedFonts.bind(this),100)}function W(Q){if(Q){this.chars||(this.chars=[]);var it,Z=Q.length,et,ht=this.chars.length,lt;for(it=0;it<Z;it+=1){for(et=0,lt=!1;et<ht;)this.chars[et].style===Q[it].style&&this.chars[et].fFamily===Q[it].fFamily&&this.chars[et].ch===Q[it].ch&&(lt=!0),et+=1;lt||(this.chars.push(Q[it]),ht+=1)}}}function X(Q,it,Z){for(var et=0,ht=this.chars.length;et<ht;){if(this.chars[et].ch===Q&&this.chars[et].style===it&&this.chars[et].fFamily===Z)return this.chars[et];et+=1}return(typeof Q=="string"&&Q.charCodeAt(0)!==13||!Q)&&console&&console.warn&&!this._warned&&(this._warned=!0,console.warn("Missing character from exported characters list: ",Q,it,Z)),_}function Y(Q,it,Z){var et=this.getFontByName(it),ht=Q;if(!et.cache[ht]){var lt=et.helper;if(Q===" "){var ft=lt.measureText("|"+Q+"|"),pt=lt.measureText("||");et.cache[ht]=(ft-pt)/100}else et.cache[ht]=lt.measureText(Q)/100}return et.cache[ht]*Z}function K(Q){for(var it=0,Z=this.fonts.length;it<Z;){if(this.fonts[it].fName===Q)return this.fonts[it];it+=1}return this.fonts[0]}function q(Q){var it=0,Z=Q.charCodeAt(0);if(Z>=55296&&Z<=56319){var et=Q.charCodeAt(1);et>=56320&&et<=57343&&(it=(Z-55296)*1024+et-56320+65536)}return it}function J(Q,it){var Z=Q.toString(16)+it.toString(16);return z.indexOf(Z)!==-1}function tt(Q){return Q===B}function rt(Q){return Q===F}function st(Q){var it=q(Q);return it>=G&&it<=R}function nt(Q){return st(Q.substr(0,2))&&st(Q.substr(2,2))}function at(Q){return C.indexOf(Q)!==-1}function ot(Q,it){var Z=q(Q.substr(it,2));if(Z!==A)return!1;var et=0;for(it+=2;et<5;){if(Z=q(Q.substr(it,2)),Z<E||Z>I)return!1;et+=1,it+=2}return q(Q.substr(it,2))===T}function ct(){this.isLoaded=!0}var dt=function(){this.fonts=[],this.chars=null,this.typekitLoaded=0,this.isLoaded=!1,this._warned=!1,this.initTime=Date.now(),this.setIsLoadedBinded=this.setIsLoaded.bind(this),this.checkLoadedFontsBinded=this.checkLoadedFonts.bind(this)};dt.isModifier=J,dt.isZeroWidthJoiner=tt,dt.isFlagEmoji=nt,dt.isRegionalCode=st,dt.isCombinedCharacter=at,dt.isRegionalFlag=ot,dt.isVariationSelector=rt,dt.BLACK_FLAG_CODE_POINT=A;var ut={addChars:W,addFonts:U,getCharData:X,getFontByName:K,measureText:Y,checkLoadedFonts:O,setIsLoaded:ct};return dt.prototype=ut,dt}();function SlotManager(P){this.animationData=P}SlotManager.prototype.getProp=function(P){return this.animationData.slots&&this.animationData.slots[P.sid]?Object.assign(P,this.animationData.slots[P.sid].p):P};function slotFactory(P){return new SlotManager(P)}function RenderableElement(){}RenderableElement.prototype={initRenderable:function(){this.isInRange=!1,this.hidden=!1,this.isTransparent=!1,this.renderableComponents=[]},addRenderableComponent:function(_){this.renderableComponents.indexOf(_)===-1&&this.renderableComponents.push(_)},removeRenderableComponent:function(_){this.renderableComponents.indexOf(_)!==-1&&this.renderableComponents.splice(this.renderableComponents.indexOf(_),1)},prepareRenderableFrame:function(_){this.checkLayerLimits(_)},checkTransparency:function(){this.finalTransform.mProp.o.v<=0?!this.isTransparent&&this.globalData.renderConfig.hideOnTransparent&&(this.isTransparent=!0,this.hide()):this.isTransparent&&(this.isTransparent=!1,this.show())},checkLayerLimits:function(_){this.data.ip-this.data.st<=_&&this.data.op-this.data.st>_?this.isInRange!==!0&&(this.globalData._mdf=!0,this._mdf=!0,this.isInRange=!0,this.show()):this.isInRange!==!1&&(this.globalData._mdf=!0,this.isInRange=!1,this.hide())},renderRenderable:function(){var _,C=this.renderableComponents.length;for(_=0;_<C;_+=1)this.renderableComponents[_].renderFrame(this._isFirstFrame)},sourceRectAtTime:function(){return{top:0,left:0,width:100,height:100}},getLayerSize:function(){return this.data.ty===5?{w:this.data.textData.width,h:this.data.textData.height}:{w:this.data.width,h:this.data.height}}};var getBlendMode=function(){var P={0:"source-over",1:"multiply",2:"screen",3:"overlay",4:"darken",5:"lighten",6:"color-dodge",7:"color-burn",8:"hard-light",9:"soft-light",10:"difference",11:"exclusion",12:"hue",13:"saturation",14:"color",15:"luminosity"};return function(_){return P[_]||""}}();function SliderEffect(P,_,C){this.p=PropertyFactory.getProp(_,P.v,0,0,C)}function AngleEffect(P,_,C){this.p=PropertyFactory.getProp(_,P.v,0,0,C)}function ColorEffect(P,_,C){this.p=PropertyFactory.getProp(_,P.v,1,0,C)}function PointEffect(P,_,C){this.p=PropertyFactory.getProp(_,P.v,1,0,C)}function LayerIndexEffect(P,_,C){this.p=PropertyFactory.getProp(_,P.v,0,0,C)}function MaskIndexEffect(P,_,C){this.p=PropertyFactory.getProp(_,P.v,0,0,C)}function CheckboxEffect(P,_,C){this.p=PropertyFactory.getProp(_,P.v,0,0,C)}function NoValueEffect(){this.p={}}function EffectsManager(P,_){var C=P.ef||[];this.effectElements=[];var A,T=C.length,E;for(A=0;A<T;A+=1)E=new GroupEffect(C[A],_),this.effectElements.push(E)}function GroupEffect(P,_){this.init(P,_)}extendPrototype([DynamicPropertyContainer],GroupEffect),GroupEffect.prototype.getValue=GroupEffect.prototype.iterateDynamicProperties,GroupEffect.prototype.init=function(P,_){this.data=P,this.effectElements=[],this.initDynamicPropertyContainer(_);var C,A=this.data.ef.length,T,E=this.data.ef;for(C=0;C<A;C+=1){switch(T=null,E[C].ty){case 0:T=new SliderEffect(E[C],_,this);break;case 1:T=new AngleEffect(E[C],_,this);break;case 2:T=new ColorEffect(E[C],_,this);break;case 3:T=new PointEffect(E[C],_,this);break;case 4:case 7:T=new CheckboxEffect(E[C],_,this);break;case 10:T=new LayerIndexEffect(E[C],_,this);break;case 11:T=new MaskIndexEffect(E[C],_,this);break;case 5:T=new EffectsManager(E[C],_);break;default:T=new NoValueEffect(E[C]);break}T&&this.effectElements.push(T)}};function BaseElement(){}BaseElement.prototype={checkMasks:function(){if(!this.data.hasMask)return!1;for(var _=0,C=this.data.masksProperties.length;_<C;){if(this.data.masksProperties[_].mode!=="n"&&this.data.masksProperties[_].cl!==!1)return!0;_+=1}return!1},initExpressions:function(){var _=getExpressionInterfaces();if(_){var C=_("layer"),A=_("effects"),T=_("shape"),E=_("text"),I=_("comp");this.layerInterface=C(this),this.data.hasMask&&this.maskManager&&this.layerInterface.registerMaskInterface(this.maskManager);var F=A.createEffectsInterface(this,this.layerInterface);this.layerInterface.registerEffectsInterface(F),this.data.ty===0||this.data.xt?this.compInterface=I(this):this.data.ty===4?(this.layerInterface.shapeInterface=T(this.shapesData,this.itemsData,this.layerInterface),this.layerInterface.content=this.layerInterface.shapeInterface):this.data.ty===5&&(this.layerInterface.textInterface=E(this),this.layerInterface.text=this.layerInterface.textInterface)}},setBlendMode:function(){var _=getBlendMode(this.data.bm),C=this.baseElement||this.layerElement;C.style["mix-blend-mode"]=_},initBaseData:function(_,C,A){this.globalData=C,this.comp=A,this.data=_,this.layerId=createElementID(),this.data.sr||(this.data.sr=1),this.effectsManager=new EffectsManager(this.data,this,this.dynamicProperties)},getType:function(){return this.type},sourceRectAtTime:function(){}};function FrameElement(){}FrameElement.prototype={initFrame:function(){this._isFirstFrame=!1,this.dynamicProperties=[],this._mdf=!1},prepareProperties:function(_,C){var A,T=this.dynamicProperties.length;for(A=0;A<T;A+=1)(C||this._isParent&&this.dynamicProperties[A].propType==="transform")&&(this.dynamicProperties[A].getValue(),this.dynamicProperties[A]._mdf&&(this.globalData._mdf=!0,this._mdf=!0))},addDynamicProperty:function(_){this.dynamicProperties.indexOf(_)===-1&&this.dynamicProperties.push(_)}};function FootageElement(P,_,C){this.initFrame(),this.initRenderable(),this.assetData=_.getAssetData(P.refId),this.footageData=_.imageLoader.getAsset(this.assetData),this.initBaseData(P,_,C)}FootageElement.prototype.prepareFrame=function(){},extendPrototype([RenderableElement,BaseElement,FrameElement],FootageElement),FootageElement.prototype.getBaseElement=function(){return null},FootageElement.prototype.renderFrame=function(){},FootageElement.prototype.destroy=function(){},FootageElement.prototype.initExpressions=function(){var P=getExpressionInterfaces();if(P){var _=P("footage");this.layerInterface=_(this)}},FootageElement.prototype.getFootageData=function(){return this.footageData};function AudioElement(P,_,C){this.initFrame(),this.initRenderable(),this.assetData=_.getAssetData(P.refId),this.initBaseData(P,_,C),this._isPlaying=!1,this._canPlay=!1;var A=this.globalData.getAssetsPath(this.assetData);this.audio=this.globalData.audioController.createAudio(A),this._currentTime=0,this.globalData.audioController.addAudio(this),this._volumeMultiplier=1,this._volume=1,this._previousVolume=null,this.tm=P.tm?PropertyFactory.getProp(this,P.tm,0,_.frameRate,this):{_placeholder:!0},this.lv=PropertyFactory.getProp(this,P.au&&P.au.lv?P.au.lv:{k:[100]},1,.01,this)}AudioElement.prototype.prepareFrame=function(P){if(this.prepareRenderableFrame(P,!0),this.prepareProperties(P,!0),this.tm._placeholder)this._currentTime=P/this.data.sr;else{var _=this.tm.v;this._currentTime=_}this._volume=this.lv.v[0];var C=this._volume*this._volumeMultiplier;this._previousVolume!==C&&(this._previousVolume=C,this.audio.volume(C))},extendPrototype([RenderableElement,BaseElement,FrameElement],AudioElement),AudioElement.prototype.renderFrame=function(){this.isInRange&&this._canPlay&&(this._isPlaying?(!this.audio.playing()||Math.abs(this._currentTime/this.globalData.frameRate-this.audio.seek())>.1)&&this.audio.seek(this._currentTime/this.globalData.frameRate):(this.audio.play(),this.audio.seek(this._currentTime/this.globalData.frameRate),this._isPlaying=!0))},AudioElement.prototype.show=function(){},AudioElement.prototype.hide=function(){this.audio.pause(),this._isPlaying=!1},AudioElement.prototype.pause=function(){this.audio.pause(),this._isPlaying=!1,this._canPlay=!1},AudioElement.prototype.resume=function(){this._canPlay=!0},AudioElement.prototype.setRate=function(P){this.audio.rate(P)},AudioElement.prototype.volume=function(P){this._volumeMultiplier=P,this._previousVolume=P*this._volume,this.audio.volume(this._previousVolume)},AudioElement.prototype.getBaseElement=function(){return null},AudioElement.prototype.destroy=function(){},AudioElement.prototype.sourceRectAtTime=function(){},AudioElement.prototype.initExpressions=function(){};function BaseRenderer(){}BaseRenderer.prototype.checkLayers=function(P){var _,C=this.layers.length,A;for(this.completeLayers=!0,_=C-1;_>=0;_-=1)this.elements[_]||(A=this.layers[_],A.ip-A.st<=P-this.layers[_].st&&A.op-A.st>P-this.layers[_].st&&this.buildItem(_)),this.completeLayers=this.elements[_]?this.completeLayers:!1;this.checkPendingElements()},BaseRenderer.prototype.createItem=function(P){switch(P.ty){case 2:return this.createImage(P);case 0:return this.createComp(P);case 1:return this.createSolid(P);case 3:return this.createNull(P);case 4:return this.createShape(P);case 5:return this.createText(P);case 6:return this.createAudio(P);case 13:return this.createCamera(P);case 15:return this.createFootage(P);default:return this.createNull(P)}},BaseRenderer.prototype.createCamera=function(){throw new Error("You're using a 3d camera. Try the html renderer.")},BaseRenderer.prototype.createAudio=function(P){return new AudioElement(P,this.globalData,this)},BaseRenderer.prototype.createFootage=function(P){return new FootageElement(P,this.globalData,this)},BaseRenderer.prototype.buildAllItems=function(){var P,_=this.layers.length;for(P=0;P<_;P+=1)this.buildItem(P);this.checkPendingElements()},BaseRenderer.prototype.includeLayers=function(P){this.completeLayers=!1;var _,C=P.length,A,T=this.layers.length;for(_=0;_<C;_+=1)for(A=0;A<T;){if(this.layers[A].id===P[_].id){this.layers[A]=P[_];break}A+=1}},BaseRenderer.prototype.setProjectInterface=function(P){this.globalData.projectInterface=P},BaseRenderer.prototype.initItems=function(){this.globalData.progressiveLoad||this.buildAllItems()},BaseRenderer.prototype.buildElementParenting=function(P,_,C){for(var A=this.elements,T=this.layers,E=0,I=T.length;E<I;)T[E].ind==_&&(!A[E]||A[E]===!0?(this.buildItem(E),this.addPendingElement(P)):(C.push(A[E]),A[E].setAsParent(),T[E].parent!==void 0?this.buildElementParenting(P,T[E].parent,C):P.setHierarchy(C))),E+=1},BaseRenderer.prototype.addPendingElement=function(P){this.pendingElements.push(P)},BaseRenderer.prototype.searchExtraCompositions=function(P){var _,C=P.length;for(_=0;_<C;_+=1)if(P[_].xt){var A=this.createComp(P[_]);A.initExpressions(),this.globalData.projectInterface.registerComposition(A)}},BaseRenderer.prototype.getElementById=function(P){var _,C=this.elements.length;for(_=0;_<C;_+=1)if(this.elements[_].data.ind===P)return this.elements[_];return null},BaseRenderer.prototype.getElementByPath=function(P){var _=P.shift(),C;if(typeof _=="number")C=this.elements[_];else{var A,T=this.elements.length;for(A=0;A<T;A+=1)if(this.elements[A].data.nm===_){C=this.elements[A];break}}return P.length===0?C:C.getElementByPath(P)},BaseRenderer.prototype.setupGlobalData=function(P,_){this.globalData.fontManager=new FontManager,this.globalData.slotManager=slotFactory(P),this.globalData.fontManager.addChars(P.chars),this.globalData.fontManager.addFonts(P.fonts,_),this.globalData.getAssetData=this.animationItem.getAssetData.bind(this.animationItem),this.globalData.getAssetsPath=this.animationItem.getAssetsPath.bind(this.animationItem),this.globalData.imageLoader=this.animationItem.imagePreloader,this.globalData.audioController=this.animationItem.audioController,this.globalData.frameId=0,this.globalData.frameRate=P.fr,this.globalData.nm=P.nm,this.globalData.compSize={w:P.w,h:P.h}};var effectTypes={TRANSFORM_EFFECT:"transformEFfect"};function TransformElement(){}TransformElement.prototype={initTransform:function(){var _=new Matrix;this.finalTransform={mProp:this.data.ks?TransformPropertyFactory.getTransformProperty(this,this.data.ks,this):{o:0},_matMdf:!1,_localMatMdf:!1,_opMdf:!1,mat:_,localMat:_,localOpacity:1},this.data.ao&&(this.finalTransform.mProp.autoOriented=!0),this.data.ty},renderTransform:function(){if(this.finalTransform._opMdf=this.finalTransform.mProp.o._mdf||this._isFirstFrame,this.finalTransform._matMdf=this.finalTransform.mProp._mdf||this._isFirstFrame,this.hierarchy){var _,C=this.finalTransform.mat,A=0,T=this.hierarchy.length;if(!this.finalTransform._matMdf)for(;A<T;){if(this.hierarchy[A].finalTransform.mProp._mdf){this.finalTransform._matMdf=!0;break}A+=1}if(this.finalTransform._matMdf)for(_=this.finalTransform.mProp.v.props,C.cloneFromProps(_),A=0;A<T;A+=1)C.multiply(this.hierarchy[A].finalTransform.mProp.v)}this.finalTransform._matMdf&&(this.finalTransform._localMatMdf=this.finalTransform._matMdf),this.finalTransform._opMdf&&(this.finalTransform.localOpacity=this.finalTransform.mProp.o.v)},renderLocalTransform:function(){if(this.localTransforms){var _=0,C=this.localTransforms.length;if(this.finalTransform._localMatMdf=this.finalTransform._matMdf,!this.finalTransform._localMatMdf||!this.finalTransform._opMdf)for(;_<C;)this.localTransforms[_]._mdf&&(this.finalTransform._localMatMdf=!0),this.localTransforms[_]._opMdf&&!this.finalTransform._opMdf&&(this.finalTransform.localOpacity=this.finalTransform.mProp.o.v,this.finalTransform._opMdf=!0),_+=1;if(this.finalTransform._localMatMdf){var A=this.finalTransform.localMat;for(this.localTransforms[0].matrix.clone(A),_=1;_<C;_+=1){var T=this.localTransforms[_].matrix;A.multiply(T)}A.multiply(this.finalTransform.mat)}if(this.finalTransform._opMdf){var E=this.finalTransform.localOpacity;for(_=0;_<C;_+=1)E*=this.localTransforms[_].opacity*.01;this.finalTransform.localOpacity=E}}},searchEffectTransforms:function(){if(this.renderableEffectsManager){var _=this.renderableEffectsManager.getEffects(effectTypes.TRANSFORM_EFFECT);if(_.length){this.localTransforms=[],this.finalTransform.localMat=new Matrix;var C=0,A=_.length;for(C=0;C<A;C+=1)this.localTransforms.push(_[C])}}},globalToLocal:function(_){var C=[];C.push(this.finalTransform);for(var A=!0,T=this.comp;A;)T.finalTransform?(T.data.hasMask&&C.splice(0,0,T.finalTransform),T=T.comp):A=!1;var E,I=C.length,F;for(E=0;E<I;E+=1)F=C[E].mat.applyToPointArray(0,0,0),_=[_[0]-F[0],_[1]-F[1],0];return _},mHelper:new Matrix};function MaskElement(P,_,C){this.data=P,this.element=_,this.globalData=C,this.storedData=[],this.masksProperties=this.data.masksProperties||[],this.maskElement=null;var A=this.globalData.defs,T,E=this.masksProperties?this.masksProperties.length:0;this.viewData=createSizedArray(E),this.solidPath="";var I,F=this.masksProperties,B=0,G=[],R,z,D=createElementID(),L,O,V,U,W="clipPath",X="clip-path";for(T=0;T<E;T+=1)if((F[T].mode!=="a"&&F[T].mode!=="n"||F[T].inv||F[T].o.k!==100||F[T].o.x)&&(W="mask",X="mask"),(F[T].mode==="s"||F[T].mode==="i")&&B===0?(L=createNS("rect"),L.setAttribute("fill","#ffffff"),L.setAttribute("width",this.element.comp.data.w||0),L.setAttribute("height",this.element.comp.data.h||0),G.push(L)):L=null,I=createNS("path"),F[T].mode==="n")this.viewData[T]={op:PropertyFactory.getProp(this.element,F[T].o,0,.01,this.element),prop:ShapePropertyFactory.getShapeProp(this.element,F[T],3),elem:I,lastPath:""},A.appendChild(I);else{B+=1,I.setAttribute("fill",F[T].mode==="s"?"#000000":"#ffffff"),I.setAttribute("clip-rule","nonzero");var Y;if(F[T].x.k!==0?(W="mask",X="mask",U=PropertyFactory.getProp(this.element,F[T].x,0,null,this.element),Y=createElementID(),O=createNS("filter"),O.setAttribute("id",Y),V=createNS("feMorphology"),V.setAttribute("operator","erode"),V.setAttribute("in","SourceGraphic"),V.setAttribute("radius","0"),O.appendChild(V),A.appendChild(O),I.setAttribute("stroke",F[T].mode==="s"?"#000000":"#ffffff")):(V=null,U=null),this.storedData[T]={elem:I,x:U,expan:V,lastPath:"",lastOperator:"",filterId:Y,lastRadius:0},F[T].mode==="i"){z=G.length;var K=createNS("g");for(R=0;R<z;R+=1)K.appendChild(G[R]);var q=createNS("mask");q.setAttribute("mask-type","alpha"),q.setAttribute("id",D+"_"+B),q.appendChild(I),A.appendChild(q),K.setAttribute("mask","url("+getLocationHref()+"#"+D+"_"+B+")"),G.length=0,G.push(K)}else G.push(I);F[T].inv&&!this.solidPath&&(this.solidPath=this.createLayerSolidPath()),this.viewData[T]={elem:I,lastPath:"",op:PropertyFactory.getProp(this.element,F[T].o,0,.01,this.element),prop:ShapePropertyFactory.getShapeProp(this.element,F[T],3),invRect:L},this.viewData[T].prop.k||this.drawPath(F[T],this.viewData[T].prop.v,this.viewData[T])}for(this.maskElement=createNS(W),E=G.length,T=0;T<E;T+=1)this.maskElement.appendChild(G[T]);B>0&&(this.maskElement.setAttribute("id",D),this.element.maskedElement.setAttribute(X,"url("+getLocationHref()+"#"+D+")"),A.appendChild(this.maskElement)),this.viewData.length&&this.element.addRenderableComponent(this)}MaskElement.prototype.getMaskProperty=function(P){return this.viewData[P].prop},MaskElement.prototype.renderFrame=function(P){var _=this.element.finalTransform.mat,C,A=this.masksProperties.length;for(C=0;C<A;C+=1)if((this.viewData[C].prop._mdf||P)&&this.drawPath(this.masksProperties[C],this.viewData[C].prop.v,this.viewData[C]),(this.viewData[C].op._mdf||P)&&this.viewData[C].elem.setAttribute("fill-opacity",this.viewData[C].op.v),this.masksProperties[C].mode!=="n"&&(this.viewData[C].invRect&&(this.element.finalTransform.mProp._mdf||P)&&this.viewData[C].invRect.setAttribute("transform",_.getInverseMatrix().to2dCSS()),this.storedData[C].x&&(this.storedData[C].x._mdf||P))){var T=this.storedData[C].expan;this.storedData[C].x.v<0?(this.storedData[C].lastOperator!=="erode"&&(this.storedData[C].lastOperator="erode",this.storedData[C].elem.setAttribute("filter","url("+getLocationHref()+"#"+this.storedData[C].filterId+")")),T.setAttribute("radius",-this.storedData[C].x.v)):(this.storedData[C].lastOperator!=="dilate"&&(this.storedData[C].lastOperator="dilate",this.storedData[C].elem.setAttribute("filter",null)),this.storedData[C].elem.setAttribute("stroke-width",this.storedData[C].x.v*2))}},MaskElement.prototype.getMaskelement=function(){return this.maskElement},MaskElement.prototype.createLayerSolidPath=function(){var P="M0,0 ";return P+=" h"+this.globalData.compSize.w,P+=" v"+this.globalData.compSize.h,P+=" h-"+this.globalData.compSize.w,P+=" v-"+this.globalData.compSize.h+" ",P},MaskElement.prototype.drawPath=function(P,_,C){var A=" M"+_.v[0][0]+","+_.v[0][1],T,E;for(E=_._length,T=1;T<E;T+=1)A+=" C"+_.o[T-1][0]+","+_.o[T-1][1]+" "+_.i[T][0]+","+_.i[T][1]+" "+_.v[T][0]+","+_.v[T][1];if(_.c&&E>1&&(A+=" C"+_.o[T-1][0]+","+_.o[T-1][1]+" "+_.i[0][0]+","+_.i[0][1]+" "+_.v[0][0]+","+_.v[0][1]),C.lastPath!==A){var I="";C.elem&&(_.c&&(I=P.inv?this.solidPath+A:A),C.elem.setAttribute("d",I)),C.lastPath=A}},MaskElement.prototype.destroy=function(){this.element=null,this.globalData=null,this.maskElement=null,this.data=null,this.masksProperties=null};var filtersFactory=function(){var P={};P.createFilter=_,P.createAlphaToLuminanceFilter=C;function _(A,T){var E=createNS("filter");return E.setAttribute("id",A),T!==!0&&(E.setAttribute("filterUnits","objectBoundingBox"),E.setAttribute("x","0%"),E.setAttribute("y","0%"),E.setAttribute("width","100%"),E.setAttribute("height","100%")),E}function C(){var A=createNS("feColorMatrix");return A.setAttribute("type","matrix"),A.setAttribute("color-interpolation-filters","sRGB"),A.setAttribute("values","0 0 0 1 0  0 0 0 1 0  0 0 0 1 0  0 0 0 1 1"),A}return P}(),featureSupport=function(){var P={maskType:!0,svgLumaHidden:!0,offscreenCanvas:typeof OffscreenCanvas<"u"};return(/MSIE 10/i.test(navigator.userAgent)||/MSIE 9/i.test(navigator.userAgent)||/rv:11.0/i.test(navigator.userAgent)||/Edge\/\d./i.test(navigator.userAgent))&&(P.maskType=!1),/firefox/i.test(navigator.userAgent)&&(P.svgLumaHidden=!1),P}(),registeredEffects$1={},idPrefix="filter_result_";function SVGEffects(P){var _,C="SourceGraphic",A=P.data.ef?P.data.ef.length:0,T=createElementID(),E=filtersFactory.createFilter(T,!0),I=0;this.filters=[];var F;for(_=0;_<A;_+=1){F=null;var B=P.data.ef[_].ty;if(registeredEffects$1[B]){var G=registeredEffects$1[B].effect;F=new G(E,P.effectsManager.effectElements[_],P,idPrefix+I,C),C=idPrefix+I,registeredEffects$1[B].countsAsEffect&&(I+=1)}F&&this.filters.push(F)}I&&(P.globalData.defs.appendChild(E),P.layerElement.setAttribute("filter","url("+getLocationHref()+"#"+T+")")),this.filters.length&&P.addRenderableComponent(this)}SVGEffects.prototype.renderFrame=function(P){var _,C=this.filters.length;for(_=0;_<C;_+=1)this.filters[_].renderFrame(P)},SVGEffects.prototype.getEffects=function(P){var _,C=this.filters.length,A=[];for(_=0;_<C;_+=1)this.filters[_].type===P&&A.push(this.filters[_]);return A};function registerEffect$1(P,_,C){registeredEffects$1[P]={effect:_,countsAsEffect:C}}function SVGBaseElement(){}SVGBaseElement.prototype={initRendererElement:function(){this.layerElement=createNS("g")},createContainerElements:function(){this.matteElement=createNS("g"),this.transformedElement=this.layerElement,this.maskedElement=this.layerElement,this._sizeChanged=!1;var _=null;if(this.data.td){this.matteMasks={};var C=createNS("g");C.setAttribute("id",this.layerId),C.appendChild(this.layerElement),_=C,this.globalData.defs.appendChild(C)}else this.data.tt?(this.matteElement.appendChild(this.layerElement),_=this.matteElement,this.baseElement=this.matteElement):this.baseElement=this.layerElement;if(this.data.ln&&this.layerElement.setAttribute("id",this.data.ln),this.data.cl&&this.layerElement.setAttribute("class",this.data.cl),this.data.ty===0&&!this.data.hd){var A=createNS("clipPath"),T=createNS("path");T.setAttribute("d","M0,0 L"+this.data.w+",0 L"+this.data.w+","+this.data.h+" L0,"+this.data.h+"z");var E=createElementID();if(A.setAttribute("id",E),A.appendChild(T),this.globalData.defs.appendChild(A),this.checkMasks()){var I=createNS("g");I.setAttribute("clip-path","url("+getLocationHref()+"#"+E+")"),I.appendChild(this.layerElement),this.transformedElement=I,_?_.appendChild(this.transformedElement):this.baseElement=this.transformedElement}else this.layerElement.setAttribute("clip-path","url("+getLocationHref()+"#"+E+")")}this.data.bm!==0&&this.setBlendMode()},renderElement:function(){this.finalTransform._localMatMdf&&this.transformedElement.setAttribute("transform",this.finalTransform.localMat.to2dCSS()),this.finalTransform._opMdf&&this.transformedElement.setAttribute("opacity",this.finalTransform.localOpacity)},destroyBaseElement:function(){this.layerElement=null,this.matteElement=null,this.maskManager.destroy()},getBaseElement:function(){return this.data.hd?null:this.baseElement},createRenderableComponents:function(){this.maskManager=new MaskElement(this.data,this,this.globalData),this.renderableEffectsManager=new SVGEffects(this),this.searchEffectTransforms()},getMatte:function(_){if(this.matteMasks||(this.matteMasks={}),!this.matteMasks[_]){var C=this.layerId+"_"+_,A,T,E,I;if(_===1||_===3){var F=createNS("mask");F.setAttribute("id",C),F.setAttribute("mask-type",_===3?"luminance":"alpha"),E=createNS("use"),E.setAttributeNS("http://www.w3.org/1999/xlink","href","#"+this.layerId),F.appendChild(E),this.globalData.defs.appendChild(F),!featureSupport.maskType&&_===1&&(F.setAttribute("mask-type","luminance"),A=createElementID(),T=filtersFactory.createFilter(A),this.globalData.defs.appendChild(T),T.appendChild(filtersFactory.createAlphaToLuminanceFilter()),I=createNS("g"),I.appendChild(E),F.appendChild(I),I.setAttribute("filter","url("+getLocationHref()+"#"+A+")"))}else if(_===2){var B=createNS("mask");B.setAttribute("id",C),B.setAttribute("mask-type","alpha");var G=createNS("g");B.appendChild(G),A=createElementID(),T=filtersFactory.createFilter(A);var R=createNS("feComponentTransfer");R.setAttribute("in","SourceGraphic"),T.appendChild(R);var z=createNS("feFuncA");z.setAttribute("type","table"),z.setAttribute("tableValues","1.0 0.0"),R.appendChild(z),this.globalData.defs.appendChild(T);var D=createNS("rect");D.setAttribute("width",this.comp.data.w),D.setAttribute("height",this.comp.data.h),D.setAttribute("x","0"),D.setAttribute("y","0"),D.setAttribute("fill","#ffffff"),D.setAttribute("opacity","0"),G.setAttribute("filter","url("+getLocationHref()+"#"+A+")"),G.appendChild(D),E=createNS("use"),E.setAttributeNS("http://www.w3.org/1999/xlink","href","#"+this.layerId),G.appendChild(E),featureSupport.maskType||(B.setAttribute("mask-type","luminance"),T.appendChild(filtersFactory.createAlphaToLuminanceFilter()),I=createNS("g"),G.appendChild(D),I.appendChild(this.layerElement),G.appendChild(I)),this.globalData.defs.appendChild(B)}this.matteMasks[_]=C}return this.matteMasks[_]},setMatte:function(_){this.matteElement&&this.matteElement.setAttribute("mask","url("+getLocationHref()+"#"+_+")")}};function HierarchyElement(){}HierarchyElement.prototype={initHierarchy:function(){this.hierarchy=[],this._isParent=!1,this.checkParenting()},setHierarchy:function(_){this.hierarchy=_},setAsParent:function(){this._isParent=!0},checkParenting:function(){this.data.parent!==void 0&&this.comp.buildElementParenting(this,this.data.parent,[])}};function RenderableDOMElement(){}(function(){var P={initElement:function(C,A,T){this.initFrame(),this.initBaseData(C,A,T),this.initTransform(C,A,T),this.initHierarchy(),this.initRenderable(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),this.createContent(),this.hide()},hide:function(){if(!this.hidden&&(!this.isInRange||this.isTransparent)){var C=this.baseElement||this.layerElement;C.style.display="none",this.hidden=!0}},show:function(){if(this.isInRange&&!this.isTransparent){if(!this.data.hd){var C=this.baseElement||this.layerElement;C.style.display="block"}this.hidden=!1,this._isFirstFrame=!0}},renderFrame:function(){this.data.hd||this.hidden||(this.renderTransform(),this.renderRenderable(),this.renderLocalTransform(),this.renderElement(),this.renderInnerContent(),this._isFirstFrame&&(this._isFirstFrame=!1))},renderInnerContent:function(){},prepareFrame:function(C){this._mdf=!1,this.prepareRenderableFrame(C),this.prepareProperties(C,this.isInRange),this.checkTransparency()},destroy:function(){this.innerElem=null,this.destroyBaseElement()}};extendPrototype([RenderableElement,createProxyFunction(P)],RenderableDOMElement)})();function IImageElement(P,_,C){this.assetData=_.getAssetData(P.refId),this.assetData&&this.assetData.sid&&(this.assetData=_.slotManager.getProp(this.assetData)),this.initElement(P,_,C),this.sourceRect={top:0,left:0,width:this.assetData.w,height:this.assetData.h}}extendPrototype([BaseElement,TransformElement,SVGBaseElement,HierarchyElement,FrameElement,RenderableDOMElement],IImageElement),IImageElement.prototype.createContent=function(){var P=this.globalData.getAssetsPath(this.assetData);this.innerElem=createNS("image"),this.innerElem.setAttribute("width",this.assetData.w+"px"),this.innerElem.setAttribute("height",this.assetData.h+"px"),this.innerElem.setAttribute("preserveAspectRatio",this.assetData.pr||this.globalData.renderConfig.imagePreserveAspectRatio),this.innerElem.setAttributeNS("http://www.w3.org/1999/xlink","href",P),this.layerElement.appendChild(this.innerElem)},IImageElement.prototype.sourceRectAtTime=function(){return this.sourceRect};function ProcessedElement(P,_){this.elem=P,this.pos=_}function IShapeElement(){}IShapeElement.prototype={addShapeToModifiers:function(_){var C,A=this.shapeModifiers.length;for(C=0;C<A;C+=1)this.shapeModifiers[C].addShape(_)},isShapeInAnimatedModifiers:function(_){for(var C=0,A=this.shapeModifiers.length;C<A;)if(this.shapeModifiers[C].isAnimatedWithShape(_))return!0;return!1},renderModifiers:function(){if(this.shapeModifiers.length){var _,C=this.shapes.length;for(_=0;_<C;_+=1)this.shapes[_].sh.reset();C=this.shapeModifiers.length;var A;for(_=C-1;_>=0&&(A=this.shapeModifiers[_].processShapes(this._isFirstFrame),!A);_-=1);}},searchProcessedElement:function(_){for(var C=this.processedElements,A=0,T=C.length;A<T;){if(C[A].elem===_)return C[A].pos;A+=1}return 0},addProcessedElement:function(_,C){for(var A=this.processedElements,T=A.length;T;)if(T-=1,A[T].elem===_){A[T].pos=C;return}A.push(new ProcessedElement(_,C))},prepareFrame:function(_){this.prepareRenderableFrame(_),this.prepareProperties(_,this.isInRange)}};var lineCapEnum={1:"butt",2:"round",3:"square"},lineJoinEnum={1:"miter",2:"round",3:"bevel"};function SVGShapeData(P,_,C){this.caches=[],this.styles=[],this.transformers=P,this.lStr="",this.sh=C,this.lvl=_,this._isAnimated=!!C.k;for(var A=0,T=P.length;A<T;){if(P[A].mProps.dynamicProperties.length){this._isAnimated=!0;break}A+=1}}SVGShapeData.prototype.setAsAnimated=function(){this._isAnimated=!0};function SVGStyleData(P,_){this.data=P,this.type=P.ty,this.d="",this.lvl=_,this._mdf=!1,this.closed=P.hd===!0,this.pElem=createNS("path"),this.msElem=null}SVGStyleData.prototype.reset=function(){this.d="",this._mdf=!1};function DashProperty(P,_,C,A){this.elem=P,this.frameId=-1,this.dataProps=createSizedArray(_.length),this.renderer=C,this.k=!1,this.dashStr="",this.dashArray=createTypedArray("float32",_.length?_.length-1:0),this.dashoffset=createTypedArray("float32",1),this.initDynamicPropertyContainer(A);var T,E=_.length||0,I;for(T=0;T<E;T+=1)I=PropertyFactory.getProp(P,_[T].v,0,0,this),this.k=I.k||this.k,this.dataProps[T]={n:_[T].n,p:I};this.k||this.getValue(!0),this._isAnimated=this.k}DashProperty.prototype.getValue=function(P){if(!(this.elem.globalData.frameId===this.frameId&&!P)&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf=this._mdf||P,this._mdf)){var _=0,C=this.dataProps.length;for(this.renderer==="svg"&&(this.dashStr=""),_=0;_<C;_+=1)this.dataProps[_].n!=="o"?this.renderer==="svg"?this.dashStr+=" "+this.dataProps[_].p.v:this.dashArray[_]=this.dataProps[_].p.v:this.dashoffset[0]=this.dataProps[_].p.v}},extendPrototype([DynamicPropertyContainer],DashProperty);function SVGStrokeStyleData(P,_,C){this.initDynamicPropertyContainer(P),this.getValue=this.iterateDynamicProperties,this.o=PropertyFactory.getProp(P,_.o,0,.01,this),this.w=PropertyFactory.getProp(P,_.w,0,null,this),this.d=new DashProperty(P,_.d||{},"svg",this),this.c=PropertyFactory.getProp(P,_.c,1,255,this),this.style=C,this._isAnimated=!!this._isAnimated}extendPrototype([DynamicPropertyContainer],SVGStrokeStyleData);function SVGFillStyleData(P,_,C){this.initDynamicPropertyContainer(P),this.getValue=this.iterateDynamicProperties,this.o=PropertyFactory.getProp(P,_.o,0,.01,this),this.c=PropertyFactory.getProp(P,_.c,1,255,this),this.style=C}extendPrototype([DynamicPropertyContainer],SVGFillStyleData);function SVGNoStyleData(P,_,C){this.initDynamicPropertyContainer(P),this.getValue=this.iterateDynamicProperties,this.style=C}extendPrototype([DynamicPropertyContainer],SVGNoStyleData);function GradientProperty(P,_,C){this.data=_,this.c=createTypedArray("uint8c",_.p*4);var A=_.k.k[0].s?_.k.k[0].s.length-_.p*4:_.k.k.length-_.p*4;this.o=createTypedArray("float32",A),this._cmdf=!1,this._omdf=!1,this._collapsable=this.checkCollapsable(),this._hasOpacity=A,this.initDynamicPropertyContainer(C),this.prop=PropertyFactory.getProp(P,_.k,1,null,this),this.k=this.prop.k,this.getValue(!0)}GradientProperty.prototype.comparePoints=function(P,_){for(var C=0,A=this.o.length/2,T;C<A;){if(T=Math.abs(P[C*4]-P[_*4+C*2]),T>.01)return!1;C+=1}return!0},GradientProperty.prototype.checkCollapsable=function(){if(this.o.length/2!==this.c.length/4)return!1;if(this.data.k.k[0].s)for(var P=0,_=this.data.k.k.length;P<_;){if(!this.comparePoints(this.data.k.k[P].s,this.data.p))return!1;P+=1}else if(!this.comparePoints(this.data.k.k,this.data.p))return!1;return!0},GradientProperty.prototype.getValue=function(P){if(this.prop.getValue(),this._mdf=!1,this._cmdf=!1,this._omdf=!1,this.prop._mdf||P){var _,C=this.data.p*4,A,T;for(_=0;_<C;_+=1)A=_%4===0?100:255,T=Math.round(this.prop.v[_]*A),this.c[_]!==T&&(this.c[_]=T,this._cmdf=!P);if(this.o.length)for(C=this.prop.v.length,_=this.data.p*4;_<C;_+=1)A=_%2===0?100:1,T=_%2===0?Math.round(this.prop.v[_]*100):this.prop.v[_],this.o[_-this.data.p*4]!==T&&(this.o[_-this.data.p*4]=T,this._omdf=!P);this._mdf=!P}},extendPrototype([DynamicPropertyContainer],GradientProperty);function SVGGradientFillStyleData(P,_,C){this.initDynamicPropertyContainer(P),this.getValue=this.iterateDynamicProperties,this.initGradientData(P,_,C)}SVGGradientFillStyleData.prototype.initGradientData=function(P,_,C){this.o=PropertyFactory.getProp(P,_.o,0,.01,this),this.s=PropertyFactory.getProp(P,_.s,1,null,this),this.e=PropertyFactory.getProp(P,_.e,1,null,this),this.h=PropertyFactory.getProp(P,_.h||{k:0},0,.01,this),this.a=PropertyFactory.getProp(P,_.a||{k:0},0,degToRads,this),this.g=new GradientProperty(P,_.g,this),this.style=C,this.stops=[],this.setGradientData(C.pElem,_),this.setGradientOpacity(_,C),this._isAnimated=!!this._isAnimated},SVGGradientFillStyleData.prototype.setGradientData=function(P,_){var C=createElementID(),A=createNS(_.t===1?"linearGradient":"radialGradient");A.setAttribute("id",C),A.setAttribute("spreadMethod","pad"),A.setAttribute("gradientUnits","userSpaceOnUse");var T=[],E,I,F;for(F=_.g.p*4,I=0;I<F;I+=4)E=createNS("stop"),A.appendChild(E),T.push(E);P.setAttribute(_.ty==="gf"?"fill":"stroke","url("+getLocationHref()+"#"+C+")"),this.gf=A,this.cst=T},SVGGradientFillStyleData.prototype.setGradientOpacity=function(P,_){if(this.g._hasOpacity&&!this.g._collapsable){var C,A,T,E=createNS("mask"),I=createNS("path");E.appendChild(I);var F=createElementID(),B=createElementID();E.setAttribute("id",B);var G=createNS(P.t===1?"linearGradient":"radialGradient");G.setAttribute("id",F),G.setAttribute("spreadMethod","pad"),G.setAttribute("gradientUnits","userSpaceOnUse"),T=P.g.k.k[0].s?P.g.k.k[0].s.length:P.g.k.k.length;var R=this.stops;for(A=P.g.p*4;A<T;A+=2)C=createNS("stop"),C.setAttribute("stop-color","rgb(255,255,255)"),G.appendChild(C),R.push(C);I.setAttribute(P.ty==="gf"?"fill":"stroke","url("+getLocationHref()+"#"+F+")"),P.ty==="gs"&&(I.setAttribute("stroke-linecap",lineCapEnum[P.lc||2]),I.setAttribute("stroke-linejoin",lineJoinEnum[P.lj||2]),P.lj===1&&I.setAttribute("stroke-miterlimit",P.ml)),this.of=G,this.ms=E,this.ost=R,this.maskId=B,_.msElem=I}},extendPrototype([DynamicPropertyContainer],SVGGradientFillStyleData);function SVGGradientStrokeStyleData(P,_,C){this.initDynamicPropertyContainer(P),this.getValue=this.iterateDynamicProperties,this.w=PropertyFactory.getProp(P,_.w,0,null,this),this.d=new DashProperty(P,_.d||{},"svg",this),this.initGradientData(P,_,C),this._isAnimated=!!this._isAnimated}extendPrototype([SVGGradientFillStyleData,DynamicPropertyContainer],SVGGradientStrokeStyleData);function ShapeGroupData(){this.it=[],this.prevViewData=[],this.gr=createNS("g")}function SVGTransformData(P,_,C){this.transform={mProps:P,op:_,container:C},this.elements=[],this._isAnimated=this.transform.mProps.dynamicProperties.length||this.transform.op.effectsSequence.length}var buildShapeString=function(_,C,A,T){if(C===0)return"";var E=_.o,I=_.i,F=_.v,B,G=" M"+T.applyToPointStringified(F[0][0],F[0][1]);for(B=1;B<C;B+=1)G+=" C"+T.applyToPointStringified(E[B-1][0],E[B-1][1])+" "+T.applyToPointStringified(I[B][0],I[B][1])+" "+T.applyToPointStringified(F[B][0],F[B][1]);return A&&C&&(G+=" C"+T.applyToPointStringified(E[B-1][0],E[B-1][1])+" "+T.applyToPointStringified(I[0][0],I[0][1])+" "+T.applyToPointStringified(F[0][0],F[0][1]),G+="z"),G},SVGElementsRenderer=function(){var P=new Matrix,_=new Matrix,C={createRenderFunction:A};function A(z){switch(z.ty){case"fl":return F;case"gf":return G;case"gs":return B;case"st":return R;case"sh":case"el":case"rc":case"sr":return I;case"tr":return T;case"no":return E;default:return null}}function T(z,D,L){(L||D.transform.op._mdf)&&D.transform.container.setAttribute("opacity",D.transform.op.v),(L||D.transform.mProps._mdf)&&D.transform.container.setAttribute("transform",D.transform.mProps.v.to2dCSS())}function E(){}function I(z,D,L){var O,V,U,W,X,Y,K=D.styles.length,q=D.lvl,J,tt,rt,st;for(Y=0;Y<K;Y+=1){if(W=D.sh._mdf||L,D.styles[Y].lvl<q){for(tt=_.reset(),rt=q-D.styles[Y].lvl,st=D.transformers.length-1;!W&&rt>0;)W=D.transformers[st].mProps._mdf||W,rt-=1,st-=1;if(W)for(rt=q-D.styles[Y].lvl,st=D.transformers.length-1;rt>0;)tt.multiply(D.transformers[st].mProps.v),rt-=1,st-=1}else tt=P;if(J=D.sh.paths,V=J._length,W){for(U="",O=0;O<V;O+=1)X=J.shapes[O],X&&X._length&&(U+=buildShapeString(X,X._length,X.c,tt));D.caches[Y]=U}else U=D.caches[Y];D.styles[Y].d+=z.hd===!0?"":U,D.styles[Y]._mdf=W||D.styles[Y]._mdf}}function F(z,D,L){var O=D.style;(D.c._mdf||L)&&O.pElem.setAttribute("fill","rgb("+bmFloor(D.c.v[0])+","+bmFloor(D.c.v[1])+","+bmFloor(D.c.v[2])+")"),(D.o._mdf||L)&&O.pElem.setAttribute("fill-opacity",D.o.v)}function B(z,D,L){G(z,D,L),R(z,D,L)}function G(z,D,L){var O=D.gf,V=D.g._hasOpacity,U=D.s.v,W=D.e.v;if(D.o._mdf||L){var X=z.ty==="gf"?"fill-opacity":"stroke-opacity";D.style.pElem.setAttribute(X,D.o.v)}if(D.s._mdf||L){var Y=z.t===1?"x1":"cx",K=Y==="x1"?"y1":"cy";O.setAttribute(Y,U[0]),O.setAttribute(K,U[1]),V&&!D.g._collapsable&&(D.of.setAttribute(Y,U[0]),D.of.setAttribute(K,U[1]))}var q,J,tt,rt;if(D.g._cmdf||L){q=D.cst;var st=D.g.c;for(tt=q.length,J=0;J<tt;J+=1)rt=q[J],rt.setAttribute("offset",st[J*4]+"%"),rt.setAttribute("stop-color","rgb("+st[J*4+1]+","+st[J*4+2]+","+st[J*4+3]+")")}if(V&&(D.g._omdf||L)){var nt=D.g.o;for(D.g._collapsable?q=D.cst:q=D.ost,tt=q.length,J=0;J<tt;J+=1)rt=q[J],D.g._collapsable||rt.setAttribute("offset",nt[J*2]+"%"),rt.setAttribute("stop-opacity",nt[J*2+1])}if(z.t===1)(D.e._mdf||L)&&(O.setAttribute("x2",W[0]),O.setAttribute("y2",W[1]),V&&!D.g._collapsable&&(D.of.setAttribute("x2",W[0]),D.of.setAttribute("y2",W[1])));else{var at;if((D.s._mdf||D.e._mdf||L)&&(at=Math.sqrt(Math.pow(U[0]-W[0],2)+Math.pow(U[1]-W[1],2)),O.setAttribute("r",at),V&&!D.g._collapsable&&D.of.setAttribute("r",at)),D.e._mdf||D.h._mdf||D.a._mdf||L){at||(at=Math.sqrt(Math.pow(U[0]-W[0],2)+Math.pow(U[1]-W[1],2)));var ot=Math.atan2(W[1]-U[1],W[0]-U[0]),ct=D.h.v;ct>=1?ct=.99:ct<=-1&&(ct=-.99);var dt=at*ct,ut=Math.cos(ot+D.a.v)*dt+U[0],Q=Math.sin(ot+D.a.v)*dt+U[1];O.setAttribute("fx",ut),O.setAttribute("fy",Q),V&&!D.g._collapsable&&(D.of.setAttribute("fx",ut),D.of.setAttribute("fy",Q))}}}function R(z,D,L){var O=D.style,V=D.d;V&&(V._mdf||L)&&V.dashStr&&(O.pElem.setAttribute("stroke-dasharray",V.dashStr),O.pElem.setAttribute("stroke-dashoffset",V.dashoffset[0])),D.c&&(D.c._mdf||L)&&O.pElem.setAttribute("stroke","rgb("+bmFloor(D.c.v[0])+","+bmFloor(D.c.v[1])+","+bmFloor(D.c.v[2])+")"),(D.o._mdf||L)&&O.pElem.setAttribute("stroke-opacity",D.o.v),(D.w._mdf||L)&&(O.pElem.setAttribute("stroke-width",D.w.v),O.msElem&&O.msElem.setAttribute("stroke-width",D.w.v))}return C}();function SVGShapeElement(P,_,C){this.shapes=[],this.shapesData=P.shapes,this.stylesList=[],this.shapeModifiers=[],this.itemsData=[],this.processedElements=[],this.animatedContents=[],this.initElement(P,_,C),this.prevViewData=[]}extendPrototype([BaseElement,TransformElement,SVGBaseElement,IShapeElement,HierarchyElement,FrameElement,RenderableDOMElement],SVGShapeElement),SVGShapeElement.prototype.initSecondaryElement=function(){},SVGShapeElement.prototype.identityMatrix=new Matrix,SVGShapeElement.prototype.buildExpressionInterface=function(){},SVGShapeElement.prototype.createContent=function(){this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.layerElement,0,[],!0),this.filterUniqueShapes()},SVGShapeElement.prototype.filterUniqueShapes=function(){var P,_=this.shapes.length,C,A,T=this.stylesList.length,E,I=[],F=!1;for(A=0;A<T;A+=1){for(E=this.stylesList[A],F=!1,I.length=0,P=0;P<_;P+=1)C=this.shapes[P],C.styles.indexOf(E)!==-1&&(I.push(C),F=C._isAnimated||F);I.length>1&&F&&this.setShapesAsAnimated(I)}},SVGShapeElement.prototype.setShapesAsAnimated=function(P){var _,C=P.length;for(_=0;_<C;_+=1)P[_].setAsAnimated()},SVGShapeElement.prototype.createStyleElement=function(P,_){var C,A=new SVGStyleData(P,_),T=A.pElem;if(P.ty==="st")C=new SVGStrokeStyleData(this,P,A);else if(P.ty==="fl")C=new SVGFillStyleData(this,P,A);else if(P.ty==="gf"||P.ty==="gs"){var E=P.ty==="gf"?SVGGradientFillStyleData:SVGGradientStrokeStyleData;C=new E(this,P,A),this.globalData.defs.appendChild(C.gf),C.maskId&&(this.globalData.defs.appendChild(C.ms),this.globalData.defs.appendChild(C.of),T.setAttribute("mask","url("+getLocationHref()+"#"+C.maskId+")"))}else P.ty==="no"&&(C=new SVGNoStyleData(this,P,A));return(P.ty==="st"||P.ty==="gs")&&(T.setAttribute("stroke-linecap",lineCapEnum[P.lc||2]),T.setAttribute("stroke-linejoin",lineJoinEnum[P.lj||2]),T.setAttribute("fill-opacity","0"),P.lj===1&&T.setAttribute("stroke-miterlimit",P.ml)),P.r===2&&T.setAttribute("fill-rule","evenodd"),P.ln&&T.setAttribute("id",P.ln),P.cl&&T.setAttribute("class",P.cl),P.bm&&(T.style["mix-blend-mode"]=getBlendMode(P.bm)),this.stylesList.push(A),this.addToAnimatedContents(P,C),C},SVGShapeElement.prototype.createGroupElement=function(P){var _=new ShapeGroupData;return P.ln&&_.gr.setAttribute("id",P.ln),P.cl&&_.gr.setAttribute("class",P.cl),P.bm&&(_.gr.style["mix-blend-mode"]=getBlendMode(P.bm)),_},SVGShapeElement.prototype.createTransformElement=function(P,_){var C=TransformPropertyFactory.getTransformProperty(this,P,this),A=new SVGTransformData(C,C.o,_);return this.addToAnimatedContents(P,A),A},SVGShapeElement.prototype.createShapeElement=function(P,_,C){var A=4;P.ty==="rc"?A=5:P.ty==="el"?A=6:P.ty==="sr"&&(A=7);var T=ShapePropertyFactory.getShapeProp(this,P,A,this),E=new SVGShapeData(_,C,T);return this.shapes.push(E),this.addShapeToModifiers(E),this.addToAnimatedContents(P,E),E},SVGShapeElement.prototype.addToAnimatedContents=function(P,_){for(var C=0,A=this.animatedContents.length;C<A;){if(this.animatedContents[C].element===_)return;C+=1}this.animatedContents.push({fn:SVGElementsRenderer.createRenderFunction(P),element:_,data:P})},SVGShapeElement.prototype.setElementStyles=function(P){var _=P.styles,C,A=this.stylesList.length;for(C=0;C<A;C+=1)this.stylesList[C].closed||_.push(this.stylesList[C])},SVGShapeElement.prototype.reloadShapes=function(){this._isFirstFrame=!0;var P,_=this.itemsData.length;for(P=0;P<_;P+=1)this.prevViewData[P]=this.itemsData[P];for(this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.layerElement,0,[],!0),this.filterUniqueShapes(),_=this.dynamicProperties.length,P=0;P<_;P+=1)this.dynamicProperties[P].getValue();this.renderModifiers()},SVGShapeElement.prototype.searchShapes=function(P,_,C,A,T,E,I){var F=[].concat(E),B,G=P.length-1,R,z,D=[],L=[],O,V,U;for(B=G;B>=0;B-=1){if(U=this.searchProcessedElement(P[B]),U?_[B]=C[U-1]:P[B]._render=I,P[B].ty==="fl"||P[B].ty==="st"||P[B].ty==="gf"||P[B].ty==="gs"||P[B].ty==="no")U?_[B].style.closed=!1:_[B]=this.createStyleElement(P[B],T),P[B]._render&&_[B].style.pElem.parentNode!==A&&A.appendChild(_[B].style.pElem),D.push(_[B].style);else if(P[B].ty==="gr"){if(!U)_[B]=this.createGroupElement(P[B]);else for(z=_[B].it.length,R=0;R<z;R+=1)_[B].prevViewData[R]=_[B].it[R];this.searchShapes(P[B].it,_[B].it,_[B].prevViewData,_[B].gr,T+1,F,I),P[B]._render&&_[B].gr.parentNode!==A&&A.appendChild(_[B].gr)}else P[B].ty==="tr"?(U||(_[B]=this.createTransformElement(P[B],A)),O=_[B].transform,F.push(O)):P[B].ty==="sh"||P[B].ty==="rc"||P[B].ty==="el"||P[B].ty==="sr"?(U||(_[B]=this.createShapeElement(P[B],F,T)),this.setElementStyles(_[B])):P[B].ty==="tm"||P[B].ty==="rd"||P[B].ty==="ms"||P[B].ty==="pb"||P[B].ty==="zz"||P[B].ty==="op"?(U?(V=_[B],V.closed=!1):(V=ShapeModifiers.getModifier(P[B].ty),V.init(this,P[B]),_[B]=V,this.shapeModifiers.push(V)),L.push(V)):P[B].ty==="rp"&&(U?(V=_[B],V.closed=!0):(V=ShapeModifiers.getModifier(P[B].ty),_[B]=V,V.init(this,P,B,_),this.shapeModifiers.push(V),I=!1),L.push(V));this.addProcessedElement(P[B],B+1)}for(G=D.length,B=0;B<G;B+=1)D[B].closed=!0;for(G=L.length,B=0;B<G;B+=1)L[B].closed=!0},SVGShapeElement.prototype.renderInnerContent=function(){this.renderModifiers();var P,_=this.stylesList.length;for(P=0;P<_;P+=1)this.stylesList[P].reset();for(this.renderShape(),P=0;P<_;P+=1)(this.stylesList[P]._mdf||this._isFirstFrame)&&(this.stylesList[P].msElem&&(this.stylesList[P].msElem.setAttribute("d",this.stylesList[P].d),this.stylesList[P].d="M0 0"+this.stylesList[P].d),this.stylesList[P].pElem.setAttribute("d",this.stylesList[P].d||"M0 0"))},SVGShapeElement.prototype.renderShape=function(){var P,_=this.animatedContents.length,C;for(P=0;P<_;P+=1)C=this.animatedContents[P],(this._isFirstFrame||C.element._isAnimated)&&C.data!==!0&&C.fn(C.data,C.element,this._isFirstFrame)},SVGShapeElement.prototype.destroy=function(){this.destroyBaseElement(),this.shapesData=null,this.itemsData=null};function LetterProps(P,_,C,A,T,E){this.o=P,this.sw=_,this.sc=C,this.fc=A,this.m=T,this.p=E,this._mdf={o:!0,sw:!!_,sc:!!C,fc:!!A,m:!0,p:!0}}LetterProps.prototype.update=function(P,_,C,A,T,E){this._mdf.o=!1,this._mdf.sw=!1,this._mdf.sc=!1,this._mdf.fc=!1,this._mdf.m=!1,this._mdf.p=!1;var I=!1;return this.o!==P&&(this.o=P,this._mdf.o=!0,I=!0),this.sw!==_&&(this.sw=_,this._mdf.sw=!0,I=!0),this.sc!==C&&(this.sc=C,this._mdf.sc=!0,I=!0),this.fc!==A&&(this.fc=A,this._mdf.fc=!0,I=!0),this.m!==T&&(this.m=T,this._mdf.m=!0,I=!0),E.length&&(this.p[0]!==E[0]||this.p[1]!==E[1]||this.p[4]!==E[4]||this.p[5]!==E[5]||this.p[12]!==E[12]||this.p[13]!==E[13])&&(this.p=E,this._mdf.p=!0,I=!0),I};function TextProperty(P,_){this._frameId=initialDefaultFrame,this.pv="",this.v="",this.kf=!1,this._isFirstFrame=!0,this._mdf=!1,_.d&&_.d.sid&&(_.d=P.globalData.slotManager.getProp(_.d)),this.data=_,this.elem=P,this.comp=this.elem.comp,this.keysIndex=0,this.canResize=!1,this.minimumFontSize=1,this.effectsSequence=[],this.currentData={ascent:0,boxWidth:this.defaultBoxWidth,f:"",fStyle:"",fWeight:"",fc:"",j:"",justifyOffset:"",l:[],lh:0,lineWidths:[],ls:"",of:"",s:"",sc:"",sw:0,t:0,tr:0,sz:0,ps:null,fillColorAnim:!1,strokeColorAnim:!1,strokeWidthAnim:!1,yOffset:0,finalSize:0,finalText:[],finalLineHeight:0,__complete:!1},this.copyData(this.currentData,this.data.d.k[0].s),this.searchProperty()||this.completeTextData(this.currentData)}TextProperty.prototype.defaultBoxWidth=[0,0],TextProperty.prototype.copyData=function(P,_){for(var C in _)Object.prototype.hasOwnProperty.call(_,C)&&(P[C]=_[C]);return P},TextProperty.prototype.setCurrentData=function(P){P.__complete||this.completeTextData(P),this.currentData=P,this.currentData.boxWidth=this.currentData.boxWidth||this.defaultBoxWidth,this._mdf=!0},TextProperty.prototype.searchProperty=function(){return this.searchKeyframes()},TextProperty.prototype.searchKeyframes=function(){return this.kf=this.data.d.k.length>1,this.kf&&this.addEffect(this.getKeyframeValue.bind(this)),this.kf},TextProperty.prototype.addEffect=function(P){this.effectsSequence.push(P),this.elem.addDynamicProperty(this)},TextProperty.prototype.getValue=function(P){if(!((this.elem.globalData.frameId===this.frameId||!this.effectsSequence.length)&&!P)){this.currentData.t=this.data.d.k[this.keysIndex].s.t;var _=this.currentData,C=this.keysIndex;if(this.lock){this.setCurrentData(this.currentData);return}this.lock=!0,this._mdf=!1;var A,T=this.effectsSequence.length,E=P||this.data.d.k[this.keysIndex].s;for(A=0;A<T;A+=1)C!==this.keysIndex?E=this.effectsSequence[A](E,E.t):E=this.effectsSequence[A](this.currentData,E.t);_!==E&&this.setCurrentData(E),this.v=this.currentData,this.pv=this.v,this.lock=!1,this.frameId=this.elem.globalData.frameId}},TextProperty.prototype.getKeyframeValue=function(){for(var P=this.data.d.k,_=this.elem.comp.renderedFrame,C=0,A=P.length;C<=A-1&&!(C===A-1||P[C+1].t>_);)C+=1;return this.keysIndex!==C&&(this.keysIndex=C),this.data.d.k[this.keysIndex].s},TextProperty.prototype.buildFinalText=function(P){for(var _=[],C=0,A=P.length,T,E,I=!1,F=!1,B="";C<A;)I=F,F=!1,T=P.charCodeAt(C),B=P.charAt(C),FontManager.isCombinedCharacter(T)?I=!0:T>=55296&&T<=56319?FontManager.isRegionalFlag(P,C)?B=P.substr(C,14):(E=P.charCodeAt(C+1),E>=56320&&E<=57343&&(FontManager.isModifier(T,E)?(B=P.substr(C,2),I=!0):FontManager.isFlagEmoji(P.substr(C,4))?B=P.substr(C,4):B=P.substr(C,2))):T>56319?(E=P.charCodeAt(C+1),FontManager.isVariationSelector(T)&&(I=!0)):FontManager.isZeroWidthJoiner(T)&&(I=!0,F=!0),I?(_[_.length-1]+=B,I=!1):_.push(B),C+=B.length;return _},TextProperty.prototype.completeTextData=function(P){P.__complete=!0;var _=this.elem.globalData.fontManager,C=this.data,A=[],T,E,I,F=0,B,G=C.m.g,R=0,z=0,D=0,L=[],O=0,V=0,U,W,X=_.getFontByName(P.f),Y,K=0,q=getFontProperties(X);P.fWeight=q.weight,P.fStyle=q.style,P.finalSize=P.s,P.finalText=this.buildFinalText(P.t),E=P.finalText.length,P.finalLineHeight=P.lh;var J=P.tr/1e3*P.finalSize,tt;if(P.sz)for(var rt=!0,st=P.sz[0],nt=P.sz[1],at,ot;rt;){ot=this.buildFinalText(P.t),at=0,O=0,E=ot.length,J=P.tr/1e3*P.finalSize;var ct=-1;for(T=0;T<E;T+=1)tt=ot[T].charCodeAt(0),I=!1,ot[T]===" "?ct=T:(tt===13||tt===3)&&(O=0,I=!0,at+=P.finalLineHeight||P.finalSize*1.2),_.chars?(Y=_.getCharData(ot[T],X.fStyle,X.fFamily),K=I?0:Y.w*P.finalSize/100):K=_.measureText(ot[T],P.f,P.finalSize),O+K>st&&ot[T]!==" "?(ct===-1?E+=1:T=ct,at+=P.finalLineHeight||P.finalSize*1.2,ot.splice(T,ct===T?1:0,"\r"),ct=-1,O=0):(O+=K,O+=J);at+=X.ascent*P.finalSize/100,this.canResize&&P.finalSize>this.minimumFontSize&&nt<at?(P.finalSize-=1,P.finalLineHeight=P.finalSize*P.lh/P.s):(P.finalText=ot,E=P.finalText.length,rt=!1)}O=-J,K=0;var dt=0,ut;for(T=0;T<E;T+=1)if(I=!1,ut=P.finalText[T],tt=ut.charCodeAt(0),tt===13||tt===3?(dt=0,L.push(O),V=O>V?O:V,O=-2*J,B="",I=!0,D+=1):B=ut,_.chars?(Y=_.getCharData(ut,X.fStyle,_.getFontByName(P.f).fFamily),K=I?0:Y.w*P.finalSize/100):K=_.measureText(B,P.f,P.finalSize),ut===" "?dt+=K+J:(O+=K+J+dt,dt=0),A.push({l:K,an:K,add:R,n:I,anIndexes:[],val:B,line:D,animatorJustifyOffset:0}),G==2){if(R+=K,B===""||B===" "||T===E-1){for((B===""||B===" ")&&(R-=K);z<=T;)A[z].an=R,A[z].ind=F,A[z].extra=K,z+=1;F+=1,R=0}}else if(G==3){if(R+=K,B===""||T===E-1){for(B===""&&(R-=K);z<=T;)A[z].an=R,A[z].ind=F,A[z].extra=K,z+=1;R=0,F+=1}}else A[F].ind=F,A[F].extra=0,F+=1;if(P.l=A,V=O>V?O:V,L.push(O),P.sz)P.boxWidth=P.sz[0],P.justifyOffset=0;else switch(P.boxWidth=V,P.j){case 1:P.justifyOffset=-P.boxWidth;break;case 2:P.justifyOffset=-P.boxWidth/2;break;default:P.justifyOffset=0}P.lineWidths=L;var Q=C.a,it,Z;W=Q.length;var et,ht,lt=[];for(U=0;U<W;U+=1){for(it=Q[U],it.a.sc&&(P.strokeColorAnim=!0),it.a.sw&&(P.strokeWidthAnim=!0),(it.a.fc||it.a.fh||it.a.fs||it.a.fb)&&(P.fillColorAnim=!0),ht=0,et=it.s.b,T=0;T<E;T+=1)Z=A[T],Z.anIndexes[U]=ht,(et==1&&Z.val!==""||et==2&&Z.val!==""&&Z.val!==" "||et==3&&(Z.n||Z.val==" "||T==E-1)||et==4&&(Z.n||T==E-1))&&(it.s.rn===1&&lt.push(ht),ht+=1);C.a[U].s.totalChars=ht;var ft=-1,pt;if(it.s.rn===1)for(T=0;T<E;T+=1)Z=A[T],ft!=Z.anIndexes[U]&&(ft=Z.anIndexes[U],pt=lt.splice(Math.floor(Math.random()*lt.length),1)[0]),Z.anIndexes[U]=pt}P.yOffset=P.finalLineHeight||P.finalSize*1.2,P.ls=P.ls||0,P.ascent=X.ascent*P.finalSize/100},TextProperty.prototype.updateDocumentData=function(P,_){_=_===void 0?this.keysIndex:_;var C=this.copyData({},this.data.d.k[_].s);C=this.copyData(C,P),this.data.d.k[_].s=C,this.recalculate(_),this.setCurrentData(C),this.elem.addDynamicProperty(this)},TextProperty.prototype.recalculate=function(P){var _=this.data.d.k[P].s;_.__complete=!1,this.keysIndex=0,this._isFirstFrame=!0,this.getValue(_)},TextProperty.prototype.canResizeFont=function(P){this.canResize=P,this.recalculate(this.keysIndex),this.elem.addDynamicProperty(this)},TextProperty.prototype.setMinimumFontSize=function(P){this.minimumFontSize=Math.floor(P)||1,this.recalculate(this.keysIndex),this.elem.addDynamicProperty(this)};var TextSelectorProp=function(){var P=Math.max,_=Math.min,C=Math.floor;function A(E,I){this._currentTextLength=-1,this.k=!1,this.data=I,this.elem=E,this.comp=E.comp,this.finalS=0,this.finalE=0,this.initDynamicPropertyContainer(E),this.s=PropertyFactory.getProp(E,I.s||{k:0},0,0,this),"e"in I?this.e=PropertyFactory.getProp(E,I.e,0,0,this):this.e={v:100},this.o=PropertyFactory.getProp(E,I.o||{k:0},0,0,this),this.xe=PropertyFactory.getProp(E,I.xe||{k:0},0,0,this),this.ne=PropertyFactory.getProp(E,I.ne||{k:0},0,0,this),this.sm=PropertyFactory.getProp(E,I.sm||{k:100},0,0,this),this.a=PropertyFactory.getProp(E,I.a,0,.01,this),this.dynamicProperties.length||this.getValue()}A.prototype={getMult:function(I){this._currentTextLength!==this.elem.textProperty.currentData.l.length&&this.getValue();var F=0,B=0,G=1,R=1;this.ne.v>0?F=this.ne.v/100:B=-this.ne.v/100,this.xe.v>0?G=1-this.xe.v/100:R=1+this.xe.v/100;var z=BezierFactory.getBezierEasing(F,B,G,R).get,D=0,L=this.finalS,O=this.finalE,V=this.data.sh;if(V===2)O===L?D=I>=O?1:0:D=P(0,_(.5/(O-L)+(I-L)/(O-L),1)),D=z(D);else if(V===3)O===L?D=I>=O?0:1:D=1-P(0,_(.5/(O-L)+(I-L)/(O-L),1)),D=z(D);else if(V===4)O===L?D=0:(D=P(0,_(.5/(O-L)+(I-L)/(O-L),1)),D<.5?D*=2:D=1-2*(D-.5)),D=z(D);else if(V===5){if(O===L)D=0;else{var U=O-L;I=_(P(0,I+.5-L),O-L);var W=-U/2+I,X=U/2;D=Math.sqrt(1-W*W/(X*X))}D=z(D)}else V===6?(O===L?D=0:(I=_(P(0,I+.5-L),O-L),D=(1+Math.cos(Math.PI+Math.PI*2*I/(O-L)))/2),D=z(D)):(I>=C(L)&&(I-L<0?D=P(0,_(_(O,1)-(L-I),1)):D=P(0,_(O-I,1))),D=z(D));if(this.sm.v!==100){var Y=this.sm.v*.01;Y===0&&(Y=1e-8);var K=.5-Y*.5;D<K?D=0:(D=(D-K)/Y,D>1&&(D=1))}return D*this.a.v},getValue:function(I){this.iterateDynamicProperties(),this._mdf=I||this._mdf,this._currentTextLength=this.elem.textProperty.currentData.l.length||0,I&&this.data.r===2&&(this.e.v=this._currentTextLength);var F=this.data.r===2?1:100/this.data.totalChars,B=this.o.v/F,G=this.s.v/F+B,R=this.e.v/F+B;if(G>R){var z=G;G=R,R=z}this.finalS=G,this.finalE=R}},extendPrototype([DynamicPropertyContainer],A);function T(E,I,F){return new A(E,I)}return{getTextSelectorProp:T}}();function TextAnimatorDataProperty(P,_,C){var A={propType:!1},T=PropertyFactory.getProp,E=_.a;this.a={r:E.r?T(P,E.r,0,degToRads,C):A,rx:E.rx?T(P,E.rx,0,degToRads,C):A,ry:E.ry?T(P,E.ry,0,degToRads,C):A,sk:E.sk?T(P,E.sk,0,degToRads,C):A,sa:E.sa?T(P,E.sa,0,degToRads,C):A,s:E.s?T(P,E.s,1,.01,C):A,a:E.a?T(P,E.a,1,0,C):A,o:E.o?T(P,E.o,0,.01,C):A,p:E.p?T(P,E.p,1,0,C):A,sw:E.sw?T(P,E.sw,0,0,C):A,sc:E.sc?T(P,E.sc,1,0,C):A,fc:E.fc?T(P,E.fc,1,0,C):A,fh:E.fh?T(P,E.fh,0,0,C):A,fs:E.fs?T(P,E.fs,0,.01,C):A,fb:E.fb?T(P,E.fb,0,.01,C):A,t:E.t?T(P,E.t,0,0,C):A},this.s=TextSelectorProp.getTextSelectorProp(P,_.s,C),this.s.t=_.s.t}function TextAnimatorProperty(P,_,C){this._isFirstFrame=!0,this._hasMaskedPath=!1,this._frameId=-1,this._textData=P,this._renderType=_,this._elem=C,this._animatorsData=createSizedArray(this._textData.a.length),this._pathData={},this._moreOptions={alignment:{}},this.renderedLetters=[],this.lettersChangedFlag=!1,this.initDynamicPropertyContainer(C)}TextAnimatorProperty.prototype.searchProperties=function(){var P,_=this._textData.a.length,C,A=PropertyFactory.getProp;for(P=0;P<_;P+=1)C=this._textData.a[P],this._animatorsData[P]=new TextAnimatorDataProperty(this._elem,C,this);this._textData.p&&"m"in this._textData.p?(this._pathData={a:A(this._elem,this._textData.p.a,0,0,this),f:A(this._elem,this._textData.p.f,0,0,this),l:A(this._elem,this._textData.p.l,0,0,this),r:A(this._elem,this._textData.p.r,0,0,this),p:A(this._elem,this._textData.p.p,0,0,this),m:this._elem.maskManager.getMaskProperty(this._textData.p.m)},this._hasMaskedPath=!0):this._hasMaskedPath=!1,this._moreOptions.alignment=A(this._elem,this._textData.m.a,1,0,this)},TextAnimatorProperty.prototype.getMeasures=function(P,_){if(this.lettersChangedFlag=_,!(!this._mdf&&!this._isFirstFrame&&!_&&(!this._hasMaskedPath||!this._pathData.m._mdf))){this._isFirstFrame=!1;var C=this._moreOptions.alignment.v,A=this._animatorsData,T=this._textData,E=this.mHelper,I=this._renderType,F=this.renderedLetters.length,B,G,R,z,D=P.l,L,O,V,U,W,X,Y,K,q,J,tt,rt,st,nt,at;if(this._hasMaskedPath){if(at=this._pathData.m,!this._pathData.n||this._pathData._mdf){var ot=at.v;this._pathData.r.v&&(ot=ot.reverse()),L={tLength:0,segments:[]},z=ot._length-1;var ct;for(rt=0,R=0;R<z;R+=1)ct=bez.buildBezierData(ot.v[R],ot.v[R+1],[ot.o[R][0]-ot.v[R][0],ot.o[R][1]-ot.v[R][1]],[ot.i[R+1][0]-ot.v[R+1][0],ot.i[R+1][1]-ot.v[R+1][1]]),L.tLength+=ct.segmentLength,L.segments.push(ct),rt+=ct.segmentLength;R=z,at.v.c&&(ct=bez.buildBezierData(ot.v[R],ot.v[0],[ot.o[R][0]-ot.v[R][0],ot.o[R][1]-ot.v[R][1]],[ot.i[0][0]-ot.v[0][0],ot.i[0][1]-ot.v[0][1]]),L.tLength+=ct.segmentLength,L.segments.push(ct),rt+=ct.segmentLength),this._pathData.pi=L}if(L=this._pathData.pi,O=this._pathData.f.v,Y=0,X=1,U=0,W=!0,J=L.segments,O<0&&at.v.c)for(L.tLength<Math.abs(O)&&(O=-Math.abs(O)%L.tLength),Y=J.length-1,q=J[Y].points,X=q.length-1;O<0;)O+=q[X].partialLength,X-=1,X<0&&(Y-=1,q=J[Y].points,X=q.length-1);q=J[Y].points,K=q[X-1],V=q[X],tt=V.partialLength}z=D.length,B=0,G=0;var dt=P.finalSize*1.2*.714,ut=!0,Q,it,Z,et,ht;et=A.length;var lt,ft=-1,pt,mt,gt,yt=O,bt=Y,xt=X,Et=-1,_t,Tt,At,wt,vt,Pt,Ct,Bt,It="",Mt=this.defaultPropsArray,Gt;if(P.j===2||P.j===1){var kt=0,Dt=0,Vt=P.j===2?-.5:-1,Rt=0,Ot=!0;for(R=0;R<z;R+=1)if(D[R].n){for(kt&&(kt+=Dt);Rt<R;)D[Rt].animatorJustifyOffset=kt,Rt+=1;kt=0,Ot=!0}else{for(Z=0;Z<et;Z+=1)Q=A[Z].a,Q.t.propType&&(Ot&&P.j===2&&(Dt+=Q.t.v*Vt),it=A[Z].s,lt=it.getMult(D[R].anIndexes[Z],T.a[Z].s.totalChars),lt.length?kt+=Q.t.v*lt[0]*Vt:kt+=Q.t.v*lt*Vt);Ot=!1}for(kt&&(kt+=Dt);Rt<R;)D[Rt].animatorJustifyOffset=kt,Rt+=1}for(R=0;R<z;R+=1){if(E.reset(),_t=1,D[R].n)B=0,G+=P.yOffset,G+=ut?1:0,O=yt,ut=!1,this._hasMaskedPath&&(Y=bt,X=xt,q=J[Y].points,K=q[X-1],V=q[X],tt=V.partialLength,U=0),It="",Bt="",Pt="",Gt="",Mt=this.defaultPropsArray;else{if(this._hasMaskedPath){if(Et!==D[R].line){switch(P.j){case 1:O+=rt-P.lineWidths[D[R].line];break;case 2:O+=(rt-P.lineWidths[D[R].line])/2;break}Et=D[R].line}ft!==D[R].ind&&(D[ft]&&(O+=D[ft].extra),O+=D[R].an/2,ft=D[R].ind),O+=C[0]*D[R].an*.005;var Ft=0;for(Z=0;Z<et;Z+=1)Q=A[Z].a,Q.p.propType&&(it=A[Z].s,lt=it.getMult(D[R].anIndexes[Z],T.a[Z].s.totalChars),lt.length?Ft+=Q.p.v[0]*lt[0]:Ft+=Q.p.v[0]*lt),Q.a.propType&&(it=A[Z].s,lt=it.getMult(D[R].anIndexes[Z],T.a[Z].s.totalChars),lt.length?Ft+=Q.a.v[0]*lt[0]:Ft+=Q.a.v[0]*lt);for(W=!0,this._pathData.a.v&&(O=D[0].an*.5+(rt-this._pathData.f.v-D[0].an*.5-D[D.length-1].an*.5)*ft/(z-1),O+=this._pathData.f.v);W;)U+tt>=O+Ft||!q?(st=(O+Ft-U)/V.partialLength,mt=K.point[0]+(V.point[0]-K.point[0])*st,gt=K.point[1]+(V.point[1]-K.point[1])*st,E.translate(-C[0]*D[R].an*.005,-(C[1]*dt)*.01),W=!1):q&&(U+=V.partialLength,X+=1,X>=q.length&&(X=0,Y+=1,J[Y]?q=J[Y].points:at.v.c?(X=0,Y=0,q=J[Y].points):(U-=V.partialLength,q=null)),q&&(K=V,V=q[X],tt=V.partialLength));pt=D[R].an/2-D[R].add,E.translate(-pt,0,0)}else pt=D[R].an/2-D[R].add,E.translate(-pt,0,0),E.translate(-C[0]*D[R].an*.005,-C[1]*dt*.01,0);for(Z=0;Z<et;Z+=1)Q=A[Z].a,Q.t.propType&&(it=A[Z].s,lt=it.getMult(D[R].anIndexes[Z],T.a[Z].s.totalChars),(B!==0||P.j!==0)&&(this._hasMaskedPath?lt.length?O+=Q.t.v*lt[0]:O+=Q.t.v*lt:lt.length?B+=Q.t.v*lt[0]:B+=Q.t.v*lt));for(P.strokeWidthAnim&&(At=P.sw||0),P.strokeColorAnim&&(P.sc?Tt=[P.sc[0],P.sc[1],P.sc[2]]:Tt=[0,0,0]),P.fillColorAnim&&P.fc&&(wt=[P.fc[0],P.fc[1],P.fc[2]]),Z=0;Z<et;Z+=1)Q=A[Z].a,Q.a.propType&&(it=A[Z].s,lt=it.getMult(D[R].anIndexes[Z],T.a[Z].s.totalChars),lt.length?E.translate(-Q.a.v[0]*lt[0],-Q.a.v[1]*lt[1],Q.a.v[2]*lt[2]):E.translate(-Q.a.v[0]*lt,-Q.a.v[1]*lt,Q.a.v[2]*lt));for(Z=0;Z<et;Z+=1)Q=A[Z].a,Q.s.propType&&(it=A[Z].s,lt=it.getMult(D[R].anIndexes[Z],T.a[Z].s.totalChars),lt.length?E.scale(1+(Q.s.v[0]-1)*lt[0],1+(Q.s.v[1]-1)*lt[1],1):E.scale(1+(Q.s.v[0]-1)*lt,1+(Q.s.v[1]-1)*lt,1));for(Z=0;Z<et;Z+=1){if(Q=A[Z].a,it=A[Z].s,lt=it.getMult(D[R].anIndexes[Z],T.a[Z].s.totalChars),Q.sk.propType&&(lt.length?E.skewFromAxis(-Q.sk.v*lt[0],Q.sa.v*lt[1]):E.skewFromAxis(-Q.sk.v*lt,Q.sa.v*lt)),Q.r.propType&&(lt.length?E.rotateZ(-Q.r.v*lt[2]):E.rotateZ(-Q.r.v*lt)),Q.ry.propType&&(lt.length?E.rotateY(Q.ry.v*lt[1]):E.rotateY(Q.ry.v*lt)),Q.rx.propType&&(lt.length?E.rotateX(Q.rx.v*lt[0]):E.rotateX(Q.rx.v*lt)),Q.o.propType&&(lt.length?_t+=(Q.o.v*lt[0]-_t)*lt[0]:_t+=(Q.o.v*lt-_t)*lt),P.strokeWidthAnim&&Q.sw.propType&&(lt.length?At+=Q.sw.v*lt[0]:At+=Q.sw.v*lt),P.strokeColorAnim&&Q.sc.propType)for(vt=0;vt<3;vt+=1)lt.length?Tt[vt]+=(Q.sc.v[vt]-Tt[vt])*lt[0]:Tt[vt]+=(Q.sc.v[vt]-Tt[vt])*lt;if(P.fillColorAnim&&P.fc){if(Q.fc.propType)for(vt=0;vt<3;vt+=1)lt.length?wt[vt]+=(Q.fc.v[vt]-wt[vt])*lt[0]:wt[vt]+=(Q.fc.v[vt]-wt[vt])*lt;Q.fh.propType&&(lt.length?wt=addHueToRGB(wt,Q.fh.v*lt[0]):wt=addHueToRGB(wt,Q.fh.v*lt)),Q.fs.propType&&(lt.length?wt=addSaturationToRGB(wt,Q.fs.v*lt[0]):wt=addSaturationToRGB(wt,Q.fs.v*lt)),Q.fb.propType&&(lt.length?wt=addBrightnessToRGB(wt,Q.fb.v*lt[0]):wt=addBrightnessToRGB(wt,Q.fb.v*lt))}}for(Z=0;Z<et;Z+=1)Q=A[Z].a,Q.p.propType&&(it=A[Z].s,lt=it.getMult(D[R].anIndexes[Z],T.a[Z].s.totalChars),this._hasMaskedPath?lt.length?E.translate(0,Q.p.v[1]*lt[0],-Q.p.v[2]*lt[1]):E.translate(0,Q.p.v[1]*lt,-Q.p.v[2]*lt):lt.length?E.translate(Q.p.v[0]*lt[0],Q.p.v[1]*lt[1],-Q.p.v[2]*lt[2]):E.translate(Q.p.v[0]*lt,Q.p.v[1]*lt,-Q.p.v[2]*lt));if(P.strokeWidthAnim&&(Pt=At<0?0:At),P.strokeColorAnim&&(Ct="rgb("+Math.round(Tt[0]*255)+","+Math.round(Tt[1]*255)+","+Math.round(Tt[2]*255)+")"),P.fillColorAnim&&P.fc&&(Bt="rgb("+Math.round(wt[0]*255)+","+Math.round(wt[1]*255)+","+Math.round(wt[2]*255)+")"),this._hasMaskedPath){if(E.translate(0,-P.ls),E.translate(0,C[1]*dt*.01+G,0),this._pathData.p.v){nt=(V.point[1]-K.point[1])/(V.point[0]-K.point[0]);var Ht=Math.atan(nt)*180/Math.PI;V.point[0]<K.point[0]&&(Ht+=180),E.rotate(-Ht*Math.PI/180)}E.translate(mt,gt,0),O-=C[0]*D[R].an*.005,D[R+1]&&ft!==D[R+1].ind&&(O+=D[R].an/2,O+=P.tr*.001*P.finalSize)}else{switch(E.translate(B,G,0),P.ps&&E.translate(P.ps[0],P.ps[1]+P.ascent,0),P.j){case 1:E.translate(D[R].animatorJustifyOffset+P.justifyOffset+(P.boxWidth-P.lineWidths[D[R].line]),0,0);break;case 2:E.translate(D[R].animatorJustifyOffset+P.justifyOffset+(P.boxWidth-P.lineWidths[D[R].line])/2,0,0);break}E.translate(0,-P.ls),E.translate(pt,0,0),E.translate(C[0]*D[R].an*.005,C[1]*dt*.01,0),B+=D[R].l+P.tr*.001*P.finalSize}I==="html"?It=E.toCSS():I==="svg"?It=E.to2dCSS():Mt=[E.props[0],E.props[1],E.props[2],E.props[3],E.props[4],E.props[5],E.props[6],E.props[7],E.props[8],E.props[9],E.props[10],E.props[11],E.props[12],E.props[13],E.props[14],E.props[15]],Gt=_t}F<=R?(ht=new LetterProps(Gt,Pt,Ct,Bt,It,Mt),this.renderedLetters.push(ht),F+=1,this.lettersChangedFlag=!0):(ht=this.renderedLetters[R],this.lettersChangedFlag=ht.update(Gt,Pt,Ct,Bt,It,Mt)||this.lettersChangedFlag)}}},TextAnimatorProperty.prototype.getValue=function(){this._elem.globalData.frameId!==this._frameId&&(this._frameId=this._elem.globalData.frameId,this.iterateDynamicProperties())},TextAnimatorProperty.prototype.mHelper=new Matrix,TextAnimatorProperty.prototype.defaultPropsArray=[],extendPrototype([DynamicPropertyContainer],TextAnimatorProperty);function ITextElement(){}ITextElement.prototype.initElement=function(P,_,C){this.lettersChangedFlag=!0,this.initFrame(),this.initBaseData(P,_,C),this.textProperty=new TextProperty(this,P.t,this.dynamicProperties),this.textAnimator=new TextAnimatorProperty(P.t,this.renderType,this),this.initTransform(P,_,C),this.initHierarchy(),this.initRenderable(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),this.createContent(),this.hide(),this.textAnimator.searchProperties(this.dynamicProperties)},ITextElement.prototype.prepareFrame=function(P){this._mdf=!1,this.prepareRenderableFrame(P),this.prepareProperties(P,this.isInRange)},ITextElement.prototype.createPathShape=function(P,_){var C,A=_.length,T,E="";for(C=0;C<A;C+=1)_[C].ty==="sh"&&(T=_[C].ks.k,E+=buildShapeString(T,T.i.length,!0,P));return E},ITextElement.prototype.updateDocumentData=function(P,_){this.textProperty.updateDocumentData(P,_)},ITextElement.prototype.canResizeFont=function(P){this.textProperty.canResizeFont(P)},ITextElement.prototype.setMinimumFontSize=function(P){this.textProperty.setMinimumFontSize(P)},ITextElement.prototype.applyTextPropertiesToMatrix=function(P,_,C,A,T){switch(P.ps&&_.translate(P.ps[0],P.ps[1]+P.ascent,0),_.translate(0,-P.ls,0),P.j){case 1:_.translate(P.justifyOffset+(P.boxWidth-P.lineWidths[C]),0,0);break;case 2:_.translate(P.justifyOffset+(P.boxWidth-P.lineWidths[C])/2,0,0);break}_.translate(A,T,0)},ITextElement.prototype.buildColor=function(P){return"rgb("+Math.round(P[0]*255)+","+Math.round(P[1]*255)+","+Math.round(P[2]*255)+")"},ITextElement.prototype.emptyProp=new LetterProps,ITextElement.prototype.destroy=function(){},ITextElement.prototype.validateText=function(){(this.textProperty._mdf||this.textProperty._isFirstFrame)&&(this.buildNewText(),this.textProperty._isFirstFrame=!1,this.textProperty._mdf=!1)};var emptyShapeData={shapes:[]};function SVGTextLottieElement(P,_,C){this.textSpans=[],this.renderType="svg",this.initElement(P,_,C)}extendPrototype([BaseElement,TransformElement,SVGBaseElement,HierarchyElement,FrameElement,RenderableDOMElement,ITextElement],SVGTextLottieElement),SVGTextLottieElement.prototype.createContent=function(){this.data.singleShape&&!this.globalData.fontManager.chars&&(this.textContainer=createNS("text"))},SVGTextLottieElement.prototype.buildTextContents=function(P){for(var _=0,C=P.length,A=[],T="";_<C;)P[_]==="\r"||P[_]===""?(A.push(T),T=""):T+=P[_],_+=1;return A.push(T),A},SVGTextLottieElement.prototype.buildShapeData=function(P,_){if(P.shapes&&P.shapes.length){var C=P.shapes[0];if(C.it){var A=C.it[C.it.length-1];A.s&&(A.s.k[0]=_,A.s.k[1]=_)}}return P},SVGTextLottieElement.prototype.buildNewText=function(){this.addDynamicProperty(this);var P,_,C=this.textProperty.currentData;this.renderedLetters=createSizedArray(C?C.l.length:0),C.fc?this.layerElement.setAttribute("fill",this.buildColor(C.fc)):this.layerElement.setAttribute("fill","rgba(0,0,0,0)"),C.sc&&(this.layerElement.setAttribute("stroke",this.buildColor(C.sc)),this.layerElement.setAttribute("stroke-width",C.sw)),this.layerElement.setAttribute("font-size",C.finalSize);var A=this.globalData.fontManager.getFontByName(C.f);if(A.fClass)this.layerElement.setAttribute("class",A.fClass);else{this.layerElement.setAttribute("font-family",A.fFamily);var T=C.fWeight,E=C.fStyle;this.layerElement.setAttribute("font-style",E),this.layerElement.setAttribute("font-weight",T)}this.layerElement.setAttribute("aria-label",C.t);var I=C.l||[],F=!!this.globalData.fontManager.chars;_=I.length;var B,G=this.mHelper,R="",z=this.data.singleShape,D=0,L=0,O=!0,V=C.tr*.001*C.finalSize;if(z&&!F&&!C.sz){var U=this.textContainer,W="start";switch(C.j){case 1:W="end";break;case 2:W="middle";break;default:W="start";break}U.setAttribute("text-anchor",W),U.setAttribute("letter-spacing",V);var X=this.buildTextContents(C.finalText);for(_=X.length,L=C.ps?C.ps[1]+C.ascent:0,P=0;P<_;P+=1)B=this.textSpans[P].span||createNS("tspan"),B.textContent=X[P],B.setAttribute("x",0),B.setAttribute("y",L),B.style.display="inherit",U.appendChild(B),this.textSpans[P]||(this.textSpans[P]={span:null,glyph:null}),this.textSpans[P].span=B,L+=C.finalLineHeight;this.layerElement.appendChild(U)}else{var Y=this.textSpans.length,K;for(P=0;P<_;P+=1){if(this.textSpans[P]||(this.textSpans[P]={span:null,childSpan:null,glyph:null}),!F||!z||P===0){if(B=Y>P?this.textSpans[P].span:createNS(F?"g":"text"),Y<=P){if(B.setAttribute("stroke-linecap","butt"),B.setAttribute("stroke-linejoin","round"),B.setAttribute("stroke-miterlimit","4"),this.textSpans[P].span=B,F){var q=createNS("g");B.appendChild(q),this.textSpans[P].childSpan=q}this.textSpans[P].span=B,this.layerElement.appendChild(B)}B.style.display="inherit"}if(G.reset(),z&&(I[P].n&&(D=-V,L+=C.yOffset,L+=O?1:0,O=!1),this.applyTextPropertiesToMatrix(C,G,I[P].line,D,L),D+=I[P].l||0,D+=V),F){K=this.globalData.fontManager.getCharData(C.finalText[P],A.fStyle,this.globalData.fontManager.getFontByName(C.f).fFamily);var J;if(K.t===1)J=new SVGCompElement(K.data,this.globalData,this);else{var tt=emptyShapeData;K.data&&K.data.shapes&&(tt=this.buildShapeData(K.data,C.finalSize)),J=new SVGShapeElement(tt,this.globalData,this)}if(this.textSpans[P].glyph){var rt=this.textSpans[P].glyph;this.textSpans[P].childSpan.removeChild(rt.layerElement),rt.destroy()}this.textSpans[P].glyph=J,J._debug=!0,J.prepareFrame(0),J.renderFrame(),this.textSpans[P].childSpan.appendChild(J.layerElement),K.t===1&&this.textSpans[P].childSpan.setAttribute("transform","scale("+C.finalSize/100+","+C.finalSize/100+")")}else z&&B.setAttribute("transform","translate("+G.props[12]+","+G.props[13]+")"),B.textContent=I[P].val,B.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve")}z&&B&&B.setAttribute("d",R)}for(;P<this.textSpans.length;)this.textSpans[P].span.style.display="none",P+=1;this._sizeChanged=!0},SVGTextLottieElement.prototype.sourceRectAtTime=function(){if(this.prepareFrame(this.comp.renderedFrame-this.data.st),this.renderInnerContent(),this._sizeChanged){this._sizeChanged=!1;var P=this.layerElement.getBBox();this.bbox={top:P.y,left:P.x,width:P.width,height:P.height}}return this.bbox},SVGTextLottieElement.prototype.getValue=function(){var P,_=this.textSpans.length,C;for(this.renderedFrame=this.comp.renderedFrame,P=0;P<_;P+=1)C=this.textSpans[P].glyph,C&&(C.prepareFrame(this.comp.renderedFrame-this.data.st),C._mdf&&(this._mdf=!0))},SVGTextLottieElement.prototype.renderInnerContent=function(){if(this.validateText(),(!this.data.singleShape||this._mdf)&&(this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag),this.lettersChangedFlag||this.textAnimator.lettersChangedFlag)){this._sizeChanged=!0;var P,_,C=this.textAnimator.renderedLetters,A=this.textProperty.currentData.l;_=A.length;var T,E,I;for(P=0;P<_;P+=1)A[P].n||(T=C[P],E=this.textSpans[P].span,I=this.textSpans[P].glyph,I&&I.renderFrame(),T._mdf.m&&E.setAttribute("transform",T.m),T._mdf.o&&E.setAttribute("opacity",T.o),T._mdf.sw&&E.setAttribute("stroke-width",T.sw),T._mdf.sc&&E.setAttribute("stroke",T.sc),T._mdf.fc&&E.setAttribute("fill",T.fc))}};function ISolidElement(P,_,C){this.initElement(P,_,C)}extendPrototype([IImageElement],ISolidElement),ISolidElement.prototype.createContent=function(){var P=createNS("rect");P.setAttribute("width",this.data.sw),P.setAttribute("height",this.data.sh),P.setAttribute("fill",this.data.sc),this.layerElement.appendChild(P)};function NullElement(P,_,C){this.initFrame(),this.initBaseData(P,_,C),this.initFrame(),this.initTransform(P,_,C),this.initHierarchy()}NullElement.prototype.prepareFrame=function(P){this.prepareProperties(P,!0)},NullElement.prototype.renderFrame=function(){},NullElement.prototype.getBaseElement=function(){return null},NullElement.prototype.destroy=function(){},NullElement.prototype.sourceRectAtTime=function(){},NullElement.prototype.hide=function(){},extendPrototype([BaseElement,TransformElement,HierarchyElement,FrameElement],NullElement);function SVGRendererBase(){}extendPrototype([BaseRenderer],SVGRendererBase),SVGRendererBase.prototype.createNull=function(P){return new NullElement(P,this.globalData,this)},SVGRendererBase.prototype.createShape=function(P){return new SVGShapeElement(P,this.globalData,this)},SVGRendererBase.prototype.createText=function(P){return new SVGTextLottieElement(P,this.globalData,this)},SVGRendererBase.prototype.createImage=function(P){return new IImageElement(P,this.globalData,this)},SVGRendererBase.prototype.createSolid=function(P){return new ISolidElement(P,this.globalData,this)},SVGRendererBase.prototype.configAnimation=function(P){this.svgElement.setAttribute("xmlns","http://www.w3.org/2000/svg"),this.svgElement.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),this.renderConfig.viewBoxSize?this.svgElement.setAttribute("viewBox",this.renderConfig.viewBoxSize):this.svgElement.setAttribute("viewBox","0 0 "+P.w+" "+P.h),this.renderConfig.viewBoxOnly||(this.svgElement.setAttribute("width",P.w),this.svgElement.setAttribute("height",P.h),this.svgElement.style.width="100%",this.svgElement.style.height="100%",this.svgElement.style.transform="translate3d(0,0,0)",this.svgElement.style.contentVisibility=this.renderConfig.contentVisibility),this.renderConfig.width&&this.svgElement.setAttribute("width",this.renderConfig.width),this.renderConfig.height&&this.svgElement.setAttribute("height",this.renderConfig.height),this.renderConfig.className&&this.svgElement.setAttribute("class",this.renderConfig.className),this.renderConfig.id&&this.svgElement.setAttribute("id",this.renderConfig.id),this.renderConfig.focusable!==void 0&&this.svgElement.setAttribute("focusable",this.renderConfig.focusable),this.svgElement.setAttribute("preserveAspectRatio",this.renderConfig.preserveAspectRatio),this.animationItem.wrapper.appendChild(this.svgElement);var _=this.globalData.defs;this.setupGlobalData(P,_),this.globalData.progressiveLoad=this.renderConfig.progressiveLoad,this.data=P;var C=createNS("clipPath"),A=createNS("rect");A.setAttribute("width",P.w),A.setAttribute("height",P.h),A.setAttribute("x",0),A.setAttribute("y",0);var T=createElementID();C.setAttribute("id",T),C.appendChild(A),this.layerElement.setAttribute("clip-path","url("+getLocationHref()+"#"+T+")"),_.appendChild(C),this.layers=P.layers,this.elements=createSizedArray(P.layers.length)},SVGRendererBase.prototype.destroy=function(){this.animationItem.wrapper&&(this.animationItem.wrapper.innerText=""),this.layerElement=null,this.globalData.defs=null;var P,_=this.layers?this.layers.length:0;for(P=0;P<_;P+=1)this.elements[P]&&this.elements[P].destroy&&this.elements[P].destroy();this.elements.length=0,this.destroyed=!0,this.animationItem=null},SVGRendererBase.prototype.updateContainerSize=function(){},SVGRendererBase.prototype.findIndexByInd=function(P){var _=0,C=this.layers.length;for(_=0;_<C;_+=1)if(this.layers[_].ind===P)return _;return-1},SVGRendererBase.prototype.buildItem=function(P){var _=this.elements;if(!(_[P]||this.layers[P].ty===99)){_[P]=!0;var C=this.createItem(this.layers[P]);if(_[P]=C,getExpressionsPlugin()&&(this.layers[P].ty===0&&this.globalData.projectInterface.registerComposition(C),C.initExpressions()),this.appendElementInPos(C,P),this.layers[P].tt){var A="tp"in this.layers[P]?this.findIndexByInd(this.layers[P].tp):P-1;if(A===-1)return;if(!this.elements[A]||this.elements[A]===!0)this.buildItem(A),this.addPendingElement(C);else{var T=_[A],E=T.getMatte(this.layers[P].tt);C.setMatte(E)}}}},SVGRendererBase.prototype.checkPendingElements=function(){for(;this.pendingElements.length;){var P=this.pendingElements.pop();if(P.checkParenting(),P.data.tt)for(var _=0,C=this.elements.length;_<C;){if(this.elements[_]===P){var A="tp"in P.data?this.findIndexByInd(P.data.tp):_-1,T=this.elements[A],E=T.getMatte(this.layers[_].tt);P.setMatte(E);break}_+=1}}},SVGRendererBase.prototype.renderFrame=function(P){if(!(this.renderedFrame===P||this.destroyed)){P===null?P=this.renderedFrame:this.renderedFrame=P,this.globalData.frameNum=P,this.globalData.frameId+=1,this.globalData.projectInterface.currentFrame=P,this.globalData._mdf=!1;var _,C=this.layers.length;for(this.completeLayers||this.checkLayers(P),_=C-1;_>=0;_-=1)(this.completeLayers||this.elements[_])&&this.elements[_].prepareFrame(P-this.layers[_].st);if(this.globalData._mdf)for(_=0;_<C;_+=1)(this.completeLayers||this.elements[_])&&this.elements[_].renderFrame()}},SVGRendererBase.prototype.appendElementInPos=function(P,_){var C=P.getBaseElement();if(C){for(var A=0,T;A<_;)this.elements[A]&&this.elements[A]!==!0&&this.elements[A].getBaseElement()&&(T=this.elements[A].getBaseElement()),A+=1;T?this.layerElement.insertBefore(C,T):this.layerElement.appendChild(C)}},SVGRendererBase.prototype.hide=function(){this.layerElement.style.display="none"},SVGRendererBase.prototype.show=function(){this.layerElement.style.display="block"};function ICompElement(){}extendPrototype([BaseElement,TransformElement,HierarchyElement,FrameElement,RenderableDOMElement],ICompElement),ICompElement.prototype.initElement=function(P,_,C){this.initFrame(),this.initBaseData(P,_,C),this.initTransform(P,_,C),this.initRenderable(),this.initHierarchy(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),(this.data.xt||!_.progressiveLoad)&&this.buildAllItems(),this.hide()},ICompElement.prototype.prepareFrame=function(P){if(this._mdf=!1,this.prepareRenderableFrame(P),this.prepareProperties(P,this.isInRange),!(!this.isInRange&&!this.data.xt)){if(this.tm._placeholder)this.renderedFrame=P/this.data.sr;else{var _=this.tm.v;_===this.data.op&&(_=this.data.op-1),this.renderedFrame=_}var C,A=this.elements.length;for(this.completeLayers||this.checkLayers(this.renderedFrame),C=A-1;C>=0;C-=1)(this.completeLayers||this.elements[C])&&(this.elements[C].prepareFrame(this.renderedFrame-this.layers[C].st),this.elements[C]._mdf&&(this._mdf=!0))}},ICompElement.prototype.renderInnerContent=function(){var P,_=this.layers.length;for(P=0;P<_;P+=1)(this.completeLayers||this.elements[P])&&this.elements[P].renderFrame()},ICompElement.prototype.setElements=function(P){this.elements=P},ICompElement.prototype.getElements=function(){return this.elements},ICompElement.prototype.destroyElements=function(){var P,_=this.layers.length;for(P=0;P<_;P+=1)this.elements[P]&&this.elements[P].destroy()},ICompElement.prototype.destroy=function(){this.destroyElements(),this.destroyBaseElement()};function SVGCompElement(P,_,C){this.layers=P.layers,this.supports3d=!0,this.completeLayers=!1,this.pendingElements=[],this.elements=this.layers?createSizedArray(this.layers.length):[],this.initElement(P,_,C),this.tm=P.tm?PropertyFactory.getProp(this,P.tm,0,_.frameRate,this):{_placeholder:!0}}extendPrototype([SVGRendererBase,ICompElement,SVGBaseElement],SVGCompElement),SVGCompElement.prototype.createComp=function(P){return new SVGCompElement(P,this.globalData,this)};function SVGRenderer(P,_){this.animationItem=P,this.layers=null,this.renderedFrame=-1,this.svgElement=createNS("svg");var C="";if(_&&_.title){var A=createNS("title"),T=createElementID();A.setAttribute("id",T),A.textContent=_.title,this.svgElement.appendChild(A),C+=T}if(_&&_.description){var E=createNS("desc"),I=createElementID();E.setAttribute("id",I),E.textContent=_.description,this.svgElement.appendChild(E),C+=" "+I}C&&this.svgElement.setAttribute("aria-labelledby",C);var F=createNS("defs");this.svgElement.appendChild(F);var B=createNS("g");this.svgElement.appendChild(B),this.layerElement=B,this.renderConfig={preserveAspectRatio:_&&_.preserveAspectRatio||"xMidYMid meet",imagePreserveAspectRatio:_&&_.imagePreserveAspectRatio||"xMidYMid slice",contentVisibility:_&&_.contentVisibility||"visible",progressiveLoad:_&&_.progressiveLoad||!1,hideOnTransparent:!(_&&_.hideOnTransparent===!1),viewBoxOnly:_&&_.viewBoxOnly||!1,viewBoxSize:_&&_.viewBoxSize||!1,className:_&&_.className||"",id:_&&_.id||"",focusable:_&&_.focusable,filterSize:{width:_&&_.filterSize&&_.filterSize.width||"100%",height:_&&_.filterSize&&_.filterSize.height||"100%",x:_&&_.filterSize&&_.filterSize.x||"0%",y:_&&_.filterSize&&_.filterSize.y||"0%"},width:_&&_.width,height:_&&_.height,runExpressions:!_||_.runExpressions===void 0||_.runExpressions},this.globalData={_mdf:!1,frameNum:-1,defs:F,renderConfig:this.renderConfig},this.elements=[],this.pendingElements=[],this.destroyed=!1,this.rendererType="svg"}extendPrototype([SVGRendererBase],SVGRenderer),SVGRenderer.prototype.createComp=function(P){return new SVGCompElement(P,this.globalData,this)};function ShapeTransformManager(){this.sequences={},this.sequenceList=[],this.transform_key_count=0}ShapeTransformManager.prototype={addTransformSequence:function(_){var C,A=_.length,T="_";for(C=0;C<A;C+=1)T+=_[C].transform.key+"_";var E=this.sequences[T];return E||(E={transforms:[].concat(_),finalTransform:new Matrix,_mdf:!1},this.sequences[T]=E,this.sequenceList.push(E)),E},processSequence:function(_,C){for(var A=0,T=_.transforms.length,E=C;A<T&&!C;){if(_.transforms[A].transform.mProps._mdf){E=!0;break}A+=1}if(E)for(_.finalTransform.reset(),A=T-1;A>=0;A-=1)_.finalTransform.multiply(_.transforms[A].transform.mProps.v);_._mdf=E},processSequences:function(_){var C,A=this.sequenceList.length;for(C=0;C<A;C+=1)this.processSequence(this.sequenceList[C],_)},getNewKey:function(){return this.transform_key_count+=1,"_"+this.transform_key_count}};var lumaLoader=function(){var _="__lottie_element_luma_buffer",C=null,A=null,T=null;function E(){var B=createNS("svg"),G=createNS("filter"),R=createNS("feColorMatrix");return G.setAttribute("id",_),R.setAttribute("type","matrix"),R.setAttribute("color-interpolation-filters","sRGB"),R.setAttribute("values","0.3, 0.3, 0.3, 0, 0, 0.3, 0.3, 0.3, 0, 0, 0.3, 0.3, 0.3, 0, 0, 0.3, 0.3, 0.3, 0, 0"),G.appendChild(R),B.appendChild(G),B.setAttribute("id",_+"_svg"),featureSupport.svgLumaHidden&&(B.style.display="none"),B}function I(){C||(T=E(),document.body.appendChild(T),C=createTag("canvas"),A=C.getContext("2d"),A.filter="url(#"+_+")",A.fillStyle="rgba(0,0,0,0)",A.fillRect(0,0,1,1))}function F(B){return C||I(),C.width=B.width,C.height=B.height,A.filter="url(#"+_+")",C}return{load:I,get:F}};function createCanvas(P,_){if(featureSupport.offscreenCanvas)return new OffscreenCanvas(P,_);var C=createTag("canvas");return C.width=P,C.height=_,C}var assetLoader=function(){return{loadLumaCanvas:lumaLoader.load,getLumaCanvas:lumaLoader.get,createCanvas}}(),registeredEffects={};function CVEffects(P){var _,C=P.data.ef?P.data.ef.length:0;this.filters=[];var A;for(_=0;_<C;_+=1){A=null;var T=P.data.ef[_].ty;if(registeredEffects[T]){var E=registeredEffects[T].effect;A=new E(P.effectsManager.effectElements[_],P)}A&&this.filters.push(A)}this.filters.length&&P.addRenderableComponent(this)}CVEffects.prototype.renderFrame=function(P){var _,C=this.filters.length;for(_=0;_<C;_+=1)this.filters[_].renderFrame(P)},CVEffects.prototype.getEffects=function(P){var _,C=this.filters.length,A=[];for(_=0;_<C;_+=1)this.filters[_].type===P&&A.push(this.filters[_]);return A};function registerEffect(P,_){registeredEffects[P]={effect:_}}function CVMaskElement(P,_){this.data=P,this.element=_,this.masksProperties=this.data.masksProperties||[],this.viewData=createSizedArray(this.masksProperties.length);var C,A=this.masksProperties.length,T=!1;for(C=0;C<A;C+=1)this.masksProperties[C].mode!=="n"&&(T=!0),this.viewData[C]=ShapePropertyFactory.getShapeProp(this.element,this.masksProperties[C],3);this.hasMasks=T,T&&this.element.addRenderableComponent(this)}CVMaskElement.prototype.renderFrame=function(){if(this.hasMasks){var P=this.element.finalTransform.mat,_=this.element.canvasContext,C,A=this.masksProperties.length,T,E,I;for(_.beginPath(),C=0;C<A;C+=1)if(this.masksProperties[C].mode!=="n"){this.masksProperties[C].inv&&(_.moveTo(0,0),_.lineTo(this.element.globalData.compSize.w,0),_.lineTo(this.element.globalData.compSize.w,this.element.globalData.compSize.h),_.lineTo(0,this.element.globalData.compSize.h),_.lineTo(0,0)),I=this.viewData[C].v,T=P.applyToPointArray(I.v[0][0],I.v[0][1],0),_.moveTo(T[0],T[1]);var F,B=I._length;for(F=1;F<B;F+=1)E=P.applyToTriplePoints(I.o[F-1],I.i[F],I.v[F]),_.bezierCurveTo(E[0],E[1],E[2],E[3],E[4],E[5]);E=P.applyToTriplePoints(I.o[F-1],I.i[0],I.v[0]),_.bezierCurveTo(E[0],E[1],E[2],E[3],E[4],E[5])}this.element.globalData.renderer.save(!0),_.clip()}},CVMaskElement.prototype.getMaskProperty=MaskElement.prototype.getMaskProperty,CVMaskElement.prototype.destroy=function(){this.element=null};function CVBaseElement(){}var operationsMap={1:"source-in",2:"source-out",3:"source-in",4:"source-out"};CVBaseElement.prototype={createElements:function(){},initRendererElement:function(){},createContainerElements:function(){if(this.data.tt>=1){this.buffers=[];var _=this.globalData.canvasContext,C=assetLoader.createCanvas(_.canvas.width,_.canvas.height);this.buffers.push(C);var A=assetLoader.createCanvas(_.canvas.width,_.canvas.height);this.buffers.push(A),this.data.tt>=3&&!document._isProxy&&assetLoader.loadLumaCanvas()}this.canvasContext=this.globalData.canvasContext,this.transformCanvas=this.globalData.transformCanvas,this.renderableEffectsManager=new CVEffects(this),this.searchEffectTransforms()},createContent:function(){},setBlendMode:function(){var _=this.globalData;if(_.blendMode!==this.data.bm){_.blendMode=this.data.bm;var C=getBlendMode(this.data.bm);_.canvasContext.globalCompositeOperation=C}},createRenderableComponents:function(){this.maskManager=new CVMaskElement(this.data,this),this.transformEffects=this.renderableEffectsManager.getEffects(effectTypes.TRANSFORM_EFFECT)},hideElement:function(){!this.hidden&&(!this.isInRange||this.isTransparent)&&(this.hidden=!0)},showElement:function(){this.isInRange&&!this.isTransparent&&(this.hidden=!1,this._isFirstFrame=!0,this.maskManager._isFirstFrame=!0)},clearCanvas:function(_){_.clearRect(this.transformCanvas.tx,this.transformCanvas.ty,this.transformCanvas.w*this.transformCanvas.sx,this.transformCanvas.h*this.transformCanvas.sy)},prepareLayer:function(){if(this.data.tt>=1){var _=this.buffers[0],C=_.getContext("2d");this.clearCanvas(C),C.drawImage(this.canvasContext.canvas,0,0),this.currentTransform=this.canvasContext.getTransform(),this.canvasContext.setTransform(1,0,0,1,0,0),this.clearCanvas(this.canvasContext),this.canvasContext.setTransform(this.currentTransform)}},exitLayer:function(){if(this.data.tt>=1){var _=this.buffers[1],C=_.getContext("2d");this.clearCanvas(C),C.drawImage(this.canvasContext.canvas,0,0),this.canvasContext.setTransform(1,0,0,1,0,0),this.clearCanvas(this.canvasContext),this.canvasContext.setTransform(this.currentTransform);var A=this.comp.getElementById("tp"in this.data?this.data.tp:this.data.ind-1);if(A.renderFrame(!0),this.canvasContext.setTransform(1,0,0,1,0,0),this.data.tt>=3&&!document._isProxy){var T=assetLoader.getLumaCanvas(this.canvasContext.canvas),E=T.getContext("2d");E.drawImage(this.canvasContext.canvas,0,0),this.clearCanvas(this.canvasContext),this.canvasContext.drawImage(T,0,0)}this.canvasContext.globalCompositeOperation=operationsMap[this.data.tt],this.canvasContext.drawImage(_,0,0),this.canvasContext.globalCompositeOperation="destination-over",this.canvasContext.drawImage(this.buffers[0],0,0),this.canvasContext.setTransform(this.currentTransform),this.canvasContext.globalCompositeOperation="source-over"}},renderFrame:function(_){if(!(this.hidden||this.data.hd)&&!(this.data.td===1&&!_)){this.renderTransform(),this.renderRenderable(),this.renderLocalTransform(),this.setBlendMode();var C=this.data.ty===0;this.prepareLayer(),this.globalData.renderer.save(C),this.globalData.renderer.ctxTransform(this.finalTransform.localMat.props),this.globalData.renderer.ctxOpacity(this.finalTransform.localOpacity),this.renderInnerContent(),this.globalData.renderer.restore(C),this.exitLayer(),this.maskManager.hasMasks&&this.globalData.renderer.restore(!0),this._isFirstFrame&&(this._isFirstFrame=!1)}},destroy:function(){this.canvasContext=null,this.data=null,this.globalData=null,this.maskManager.destroy()},mHelper:new Matrix},CVBaseElement.prototype.hide=CVBaseElement.prototype.hideElement,CVBaseElement.prototype.show=CVBaseElement.prototype.showElement;function CVShapeData(P,_,C,A){this.styledShapes=[],this.tr=[0,0,0,0,0,0];var T=4;_.ty==="rc"?T=5:_.ty==="el"?T=6:_.ty==="sr"&&(T=7),this.sh=ShapePropertyFactory.getShapeProp(P,_,T,P);var E,I=C.length,F;for(E=0;E<I;E+=1)C[E].closed||(F={transforms:A.addTransformSequence(C[E].transforms),trNodes:[]},this.styledShapes.push(F),C[E].elements.push(F))}CVShapeData.prototype.setAsAnimated=SVGShapeData.prototype.setAsAnimated;function CVShapeElement(P,_,C){this.shapes=[],this.shapesData=P.shapes,this.stylesList=[],this.itemsData=[],this.prevViewData=[],this.shapeModifiers=[],this.processedElements=[],this.transformsManager=new ShapeTransformManager,this.initElement(P,_,C)}extendPrototype([BaseElement,TransformElement,CVBaseElement,IShapeElement,HierarchyElement,FrameElement,RenderableElement],CVShapeElement),CVShapeElement.prototype.initElement=RenderableDOMElement.prototype.initElement,CVShapeElement.prototype.transformHelper={opacity:1,_opMdf:!1},CVShapeElement.prototype.dashResetter=[],CVShapeElement.prototype.createContent=function(){this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,!0,[])},CVShapeElement.prototype.createStyleElement=function(P,_){var C={data:P,type:P.ty,preTransforms:this.transformsManager.addTransformSequence(_),transforms:[],elements:[],closed:P.hd===!0},A={};if(P.ty==="fl"||P.ty==="st"?(A.c=PropertyFactory.getProp(this,P.c,1,255,this),A.c.k||(C.co="rgb("+bmFloor(A.c.v[0])+","+bmFloor(A.c.v[1])+","+bmFloor(A.c.v[2])+")")):(P.ty==="gf"||P.ty==="gs")&&(A.s=PropertyFactory.getProp(this,P.s,1,null,this),A.e=PropertyFactory.getProp(this,P.e,1,null,this),A.h=PropertyFactory.getProp(this,P.h||{k:0},0,.01,this),A.a=PropertyFactory.getProp(this,P.a||{k:0},0,degToRads,this),A.g=new GradientProperty(this,P.g,this)),A.o=PropertyFactory.getProp(this,P.o,0,.01,this),P.ty==="st"||P.ty==="gs"){if(C.lc=lineCapEnum[P.lc||2],C.lj=lineJoinEnum[P.lj||2],P.lj==1&&(C.ml=P.ml),A.w=PropertyFactory.getProp(this,P.w,0,null,this),A.w.k||(C.wi=A.w.v),P.d){var T=new DashProperty(this,P.d,"canvas",this);A.d=T,A.d.k||(C.da=A.d.dashArray,C.do=A.d.dashoffset[0])}}else C.r=P.r===2?"evenodd":"nonzero";return this.stylesList.push(C),A.style=C,A},CVShapeElement.prototype.createGroupElement=function(){var P={it:[],prevViewData:[]};return P},CVShapeElement.prototype.createTransformElement=function(P){var _={transform:{opacity:1,_opMdf:!1,key:this.transformsManager.getNewKey(),op:PropertyFactory.getProp(this,P.o,0,.01,this),mProps:TransformPropertyFactory.getTransformProperty(this,P,this)}};return _},CVShapeElement.prototype.createShapeElement=function(P){var _=new CVShapeData(this,P,this.stylesList,this.transformsManager);return this.shapes.push(_),this.addShapeToModifiers(_),_},CVShapeElement.prototype.reloadShapes=function(){this._isFirstFrame=!0;var P,_=this.itemsData.length;for(P=0;P<_;P+=1)this.prevViewData[P]=this.itemsData[P];for(this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,!0,[]),_=this.dynamicProperties.length,P=0;P<_;P+=1)this.dynamicProperties[P].getValue();this.renderModifiers(),this.transformsManager.processSequences(this._isFirstFrame)},CVShapeElement.prototype.addTransformToStyleList=function(P){var _,C=this.stylesList.length;for(_=0;_<C;_+=1)this.stylesList[_].closed||this.stylesList[_].transforms.push(P)},CVShapeElement.prototype.removeTransformFromStyleList=function(){var P,_=this.stylesList.length;for(P=0;P<_;P+=1)this.stylesList[P].closed||this.stylesList[P].transforms.pop()},CVShapeElement.prototype.closeStyles=function(P){var _,C=P.length;for(_=0;_<C;_+=1)P[_].closed=!0},CVShapeElement.prototype.searchShapes=function(P,_,C,A,T){var E,I=P.length-1,F,B,G=[],R=[],z,D,L,O=[].concat(T);for(E=I;E>=0;E-=1){if(z=this.searchProcessedElement(P[E]),z?_[E]=C[z-1]:P[E]._shouldRender=A,P[E].ty==="fl"||P[E].ty==="st"||P[E].ty==="gf"||P[E].ty==="gs")z?_[E].style.closed=!1:_[E]=this.createStyleElement(P[E],O),G.push(_[E].style);else if(P[E].ty==="gr"){if(!z)_[E]=this.createGroupElement(P[E]);else for(B=_[E].it.length,F=0;F<B;F+=1)_[E].prevViewData[F]=_[E].it[F];this.searchShapes(P[E].it,_[E].it,_[E].prevViewData,A,O)}else P[E].ty==="tr"?(z||(L=this.createTransformElement(P[E]),_[E]=L),O.push(_[E]),this.addTransformToStyleList(_[E])):P[E].ty==="sh"||P[E].ty==="rc"||P[E].ty==="el"||P[E].ty==="sr"?z||(_[E]=this.createShapeElement(P[E])):P[E].ty==="tm"||P[E].ty==="rd"||P[E].ty==="pb"||P[E].ty==="zz"||P[E].ty==="op"?(z?(D=_[E],D.closed=!1):(D=ShapeModifiers.getModifier(P[E].ty),D.init(this,P[E]),_[E]=D,this.shapeModifiers.push(D)),R.push(D)):P[E].ty==="rp"&&(z?(D=_[E],D.closed=!0):(D=ShapeModifiers.getModifier(P[E].ty),_[E]=D,D.init(this,P,E,_),this.shapeModifiers.push(D),A=!1),R.push(D));this.addProcessedElement(P[E],E+1)}for(this.removeTransformFromStyleList(),this.closeStyles(G),I=R.length,E=0;E<I;E+=1)R[E].closed=!0},CVShapeElement.prototype.renderInnerContent=function(){this.transformHelper.opacity=1,this.transformHelper._opMdf=!1,this.renderModifiers(),this.transformsManager.processSequences(this._isFirstFrame),this.renderShape(this.transformHelper,this.shapesData,this.itemsData,!0)},CVShapeElement.prototype.renderShapeTransform=function(P,_){(P._opMdf||_.op._mdf||this._isFirstFrame)&&(_.opacity=P.opacity,_.opacity*=_.op.v,_._opMdf=!0)},CVShapeElement.prototype.drawLayer=function(){var P,_=this.stylesList.length,C,A,T,E,I,F,B=this.globalData.renderer,G=this.globalData.canvasContext,R,z;for(P=0;P<_;P+=1)if(z=this.stylesList[P],R=z.type,!((R==="st"||R==="gs")&&z.wi===0||!z.data._shouldRender||z.coOp===0||this.globalData.currentGlobalAlpha===0)){for(B.save(),I=z.elements,R==="st"||R==="gs"?(B.ctxStrokeStyle(R==="st"?z.co:z.grd),B.ctxLineWidth(z.wi),B.ctxLineCap(z.lc),B.ctxLineJoin(z.lj),B.ctxMiterLimit(z.ml||0)):B.ctxFillStyle(R==="fl"?z.co:z.grd),B.ctxOpacity(z.coOp),R!=="st"&&R!=="gs"&&G.beginPath(),B.ctxTransform(z.preTransforms.finalTransform.props),A=I.length,C=0;C<A;C+=1){for((R==="st"||R==="gs")&&(G.beginPath(),z.da&&(G.setLineDash(z.da),G.lineDashOffset=z.do)),F=I[C].trNodes,E=F.length,T=0;T<E;T+=1)F[T].t==="m"?G.moveTo(F[T].p[0],F[T].p[1]):F[T].t==="c"?G.bezierCurveTo(F[T].pts[0],F[T].pts[1],F[T].pts[2],F[T].pts[3],F[T].pts[4],F[T].pts[5]):G.closePath();(R==="st"||R==="gs")&&(B.ctxStroke(),z.da&&G.setLineDash(this.dashResetter))}R!=="st"&&R!=="gs"&&this.globalData.renderer.ctxFill(z.r),B.restore()}},CVShapeElement.prototype.renderShape=function(P,_,C,A){var T,E=_.length-1,I;for(I=P,T=E;T>=0;T-=1)_[T].ty==="tr"?(I=C[T].transform,this.renderShapeTransform(P,I)):_[T].ty==="sh"||_[T].ty==="el"||_[T].ty==="rc"||_[T].ty==="sr"?this.renderPath(_[T],C[T]):_[T].ty==="fl"?this.renderFill(_[T],C[T],I):_[T].ty==="st"?this.renderStroke(_[T],C[T],I):_[T].ty==="gf"||_[T].ty==="gs"?this.renderGradientFill(_[T],C[T],I):_[T].ty==="gr"?this.renderShape(I,_[T].it,C[T].it):_[T].ty;A&&this.drawLayer()},CVShapeElement.prototype.renderStyledShape=function(P,_){if(this._isFirstFrame||_._mdf||P.transforms._mdf){var C=P.trNodes,A=_.paths,T,E,I,F=A._length;C.length=0;var B=P.transforms.finalTransform;for(I=0;I<F;I+=1){var G=A.shapes[I];if(G&&G.v){for(E=G._length,T=1;T<E;T+=1)T===1&&C.push({t:"m",p:B.applyToPointArray(G.v[0][0],G.v[0][1],0)}),C.push({t:"c",pts:B.applyToTriplePoints(G.o[T-1],G.i[T],G.v[T])});E===1&&C.push({t:"m",p:B.applyToPointArray(G.v[0][0],G.v[0][1],0)}),G.c&&E&&(C.push({t:"c",pts:B.applyToTriplePoints(G.o[T-1],G.i[0],G.v[0])}),C.push({t:"z"}))}}P.trNodes=C}},CVShapeElement.prototype.renderPath=function(P,_){if(P.hd!==!0&&P._shouldRender){var C,A=_.styledShapes.length;for(C=0;C<A;C+=1)this.renderStyledShape(_.styledShapes[C],_.sh)}},CVShapeElement.prototype.renderFill=function(P,_,C){var A=_.style;(_.c._mdf||this._isFirstFrame)&&(A.co="rgb("+bmFloor(_.c.v[0])+","+bmFloor(_.c.v[1])+","+bmFloor(_.c.v[2])+")"),(_.o._mdf||C._opMdf||this._isFirstFrame)&&(A.coOp=_.o.v*C.opacity)},CVShapeElement.prototype.renderGradientFill=function(P,_,C){var A=_.style,T;if(!A.grd||_.g._mdf||_.s._mdf||_.e._mdf||P.t!==1&&(_.h._mdf||_.a._mdf)){var E=this.globalData.canvasContext,I=_.s.v,F=_.e.v;if(P.t===1)T=E.createLinearGradient(I[0],I[1],F[0],F[1]);else{var B=Math.sqrt(Math.pow(I[0]-F[0],2)+Math.pow(I[1]-F[1],2)),G=Math.atan2(F[1]-I[1],F[0]-I[0]),R=_.h.v;R>=1?R=.99:R<=-1&&(R=-.99);var z=B*R,D=Math.cos(G+_.a.v)*z+I[0],L=Math.sin(G+_.a.v)*z+I[1];T=E.createRadialGradient(D,L,0,I[0],I[1],B)}var O,V=P.g.p,U=_.g.c,W=1;for(O=0;O<V;O+=1)_.g._hasOpacity&&_.g._collapsable&&(W=_.g.o[O*2+1]),T.addColorStop(U[O*4]/100,"rgba("+U[O*4+1]+","+U[O*4+2]+","+U[O*4+3]+","+W+")");A.grd=T}A.coOp=_.o.v*C.opacity},CVShapeElement.prototype.renderStroke=function(P,_,C){var A=_.style,T=_.d;T&&(T._mdf||this._isFirstFrame)&&(A.da=T.dashArray,A.do=T.dashoffset[0]),(_.c._mdf||this._isFirstFrame)&&(A.co="rgb("+bmFloor(_.c.v[0])+","+bmFloor(_.c.v[1])+","+bmFloor(_.c.v[2])+")"),(_.o._mdf||C._opMdf||this._isFirstFrame)&&(A.coOp=_.o.v*C.opacity),(_.w._mdf||this._isFirstFrame)&&(A.wi=_.w.v)},CVShapeElement.prototype.destroy=function(){this.shapesData=null,this.globalData=null,this.canvasContext=null,this.stylesList.length=0,this.itemsData.length=0};function CVTextElement(P,_,C){this.textSpans=[],this.yOffset=0,this.fillColorAnim=!1,this.strokeColorAnim=!1,this.strokeWidthAnim=!1,this.stroke=!1,this.fill=!1,this.justifyOffset=0,this.currentRender=null,this.renderType="canvas",this.values={fill:"rgba(0,0,0,0)",stroke:"rgba(0,0,0,0)",sWidth:0,fValue:""},this.initElement(P,_,C)}extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement,ITextElement],CVTextElement),CVTextElement.prototype.tHelper=createTag("canvas").getContext("2d"),CVTextElement.prototype.buildNewText=function(){var P=this.textProperty.currentData;this.renderedLetters=createSizedArray(P.l?P.l.length:0);var _=!1;P.fc?(_=!0,this.values.fill=this.buildColor(P.fc)):this.values.fill="rgba(0,0,0,0)",this.fill=_;var C=!1;P.sc&&(C=!0,this.values.stroke=this.buildColor(P.sc),this.values.sWidth=P.sw);var A=this.globalData.fontManager.getFontByName(P.f),T,E,I=P.l,F=this.mHelper;this.stroke=C,this.values.fValue=P.finalSize+"px "+this.globalData.fontManager.getFontByName(P.f).fFamily,E=P.finalText.length;var B,G,R,z,D,L,O,V,U,W,X=this.data.singleShape,Y=P.tr*.001*P.finalSize,K=0,q=0,J=!0,tt=0;for(T=0;T<E;T+=1){B=this.globalData.fontManager.getCharData(P.finalText[T],A.fStyle,this.globalData.fontManager.getFontByName(P.f).fFamily),G=B&&B.data||{},F.reset(),X&&I[T].n&&(K=-Y,q+=P.yOffset,q+=J?1:0,J=!1),D=G.shapes?G.shapes[0].it:[],O=D.length,F.scale(P.finalSize/100,P.finalSize/100),X&&this.applyTextPropertiesToMatrix(P,F,I[T].line,K,q),U=createSizedArray(O-1);var rt=0;for(L=0;L<O;L+=1)if(D[L].ty==="sh"){for(z=D[L].ks.k.i.length,V=D[L].ks.k,W=[],R=1;R<z;R+=1)R===1&&W.push(F.applyToX(V.v[0][0],V.v[0][1],0),F.applyToY(V.v[0][0],V.v[0][1],0)),W.push(F.applyToX(V.o[R-1][0],V.o[R-1][1],0),F.applyToY(V.o[R-1][0],V.o[R-1][1],0),F.applyToX(V.i[R][0],V.i[R][1],0),F.applyToY(V.i[R][0],V.i[R][1],0),F.applyToX(V.v[R][0],V.v[R][1],0),F.applyToY(V.v[R][0],V.v[R][1],0));W.push(F.applyToX(V.o[R-1][0],V.o[R-1][1],0),F.applyToY(V.o[R-1][0],V.o[R-1][1],0),F.applyToX(V.i[0][0],V.i[0][1],0),F.applyToY(V.i[0][0],V.i[0][1],0),F.applyToX(V.v[0][0],V.v[0][1],0),F.applyToY(V.v[0][0],V.v[0][1],0)),U[rt]=W,rt+=1}X&&(K+=I[T].l,K+=Y),this.textSpans[tt]?this.textSpans[tt].elem=U:this.textSpans[tt]={elem:U},tt+=1}},CVTextElement.prototype.renderInnerContent=function(){this.validateText();var P=this.canvasContext;P.font=this.values.fValue,this.globalData.renderer.ctxLineCap("butt"),this.globalData.renderer.ctxLineJoin("miter"),this.globalData.renderer.ctxMiterLimit(4),this.data.singleShape||this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag);var _,C,A,T,E,I,F=this.textAnimator.renderedLetters,B=this.textProperty.currentData.l;C=B.length;var G,R=null,z=null,D=null,L,O,V=this.globalData.renderer;for(_=0;_<C;_+=1)if(!B[_].n){if(G=F[_],G&&(V.save(),V.ctxTransform(G.p),V.ctxOpacity(G.o)),this.fill){for(G&&G.fc?R!==G.fc&&(V.ctxFillStyle(G.fc),R=G.fc):R!==this.values.fill&&(R=this.values.fill,V.ctxFillStyle(this.values.fill)),L=this.textSpans[_].elem,T=L.length,this.globalData.canvasContext.beginPath(),A=0;A<T;A+=1)for(O=L[A],I=O.length,this.globalData.canvasContext.moveTo(O[0],O[1]),E=2;E<I;E+=6)this.globalData.canvasContext.bezierCurveTo(O[E],O[E+1],O[E+2],O[E+3],O[E+4],O[E+5]);this.globalData.canvasContext.closePath(),V.ctxFill()}if(this.stroke){for(G&&G.sw?D!==G.sw&&(D=G.sw,V.ctxLineWidth(G.sw)):D!==this.values.sWidth&&(D=this.values.sWidth,V.ctxLineWidth(this.values.sWidth)),G&&G.sc?z!==G.sc&&(z=G.sc,V.ctxStrokeStyle(G.sc)):z!==this.values.stroke&&(z=this.values.stroke,V.ctxStrokeStyle(this.values.stroke)),L=this.textSpans[_].elem,T=L.length,this.globalData.canvasContext.beginPath(),A=0;A<T;A+=1)for(O=L[A],I=O.length,this.globalData.canvasContext.moveTo(O[0],O[1]),E=2;E<I;E+=6)this.globalData.canvasContext.bezierCurveTo(O[E],O[E+1],O[E+2],O[E+3],O[E+4],O[E+5]);this.globalData.canvasContext.closePath(),V.ctxStroke()}G&&this.globalData.renderer.restore()}};function CVImageElement(P,_,C){this.assetData=_.getAssetData(P.refId),this.img=_.imageLoader.getAsset(this.assetData),this.initElement(P,_,C)}extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement],CVImageElement),CVImageElement.prototype.initElement=SVGShapeElement.prototype.initElement,CVImageElement.prototype.prepareFrame=IImageElement.prototype.prepareFrame,CVImageElement.prototype.createContent=function(){if(this.img.width&&(this.assetData.w!==this.img.width||this.assetData.h!==this.img.height)){var P=createTag("canvas");P.width=this.assetData.w,P.height=this.assetData.h;var _=P.getContext("2d"),C=this.img.width,A=this.img.height,T=C/A,E=this.assetData.w/this.assetData.h,I,F,B=this.assetData.pr||this.globalData.renderConfig.imagePreserveAspectRatio;T>E&&B==="xMidYMid slice"||T<E&&B!=="xMidYMid slice"?(F=A,I=F*E):(I=C,F=I/E),_.drawImage(this.img,(C-I)/2,(A-F)/2,I,F,0,0,this.assetData.w,this.assetData.h),this.img=P}},CVImageElement.prototype.renderInnerContent=function(){this.canvasContext.drawImage(this.img,0,0)},CVImageElement.prototype.destroy=function(){this.img=null};function CVSolidElement(P,_,C){this.initElement(P,_,C)}extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement],CVSolidElement),CVSolidElement.prototype.initElement=SVGShapeElement.prototype.initElement,CVSolidElement.prototype.prepareFrame=IImageElement.prototype.prepareFrame,CVSolidElement.prototype.renderInnerContent=function(){this.globalData.renderer.ctxFillStyle(this.data.sc),this.globalData.renderer.ctxFillRect(0,0,this.data.sw,this.data.sh)};function CanvasRendererBase(){}extendPrototype([BaseRenderer],CanvasRendererBase),CanvasRendererBase.prototype.createShape=function(P){return new CVShapeElement(P,this.globalData,this)},CanvasRendererBase.prototype.createText=function(P){return new CVTextElement(P,this.globalData,this)},CanvasRendererBase.prototype.createImage=function(P){return new CVImageElement(P,this.globalData,this)},CanvasRendererBase.prototype.createSolid=function(P){return new CVSolidElement(P,this.globalData,this)},CanvasRendererBase.prototype.createNull=SVGRenderer.prototype.createNull,CanvasRendererBase.prototype.ctxTransform=function(P){P[0]===1&&P[1]===0&&P[4]===0&&P[5]===1&&P[12]===0&&P[13]===0||this.canvasContext.transform(P[0],P[1],P[4],P[5],P[12],P[13])},CanvasRendererBase.prototype.ctxOpacity=function(P){this.canvasContext.globalAlpha*=P<0?0:P},CanvasRendererBase.prototype.ctxFillStyle=function(P){this.canvasContext.fillStyle=P},CanvasRendererBase.prototype.ctxStrokeStyle=function(P){this.canvasContext.strokeStyle=P},CanvasRendererBase.prototype.ctxLineWidth=function(P){this.canvasContext.lineWidth=P},CanvasRendererBase.prototype.ctxLineCap=function(P){this.canvasContext.lineCap=P},CanvasRendererBase.prototype.ctxLineJoin=function(P){this.canvasContext.lineJoin=P},CanvasRendererBase.prototype.ctxMiterLimit=function(P){this.canvasContext.miterLimit=P},CanvasRendererBase.prototype.ctxFill=function(P){this.canvasContext.fill(P)},CanvasRendererBase.prototype.ctxFillRect=function(P,_,C,A){this.canvasContext.fillRect(P,_,C,A)},CanvasRendererBase.prototype.ctxStroke=function(){this.canvasContext.stroke()},CanvasRendererBase.prototype.reset=function(){if(!this.renderConfig.clearCanvas){this.canvasContext.restore();return}this.contextData.reset()},CanvasRendererBase.prototype.save=function(){this.canvasContext.save()},CanvasRendererBase.prototype.restore=function(P){if(!this.renderConfig.clearCanvas){this.canvasContext.restore();return}P&&(this.globalData.blendMode="source-over"),this.contextData.restore(P)},CanvasRendererBase.prototype.configAnimation=function(P){if(this.animationItem.wrapper){this.animationItem.container=createTag("canvas");var _=this.animationItem.container.style;_.width="100%",_.height="100%";var C="0px 0px 0px";_.transformOrigin=C,_.mozTransformOrigin=C,_.webkitTransformOrigin=C,_["-webkit-transform"]=C,_.contentVisibility=this.renderConfig.contentVisibility,this.animationItem.wrapper.appendChild(this.animationItem.container),this.canvasContext=this.animationItem.container.getContext("2d"),this.renderConfig.className&&this.animationItem.container.setAttribute("class",this.renderConfig.className),this.renderConfig.id&&this.animationItem.container.setAttribute("id",this.renderConfig.id)}else this.canvasContext=this.renderConfig.context;this.contextData.setContext(this.canvasContext),this.data=P,this.layers=P.layers,this.transformCanvas={w:P.w,h:P.h,sx:0,sy:0,tx:0,ty:0},this.setupGlobalData(P,document.body),this.globalData.canvasContext=this.canvasContext,this.globalData.renderer=this,this.globalData.isDashed=!1,this.globalData.progressiveLoad=this.renderConfig.progressiveLoad,this.globalData.transformCanvas=this.transformCanvas,this.elements=createSizedArray(P.layers.length),this.updateContainerSize()},CanvasRendererBase.prototype.updateContainerSize=function(P,_){this.reset();var C,A;P?(C=P,A=_,this.canvasContext.canvas.width=C,this.canvasContext.canvas.height=A):(this.animationItem.wrapper&&this.animationItem.container?(C=this.animationItem.wrapper.offsetWidth,A=this.animationItem.wrapper.offsetHeight):(C=this.canvasContext.canvas.width,A=this.canvasContext.canvas.height),this.canvasContext.canvas.width=C*this.renderConfig.dpr,this.canvasContext.canvas.height=A*this.renderConfig.dpr);var T,E;if(this.renderConfig.preserveAspectRatio.indexOf("meet")!==-1||this.renderConfig.preserveAspectRatio.indexOf("slice")!==-1){var I=this.renderConfig.preserveAspectRatio.split(" "),F=I[1]||"meet",B=I[0]||"xMidYMid",G=B.substr(0,4),R=B.substr(4);T=C/A,E=this.transformCanvas.w/this.transformCanvas.h,E>T&&F==="meet"||E<T&&F==="slice"?(this.transformCanvas.sx=C/(this.transformCanvas.w/this.renderConfig.dpr),this.transformCanvas.sy=C/(this.transformCanvas.w/this.renderConfig.dpr)):(this.transformCanvas.sx=A/(this.transformCanvas.h/this.renderConfig.dpr),this.transformCanvas.sy=A/(this.transformCanvas.h/this.renderConfig.dpr)),G==="xMid"&&(E<T&&F==="meet"||E>T&&F==="slice")?this.transformCanvas.tx=(C-this.transformCanvas.w*(A/this.transformCanvas.h))/2*this.renderConfig.dpr:G==="xMax"&&(E<T&&F==="meet"||E>T&&F==="slice")?this.transformCanvas.tx=(C-this.transformCanvas.w*(A/this.transformCanvas.h))*this.renderConfig.dpr:this.transformCanvas.tx=0,R==="YMid"&&(E>T&&F==="meet"||E<T&&F==="slice")?this.transformCanvas.ty=(A-this.transformCanvas.h*(C/this.transformCanvas.w))/2*this.renderConfig.dpr:R==="YMax"&&(E>T&&F==="meet"||E<T&&F==="slice")?this.transformCanvas.ty=(A-this.transformCanvas.h*(C/this.transformCanvas.w))*this.renderConfig.dpr:this.transformCanvas.ty=0}else this.renderConfig.preserveAspectRatio==="none"?(this.transformCanvas.sx=C/(this.transformCanvas.w/this.renderConfig.dpr),this.transformCanvas.sy=A/(this.transformCanvas.h/this.renderConfig.dpr),this.transformCanvas.tx=0,this.transformCanvas.ty=0):(this.transformCanvas.sx=this.renderConfig.dpr,this.transformCanvas.sy=this.renderConfig.dpr,this.transformCanvas.tx=0,this.transformCanvas.ty=0);this.transformCanvas.props=[this.transformCanvas.sx,0,0,0,0,this.transformCanvas.sy,0,0,0,0,1,0,this.transformCanvas.tx,this.transformCanvas.ty,0,1],this.ctxTransform(this.transformCanvas.props),this.canvasContext.beginPath(),this.canvasContext.rect(0,0,this.transformCanvas.w,this.transformCanvas.h),this.canvasContext.closePath(),this.canvasContext.clip(),this.renderFrame(this.renderedFrame,!0)},CanvasRendererBase.prototype.destroy=function(){this.renderConfig.clearCanvas&&this.animationItem.wrapper&&(this.animationItem.wrapper.innerText="");var P,_=this.layers?this.layers.length:0;for(P=_-1;P>=0;P-=1)this.elements[P]&&this.elements[P].destroy&&this.elements[P].destroy();this.elements.length=0,this.globalData.canvasContext=null,this.animationItem.container=null,this.destroyed=!0},CanvasRendererBase.prototype.renderFrame=function(P,_){if(!(this.renderedFrame===P&&this.renderConfig.clearCanvas===!0&&!_||this.destroyed||P===-1)){this.renderedFrame=P,this.globalData.frameNum=P-this.animationItem._isFirstFrame,this.globalData.frameId+=1,this.globalData._mdf=!this.renderConfig.clearCanvas||_,this.globalData.projectInterface.currentFrame=P;var C,A=this.layers.length;for(this.completeLayers||this.checkLayers(P),C=A-1;C>=0;C-=1)(this.completeLayers||this.elements[C])&&this.elements[C].prepareFrame(P-this.layers[C].st);if(this.globalData._mdf){for(this.renderConfig.clearCanvas===!0?this.canvasContext.clearRect(0,0,this.transformCanvas.w,this.transformCanvas.h):this.save(),C=A-1;C>=0;C-=1)(this.completeLayers||this.elements[C])&&this.elements[C].renderFrame();this.renderConfig.clearCanvas!==!0&&this.restore()}}},CanvasRendererBase.prototype.buildItem=function(P){var _=this.elements;if(!(_[P]||this.layers[P].ty===99)){var C=this.createItem(this.layers[P],this,this.globalData);_[P]=C,C.initExpressions()}},CanvasRendererBase.prototype.checkPendingElements=function(){for(;this.pendingElements.length;){var P=this.pendingElements.pop();P.checkParenting()}},CanvasRendererBase.prototype.hide=function(){this.animationItem.container.style.display="none"},CanvasRendererBase.prototype.show=function(){this.animationItem.container.style.display="block"};function CanvasContext(){this.opacity=-1,this.transform=createTypedArray("float32",16),this.fillStyle="",this.strokeStyle="",this.lineWidth="",this.lineCap="",this.lineJoin="",this.miterLimit="",this.id=Math.random()}function CVContextData(){this.stack=[],this.cArrPos=0,this.cTr=new Matrix;var P,_=15;for(P=0;P<_;P+=1){var C=new CanvasContext;this.stack[P]=C}this._length=_,this.nativeContext=null,this.transformMat=new Matrix,this.currentOpacity=1,this.currentFillStyle="",this.appliedFillStyle="",this.currentStrokeStyle="",this.appliedStrokeStyle="",this.currentLineWidth="",this.appliedLineWidth="",this.currentLineCap="",this.appliedLineCap="",this.currentLineJoin="",this.appliedLineJoin="",this.appliedMiterLimit="",this.currentMiterLimit=""}CVContextData.prototype.duplicate=function(){var P=this._length*2,_=0;for(_=this._length;_<P;_+=1)this.stack[_]=new CanvasContext;this._length=P},CVContextData.prototype.reset=function(){this.cArrPos=0,this.cTr.reset(),this.stack[this.cArrPos].opacity=1},CVContextData.prototype.restore=function(P){this.cArrPos-=1;var _=this.stack[this.cArrPos],C=_.transform,A,T=this.cTr.props;for(A=0;A<16;A+=1)T[A]=C[A];if(P){this.nativeContext.restore();var E=this.stack[this.cArrPos+1];this.appliedFillStyle=E.fillStyle,this.appliedStrokeStyle=E.strokeStyle,this.appliedLineWidth=E.lineWidth,this.appliedLineCap=E.lineCap,this.appliedLineJoin=E.lineJoin,this.appliedMiterLimit=E.miterLimit}this.nativeContext.setTransform(C[0],C[1],C[4],C[5],C[12],C[13]),(P||_.opacity!==-1&&this.currentOpacity!==_.opacity)&&(this.nativeContext.globalAlpha=_.opacity,this.currentOpacity=_.opacity),this.currentFillStyle=_.fillStyle,this.currentStrokeStyle=_.strokeStyle,this.currentLineWidth=_.lineWidth,this.currentLineCap=_.lineCap,this.currentLineJoin=_.lineJoin,this.currentMiterLimit=_.miterLimit},CVContextData.prototype.save=function(P){P&&this.nativeContext.save();var _=this.cTr.props;this._length<=this.cArrPos&&this.duplicate();var C=this.stack[this.cArrPos],A;for(A=0;A<16;A+=1)C.transform[A]=_[A];this.cArrPos+=1;var T=this.stack[this.cArrPos];T.opacity=C.opacity,T.fillStyle=C.fillStyle,T.strokeStyle=C.strokeStyle,T.lineWidth=C.lineWidth,T.lineCap=C.lineCap,T.lineJoin=C.lineJoin,T.miterLimit=C.miterLimit},CVContextData.prototype.setOpacity=function(P){this.stack[this.cArrPos].opacity=P},CVContextData.prototype.setContext=function(P){this.nativeContext=P},CVContextData.prototype.fillStyle=function(P){this.stack[this.cArrPos].fillStyle!==P&&(this.currentFillStyle=P,this.stack[this.cArrPos].fillStyle=P)},CVContextData.prototype.strokeStyle=function(P){this.stack[this.cArrPos].strokeStyle!==P&&(this.currentStrokeStyle=P,this.stack[this.cArrPos].strokeStyle=P)},CVContextData.prototype.lineWidth=function(P){this.stack[this.cArrPos].lineWidth!==P&&(this.currentLineWidth=P,this.stack[this.cArrPos].lineWidth=P)},CVContextData.prototype.lineCap=function(P){this.stack[this.cArrPos].lineCap!==P&&(this.currentLineCap=P,this.stack[this.cArrPos].lineCap=P)},CVContextData.prototype.lineJoin=function(P){this.stack[this.cArrPos].lineJoin!==P&&(this.currentLineJoin=P,this.stack[this.cArrPos].lineJoin=P)},CVContextData.prototype.miterLimit=function(P){this.stack[this.cArrPos].miterLimit!==P&&(this.currentMiterLimit=P,this.stack[this.cArrPos].miterLimit=P)},CVContextData.prototype.transform=function(P){this.transformMat.cloneFromProps(P);var _=this.cTr;this.transformMat.multiply(_),_.cloneFromProps(this.transformMat.props);var C=_.props;this.nativeContext.setTransform(C[0],C[1],C[4],C[5],C[12],C[13])},CVContextData.prototype.opacity=function(P){var _=this.stack[this.cArrPos].opacity;_*=P<0?0:P,this.stack[this.cArrPos].opacity!==_&&(this.currentOpacity!==P&&(this.nativeContext.globalAlpha=P,this.currentOpacity=P),this.stack[this.cArrPos].opacity=_)},CVContextData.prototype.fill=function(P){this.appliedFillStyle!==this.currentFillStyle&&(this.appliedFillStyle=this.currentFillStyle,this.nativeContext.fillStyle=this.appliedFillStyle),this.nativeContext.fill(P)},CVContextData.prototype.fillRect=function(P,_,C,A){this.appliedFillStyle!==this.currentFillStyle&&(this.appliedFillStyle=this.currentFillStyle,this.nativeContext.fillStyle=this.appliedFillStyle),this.nativeContext.fillRect(P,_,C,A)},CVContextData.prototype.stroke=function(){this.appliedStrokeStyle!==this.currentStrokeStyle&&(this.appliedStrokeStyle=this.currentStrokeStyle,this.nativeContext.strokeStyle=this.appliedStrokeStyle),this.appliedLineWidth!==this.currentLineWidth&&(this.appliedLineWidth=this.currentLineWidth,this.nativeContext.lineWidth=this.appliedLineWidth),this.appliedLineCap!==this.currentLineCap&&(this.appliedLineCap=this.currentLineCap,this.nativeContext.lineCap=this.appliedLineCap),this.appliedLineJoin!==this.currentLineJoin&&(this.appliedLineJoin=this.currentLineJoin,this.nativeContext.lineJoin=this.appliedLineJoin),this.appliedMiterLimit!==this.currentMiterLimit&&(this.appliedMiterLimit=this.currentMiterLimit,this.nativeContext.miterLimit=this.appliedMiterLimit),this.nativeContext.stroke()};function CVCompElement(P,_,C){this.completeLayers=!1,this.layers=P.layers,this.pendingElements=[],this.elements=createSizedArray(this.layers.length),this.initElement(P,_,C),this.tm=P.tm?PropertyFactory.getProp(this,P.tm,0,_.frameRate,this):{_placeholder:!0}}extendPrototype([CanvasRendererBase,ICompElement,CVBaseElement],CVCompElement),CVCompElement.prototype.renderInnerContent=function(){var P=this.canvasContext;P.beginPath(),P.moveTo(0,0),P.lineTo(this.data.w,0),P.lineTo(this.data.w,this.data.h),P.lineTo(0,this.data.h),P.lineTo(0,0),P.clip();var _,C=this.layers.length;for(_=C-1;_>=0;_-=1)(this.completeLayers||this.elements[_])&&this.elements[_].renderFrame()},CVCompElement.prototype.destroy=function(){var P,_=this.layers.length;for(P=_-1;P>=0;P-=1)this.elements[P]&&this.elements[P].destroy();this.layers=null,this.elements=null},CVCompElement.prototype.createComp=function(P){return new CVCompElement(P,this.globalData,this)};function CanvasRenderer(P,_){this.animationItem=P,this.renderConfig={clearCanvas:_&&_.clearCanvas!==void 0?_.clearCanvas:!0,context:_&&_.context||null,progressiveLoad:_&&_.progressiveLoad||!1,preserveAspectRatio:_&&_.preserveAspectRatio||"xMidYMid meet",imagePreserveAspectRatio:_&&_.imagePreserveAspectRatio||"xMidYMid slice",contentVisibility:_&&_.contentVisibility||"visible",className:_&&_.className||"",id:_&&_.id||"",runExpressions:!_||_.runExpressions===void 0||_.runExpressions},this.renderConfig.dpr=_&&_.dpr||1,this.animationItem.wrapper&&(this.renderConfig.dpr=_&&_.dpr||window.devicePixelRatio||1),this.renderedFrame=-1,this.globalData={frameNum:-1,_mdf:!1,renderConfig:this.renderConfig,currentGlobalAlpha:-1},this.contextData=new CVContextData,this.elements=[],this.pendingElements=[],this.transformMat=new Matrix,this.completeLayers=!1,this.rendererType="canvas",this.renderConfig.clearCanvas&&(this.ctxTransform=this.contextData.transform.bind(this.contextData),this.ctxOpacity=this.contextData.opacity.bind(this.contextData),this.ctxFillStyle=this.contextData.fillStyle.bind(this.contextData),this.ctxStrokeStyle=this.contextData.strokeStyle.bind(this.contextData),this.ctxLineWidth=this.contextData.lineWidth.bind(this.contextData),this.ctxLineCap=this.contextData.lineCap.bind(this.contextData),this.ctxLineJoin=this.contextData.lineJoin.bind(this.contextData),this.ctxMiterLimit=this.contextData.miterLimit.bind(this.contextData),this.ctxFill=this.contextData.fill.bind(this.contextData),this.ctxFillRect=this.contextData.fillRect.bind(this.contextData),this.ctxStroke=this.contextData.stroke.bind(this.contextData),this.save=this.contextData.save.bind(this.contextData))}extendPrototype([CanvasRendererBase],CanvasRenderer),CanvasRenderer.prototype.createComp=function(P){return new CVCompElement(P,this.globalData,this)};function HBaseElement(){}HBaseElement.prototype={checkBlendMode:function(){},initRendererElement:function(){this.baseElement=createTag(this.data.tg||"div"),this.data.hasMask?(this.svgElement=createNS("svg"),this.layerElement=createNS("g"),this.maskedElement=this.layerElement,this.svgElement.appendChild(this.layerElement),this.baseElement.appendChild(this.svgElement)):this.layerElement=this.baseElement,styleDiv(this.baseElement)},createContainerElements:function(){this.renderableEffectsManager=new CVEffects(this),this.transformedElement=this.baseElement,this.maskedElement=this.layerElement,this.data.ln&&this.layerElement.setAttribute("id",this.data.ln),this.data.cl&&this.layerElement.setAttribute("class",this.data.cl),this.data.bm!==0&&this.setBlendMode()},renderElement:function(){var _=this.transformedElement?this.transformedElement.style:{};if(this.finalTransform._matMdf){var C=this.finalTransform.mat.toCSS();_.transform=C,_.webkitTransform=C}this.finalTransform._opMdf&&(_.opacity=this.finalTransform.mProp.o.v)},renderFrame:function(){this.data.hd||this.hidden||(this.renderTransform(),this.renderRenderable(),this.renderElement(),this.renderInnerContent(),this._isFirstFrame&&(this._isFirstFrame=!1))},destroy:function(){this.layerElement=null,this.transformedElement=null,this.matteElement&&(this.matteElement=null),this.maskManager&&(this.maskManager.destroy(),this.maskManager=null)},createRenderableComponents:function(){this.maskManager=new MaskElement(this.data,this,this.globalData)},addEffects:function(){},setMatte:function(){}},HBaseElement.prototype.getBaseElement=SVGBaseElement.prototype.getBaseElement,HBaseElement.prototype.destroyBaseElement=HBaseElement.prototype.destroy,HBaseElement.prototype.buildElementParenting=BaseRenderer.prototype.buildElementParenting;function HSolidElement(P,_,C){this.initElement(P,_,C)}extendPrototype([BaseElement,TransformElement,HBaseElement,HierarchyElement,FrameElement,RenderableDOMElement],HSolidElement),HSolidElement.prototype.createContent=function(){var P;this.data.hasMask?(P=createNS("rect"),P.setAttribute("width",this.data.sw),P.setAttribute("height",this.data.sh),P.setAttribute("fill",this.data.sc),this.svgElement.setAttribute("width",this.data.sw),this.svgElement.setAttribute("height",this.data.sh)):(P=createTag("div"),P.style.width=this.data.sw+"px",P.style.height=this.data.sh+"px",P.style.backgroundColor=this.data.sc),this.layerElement.appendChild(P)};function HShapeElement(P,_,C){this.shapes=[],this.shapesData=P.shapes,this.stylesList=[],this.shapeModifiers=[],this.itemsData=[],this.processedElements=[],this.animatedContents=[],this.shapesContainer=createNS("g"),this.initElement(P,_,C),this.prevViewData=[],this.currentBBox={x:999999,y:-999999,h:0,w:0}}extendPrototype([BaseElement,TransformElement,HSolidElement,SVGShapeElement,HBaseElement,HierarchyElement,FrameElement,RenderableElement],HShapeElement),HShapeElement.prototype._renderShapeFrame=HShapeElement.prototype.renderInnerContent,HShapeElement.prototype.createContent=function(){var P;if(this.baseElement.style.fontSize=0,this.data.hasMask)this.layerElement.appendChild(this.shapesContainer),P=this.svgElement;else{P=createNS("svg");var _=this.comp.data?this.comp.data:this.globalData.compSize;P.setAttribute("width",_.w),P.setAttribute("height",_.h),P.appendChild(this.shapesContainer),this.layerElement.appendChild(P)}this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.shapesContainer,0,[],!0),this.filterUniqueShapes(),this.shapeCont=P},HShapeElement.prototype.getTransformedPoint=function(P,_){var C,A=P.length;for(C=0;C<A;C+=1)_=P[C].mProps.v.applyToPointArray(_[0],_[1],0);return _},HShapeElement.prototype.calculateShapeBoundingBox=function(P,_){var C=P.sh.v,A=P.transformers,T,E=C._length,I,F,B,G;if(!(E<=1)){for(T=0;T<E-1;T+=1)I=this.getTransformedPoint(A,C.v[T]),F=this.getTransformedPoint(A,C.o[T]),B=this.getTransformedPoint(A,C.i[T+1]),G=this.getTransformedPoint(A,C.v[T+1]),this.checkBounds(I,F,B,G,_);C.c&&(I=this.getTransformedPoint(A,C.v[T]),F=this.getTransformedPoint(A,C.o[T]),B=this.getTransformedPoint(A,C.i[0]),G=this.getTransformedPoint(A,C.v[0]),this.checkBounds(I,F,B,G,_))}},HShapeElement.prototype.checkBounds=function(P,_,C,A,T){this.getBoundsOfCurve(P,_,C,A);var E=this.shapeBoundingBox;T.x=bmMin(E.left,T.x),T.xMax=bmMax(E.right,T.xMax),T.y=bmMin(E.top,T.y),T.yMax=bmMax(E.bottom,T.yMax)},HShapeElement.prototype.shapeBoundingBox={left:0,right:0,top:0,bottom:0},HShapeElement.prototype.tempBoundingBox={x:0,xMax:0,y:0,yMax:0,width:0,height:0},HShapeElement.prototype.getBoundsOfCurve=function(P,_,C,A){for(var T=[[P[0],A[0]],[P[1],A[1]]],E,I,F,B,G,R,z,D=0;D<2;++D)I=6*P[D]-12*_[D]+6*C[D],E=-3*P[D]+9*_[D]-9*C[D]+3*A[D],F=3*_[D]-3*P[D],I|=0,E|=0,F|=0,E===0&&I===0||(E===0?(B=-F/I,B>0&&B<1&&T[D].push(this.calculateF(B,P,_,C,A,D))):(G=I*I-4*F*E,G>=0&&(R=(-I+bmSqrt(G))/(2*E),R>0&&R<1&&T[D].push(this.calculateF(R,P,_,C,A,D)),z=(-I-bmSqrt(G))/(2*E),z>0&&z<1&&T[D].push(this.calculateF(z,P,_,C,A,D)))));this.shapeBoundingBox.left=bmMin.apply(null,T[0]),this.shapeBoundingBox.top=bmMin.apply(null,T[1]),this.shapeBoundingBox.right=bmMax.apply(null,T[0]),this.shapeBoundingBox.bottom=bmMax.apply(null,T[1])},HShapeElement.prototype.calculateF=function(P,_,C,A,T,E){return bmPow(1-P,3)*_[E]+3*bmPow(1-P,2)*P*C[E]+3*(1-P)*bmPow(P,2)*A[E]+bmPow(P,3)*T[E]},HShapeElement.prototype.calculateBoundingBox=function(P,_){var C,A=P.length;for(C=0;C<A;C+=1)P[C]&&P[C].sh?this.calculateShapeBoundingBox(P[C],_):P[C]&&P[C].it?this.calculateBoundingBox(P[C].it,_):P[C]&&P[C].style&&P[C].w&&this.expandStrokeBoundingBox(P[C].w,_)},HShapeElement.prototype.expandStrokeBoundingBox=function(P,_){var C=0;if(P.keyframes){for(var A=0;A<P.keyframes.length;A+=1){var T=P.keyframes[A].s;T>C&&(C=T)}C*=P.mult}else C=P.v*P.mult;_.x-=C,_.xMax+=C,_.y-=C,_.yMax+=C},HShapeElement.prototype.currentBoxContains=function(P){return this.currentBBox.x<=P.x&&this.currentBBox.y<=P.y&&this.currentBBox.width+this.currentBBox.x>=P.x+P.width&&this.currentBBox.height+this.currentBBox.y>=P.y+P.height},HShapeElement.prototype.renderInnerContent=function(){if(this._renderShapeFrame(),!this.hidden&&(this._isFirstFrame||this._mdf)){var P=this.tempBoundingBox,_=999999;if(P.x=_,P.xMax=-_,P.y=_,P.yMax=-_,this.calculateBoundingBox(this.itemsData,P),P.width=P.xMax<P.x?0:P.xMax-P.x,P.height=P.yMax<P.y?0:P.yMax-P.y,this.currentBoxContains(P))return;var C=!1;if(this.currentBBox.w!==P.width&&(this.currentBBox.w=P.width,this.shapeCont.setAttribute("width",P.width),C=!0),this.currentBBox.h!==P.height&&(this.currentBBox.h=P.height,this.shapeCont.setAttribute("height",P.height),C=!0),C||this.currentBBox.x!==P.x||this.currentBBox.y!==P.y){this.currentBBox.w=P.width,this.currentBBox.h=P.height,this.currentBBox.x=P.x,this.currentBBox.y=P.y,this.shapeCont.setAttribute("viewBox",this.currentBBox.x+" "+this.currentBBox.y+" "+this.currentBBox.w+" "+this.currentBBox.h);var A=this.shapeCont.style,T="translate("+this.currentBBox.x+"px,"+this.currentBBox.y+"px)";A.transform=T,A.webkitTransform=T}}};function HTextElement(P,_,C){this.textSpans=[],this.textPaths=[],this.currentBBox={x:999999,y:-999999,h:0,w:0},this.renderType="svg",this.isMasked=!1,this.initElement(P,_,C)}extendPrototype([BaseElement,TransformElement,HBaseElement,HierarchyElement,FrameElement,RenderableDOMElement,ITextElement],HTextElement),HTextElement.prototype.createContent=function(){if(this.isMasked=this.checkMasks(),this.isMasked){this.renderType="svg",this.compW=this.comp.data.w,this.compH=this.comp.data.h,this.svgElement.setAttribute("width",this.compW),this.svgElement.setAttribute("height",this.compH);var P=createNS("g");this.maskedElement.appendChild(P),this.innerElem=P}else this.renderType="html",this.innerElem=this.layerElement;this.checkParenting()},HTextElement.prototype.buildNewText=function(){var P=this.textProperty.currentData;this.renderedLetters=createSizedArray(P.l?P.l.length:0);var _=this.innerElem.style,C=P.fc?this.buildColor(P.fc):"rgba(0,0,0,0)";_.fill=C,_.color=C,P.sc&&(_.stroke=this.buildColor(P.sc),_.strokeWidth=P.sw+"px");var A=this.globalData.fontManager.getFontByName(P.f);if(!this.globalData.fontManager.chars)if(_.fontSize=P.finalSize+"px",_.lineHeight=P.finalSize+"px",A.fClass)this.innerElem.className=A.fClass;else{_.fontFamily=A.fFamily;var T=P.fWeight,E=P.fStyle;_.fontStyle=E,_.fontWeight=T}var I,F,B=P.l;F=B.length;var G,R,z,D=this.mHelper,L,O="",V=0;for(I=0;I<F;I+=1){if(this.globalData.fontManager.chars?(this.textPaths[V]?G=this.textPaths[V]:(G=createNS("path"),G.setAttribute("stroke-linecap",lineCapEnum[1]),G.setAttribute("stroke-linejoin",lineJoinEnum[2]),G.setAttribute("stroke-miterlimit","4")),this.isMasked||(this.textSpans[V]?(R=this.textSpans[V],z=R.children[0]):(R=createTag("div"),R.style.lineHeight=0,z=createNS("svg"),z.appendChild(G),styleDiv(R)))):this.isMasked?G=this.textPaths[V]?this.textPaths[V]:createNS("text"):this.textSpans[V]?(R=this.textSpans[V],G=this.textPaths[V]):(R=createTag("span"),styleDiv(R),G=createTag("span"),styleDiv(G),R.appendChild(G)),this.globalData.fontManager.chars){var U=this.globalData.fontManager.getCharData(P.finalText[I],A.fStyle,this.globalData.fontManager.getFontByName(P.f).fFamily),W;if(U?W=U.data:W=null,D.reset(),W&&W.shapes&&W.shapes.length&&(L=W.shapes[0].it,D.scale(P.finalSize/100,P.finalSize/100),O=this.createPathShape(D,L),G.setAttribute("d",O)),this.isMasked)this.innerElem.appendChild(G);else{if(this.innerElem.appendChild(R),W&&W.shapes){document.body.appendChild(z);var X=z.getBBox();z.setAttribute("width",X.width+2),z.setAttribute("height",X.height+2),z.setAttribute("viewBox",X.x-1+" "+(X.y-1)+" "+(X.width+2)+" "+(X.height+2));var Y=z.style,K="translate("+(X.x-1)+"px,"+(X.y-1)+"px)";Y.transform=K,Y.webkitTransform=K,B[I].yOffset=X.y-1}else z.setAttribute("width",1),z.setAttribute("height",1);R.appendChild(z)}}else if(G.textContent=B[I].val,G.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),this.isMasked)this.innerElem.appendChild(G);else{this.innerElem.appendChild(R);var q=G.style,J="translate3d(0,"+-P.finalSize/1.2+"px,0)";q.transform=J,q.webkitTransform=J}this.isMasked?this.textSpans[V]=G:this.textSpans[V]=R,this.textSpans[V].style.display="block",this.textPaths[V]=G,V+=1}for(;V<this.textSpans.length;)this.textSpans[V].style.display="none",V+=1},HTextElement.prototype.renderInnerContent=function(){this.validateText();var P;if(this.data.singleShape){if(!this._isFirstFrame&&!this.lettersChangedFlag)return;if(this.isMasked&&this.finalTransform._matMdf){this.svgElement.setAttribute("viewBox",-this.finalTransform.mProp.p.v[0]+" "+-this.finalTransform.mProp.p.v[1]+" "+this.compW+" "+this.compH),P=this.svgElement.style;var _="translate("+-this.finalTransform.mProp.p.v[0]+"px,"+-this.finalTransform.mProp.p.v[1]+"px)";P.transform=_,P.webkitTransform=_}}if(this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag),!(!this.lettersChangedFlag&&!this.textAnimator.lettersChangedFlag)){var C,A,T=0,E=this.textAnimator.renderedLetters,I=this.textProperty.currentData.l;A=I.length;var F,B,G;for(C=0;C<A;C+=1)I[C].n?T+=1:(B=this.textSpans[C],G=this.textPaths[C],F=E[T],T+=1,F._mdf.m&&(this.isMasked?B.setAttribute("transform",F.m):(B.style.webkitTransform=F.m,B.style.transform=F.m)),B.style.opacity=F.o,F.sw&&F._mdf.sw&&G.setAttribute("stroke-width",F.sw),F.sc&&F._mdf.sc&&G.setAttribute("stroke",F.sc),F.fc&&F._mdf.fc&&(G.setAttribute("fill",F.fc),G.style.color=F.fc));if(this.innerElem.getBBox&&!this.hidden&&(this._isFirstFrame||this._mdf)){var R=this.innerElem.getBBox();this.currentBBox.w!==R.width&&(this.currentBBox.w=R.width,this.svgElement.setAttribute("width",R.width)),this.currentBBox.h!==R.height&&(this.currentBBox.h=R.height,this.svgElement.setAttribute("height",R.height));var z=1;if(this.currentBBox.w!==R.width+z*2||this.currentBBox.h!==R.height+z*2||this.currentBBox.x!==R.x-z||this.currentBBox.y!==R.y-z){this.currentBBox.w=R.width+z*2,this.currentBBox.h=R.height+z*2,this.currentBBox.x=R.x-z,this.currentBBox.y=R.y-z,this.svgElement.setAttribute("viewBox",this.currentBBox.x+" "+this.currentBBox.y+" "+this.currentBBox.w+" "+this.currentBBox.h),P=this.svgElement.style;var D="translate("+this.currentBBox.x+"px,"+this.currentBBox.y+"px)";P.transform=D,P.webkitTransform=D}}}};function HCameraElement(P,_,C){this.initFrame(),this.initBaseData(P,_,C),this.initHierarchy();var A=PropertyFactory.getProp;if(this.pe=A(this,P.pe,0,0,this),P.ks.p.s?(this.px=A(this,P.ks.p.x,1,0,this),this.py=A(this,P.ks.p.y,1,0,this),this.pz=A(this,P.ks.p.z,1,0,this)):this.p=A(this,P.ks.p,1,0,this),P.ks.a&&(this.a=A(this,P.ks.a,1,0,this)),P.ks.or.k.length&&P.ks.or.k[0].to){var T,E=P.ks.or.k.length;for(T=0;T<E;T+=1)P.ks.or.k[T].to=null,P.ks.or.k[T].ti=null}this.or=A(this,P.ks.or,1,degToRads,this),this.or.sh=!0,this.rx=A(this,P.ks.rx,0,degToRads,this),this.ry=A(this,P.ks.ry,0,degToRads,this),this.rz=A(this,P.ks.rz,0,degToRads,this),this.mat=new Matrix,this._prevMat=new Matrix,this._isFirstFrame=!0,this.finalTransform={mProp:this}}extendPrototype([BaseElement,FrameElement,HierarchyElement],HCameraElement),HCameraElement.prototype.setup=function(){var P,_=this.comp.threeDElements.length,C,A,T;for(P=0;P<_;P+=1)if(C=this.comp.threeDElements[P],C.type==="3d"){A=C.perspectiveElem.style,T=C.container.style;var E=this.pe.v+"px",I="0px 0px 0px",F="matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)";A.perspective=E,A.webkitPerspective=E,T.transformOrigin=I,T.mozTransformOrigin=I,T.webkitTransformOrigin=I,A.transform=F,A.webkitTransform=F}},HCameraElement.prototype.createElements=function(){},HCameraElement.prototype.hide=function(){},HCameraElement.prototype.renderFrame=function(){var P=this._isFirstFrame,_,C;if(this.hierarchy)for(C=this.hierarchy.length,_=0;_<C;_+=1)P=this.hierarchy[_].finalTransform.mProp._mdf||P;if(P||this.pe._mdf||this.p&&this.p._mdf||this.px&&(this.px._mdf||this.py._mdf||this.pz._mdf)||this.rx._mdf||this.ry._mdf||this.rz._mdf||this.or._mdf||this.a&&this.a._mdf){if(this.mat.reset(),this.hierarchy)for(C=this.hierarchy.length-1,_=C;_>=0;_-=1){var A=this.hierarchy[_].finalTransform.mProp;this.mat.translate(-A.p.v[0],-A.p.v[1],A.p.v[2]),this.mat.rotateX(-A.or.v[0]).rotateY(-A.or.v[1]).rotateZ(A.or.v[2]),this.mat.rotateX(-A.rx.v).rotateY(-A.ry.v).rotateZ(A.rz.v),this.mat.scale(1/A.s.v[0],1/A.s.v[1],1/A.s.v[2]),this.mat.translate(A.a.v[0],A.a.v[1],A.a.v[2])}if(this.p?this.mat.translate(-this.p.v[0],-this.p.v[1],this.p.v[2]):this.mat.translate(-this.px.v,-this.py.v,this.pz.v),this.a){var T;this.p?T=[this.p.v[0]-this.a.v[0],this.p.v[1]-this.a.v[1],this.p.v[2]-this.a.v[2]]:T=[this.px.v-this.a.v[0],this.py.v-this.a.v[1],this.pz.v-this.a.v[2]];var E=Math.sqrt(Math.pow(T[0],2)+Math.pow(T[1],2)+Math.pow(T[2],2)),I=[T[0]/E,T[1]/E,T[2]/E],F=Math.sqrt(I[2]*I[2]+I[0]*I[0]),B=Math.atan2(I[1],F),G=Math.atan2(I[0],-I[2]);this.mat.rotateY(G).rotateX(-B)}this.mat.rotateX(-this.rx.v).rotateY(-this.ry.v).rotateZ(this.rz.v),this.mat.rotateX(-this.or.v[0]).rotateY(-this.or.v[1]).rotateZ(this.or.v[2]),this.mat.translate(this.globalData.compSize.w/2,this.globalData.compSize.h/2,0),this.mat.translate(0,0,this.pe.v);var R=!this._prevMat.equals(this.mat);if((R||this.pe._mdf)&&this.comp.threeDElements){C=this.comp.threeDElements.length;var z,D,L;for(_=0;_<C;_+=1)if(z=this.comp.threeDElements[_],z.type==="3d"){if(R){var O=this.mat.toCSS();L=z.container.style,L.transform=O,L.webkitTransform=O}this.pe._mdf&&(D=z.perspectiveElem.style,D.perspective=this.pe.v+"px",D.webkitPerspective=this.pe.v+"px")}this.mat.clone(this._prevMat)}}this._isFirstFrame=!1},HCameraElement.prototype.prepareFrame=function(P){this.prepareProperties(P,!0)},HCameraElement.prototype.destroy=function(){},HCameraElement.prototype.getBaseElement=function(){return null};function HImageElement(P,_,C){this.assetData=_.getAssetData(P.refId),this.initElement(P,_,C)}extendPrototype([BaseElement,TransformElement,HBaseElement,HSolidElement,HierarchyElement,FrameElement,RenderableElement],HImageElement),HImageElement.prototype.createContent=function(){var P=this.globalData.getAssetsPath(this.assetData),_=new Image;this.data.hasMask?(this.imageElem=createNS("image"),this.imageElem.setAttribute("width",this.assetData.w+"px"),this.imageElem.setAttribute("height",this.assetData.h+"px"),this.imageElem.setAttributeNS("http://www.w3.org/1999/xlink","href",P),this.layerElement.appendChild(this.imageElem),this.baseElement.setAttribute("width",this.assetData.w),this.baseElement.setAttribute("height",this.assetData.h)):this.layerElement.appendChild(_),_.crossOrigin="anonymous",_.src=P,this.data.ln&&this.baseElement.setAttribute("id",this.data.ln)};function HybridRendererBase(P,_){this.animationItem=P,this.layers=null,this.renderedFrame=-1,this.renderConfig={className:_&&_.className||"",imagePreserveAspectRatio:_&&_.imagePreserveAspectRatio||"xMidYMid slice",hideOnTransparent:!(_&&_.hideOnTransparent===!1),filterSize:{width:_&&_.filterSize&&_.filterSize.width||"400%",height:_&&_.filterSize&&_.filterSize.height||"400%",x:_&&_.filterSize&&_.filterSize.x||"-100%",y:_&&_.filterSize&&_.filterSize.y||"-100%"}},this.globalData={_mdf:!1,frameNum:-1,renderConfig:this.renderConfig},this.pendingElements=[],this.elements=[],this.threeDElements=[],this.destroyed=!1,this.camera=null,this.supports3d=!0,this.rendererType="html"}extendPrototype([BaseRenderer],HybridRendererBase),HybridRendererBase.prototype.buildItem=SVGRenderer.prototype.buildItem,HybridRendererBase.prototype.checkPendingElements=function(){for(;this.pendingElements.length;){var P=this.pendingElements.pop();P.checkParenting()}},HybridRendererBase.prototype.appendElementInPos=function(P,_){var C=P.getBaseElement();if(C){var A=this.layers[_];if(!A.ddd||!this.supports3d)if(this.threeDElements)this.addTo3dContainer(C,_);else{for(var T=0,E,I,F;T<_;)this.elements[T]&&this.elements[T]!==!0&&this.elements[T].getBaseElement&&(I=this.elements[T],F=this.layers[T].ddd?this.getThreeDContainerByPos(T):I.getBaseElement(),E=F||E),T+=1;E?(!A.ddd||!this.supports3d)&&this.layerElement.insertBefore(C,E):(!A.ddd||!this.supports3d)&&this.layerElement.appendChild(C)}else this.addTo3dContainer(C,_)}},HybridRendererBase.prototype.createShape=function(P){return this.supports3d?new HShapeElement(P,this.globalData,this):new SVGShapeElement(P,this.globalData,this)},HybridRendererBase.prototype.createText=function(P){return this.supports3d?new HTextElement(P,this.globalData,this):new SVGTextLottieElement(P,this.globalData,this)},HybridRendererBase.prototype.createCamera=function(P){return this.camera=new HCameraElement(P,this.globalData,this),this.camera},HybridRendererBase.prototype.createImage=function(P){return this.supports3d?new HImageElement(P,this.globalData,this):new IImageElement(P,this.globalData,this)},HybridRendererBase.prototype.createSolid=function(P){return this.supports3d?new HSolidElement(P,this.globalData,this):new ISolidElement(P,this.globalData,this)},HybridRendererBase.prototype.createNull=SVGRenderer.prototype.createNull,HybridRendererBase.prototype.getThreeDContainerByPos=function(P){for(var _=0,C=this.threeDElements.length;_<C;){if(this.threeDElements[_].startPos<=P&&this.threeDElements[_].endPos>=P)return this.threeDElements[_].perspectiveElem;_+=1}return null},HybridRendererBase.prototype.createThreeDContainer=function(P,_){var C=createTag("div"),A,T;styleDiv(C);var E=createTag("div");if(styleDiv(E),_==="3d"){A=C.style,A.width=this.globalData.compSize.w+"px",A.height=this.globalData.compSize.h+"px";var I="50% 50%";A.webkitTransformOrigin=I,A.mozTransformOrigin=I,A.transformOrigin=I,T=E.style;var F="matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)";T.transform=F,T.webkitTransform=F}C.appendChild(E);var B={container:E,perspectiveElem:C,startPos:P,endPos:P,type:_};return this.threeDElements.push(B),B},HybridRendererBase.prototype.build3dContainers=function(){var P,_=this.layers.length,C,A="";for(P=0;P<_;P+=1)this.layers[P].ddd&&this.layers[P].ty!==3?(A!=="3d"&&(A="3d",C=this.createThreeDContainer(P,"3d")),C.endPos=Math.max(C.endPos,P)):(A!=="2d"&&(A="2d",C=this.createThreeDContainer(P,"2d")),C.endPos=Math.max(C.endPos,P));for(_=this.threeDElements.length,P=_-1;P>=0;P-=1)this.resizerElem.appendChild(this.threeDElements[P].perspectiveElem)},HybridRendererBase.prototype.addTo3dContainer=function(P,_){for(var C=0,A=this.threeDElements.length;C<A;){if(_<=this.threeDElements[C].endPos){for(var T=this.threeDElements[C].startPos,E;T<_;)this.elements[T]&&this.elements[T].getBaseElement&&(E=this.elements[T].getBaseElement()),T+=1;E?this.threeDElements[C].container.insertBefore(P,E):this.threeDElements[C].container.appendChild(P);break}C+=1}},HybridRendererBase.prototype.configAnimation=function(P){var _=createTag("div"),C=this.animationItem.wrapper,A=_.style;A.width=P.w+"px",A.height=P.h+"px",this.resizerElem=_,styleDiv(_),A.transformStyle="flat",A.mozTransformStyle="flat",A.webkitTransformStyle="flat",this.renderConfig.className&&_.setAttribute("class",this.renderConfig.className),C.appendChild(_),A.overflow="hidden";var T=createNS("svg");T.setAttribute("width","1"),T.setAttribute("height","1"),styleDiv(T),this.resizerElem.appendChild(T);var E=createNS("defs");T.appendChild(E),this.data=P,this.setupGlobalData(P,T),this.globalData.defs=E,this.layers=P.layers,this.layerElement=this.resizerElem,this.build3dContainers(),this.updateContainerSize()},HybridRendererBase.prototype.destroy=function(){this.animationItem.wrapper&&(this.animationItem.wrapper.innerText=""),this.animationItem.container=null,this.globalData.defs=null;var P,_=this.layers?this.layers.length:0;for(P=0;P<_;P+=1)this.elements[P]&&this.elements[P].destroy&&this.elements[P].destroy();this.elements.length=0,this.destroyed=!0,this.animationItem=null},HybridRendererBase.prototype.updateContainerSize=function(){var P=this.animationItem.wrapper.offsetWidth,_=this.animationItem.wrapper.offsetHeight,C=P/_,A=this.globalData.compSize.w/this.globalData.compSize.h,T,E,I,F;A>C?(T=P/this.globalData.compSize.w,E=P/this.globalData.compSize.w,I=0,F=(_-this.globalData.compSize.h*(P/this.globalData.compSize.w))/2):(T=_/this.globalData.compSize.h,E=_/this.globalData.compSize.h,I=(P-this.globalData.compSize.w*(_/this.globalData.compSize.h))/2,F=0);var B=this.resizerElem.style;B.webkitTransform="matrix3d("+T+",0,0,0,0,"+E+",0,0,0,0,1,0,"+I+","+F+",0,1)",B.transform=B.webkitTransform},HybridRendererBase.prototype.renderFrame=SVGRenderer.prototype.renderFrame,HybridRendererBase.prototype.hide=function(){this.resizerElem.style.display="none"},HybridRendererBase.prototype.show=function(){this.resizerElem.style.display="block"},HybridRendererBase.prototype.initItems=function(){if(this.buildAllItems(),this.camera)this.camera.setup();else{var P=this.globalData.compSize.w,_=this.globalData.compSize.h,C,A=this.threeDElements.length;for(C=0;C<A;C+=1){var T=this.threeDElements[C].perspectiveElem.style;T.webkitPerspective=Math.sqrt(Math.pow(P,2)+Math.pow(_,2))+"px",T.perspective=T.webkitPerspective}}},HybridRendererBase.prototype.searchExtraCompositions=function(P){var _,C=P.length,A=createTag("div");for(_=0;_<C;_+=1)if(P[_].xt){var T=this.createComp(P[_],A,this.globalData.comp,null);T.initExpressions(),this.globalData.projectInterface.registerComposition(T)}};function HCompElement(P,_,C){this.layers=P.layers,this.supports3d=!P.hasMask,this.completeLayers=!1,this.pendingElements=[],this.elements=this.layers?createSizedArray(this.layers.length):[],this.initElement(P,_,C),this.tm=P.tm?PropertyFactory.getProp(this,P.tm,0,_.frameRate,this):{_placeholder:!0}}extendPrototype([HybridRendererBase,ICompElement,HBaseElement],HCompElement),HCompElement.prototype._createBaseContainerElements=HCompElement.prototype.createContainerElements,HCompElement.prototype.createContainerElements=function(){this._createBaseContainerElements(),this.data.hasMask?(this.svgElement.setAttribute("width",this.data.w),this.svgElement.setAttribute("height",this.data.h),this.transformedElement=this.baseElement):this.transformedElement=this.layerElement},HCompElement.prototype.addTo3dContainer=function(P,_){for(var C=0,A;C<_;)this.elements[C]&&this.elements[C].getBaseElement&&(A=this.elements[C].getBaseElement()),C+=1;A?this.layerElement.insertBefore(P,A):this.layerElement.appendChild(P)},HCompElement.prototype.createComp=function(P){return this.supports3d?new HCompElement(P,this.globalData,this):new SVGCompElement(P,this.globalData,this)};function HybridRenderer(P,_){this.animationItem=P,this.layers=null,this.renderedFrame=-1,this.renderConfig={className:_&&_.className||"",imagePreserveAspectRatio:_&&_.imagePreserveAspectRatio||"xMidYMid slice",hideOnTransparent:!(_&&_.hideOnTransparent===!1),filterSize:{width:_&&_.filterSize&&_.filterSize.width||"400%",height:_&&_.filterSize&&_.filterSize.height||"400%",x:_&&_.filterSize&&_.filterSize.x||"-100%",y:_&&_.filterSize&&_.filterSize.y||"-100%"},runExpressions:!_||_.runExpressions===void 0||_.runExpressions},this.globalData={_mdf:!1,frameNum:-1,renderConfig:this.renderConfig},this.pendingElements=[],this.elements=[],this.threeDElements=[],this.destroyed=!1,this.camera=null,this.supports3d=!0,this.rendererType="html"}extendPrototype([HybridRendererBase],HybridRenderer),HybridRenderer.prototype.createComp=function(P){return this.supports3d?new HCompElement(P,this.globalData,this):new SVGCompElement(P,this.globalData,this)};var CompExpressionInterface=function(){return function(P){function _(C){for(var A=0,T=P.layers.length;A<T;){if(P.layers[A].nm===C||P.layers[A].ind===C)return P.elements[A].layerInterface;A+=1}return null}return Object.defineProperty(_,"_name",{value:P.data.nm}),_.layer=_,_.pixelAspect=1,_.height=P.data.h||P.globalData.compSize.h,_.width=P.data.w||P.globalData.compSize.w,_.pixelAspect=1,_.frameDuration=1/P.globalData.frameRate,_.displayStartTime=0,_.numLayers=P.layers.length,_}}();function _typeof$2(P){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?_typeof$2=function(C){return typeof C}:_typeof$2=function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C},_typeof$2(P)}function seedRandom(P,_){var C=this,A=256,T=6,E=52,I="random",F=_.pow(A,T),B=_.pow(2,E),G=B*2,R=A-1,z;function D(Y,K,q){var J=[];K=K===!0?{entropy:!0}:K||{};var tt=U(V(K.entropy?[Y,X(P)]:Y===null?W():Y,3),J),rt=new L(J),st=function(){for(var at=rt.g(T),ot=F,ct=0;at<B;)at=(at+ct)*A,ot*=A,ct=rt.g(1);for(;at>=G;)at/=2,ot/=2,ct>>>=1;return(at+ct)/ot};return st.int32=function(){return rt.g(4)|0},st.quick=function(){return rt.g(4)/4294967296},st.double=st,U(X(rt.S),P),(K.pass||q||function(nt,at,ot,ct){return ct&&(ct.S&&O(ct,rt),nt.state=function(){return O(rt,{})}),ot?(_[I]=nt,at):nt})(st,tt,"global"in K?K.global:this==_,K.state)}_["seed"+I]=D;function L(Y){var K,q=Y.length,J=this,tt=0,rt=J.i=J.j=0,st=J.S=[];for(q||(Y=[q++]);tt<A;)st[tt]=tt++;for(tt=0;tt<A;tt++)st[tt]=st[rt=R&rt+Y[tt%q]+(K=st[tt])],st[rt]=K;J.g=function(nt){for(var at,ot=0,ct=J.i,dt=J.j,ut=J.S;nt--;)at=ut[ct=R&ct+1],ot=ot*A+ut[R&(ut[ct]=ut[dt=R&dt+at])+(ut[dt]=at)];return J.i=ct,J.j=dt,ot}}function O(Y,K){return K.i=Y.i,K.j=Y.j,K.S=Y.S.slice(),K}function V(Y,K){var q=[],J=_typeof$2(Y),tt;if(K&&J=="object")for(tt in Y)try{q.push(V(Y[tt],K-1))}catch{}return q.length?q:J=="string"?Y:Y+"\0"}function U(Y,K){for(var q=Y+"",J,tt=0;tt<q.length;)K[R&tt]=R&(J^=K[R&tt]*19)+q.charCodeAt(tt++);return X(K)}function W(){try{var Y=new Uint8Array(A);return(C.crypto||C.msCrypto).getRandomValues(Y),X(Y)}catch{var K=C.navigator,q=K&&K.plugins;return[+new Date,C,q,C.screen,X(P)]}}function X(Y){return String.fromCharCode.apply(0,Y)}U(_.random(),P)}function initialize$2(P){seedRandom([],P)}var propTypes={SHAPE:"shape"};function _typeof$1(P){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?_typeof$1=function(C){return typeof C}:_typeof$1=function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C},_typeof$1(P)}var ExpressionManager=function(){var ob={},Math=BMMath,window=null,document=null,XMLHttpRequest=null,fetch=null,frames=null,_lottieGlobal={};initialize$2(BMMath);function resetFrame(){_lottieGlobal={}}function $bm_isInstanceOfArray(P){return P.constructor===Array||P.constructor===Float32Array}function isNumerable(P,_){return P==="number"||_ instanceof Number||P==="boolean"||P==="string"}function $bm_neg(P){var _=_typeof$1(P);if(_==="number"||P instanceof Number||_==="boolean")return-P;if($bm_isInstanceOfArray(P)){var C,A=P.length,T=[];for(C=0;C<A;C+=1)T[C]=-P[C];return T}return P.propType?P.v:-P}var easeInBez=BezierFactory.getBezierEasing(.333,0,.833,.833,"easeIn").get,easeOutBez=BezierFactory.getBezierEasing(.167,.167,.667,1,"easeOut").get,easeInOutBez=BezierFactory.getBezierEasing(.33,0,.667,1,"easeInOut").get;function sum(P,_){var C=_typeof$1(P),A=_typeof$1(_);if(isNumerable(C,P)&&isNumerable(A,_)||C==="string"||A==="string")return P+_;if($bm_isInstanceOfArray(P)&&isNumerable(A,_))return P=P.slice(0),P[0]+=_,P;if(isNumerable(C,P)&&$bm_isInstanceOfArray(_))return _=_.slice(0),_[0]=P+_[0],_;if($bm_isInstanceOfArray(P)&&$bm_isInstanceOfArray(_)){for(var T=0,E=P.length,I=_.length,F=[];T<E||T<I;)(typeof P[T]=="number"||P[T]instanceof Number)&&(typeof _[T]=="number"||_[T]instanceof Number)?F[T]=P[T]+_[T]:F[T]=_[T]===void 0?P[T]:P[T]||_[T],T+=1;return F}return 0}var add=sum;function sub(P,_){var C=_typeof$1(P),A=_typeof$1(_);if(isNumerable(C,P)&&isNumerable(A,_))return C==="string"&&(P=parseInt(P,10)),A==="string"&&(_=parseInt(_,10)),P-_;if($bm_isInstanceOfArray(P)&&isNumerable(A,_))return P=P.slice(0),P[0]-=_,P;if(isNumerable(C,P)&&$bm_isInstanceOfArray(_))return _=_.slice(0),_[0]=P-_[0],_;if($bm_isInstanceOfArray(P)&&$bm_isInstanceOfArray(_)){for(var T=0,E=P.length,I=_.length,F=[];T<E||T<I;)(typeof P[T]=="number"||P[T]instanceof Number)&&(typeof _[T]=="number"||_[T]instanceof Number)?F[T]=P[T]-_[T]:F[T]=_[T]===void 0?P[T]:P[T]||_[T],T+=1;return F}return 0}function mul(P,_){var C=_typeof$1(P),A=_typeof$1(_),T;if(isNumerable(C,P)&&isNumerable(A,_))return P*_;var E,I;if($bm_isInstanceOfArray(P)&&isNumerable(A,_)){for(I=P.length,T=createTypedArray("float32",I),E=0;E<I;E+=1)T[E]=P[E]*_;return T}if(isNumerable(C,P)&&$bm_isInstanceOfArray(_)){for(I=_.length,T=createTypedArray("float32",I),E=0;E<I;E+=1)T[E]=P*_[E];return T}return 0}function div(P,_){var C=_typeof$1(P),A=_typeof$1(_),T;if(isNumerable(C,P)&&isNumerable(A,_))return P/_;var E,I;if($bm_isInstanceOfArray(P)&&isNumerable(A,_)){for(I=P.length,T=createTypedArray("float32",I),E=0;E<I;E+=1)T[E]=P[E]/_;return T}if(isNumerable(C,P)&&$bm_isInstanceOfArray(_)){for(I=_.length,T=createTypedArray("float32",I),E=0;E<I;E+=1)T[E]=P/_[E];return T}return 0}function mod(P,_){return typeof P=="string"&&(P=parseInt(P,10)),typeof _=="string"&&(_=parseInt(_,10)),P%_}var $bm_sum=sum,$bm_sub=sub,$bm_mul=mul,$bm_div=div,$bm_mod=mod;function clamp(P,_,C){if(_>C){var A=C;C=_,_=A}return Math.min(Math.max(P,_),C)}function radiansToDegrees(P){return P/degToRads}var radians_to_degrees=radiansToDegrees;function degreesToRadians(P){return P*degToRads}var degrees_to_radians=radiansToDegrees,helperLengthArray=[0,0,0,0,0,0];function length(P,_){if(typeof P=="number"||P instanceof Number)return _=_||0,Math.abs(P-_);_||(_=helperLengthArray);var C,A=Math.min(P.length,_.length),T=0;for(C=0;C<A;C+=1)T+=Math.pow(_[C]-P[C],2);return Math.sqrt(T)}function normalize(P){return div(P,length(P))}function rgbToHsl(P){var _=P[0],C=P[1],A=P[2],T=Math.max(_,C,A),E=Math.min(_,C,A),I,F,B=(T+E)/2;if(T===E)I=0,F=0;else{var G=T-E;switch(F=B>.5?G/(2-T-E):G/(T+E),T){case _:I=(C-A)/G+(C<A?6:0);break;case C:I=(A-_)/G+2;break;case A:I=(_-C)/G+4;break}I/=6}return[I,F,B,P[3]]}function hue2rgb(P,_,C){return C<0&&(C+=1),C>1&&(C-=1),C<1/6?P+(_-P)*6*C:C<1/2?_:C<2/3?P+(_-P)*(2/3-C)*6:P}function hslToRgb(P){var _=P[0],C=P[1],A=P[2],T,E,I;if(C===0)T=A,I=A,E=A;else{var F=A<.5?A*(1+C):A+C-A*C,B=2*A-F;T=hue2rgb(B,F,_+1/3),E=hue2rgb(B,F,_),I=hue2rgb(B,F,_-1/3)}return[T,E,I,P[3]]}function linear(P,_,C,A,T){if((A===void 0||T===void 0)&&(A=_,T=C,_=0,C=1),C<_){var E=C;C=_,_=E}if(P<=_)return A;if(P>=C)return T;var I=C===_?0:(P-_)/(C-_);if(!A.length)return A+(T-A)*I;var F,B=A.length,G=createTypedArray("float32",B);for(F=0;F<B;F+=1)G[F]=A[F]+(T[F]-A[F])*I;return G}function random(P,_){if(_===void 0&&(P===void 0?(P=0,_=1):(_=P,P=void 0)),_.length){var C,A=_.length;P||(P=createTypedArray("float32",A));var T=createTypedArray("float32",A),E=BMMath.random();for(C=0;C<A;C+=1)T[C]=P[C]+E*(_[C]-P[C]);return T}P===void 0&&(P=0);var I=BMMath.random();return P+I*(_-P)}function createPath(P,_,C,A){var T,E=P.length,I=shapePool.newElement();I.setPathData(!!A,E);var F=[0,0],B,G;for(T=0;T<E;T+=1)B=_&&_[T]?_[T]:F,G=C&&C[T]?C[T]:F,I.setTripleAt(P[T][0],P[T][1],G[0]+P[T][0],G[1]+P[T][1],B[0]+P[T][0],B[1]+P[T][1],T,!0);return I}function initiateExpression(elem,data,property){function noOp(P){return P}if(!elem.globalData.renderConfig.runExpressions)return noOp;var val=data.x,needsVelocity=/velocity(?![\w\d])/.test(val),_needsRandom=val.indexOf("random")!==-1,elemType=elem.data.ty,transform,$bm_transform,content,effect,thisProperty=property;thisProperty.valueAtTime=thisProperty.getValueAtTime,Object.defineProperty(thisProperty,"value",{get:function(){return thisProperty.v}}),elem.comp.frameDuration=1/elem.comp.globalData.frameRate,elem.comp.displayStartTime=0;var inPoint=elem.data.ip/elem.comp.globalData.frameRate,outPoint=elem.data.op/elem.comp.globalData.frameRate,width=elem.data.sw?elem.data.sw:0,height=elem.data.sh?elem.data.sh:0,name=elem.data.nm,loopIn,loop_in,loopOut,loop_out,smooth,toWorld,fromWorld,fromComp,toComp,fromCompToSurface,position,rotation,anchorPoint,scale,thisLayer,thisComp,mask,valueAtTime,velocityAtTime,scoped_bm_rt,expression_function=eval("[function _expression_function(){"+val+";scoped_bm_rt=$bm_rt}]")[0],numKeys=property.kf?data.k.length:0,active=!this.data||this.data.hd!==!0,wiggle=(function P(_,C){var A,T,E=this.pv.length?this.pv.length:1,I=createTypedArray("float32",E);_=5;var F=Math.floor(time*_);for(A=0,T=0;A<F;){for(T=0;T<E;T+=1)I[T]+=-C+C*2*BMMath.random();A+=1}var B=time*_,G=B-Math.floor(B),R=createTypedArray("float32",E);if(E>1){for(T=0;T<E;T+=1)R[T]=this.pv[T]+I[T]+(-C+C*2*BMMath.random())*G;return R}return this.pv+I[0]+(-C+C*2*BMMath.random())*G}).bind(this);thisProperty.loopIn&&(loopIn=thisProperty.loopIn.bind(thisProperty),loop_in=loopIn),thisProperty.loopOut&&(loopOut=thisProperty.loopOut.bind(thisProperty),loop_out=loopOut),thisProperty.smooth&&(smooth=thisProperty.smooth.bind(thisProperty));function loopInDuration(P,_){return loopIn(P,_,!0)}function loopOutDuration(P,_){return loopOut(P,_,!0)}this.getValueAtTime&&(valueAtTime=this.getValueAtTime.bind(this)),this.getVelocityAtTime&&(velocityAtTime=this.getVelocityAtTime.bind(this));var comp=elem.comp.globalData.projectInterface.bind(elem.comp.globalData.projectInterface);function lookAt(P,_){var C=[_[0]-P[0],_[1]-P[1],_[2]-P[2]],A=Math.atan2(C[0],Math.sqrt(C[1]*C[1]+C[2]*C[2]))/degToRads,T=-Math.atan2(C[1],C[2])/degToRads;return[T,A,0]}function easeOut(P,_,C,A,T){return applyEase(easeOutBez,P,_,C,A,T)}function easeIn(P,_,C,A,T){return applyEase(easeInBez,P,_,C,A,T)}function ease(P,_,C,A,T){return applyEase(easeInOutBez,P,_,C,A,T)}function applyEase(P,_,C,A,T,E){T===void 0?(T=C,E=A):_=(_-C)/(A-C),_>1?_=1:_<0&&(_=0);var I=P(_);if($bm_isInstanceOfArray(T)){var F,B=T.length,G=createTypedArray("float32",B);for(F=0;F<B;F+=1)G[F]=(E[F]-T[F])*I+T[F];return G}return(E-T)*I+T}function nearestKey(P){var _,C=data.k.length,A,T;if(!data.k.length||typeof data.k[0]=="number")A=0,T=0;else if(A=-1,P*=elem.comp.globalData.frameRate,P<data.k[0].t)A=1,T=data.k[0].t;else{for(_=0;_<C-1;_+=1)if(P===data.k[_].t){A=_+1,T=data.k[_].t;break}else if(P>data.k[_].t&&P<data.k[_+1].t){P-data.k[_].t>data.k[_+1].t-P?(A=_+2,T=data.k[_+1].t):(A=_+1,T=data.k[_].t);break}A===-1&&(A=_+1,T=data.k[_].t)}var E={};return E.index=A,E.time=T/elem.comp.globalData.frameRate,E}function key(P){var _,C,A;if(!data.k.length||typeof data.k[0]=="number")throw new Error("The property has no keyframe at index "+P);P-=1,_={time:data.k[P].t/elem.comp.globalData.frameRate,value:[]};var T=Object.prototype.hasOwnProperty.call(data.k[P],"s")?data.k[P].s:data.k[P-1].e;for(A=T.length,C=0;C<A;C+=1)_[C]=T[C],_.value[C]=T[C];return _}function framesToTime(P,_){return _||(_=elem.comp.globalData.frameRate),P/_}function timeToFrames(P,_){return!P&&P!==0&&(P=time),_||(_=elem.comp.globalData.frameRate),P*_}function seedRandom(P){BMMath.seedrandom(randSeed+P)}function sourceRectAtTime(){return elem.sourceRectAtTime()}function substring(P,_){return typeof value=="string"?_===void 0?value.substring(P):value.substring(P,_):""}function substr(P,_){return typeof value=="string"?_===void 0?value.substr(P):value.substr(P,_):""}function posterizeTime(P){time=P===0?0:Math.floor(time*P)/P,value=valueAtTime(time)}var time,velocity,value,text,textIndex,textTotal,selectorValue,index=elem.data.ind,hasParent=!!(elem.hierarchy&&elem.hierarchy.length),parent,randSeed=Math.floor(Math.random()*1e6),globalData=elem.globalData;function executeExpression(P){return value=P,this.frameExpressionId===elem.globalData.frameId&&this.propType!=="textSelector"?value:(this.propType==="textSelector"&&(textIndex=this.textIndex,textTotal=this.textTotal,selectorValue=this.selectorValue),thisLayer||(text=elem.layerInterface.text,thisLayer=elem.layerInterface,thisComp=elem.comp.compInterface,toWorld=thisLayer.toWorld.bind(thisLayer),fromWorld=thisLayer.fromWorld.bind(thisLayer),fromComp=thisLayer.fromComp.bind(thisLayer),toComp=thisLayer.toComp.bind(thisLayer),mask=thisLayer.mask?thisLayer.mask.bind(thisLayer):null,fromCompToSurface=fromComp),transform||(transform=elem.layerInterface("ADBE Transform Group"),$bm_transform=transform,transform&&(anchorPoint=transform.anchorPoint)),elemType===4&&!content&&(content=thisLayer("ADBE Root Vectors Group")),effect||(effect=thisLayer(4)),hasParent=!!(elem.hierarchy&&elem.hierarchy.length),hasParent&&!parent&&(parent=elem.hierarchy[0].layerInterface),time=this.comp.renderedFrame/this.comp.globalData.frameRate,_needsRandom&&seedRandom(randSeed+time),needsVelocity&&(velocity=velocityAtTime(time)),expression_function(),this.frameExpressionId=elem.globalData.frameId,scoped_bm_rt=scoped_bm_rt.propType===propTypes.SHAPE?scoped_bm_rt.v:scoped_bm_rt,scoped_bm_rt)}return executeExpression.__preventDeadCodeRemoval=[$bm_transform,anchorPoint,time,velocity,inPoint,outPoint,width,height,name,loop_in,loop_out,smooth,toComp,fromCompToSurface,toWorld,fromWorld,mask,position,rotation,scale,thisComp,numKeys,active,wiggle,loopInDuration,loopOutDuration,comp,lookAt,easeOut,easeIn,ease,nearestKey,key,text,textIndex,textTotal,selectorValue,framesToTime,timeToFrames,sourceRectAtTime,substring,substr,posterizeTime,index,globalData],executeExpression}return ob.initiateExpression=initiateExpression,ob.__preventDeadCodeRemoval=[window,document,XMLHttpRequest,fetch,frames,$bm_neg,add,$bm_sum,$bm_sub,$bm_mul,$bm_div,$bm_mod,clamp,radians_to_degrees,degreesToRadians,degrees_to_radians,normalize,rgbToHsl,hslToRgb,linear,random,createPath,_lottieGlobal],ob.resetFrame=resetFrame,ob}(),Expressions=function(){var P={};P.initExpressions=_,P.resetFrame=ExpressionManager.resetFrame;function _(C){var A=0,T=[];function E(){A+=1}function I(){A-=1,A===0&&B()}function F(G){T.indexOf(G)===-1&&T.push(G)}function B(){var G,R=T.length;for(G=0;G<R;G+=1)T[G].release();T.length=0}C.renderer.compInterface=CompExpressionInterface(C.renderer),C.renderer.globalData.projectInterface.registerComposition(C.renderer),C.renderer.globalData.pushExpression=E,C.renderer.globalData.popExpression=I,C.renderer.globalData.registerExpressionProperty=F}return P}(),MaskManagerInterface=function(){function P(C,A){this._mask=C,this._data=A}Object.defineProperty(P.prototype,"maskPath",{get:function(){return this._mask.prop.k&&this._mask.prop.getValue(),this._mask.prop}}),Object.defineProperty(P.prototype,"maskOpacity",{get:function(){return this._mask.op.k&&this._mask.op.getValue(),this._mask.op.v*100}});var _=function(A){var T=createSizedArray(A.viewData.length),E,I=A.viewData.length;for(E=0;E<I;E+=1)T[E]=new P(A.viewData[E],A.masksProperties[E]);var F=function(G){for(E=0;E<I;){if(A.masksProperties[E].nm===G)return T[E];E+=1}return null};return F};return _}(),ExpressionPropertyInterface=function(){var P={pv:0,v:0,mult:1},_={pv:[0,0,0],v:[0,0,0],mult:1};function C(I,F,B){Object.defineProperty(I,"velocity",{get:function(){return F.getVelocityAtTime(F.comp.currentFrame)}}),I.numKeys=F.keyframes?F.keyframes.length:0,I.key=function(G){if(!I.numKeys)return 0;var R="";"s"in F.keyframes[G-1]?R=F.keyframes[G-1].s:"e"in F.keyframes[G-2]?R=F.keyframes[G-2].e:R=F.keyframes[G-2].s;var z=B==="unidimensional"?new Number(R):Object.assign({},R);return z.time=F.keyframes[G-1].t/F.elem.comp.globalData.frameRate,z.value=B==="unidimensional"?R[0]:R,z},I.valueAtTime=F.getValueAtTime,I.speedAtTime=F.getSpeedAtTime,I.velocityAtTime=F.getVelocityAtTime,I.propertyGroup=F.propertyGroup}function A(I){(!I||!("pv"in I))&&(I=P);var F=1/I.mult,B=I.pv*F,G=new Number(B);return G.value=B,C(G,I,"unidimensional"),function(){return I.k&&I.getValue(),B=I.v*F,G.value!==B&&(G=new Number(B),G.value=B,C(G,I,"unidimensional")),G}}function T(I){(!I||!("pv"in I))&&(I=_);var F=1/I.mult,B=I.data&&I.data.l||I.pv.length,G=createTypedArray("float32",B),R=createTypedArray("float32",B);return G.value=R,C(G,I,"multidimensional"),function(){I.k&&I.getValue();for(var z=0;z<B;z+=1)R[z]=I.v[z]*F,G[z]=R[z];return G}}function E(){return P}return function(I){return I?I.propType==="unidimensional"?A(I):T(I):E}}(),TransformExpressionInterface=function(){return function(P){function _(I){switch(I){case"scale":case"Scale":case"ADBE Scale":case 6:return _.scale;case"rotation":case"Rotation":case"ADBE Rotation":case"ADBE Rotate Z":case 10:return _.rotation;case"ADBE Rotate X":return _.xRotation;case"ADBE Rotate Y":return _.yRotation;case"position":case"Position":case"ADBE Position":case 2:return _.position;case"ADBE Position_0":return _.xPosition;case"ADBE Position_1":return _.yPosition;case"ADBE Position_2":return _.zPosition;case"anchorPoint":case"AnchorPoint":case"Anchor Point":case"ADBE AnchorPoint":case 1:return _.anchorPoint;case"opacity":case"Opacity":case 11:return _.opacity;default:return null}}Object.defineProperty(_,"rotation",{get:ExpressionPropertyInterface(P.r||P.rz)}),Object.defineProperty(_,"zRotation",{get:ExpressionPropertyInterface(P.rz||P.r)}),Object.defineProperty(_,"xRotation",{get:ExpressionPropertyInterface(P.rx)}),Object.defineProperty(_,"yRotation",{get:ExpressionPropertyInterface(P.ry)}),Object.defineProperty(_,"scale",{get:ExpressionPropertyInterface(P.s)});var C,A,T,E;return P.p?E=ExpressionPropertyInterface(P.p):(C=ExpressionPropertyInterface(P.px),A=ExpressionPropertyInterface(P.py),P.pz&&(T=ExpressionPropertyInterface(P.pz))),Object.defineProperty(_,"position",{get:function(){return P.p?E():[C(),A(),T?T():0]}}),Object.defineProperty(_,"xPosition",{get:ExpressionPropertyInterface(P.px)}),Object.defineProperty(_,"yPosition",{get:ExpressionPropertyInterface(P.py)}),Object.defineProperty(_,"zPosition",{get:ExpressionPropertyInterface(P.pz)}),Object.defineProperty(_,"anchorPoint",{get:ExpressionPropertyInterface(P.a)}),Object.defineProperty(_,"opacity",{get:ExpressionPropertyInterface(P.o)}),Object.defineProperty(_,"skew",{get:ExpressionPropertyInterface(P.sk)}),Object.defineProperty(_,"skewAxis",{get:ExpressionPropertyInterface(P.sa)}),Object.defineProperty(_,"orientation",{get:ExpressionPropertyInterface(P.or)}),_}}(),LayerExpressionInterface=function(){function P(G){var R=new Matrix;if(G!==void 0){var z=this._elem.finalTransform.mProp.getValueAtTime(G);z.clone(R)}else{var D=this._elem.finalTransform.mProp;D.applyToMatrix(R)}return R}function _(G,R){var z=this.getMatrix(R);return z.props[12]=0,z.props[13]=0,z.props[14]=0,this.applyPoint(z,G)}function C(G,R){var z=this.getMatrix(R);return this.applyPoint(z,G)}function A(G,R){var z=this.getMatrix(R);return z.props[12]=0,z.props[13]=0,z.props[14]=0,this.invertPoint(z,G)}function T(G,R){var z=this.getMatrix(R);return this.invertPoint(z,G)}function E(G,R){if(this._elem.hierarchy&&this._elem.hierarchy.length){var z,D=this._elem.hierarchy.length;for(z=0;z<D;z+=1)this._elem.hierarchy[z].finalTransform.mProp.applyToMatrix(G)}return G.applyToPointArray(R[0],R[1],R[2]||0)}function I(G,R){if(this._elem.hierarchy&&this._elem.hierarchy.length){var z,D=this._elem.hierarchy.length;for(z=0;z<D;z+=1)this._elem.hierarchy[z].finalTransform.mProp.applyToMatrix(G)}return G.inversePoint(R)}function F(G){var R=new Matrix;if(R.reset(),this._elem.finalTransform.mProp.applyToMatrix(R),this._elem.hierarchy&&this._elem.hierarchy.length){var z,D=this._elem.hierarchy.length;for(z=0;z<D;z+=1)this._elem.hierarchy[z].finalTransform.mProp.applyToMatrix(R);return R.inversePoint(G)}return R.inversePoint(G)}function B(){return[1,1,1,1]}return function(G){var R;function z(V){L.mask=new MaskManagerInterface(V,G)}function D(V){L.effect=V}function L(V){switch(V){case"ADBE Root Vectors Group":case"Contents":case 2:return L.shapeInterface;case 1:case 6:case"Transform":case"transform":case"ADBE Transform Group":return R;case 4:case"ADBE Effect Parade":case"effects":case"Effects":return L.effect;case"ADBE Text Properties":return L.textInterface;default:return null}}L.getMatrix=P,L.invertPoint=I,L.applyPoint=E,L.toWorld=C,L.toWorldVec=_,L.fromWorld=T,L.fromWorldVec=A,L.toComp=C,L.fromComp=F,L.sampleImage=B,L.sourceRectAtTime=G.sourceRectAtTime.bind(G),L._elem=G,R=TransformExpressionInterface(G.finalTransform.mProp);var O=getDescriptor(R,"anchorPoint");return Object.defineProperties(L,{hasParent:{get:function(){return G.hierarchy.length}},parent:{get:function(){return G.hierarchy[0].layerInterface}},rotation:getDescriptor(R,"rotation"),scale:getDescriptor(R,"scale"),position:getDescriptor(R,"position"),opacity:getDescriptor(R,"opacity"),anchorPoint:O,anchor_point:O,transform:{get:function(){return R}},active:{get:function(){return G.isInRange}}}),L.startTime=G.data.st,L.index=G.data.ind,L.source=G.data.refId,L.height=G.data.ty===0?G.data.h:100,L.width=G.data.ty===0?G.data.w:100,L.inPoint=G.data.ip/G.comp.globalData.frameRate,L.outPoint=G.data.op/G.comp.globalData.frameRate,L._name=G.data.nm,L.registerMaskInterface=z,L.registerEffectsInterface=D,L}}(),propertyGroupFactory=function(){return function(P,_){return function(C){return C=C===void 0?1:C,C<=0?P:_(C-1)}}}(),PropertyInterface=function(){return function(P,_){var C={_name:P};function A(T){return T=T===void 0?1:T,T<=0?C:_(T-1)}return A}}(),EffectsExpressionInterface=function(){var P={createEffectsInterface:_};function _(T,E){if(T.effectsManager){var I=[],F=T.data.ef,B,G=T.effectsManager.effectElements.length;for(B=0;B<G;B+=1)I.push(C(F[B],T.effectsManager.effectElements[B],E,T));var R=T.data.ef||[],z=function(L){for(B=0,G=R.length;B<G;){if(L===R[B].nm||L===R[B].mn||L===R[B].ix)return I[B];B+=1}return null};return Object.defineProperty(z,"numProperties",{get:function(){return R.length}}),z}return null}function C(T,E,I,F){function B(L){for(var O=T.ef,V=0,U=O.length;V<U;){if(L===O[V].nm||L===O[V].mn||L===O[V].ix)return O[V].ty===5?R[V]:R[V]();V+=1}throw new Error}var G=propertyGroupFactory(B,I),R=[],z,D=T.ef.length;for(z=0;z<D;z+=1)T.ef[z].ty===5?R.push(C(T.ef[z],E.effectElements[z],E.effectElements[z].propertyGroup,F)):R.push(A(E.effectElements[z],T.ef[z].ty,F,G));return T.mn==="ADBE Color Control"&&Object.defineProperty(B,"color",{get:function(){return R[0]()}}),Object.defineProperties(B,{numProperties:{get:function(){return T.np}},_name:{value:T.nm},propertyGroup:{value:G}}),B.enabled=T.en!==0,B.active=B.enabled,B}function A(T,E,I,F){var B=ExpressionPropertyInterface(T.p);function G(){return E===10?I.comp.compInterface(T.p.v):B()}return T.p.setGroupProperty&&T.p.setGroupProperty(PropertyInterface("",F)),G}return P}(),ShapePathInterface=function(){return function(_,C,A){var T=C.sh;function E(F){return F==="Shape"||F==="shape"||F==="Path"||F==="path"||F==="ADBE Vector Shape"||F===2?E.path:null}var I=propertyGroupFactory(E,A);return T.setGroupProperty(PropertyInterface("Path",I)),Object.defineProperties(E,{path:{get:function(){return T.k&&T.getValue(),T}},shape:{get:function(){return T.k&&T.getValue(),T}},_name:{value:_.nm},ix:{value:_.ix},propertyIndex:{value:_.ix},mn:{value:_.mn},propertyGroup:{value:A}}),E}}(),ShapeExpressionInterface=function(){function P(O,V,U){var W=[],X,Y=O?O.length:0;for(X=0;X<Y;X+=1)O[X].ty==="gr"?W.push(C(O[X],V[X],U)):O[X].ty==="fl"?W.push(A(O[X],V[X],U)):O[X].ty==="st"?W.push(I(O[X],V[X],U)):O[X].ty==="tm"?W.push(F(O[X],V[X],U)):O[X].ty==="tr"||(O[X].ty==="el"?W.push(G(O[X],V[X],U)):O[X].ty==="sr"?W.push(R(O[X],V[X],U)):O[X].ty==="sh"?W.push(ShapePathInterface(O[X],V[X],U)):O[X].ty==="rc"?W.push(z(O[X],V[X],U)):O[X].ty==="rd"?W.push(D(O[X],V[X],U)):O[X].ty==="rp"?W.push(L(O[X],V[X],U)):O[X].ty==="gf"?W.push(T(O[X],V[X],U)):W.push(E(O[X],V[X])));return W}function _(O,V,U){var W,X=function(q){for(var J=0,tt=W.length;J<tt;){if(W[J]._name===q||W[J].mn===q||W[J].propertyIndex===q||W[J].ix===q||W[J].ind===q)return W[J];J+=1}return typeof q=="number"?W[q-1]:null};X.propertyGroup=propertyGroupFactory(X,U),W=P(O.it,V.it,X.propertyGroup),X.numProperties=W.length;var Y=B(O.it[O.it.length-1],V.it[V.it.length-1],X.propertyGroup);return X.transform=Y,X.propertyIndex=O.cix,X._name=O.nm,X}function C(O,V,U){var W=function(q){switch(q){case"ADBE Vectors Group":case"Contents":case 2:return W.content;default:return W.transform}};W.propertyGroup=propertyGroupFactory(W,U);var X=_(O,V,W.propertyGroup),Y=B(O.it[O.it.length-1],V.it[V.it.length-1],W.propertyGroup);return W.content=X,W.transform=Y,Object.defineProperty(W,"_name",{get:function(){return O.nm}}),W.numProperties=O.np,W.propertyIndex=O.ix,W.nm=O.nm,W.mn=O.mn,W}function A(O,V,U){function W(X){return X==="Color"||X==="color"?W.color:X==="Opacity"||X==="opacity"?W.opacity:null}return Object.defineProperties(W,{color:{get:ExpressionPropertyInterface(V.c)},opacity:{get:ExpressionPropertyInterface(V.o)},_name:{value:O.nm},mn:{value:O.mn}}),V.c.setGroupProperty(PropertyInterface("Color",U)),V.o.setGroupProperty(PropertyInterface("Opacity",U)),W}function T(O,V,U){function W(X){return X==="Start Point"||X==="start point"?W.startPoint:X==="End Point"||X==="end point"?W.endPoint:X==="Opacity"||X==="opacity"?W.opacity:null}return Object.defineProperties(W,{startPoint:{get:ExpressionPropertyInterface(V.s)},endPoint:{get:ExpressionPropertyInterface(V.e)},opacity:{get:ExpressionPropertyInterface(V.o)},type:{get:function(){return"a"}},_name:{value:O.nm},mn:{value:O.mn}}),V.s.setGroupProperty(PropertyInterface("Start Point",U)),V.e.setGroupProperty(PropertyInterface("End Point",U)),V.o.setGroupProperty(PropertyInterface("Opacity",U)),W}function E(){function O(){return null}return O}function I(O,V,U){var W=propertyGroupFactory(tt,U),X=propertyGroupFactory(J,W);function Y(rt){Object.defineProperty(J,O.d[rt].nm,{get:ExpressionPropertyInterface(V.d.dataProps[rt].p)})}var K,q=O.d?O.d.length:0,J={};for(K=0;K<q;K+=1)Y(K),V.d.dataProps[K].p.setGroupProperty(X);function tt(rt){return rt==="Color"||rt==="color"?tt.color:rt==="Opacity"||rt==="opacity"?tt.opacity:rt==="Stroke Width"||rt==="stroke width"?tt.strokeWidth:null}return Object.defineProperties(tt,{color:{get:ExpressionPropertyInterface(V.c)},opacity:{get:ExpressionPropertyInterface(V.o)},strokeWidth:{get:ExpressionPropertyInterface(V.w)},dash:{get:function(){return J}},_name:{value:O.nm},mn:{value:O.mn}}),V.c.setGroupProperty(PropertyInterface("Color",W)),V.o.setGroupProperty(PropertyInterface("Opacity",W)),V.w.setGroupProperty(PropertyInterface("Stroke Width",W)),tt}function F(O,V,U){function W(Y){return Y===O.e.ix||Y==="End"||Y==="end"?W.end:Y===O.s.ix?W.start:Y===O.o.ix?W.offset:null}var X=propertyGroupFactory(W,U);return W.propertyIndex=O.ix,V.s.setGroupProperty(PropertyInterface("Start",X)),V.e.setGroupProperty(PropertyInterface("End",X)),V.o.setGroupProperty(PropertyInterface("Offset",X)),W.propertyIndex=O.ix,W.propertyGroup=U,Object.defineProperties(W,{start:{get:ExpressionPropertyInterface(V.s)},end:{get:ExpressionPropertyInterface(V.e)},offset:{get:ExpressionPropertyInterface(V.o)},_name:{value:O.nm}}),W.mn=O.mn,W}function B(O,V,U){function W(Y){return O.a.ix===Y||Y==="Anchor Point"?W.anchorPoint:O.o.ix===Y||Y==="Opacity"?W.opacity:O.p.ix===Y||Y==="Position"?W.position:O.r.ix===Y||Y==="Rotation"||Y==="ADBE Vector Rotation"?W.rotation:O.s.ix===Y||Y==="Scale"?W.scale:O.sk&&O.sk.ix===Y||Y==="Skew"?W.skew:O.sa&&O.sa.ix===Y||Y==="Skew Axis"?W.skewAxis:null}var X=propertyGroupFactory(W,U);return V.transform.mProps.o.setGroupProperty(PropertyInterface("Opacity",X)),V.transform.mProps.p.setGroupProperty(PropertyInterface("Position",X)),V.transform.mProps.a.setGroupProperty(PropertyInterface("Anchor Point",X)),V.transform.mProps.s.setGroupProperty(PropertyInterface("Scale",X)),V.transform.mProps.r.setGroupProperty(PropertyInterface("Rotation",X)),V.transform.mProps.sk&&(V.transform.mProps.sk.setGroupProperty(PropertyInterface("Skew",X)),V.transform.mProps.sa.setGroupProperty(PropertyInterface("Skew Angle",X))),V.transform.op.setGroupProperty(PropertyInterface("Opacity",X)),Object.defineProperties(W,{opacity:{get:ExpressionPropertyInterface(V.transform.mProps.o)},position:{get:ExpressionPropertyInterface(V.transform.mProps.p)},anchorPoint:{get:ExpressionPropertyInterface(V.transform.mProps.a)},scale:{get:ExpressionPropertyInterface(V.transform.mProps.s)},rotation:{get:ExpressionPropertyInterface(V.transform.mProps.r)},skew:{get:ExpressionPropertyInterface(V.transform.mProps.sk)},skewAxis:{get:ExpressionPropertyInterface(V.transform.mProps.sa)},_name:{value:O.nm}}),W.ty="tr",W.mn=O.mn,W.propertyGroup=U,W}function G(O,V,U){function W(K){return O.p.ix===K?W.position:O.s.ix===K?W.size:null}var X=propertyGroupFactory(W,U);W.propertyIndex=O.ix;var Y=V.sh.ty==="tm"?V.sh.prop:V.sh;return Y.s.setGroupProperty(PropertyInterface("Size",X)),Y.p.setGroupProperty(PropertyInterface("Position",X)),Object.defineProperties(W,{size:{get:ExpressionPropertyInterface(Y.s)},position:{get:ExpressionPropertyInterface(Y.p)},_name:{value:O.nm}}),W.mn=O.mn,W}function R(O,V,U){function W(K){return O.p.ix===K?W.position:O.r.ix===K?W.rotation:O.pt.ix===K?W.points:O.or.ix===K||K==="ADBE Vector Star Outer Radius"?W.outerRadius:O.os.ix===K?W.outerRoundness:O.ir&&(O.ir.ix===K||K==="ADBE Vector Star Inner Radius")?W.innerRadius:O.is&&O.is.ix===K?W.innerRoundness:null}var X=propertyGroupFactory(W,U),Y=V.sh.ty==="tm"?V.sh.prop:V.sh;return W.propertyIndex=O.ix,Y.or.setGroupProperty(PropertyInterface("Outer Radius",X)),Y.os.setGroupProperty(PropertyInterface("Outer Roundness",X)),Y.pt.setGroupProperty(PropertyInterface("Points",X)),Y.p.setGroupProperty(PropertyInterface("Position",X)),Y.r.setGroupProperty(PropertyInterface("Rotation",X)),O.ir&&(Y.ir.setGroupProperty(PropertyInterface("Inner Radius",X)),Y.is.setGroupProperty(PropertyInterface("Inner Roundness",X))),Object.defineProperties(W,{position:{get:ExpressionPropertyInterface(Y.p)},rotation:{get:ExpressionPropertyInterface(Y.r)},points:{get:ExpressionPropertyInterface(Y.pt)},outerRadius:{get:ExpressionPropertyInterface(Y.or)},outerRoundness:{get:ExpressionPropertyInterface(Y.os)},innerRadius:{get:ExpressionPropertyInterface(Y.ir)},innerRoundness:{get:ExpressionPropertyInterface(Y.is)},_name:{value:O.nm}}),W.mn=O.mn,W}function z(O,V,U){function W(K){return O.p.ix===K?W.position:O.r.ix===K?W.roundness:O.s.ix===K||K==="Size"||K==="ADBE Vector Rect Size"?W.size:null}var X=propertyGroupFactory(W,U),Y=V.sh.ty==="tm"?V.sh.prop:V.sh;return W.propertyIndex=O.ix,Y.p.setGroupProperty(PropertyInterface("Position",X)),Y.s.setGroupProperty(PropertyInterface("Size",X)),Y.r.setGroupProperty(PropertyInterface("Rotation",X)),Object.defineProperties(W,{position:{get:ExpressionPropertyInterface(Y.p)},roundness:{get:ExpressionPropertyInterface(Y.r)},size:{get:ExpressionPropertyInterface(Y.s)},_name:{value:O.nm}}),W.mn=O.mn,W}function D(O,V,U){function W(K){return O.r.ix===K||K==="Round Corners 1"?W.radius:null}var X=propertyGroupFactory(W,U),Y=V;return W.propertyIndex=O.ix,Y.rd.setGroupProperty(PropertyInterface("Radius",X)),Object.defineProperties(W,{radius:{get:ExpressionPropertyInterface(Y.rd)},_name:{value:O.nm}}),W.mn=O.mn,W}function L(O,V,U){function W(K){return O.c.ix===K||K==="Copies"?W.copies:O.o.ix===K||K==="Offset"?W.offset:null}var X=propertyGroupFactory(W,U),Y=V;return W.propertyIndex=O.ix,Y.c.setGroupProperty(PropertyInterface("Copies",X)),Y.o.setGroupProperty(PropertyInterface("Offset",X)),Object.defineProperties(W,{copies:{get:ExpressionPropertyInterface(Y.c)},offset:{get:ExpressionPropertyInterface(Y.o)},_name:{value:O.nm}}),W.mn=O.mn,W}return function(O,V,U){var W;function X(K){if(typeof K=="number")return K=K===void 0?1:K,K===0?U:W[K-1];for(var q=0,J=W.length;q<J;){if(W[q]._name===K)return W[q];q+=1}return null}function Y(){return U}return X.propertyGroup=propertyGroupFactory(X,Y),W=P(O,V,X.propertyGroup),X.numProperties=W.length,X._name="Contents",X}}(),TextExpressionInterface=function(){return function(P){var _;function C(A){switch(A){case"ADBE Text Document":return C.sourceText;default:return null}}return Object.defineProperty(C,"sourceText",{get:function(){P.textProperty.getValue();var T=P.textProperty.currentData.t;return(!_||T!==_.value)&&(_=new String(T),_.value=T||new String(T),Object.defineProperty(_,"style",{get:function(){return{fillColor:P.textProperty.currentData.fc}}})),_}}),C}}();function _typeof(P){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?_typeof=function(C){return typeof C}:_typeof=function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C},_typeof(P)}var FootageInterface=function(){var P=function(A){var T="",E=A.getFootageData();function I(){return T="",E=A.getFootageData(),F}function F(B){if(E[B])return T=B,E=E[B],_typeof(E)==="object"?F:E;var G=B.indexOf(T);if(G!==-1){var R=parseInt(B.substr(G+T.length),10);return E=E[R],_typeof(E)==="object"?F:E}return""}return I},_=function(A){function T(E){return E==="Outline"?T.outlineInterface():null}return T._name="Outline",T.outlineInterface=P(A),T};return function(C){function A(T){return T==="Data"?A.dataInterface:null}return A._name="Data",A.dataInterface=_(C),A}}(),interfaces={layer:LayerExpressionInterface,effects:EffectsExpressionInterface,comp:CompExpressionInterface,shape:ShapeExpressionInterface,text:TextExpressionInterface,footage:FootageInterface};function getInterface(P){return interfaces[P]||null}var expressionHelpers=function(){function P(I,F,B){F.x&&(B.k=!0,B.x=!0,B.initiateExpression=ExpressionManager.initiateExpression,B.effectsSequence.push(B.initiateExpression(I,F,B).bind(B)))}function _(I){return I*=this.elem.globalData.frameRate,I-=this.offsetTime,I!==this._cachingAtTime.lastFrame&&(this._cachingAtTime.lastIndex=this._cachingAtTime.lastFrame<I?this._cachingAtTime.lastIndex:0,this._cachingAtTime.value=this.interpolateValue(I,this._cachingAtTime),this._cachingAtTime.lastFrame=I),this._cachingAtTime.value}function C(I){var F=-.01,B=this.getValueAtTime(I),G=this.getValueAtTime(I+F),R=0;if(B.length){var z;for(z=0;z<B.length;z+=1)R+=Math.pow(G[z]-B[z],2);R=Math.sqrt(R)*100}else R=0;return R}function A(I){if(this.vel!==void 0)return this.vel;var F=-.001,B=this.getValueAtTime(I),G=this.getValueAtTime(I+F),R;if(B.length){R=createTypedArray("float32",B.length);var z;for(z=0;z<B.length;z+=1)R[z]=(G[z]-B[z])/F}else R=(G-B)/F;return R}function T(){return this.pv}function E(I){this.propertyGroup=I}return{searchExpressions:P,getSpeedAtTime:C,getVelocityAtTime:A,getValueAtTime:_,getStaticValueAtTime:T,setGroupProperty:E}}();function addPropertyDecorator(){function P(D,L,O){if(!this.k||!this.keyframes)return this.pv;D=D?D.toLowerCase():"";var V=this.comp.renderedFrame,U=this.keyframes,W=U[U.length-1].t;if(V<=W)return this.pv;var X,Y;O?(L?X=Math.abs(W-this.elem.comp.globalData.frameRate*L):X=Math.max(0,W-this.elem.data.ip),Y=W-X):((!L||L>U.length-1)&&(L=U.length-1),Y=U[U.length-1-L].t,X=W-Y);var K,q,J;if(D==="pingpong"){var tt=Math.floor((V-Y)/X);if(tt%2!==0)return this.getValueAtTime((X-(V-Y)%X+Y)/this.comp.globalData.frameRate,0)}else if(D==="offset"){var rt=this.getValueAtTime(Y/this.comp.globalData.frameRate,0),st=this.getValueAtTime(W/this.comp.globalData.frameRate,0),nt=this.getValueAtTime(((V-Y)%X+Y)/this.comp.globalData.frameRate,0),at=Math.floor((V-Y)/X);if(this.pv.length){for(J=new Array(rt.length),q=J.length,K=0;K<q;K+=1)J[K]=(st[K]-rt[K])*at+nt[K];return J}return(st-rt)*at+nt}else if(D==="continue"){var ot=this.getValueAtTime(W/this.comp.globalData.frameRate,0),ct=this.getValueAtTime((W-.001)/this.comp.globalData.frameRate,0);if(this.pv.length){for(J=new Array(ot.length),q=J.length,K=0;K<q;K+=1)J[K]=ot[K]+(ot[K]-ct[K])*((V-W)/this.comp.globalData.frameRate)/5e-4;return J}return ot+(ot-ct)*((V-W)/.001)}return this.getValueAtTime(((V-Y)%X+Y)/this.comp.globalData.frameRate,0)}function _(D,L,O){if(!this.k)return this.pv;D=D?D.toLowerCase():"";var V=this.comp.renderedFrame,U=this.keyframes,W=U[0].t;if(V>=W)return this.pv;var X,Y;O?(L?X=Math.abs(this.elem.comp.globalData.frameRate*L):X=Math.max(0,this.elem.data.op-W),Y=W+X):((!L||L>U.length-1)&&(L=U.length-1),Y=U[L].t,X=Y-W);var K,q,J;if(D==="pingpong"){var tt=Math.floor((W-V)/X);if(tt%2===0)return this.getValueAtTime(((W-V)%X+W)/this.comp.globalData.frameRate,0)}else if(D==="offset"){var rt=this.getValueAtTime(W/this.comp.globalData.frameRate,0),st=this.getValueAtTime(Y/this.comp.globalData.frameRate,0),nt=this.getValueAtTime((X-(W-V)%X+W)/this.comp.globalData.frameRate,0),at=Math.floor((W-V)/X)+1;if(this.pv.length){for(J=new Array(rt.length),q=J.length,K=0;K<q;K+=1)J[K]=nt[K]-(st[K]-rt[K])*at;return J}return nt-(st-rt)*at}else if(D==="continue"){var ot=this.getValueAtTime(W/this.comp.globalData.frameRate,0),ct=this.getValueAtTime((W+.001)/this.comp.globalData.frameRate,0);if(this.pv.length){for(J=new Array(ot.length),q=J.length,K=0;K<q;K+=1)J[K]=ot[K]+(ot[K]-ct[K])*(W-V)/.001;return J}return ot+(ot-ct)*(W-V)/.001}return this.getValueAtTime((X-((W-V)%X+W))/this.comp.globalData.frameRate,0)}function C(D,L){if(!this.k)return this.pv;if(D=(D||.4)*.5,L=Math.floor(L||5),L<=1)return this.pv;var O=this.comp.renderedFrame/this.comp.globalData.frameRate,V=O-D,U=O+D,W=L>1?(U-V)/(L-1):1,X=0,Y=0,K;this.pv.length?K=createTypedArray("float32",this.pv.length):K=0;for(var q;X<L;){if(q=this.getValueAtTime(V+X*W),this.pv.length)for(Y=0;Y<this.pv.length;Y+=1)K[Y]+=q[Y];else K+=q;X+=1}if(this.pv.length)for(Y=0;Y<this.pv.length;Y+=1)K[Y]/=L;else K/=L;return K}function A(D){this._transformCachingAtTime||(this._transformCachingAtTime={v:new Matrix});var L=this._transformCachingAtTime.v;if(L.cloneFromProps(this.pre.props),this.appliedTransformations<1){var O=this.a.getValueAtTime(D);L.translate(-O[0]*this.a.mult,-O[1]*this.a.mult,O[2]*this.a.mult)}if(this.appliedTransformations<2){var V=this.s.getValueAtTime(D);L.scale(V[0]*this.s.mult,V[1]*this.s.mult,V[2]*this.s.mult)}if(this.sk&&this.appliedTransformations<3){var U=this.sk.getValueAtTime(D),W=this.sa.getValueAtTime(D);L.skewFromAxis(-U*this.sk.mult,W*this.sa.mult)}if(this.r&&this.appliedTransformations<4){var X=this.r.getValueAtTime(D);L.rotate(-X*this.r.mult)}else if(!this.r&&this.appliedTransformations<4){var Y=this.rz.getValueAtTime(D),K=this.ry.getValueAtTime(D),q=this.rx.getValueAtTime(D),J=this.or.getValueAtTime(D);L.rotateZ(-Y*this.rz.mult).rotateY(K*this.ry.mult).rotateX(q*this.rx.mult).rotateZ(-J[2]*this.or.mult).rotateY(J[1]*this.or.mult).rotateX(J[0]*this.or.mult)}if(this.data.p&&this.data.p.s){var tt=this.px.getValueAtTime(D),rt=this.py.getValueAtTime(D);if(this.data.p.z){var st=this.pz.getValueAtTime(D);L.translate(tt*this.px.mult,rt*this.py.mult,-st*this.pz.mult)}else L.translate(tt*this.px.mult,rt*this.py.mult,0)}else{var nt=this.p.getValueAtTime(D);L.translate(nt[0]*this.p.mult,nt[1]*this.p.mult,-nt[2]*this.p.mult)}return L}function T(){return this.v.clone(new Matrix)}var E=TransformPropertyFactory.getTransformProperty;TransformPropertyFactory.getTransformProperty=function(D,L,O){var V=E(D,L,O);return V.dynamicProperties.length?V.getValueAtTime=A.bind(V):V.getValueAtTime=T.bind(V),V.setGroupProperty=expressionHelpers.setGroupProperty,V};var I=PropertyFactory.getProp;PropertyFactory.getProp=function(D,L,O,V,U){var W=I(D,L,O,V,U);W.kf?W.getValueAtTime=expressionHelpers.getValueAtTime.bind(W):W.getValueAtTime=expressionHelpers.getStaticValueAtTime.bind(W),W.setGroupProperty=expressionHelpers.setGroupProperty,W.loopOut=P,W.loopIn=_,W.smooth=C,W.getVelocityAtTime=expressionHelpers.getVelocityAtTime.bind(W),W.getSpeedAtTime=expressionHelpers.getSpeedAtTime.bind(W),W.numKeys=L.a===1?L.k.length:0,W.propertyIndex=L.ix;var X=0;return O!==0&&(X=createTypedArray("float32",L.a===1?L.k[0].s.length:L.k.length)),W._cachingAtTime={lastFrame:initialDefaultFrame,lastIndex:0,value:X},expressionHelpers.searchExpressions(D,L,W),W.k&&U.addDynamicProperty(W),W};function F(D){return this._cachingAtTime||(this._cachingAtTime={shapeValue:shapePool.clone(this.pv),lastIndex:0,lastTime:initialDefaultFrame}),D*=this.elem.globalData.frameRate,D-=this.offsetTime,D!==this._cachingAtTime.lastTime&&(this._cachingAtTime.lastIndex=this._cachingAtTime.lastTime<D?this._caching.lastIndex:0,this._cachingAtTime.lastTime=D,this.interpolateShape(D,this._cachingAtTime.shapeValue,this._cachingAtTime)),this._cachingAtTime.shapeValue}var B=ShapePropertyFactory.getConstructorFunction(),G=ShapePropertyFactory.getKeyframedConstructorFunction();function R(){}R.prototype={vertices:function(L,O){this.k&&this.getValue();var V=this.v;O!==void 0&&(V=this.getValueAtTime(O,0));var U,W=V._length,X=V[L],Y=V.v,K=createSizedArray(W);for(U=0;U<W;U+=1)L==="i"||L==="o"?K[U]=[X[U][0]-Y[U][0],X[U][1]-Y[U][1]]:K[U]=[X[U][0],X[U][1]];return K},points:function(L){return this.vertices("v",L)},inTangents:function(L){return this.vertices("i",L)},outTangents:function(L){return this.vertices("o",L)},isClosed:function(){return this.v.c},pointOnPath:function(L,O){var V=this.v;O!==void 0&&(V=this.getValueAtTime(O,0)),this._segmentsLength||(this._segmentsLength=bez.getSegmentsLength(V));for(var U=this._segmentsLength,W=U.lengths,X=U.totalLength*L,Y=0,K=W.length,q=0,J;Y<K;){if(q+W[Y].addedLength>X){var tt=Y,rt=V.c&&Y===K-1?0:Y+1,st=(X-q)/W[Y].addedLength;J=bez.getPointInSegment(V.v[tt],V.v[rt],V.o[tt],V.i[rt],st,W[Y]);break}else q+=W[Y].addedLength;Y+=1}return J||(J=V.c?[V.v[0][0],V.v[0][1]]:[V.v[V._length-1][0],V.v[V._length-1][1]]),J},vectorOnPath:function(L,O,V){L==1?L=this.v.c:L==0&&(L=.999);var U=this.pointOnPath(L,O),W=this.pointOnPath(L+.001,O),X=W[0]-U[0],Y=W[1]-U[1],K=Math.sqrt(Math.pow(X,2)+Math.pow(Y,2));if(K===0)return[0,0];var q=V==="tangent"?[X/K,Y/K]:[-Y/K,X/K];return q},tangentOnPath:function(L,O){return this.vectorOnPath(L,O,"tangent")},normalOnPath:function(L,O){return this.vectorOnPath(L,O,"normal")},setGroupProperty:expressionHelpers.setGroupProperty,getValueAtTime:expressionHelpers.getStaticValueAtTime},extendPrototype([R],B),extendPrototype([R],G),G.prototype.getValueAtTime=F,G.prototype.initiateExpression=ExpressionManager.initiateExpression;var z=ShapePropertyFactory.getShapeProp;ShapePropertyFactory.getShapeProp=function(D,L,O,V,U){var W=z(D,L,O,V,U);return W.propertyIndex=L.ix,W.lock=!1,O===3?expressionHelpers.searchExpressions(D,L.pt,W):O===4&&expressionHelpers.searchExpressions(D,L.ks,W),W.k&&D.addDynamicProperty(W),W}}function initialize$1(){addPropertyDecorator()}function addDecorator(){function P(){return this.data.d.x?(this.calculateExpression=ExpressionManager.initiateExpression.bind(this)(this.elem,this.data.d,this),this.addEffect(this.getExpressionValue.bind(this)),!0):null}TextProperty.prototype.getExpressionValue=function(_,C){var A=this.calculateExpression(C);if(_.t!==A){var T={};return this.copyData(T,_),T.t=A.toString(),T.__complete=!1,T}return _},TextProperty.prototype.searchProperty=function(){var _=this.searchKeyframes(),C=this.searchExpressions();return this.kf=_||C,this.kf},TextProperty.prototype.searchExpressions=P}function initialize(){addDecorator()}function SVGComposableEffect(){}SVGComposableEffect.prototype={createMergeNode:function P(_,C){var A=createNS("feMerge");A.setAttribute("result",_);var T,E;for(E=0;E<C.length;E+=1)T=createNS("feMergeNode"),T.setAttribute("in",C[E]),A.appendChild(T),A.appendChild(T);return A}};var linearFilterValue="0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0";function SVGTintFilter(P,_,C,A,T){this.filterManager=_;var E=createNS("feColorMatrix");E.setAttribute("type","matrix"),E.setAttribute("color-interpolation-filters","linearRGB"),E.setAttribute("values",linearFilterValue+" 1 0"),this.linearFilter=E,E.setAttribute("result",A+"_tint_1"),P.appendChild(E),E=createNS("feColorMatrix"),E.setAttribute("type","matrix"),E.setAttribute("color-interpolation-filters","sRGB"),E.setAttribute("values","1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"),E.setAttribute("result",A+"_tint_2"),P.appendChild(E),this.matrixFilter=E;var I=this.createMergeNode(A,[T,A+"_tint_1",A+"_tint_2"]);P.appendChild(I)}extendPrototype([SVGComposableEffect],SVGTintFilter),SVGTintFilter.prototype.renderFrame=function(P){if(P||this.filterManager._mdf){var _=this.filterManager.effectElements[0].p.v,C=this.filterManager.effectElements[1].p.v,A=this.filterManager.effectElements[2].p.v/100;this.linearFilter.setAttribute("values",linearFilterValue+" "+A+" 0"),this.matrixFilter.setAttribute("values",C[0]-_[0]+" 0 0 0 "+_[0]+" "+(C[1]-_[1])+" 0 0 0 "+_[1]+" "+(C[2]-_[2])+" 0 0 0 "+_[2]+" 0 0 0 1 0")}};function SVGFillFilter(P,_,C,A){this.filterManager=_;var T=createNS("feColorMatrix");T.setAttribute("type","matrix"),T.setAttribute("color-interpolation-filters","sRGB"),T.setAttribute("values","1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"),T.setAttribute("result",A),P.appendChild(T),this.matrixFilter=T}SVGFillFilter.prototype.renderFrame=function(P){if(P||this.filterManager._mdf){var _=this.filterManager.effectElements[2].p.v,C=this.filterManager.effectElements[6].p.v;this.matrixFilter.setAttribute("values","0 0 0 0 "+_[0]+" 0 0 0 0 "+_[1]+" 0 0 0 0 "+_[2]+" 0 0 0 "+C+" 0")}};function SVGStrokeEffect(P,_,C){this.initialized=!1,this.filterManager=_,this.elem=C,this.paths=[]}SVGStrokeEffect.prototype.initialize=function(){var P=this.elem.layerElement.children||this.elem.layerElement.childNodes,_,C,A,T;for(this.filterManager.effectElements[1].p.v===1?(T=this.elem.maskManager.masksProperties.length,A=0):(A=this.filterManager.effectElements[0].p.v-1,T=A+1),C=createNS("g"),C.setAttribute("fill","none"),C.setAttribute("stroke-linecap","round"),C.setAttribute("stroke-dashoffset",1),A;A<T;A+=1)_=createNS("path"),C.appendChild(_),this.paths.push({p:_,m:A});if(this.filterManager.effectElements[10].p.v===3){var E=createNS("mask"),I=createElementID();E.setAttribute("id",I),E.setAttribute("mask-type","alpha"),E.appendChild(C),this.elem.globalData.defs.appendChild(E);var F=createNS("g");for(F.setAttribute("mask","url("+getLocationHref()+"#"+I+")");P[0];)F.appendChild(P[0]);this.elem.layerElement.appendChild(F),this.masker=E,C.setAttribute("stroke","#fff")}else if(this.filterManager.effectElements[10].p.v===1||this.filterManager.effectElements[10].p.v===2){if(this.filterManager.effectElements[10].p.v===2)for(P=this.elem.layerElement.children||this.elem.layerElement.childNodes;P.length;)this.elem.layerElement.removeChild(P[0]);this.elem.layerElement.appendChild(C),this.elem.layerElement.removeAttribute("mask"),C.setAttribute("stroke","#fff")}this.initialized=!0,this.pathMasker=C},SVGStrokeEffect.prototype.renderFrame=function(P){this.initialized||this.initialize();var _,C=this.paths.length,A,T;for(_=0;_<C;_+=1)if(this.paths[_].m!==-1&&(A=this.elem.maskManager.viewData[this.paths[_].m],T=this.paths[_].p,(P||this.filterManager._mdf||A.prop._mdf)&&T.setAttribute("d",A.lastPath),P||this.filterManager.effectElements[9].p._mdf||this.filterManager.effectElements[4].p._mdf||this.filterManager.effectElements[7].p._mdf||this.filterManager.effectElements[8].p._mdf||A.prop._mdf)){var E;if(this.filterManager.effectElements[7].p.v!==0||this.filterManager.effectElements[8].p.v!==100){var I=Math.min(this.filterManager.effectElements[7].p.v,this.filterManager.effectElements[8].p.v)*.01,F=Math.max(this.filterManager.effectElements[7].p.v,this.filterManager.effectElements[8].p.v)*.01,B=T.getTotalLength();E="0 0 0 "+B*I+" ";var G=B*(F-I),R=1+this.filterManager.effectElements[4].p.v*2*this.filterManager.effectElements[9].p.v*.01,z=Math.floor(G/R),D;for(D=0;D<z;D+=1)E+="1 "+this.filterManager.effectElements[4].p.v*2*this.filterManager.effectElements[9].p.v*.01+" ";E+="0 "+B*10+" 0 0"}else E="1 "+this.filterManager.effectElements[4].p.v*2*this.filterManager.effectElements[9].p.v*.01;T.setAttribute("stroke-dasharray",E)}if((P||this.filterManager.effectElements[4].p._mdf)&&this.pathMasker.setAttribute("stroke-width",this.filterManager.effectElements[4].p.v*2),(P||this.filterManager.effectElements[6].p._mdf)&&this.pathMasker.setAttribute("opacity",this.filterManager.effectElements[6].p.v),(this.filterManager.effectElements[10].p.v===1||this.filterManager.effectElements[10].p.v===2)&&(P||this.filterManager.effectElements[3].p._mdf)){var L=this.filterManager.effectElements[3].p.v;this.pathMasker.setAttribute("stroke","rgb("+bmFloor(L[0]*255)+","+bmFloor(L[1]*255)+","+bmFloor(L[2]*255)+")")}};function SVGTritoneFilter(P,_,C,A){this.filterManager=_;var T=createNS("feColorMatrix");T.setAttribute("type","matrix"),T.setAttribute("color-interpolation-filters","linearRGB"),T.setAttribute("values","0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0"),P.appendChild(T);var E=createNS("feComponentTransfer");E.setAttribute("color-interpolation-filters","sRGB"),E.setAttribute("result",A),this.matrixFilter=E;var I=createNS("feFuncR");I.setAttribute("type","table"),E.appendChild(I),this.feFuncR=I;var F=createNS("feFuncG");F.setAttribute("type","table"),E.appendChild(F),this.feFuncG=F;var B=createNS("feFuncB");B.setAttribute("type","table"),E.appendChild(B),this.feFuncB=B,P.appendChild(E)}SVGTritoneFilter.prototype.renderFrame=function(P){if(P||this.filterManager._mdf){var _=this.filterManager.effectElements[0].p.v,C=this.filterManager.effectElements[1].p.v,A=this.filterManager.effectElements[2].p.v,T=A[0]+" "+C[0]+" "+_[0],E=A[1]+" "+C[1]+" "+_[1],I=A[2]+" "+C[2]+" "+_[2];this.feFuncR.setAttribute("tableValues",T),this.feFuncG.setAttribute("tableValues",E),this.feFuncB.setAttribute("tableValues",I)}};function SVGProLevelsFilter(P,_,C,A){this.filterManager=_;var T=this.filterManager.effectElements,E=createNS("feComponentTransfer");(T[10].p.k||T[10].p.v!==0||T[11].p.k||T[11].p.v!==1||T[12].p.k||T[12].p.v!==1||T[13].p.k||T[13].p.v!==0||T[14].p.k||T[14].p.v!==1)&&(this.feFuncR=this.createFeFunc("feFuncR",E)),(T[17].p.k||T[17].p.v!==0||T[18].p.k||T[18].p.v!==1||T[19].p.k||T[19].p.v!==1||T[20].p.k||T[20].p.v!==0||T[21].p.k||T[21].p.v!==1)&&(this.feFuncG=this.createFeFunc("feFuncG",E)),(T[24].p.k||T[24].p.v!==0||T[25].p.k||T[25].p.v!==1||T[26].p.k||T[26].p.v!==1||T[27].p.k||T[27].p.v!==0||T[28].p.k||T[28].p.v!==1)&&(this.feFuncB=this.createFeFunc("feFuncB",E)),(T[31].p.k||T[31].p.v!==0||T[32].p.k||T[32].p.v!==1||T[33].p.k||T[33].p.v!==1||T[34].p.k||T[34].p.v!==0||T[35].p.k||T[35].p.v!==1)&&(this.feFuncA=this.createFeFunc("feFuncA",E)),(this.feFuncR||this.feFuncG||this.feFuncB||this.feFuncA)&&(E.setAttribute("color-interpolation-filters","sRGB"),P.appendChild(E)),(T[3].p.k||T[3].p.v!==0||T[4].p.k||T[4].p.v!==1||T[5].p.k||T[5].p.v!==1||T[6].p.k||T[6].p.v!==0||T[7].p.k||T[7].p.v!==1)&&(E=createNS("feComponentTransfer"),E.setAttribute("color-interpolation-filters","sRGB"),E.setAttribute("result",A),P.appendChild(E),this.feFuncRComposed=this.createFeFunc("feFuncR",E),this.feFuncGComposed=this.createFeFunc("feFuncG",E),this.feFuncBComposed=this.createFeFunc("feFuncB",E))}SVGProLevelsFilter.prototype.createFeFunc=function(P,_){var C=createNS(P);return C.setAttribute("type","table"),_.appendChild(C),C},SVGProLevelsFilter.prototype.getTableValue=function(P,_,C,A,T){for(var E=0,I=256,F,B=Math.min(P,_),G=Math.max(P,_),R=Array.call(null,{length:I}),z,D=0,L=T-A,O=_-P;E<=256;)F=E/256,F<=B?z=O<0?T:A:F>=G?z=O<0?A:T:z=A+L*Math.pow((F-P)/O,1/C),R[D]=z,D+=1,E+=256/(I-1);return R.join(" ")},SVGProLevelsFilter.prototype.renderFrame=function(P){if(P||this.filterManager._mdf){var _,C=this.filterManager.effectElements;this.feFuncRComposed&&(P||C[3].p._mdf||C[4].p._mdf||C[5].p._mdf||C[6].p._mdf||C[7].p._mdf)&&(_=this.getTableValue(C[3].p.v,C[4].p.v,C[5].p.v,C[6].p.v,C[7].p.v),this.feFuncRComposed.setAttribute("tableValues",_),this.feFuncGComposed.setAttribute("tableValues",_),this.feFuncBComposed.setAttribute("tableValues",_)),this.feFuncR&&(P||C[10].p._mdf||C[11].p._mdf||C[12].p._mdf||C[13].p._mdf||C[14].p._mdf)&&(_=this.getTableValue(C[10].p.v,C[11].p.v,C[12].p.v,C[13].p.v,C[14].p.v),this.feFuncR.setAttribute("tableValues",_)),this.feFuncG&&(P||C[17].p._mdf||C[18].p._mdf||C[19].p._mdf||C[20].p._mdf||C[21].p._mdf)&&(_=this.getTableValue(C[17].p.v,C[18].p.v,C[19].p.v,C[20].p.v,C[21].p.v),this.feFuncG.setAttribute("tableValues",_)),this.feFuncB&&(P||C[24].p._mdf||C[25].p._mdf||C[26].p._mdf||C[27].p._mdf||C[28].p._mdf)&&(_=this.getTableValue(C[24].p.v,C[25].p.v,C[26].p.v,C[27].p.v,C[28].p.v),this.feFuncB.setAttribute("tableValues",_)),this.feFuncA&&(P||C[31].p._mdf||C[32].p._mdf||C[33].p._mdf||C[34].p._mdf||C[35].p._mdf)&&(_=this.getTableValue(C[31].p.v,C[32].p.v,C[33].p.v,C[34].p.v,C[35].p.v),this.feFuncA.setAttribute("tableValues",_))}};function SVGDropShadowEffect(P,_,C,A,T){var E=_.container.globalData.renderConfig.filterSize,I=_.data.fs||E;P.setAttribute("x",I.x||E.x),P.setAttribute("y",I.y||E.y),P.setAttribute("width",I.width||E.width),P.setAttribute("height",I.height||E.height),this.filterManager=_;var F=createNS("feGaussianBlur");F.setAttribute("in","SourceAlpha"),F.setAttribute("result",A+"_drop_shadow_1"),F.setAttribute("stdDeviation","0"),this.feGaussianBlur=F,P.appendChild(F);var B=createNS("feOffset");B.setAttribute("dx","25"),B.setAttribute("dy","0"),B.setAttribute("in",A+"_drop_shadow_1"),B.setAttribute("result",A+"_drop_shadow_2"),this.feOffset=B,P.appendChild(B);var G=createNS("feFlood");G.setAttribute("flood-color","#00ff00"),G.setAttribute("flood-opacity","1"),G.setAttribute("result",A+"_drop_shadow_3"),this.feFlood=G,P.appendChild(G);var R=createNS("feComposite");R.setAttribute("in",A+"_drop_shadow_3"),R.setAttribute("in2",A+"_drop_shadow_2"),R.setAttribute("operator","in"),R.setAttribute("result",A+"_drop_shadow_4"),P.appendChild(R);var z=this.createMergeNode(A,[A+"_drop_shadow_4",T]);P.appendChild(z)}extendPrototype([SVGComposableEffect],SVGDropShadowEffect),SVGDropShadowEffect.prototype.renderFrame=function(P){if(P||this.filterManager._mdf){if((P||this.filterManager.effectElements[4].p._mdf)&&this.feGaussianBlur.setAttribute("stdDeviation",this.filterManager.effectElements[4].p.v/4),P||this.filterManager.effectElements[0].p._mdf){var _=this.filterManager.effectElements[0].p.v;this.feFlood.setAttribute("flood-color",rgbToHex(Math.round(_[0]*255),Math.round(_[1]*255),Math.round(_[2]*255)))}if((P||this.filterManager.effectElements[1].p._mdf)&&this.feFlood.setAttribute("flood-opacity",this.filterManager.effectElements[1].p.v/255),P||this.filterManager.effectElements[2].p._mdf||this.filterManager.effectElements[3].p._mdf){var C=this.filterManager.effectElements[3].p.v,A=(this.filterManager.effectElements[2].p.v-90)*degToRads,T=C*Math.cos(A),E=C*Math.sin(A);this.feOffset.setAttribute("dx",T),this.feOffset.setAttribute("dy",E)}}};var _svgMatteSymbols=[];function SVGMatte3Effect(P,_,C){this.initialized=!1,this.filterManager=_,this.filterElem=P,this.elem=C,C.matteElement=createNS("g"),C.matteElement.appendChild(C.layerElement),C.matteElement.appendChild(C.transformedElement),C.baseElement=C.matteElement}SVGMatte3Effect.prototype.findSymbol=function(P){for(var _=0,C=_svgMatteSymbols.length;_<C;){if(_svgMatteSymbols[_]===P)return _svgMatteSymbols[_];_+=1}return null},SVGMatte3Effect.prototype.replaceInParent=function(P,_){var C=P.layerElement.parentNode;if(C){for(var A=C.children,T=0,E=A.length;T<E&&A[T]!==P.layerElement;)T+=1;var I;T<=E-2&&(I=A[T+1]);var F=createNS("use");F.setAttribute("href","#"+_),I?C.insertBefore(F,I):C.appendChild(F)}},SVGMatte3Effect.prototype.setElementAsMask=function(P,_){if(!this.findSymbol(_)){var C=createElementID(),A=createNS("mask");A.setAttribute("id",_.layerId),A.setAttribute("mask-type","alpha"),_svgMatteSymbols.push(_);var T=P.globalData.defs;T.appendChild(A);var E=createNS("symbol");E.setAttribute("id",C),this.replaceInParent(_,C),E.appendChild(_.layerElement),T.appendChild(E);var I=createNS("use");I.setAttribute("href","#"+C),A.appendChild(I),_.data.hd=!1,_.show()}P.setMatte(_.layerId)},SVGMatte3Effect.prototype.initialize=function(){for(var P=this.filterManager.effectElements[0].p.v,_=this.elem.comp.elements,C=0,A=_.length;C<A;)_[C]&&_[C].data.ind===P&&this.setElementAsMask(this.elem,_[C]),C+=1;this.initialized=!0},SVGMatte3Effect.prototype.renderFrame=function(){this.initialized||this.initialize()};function SVGGaussianBlurEffect(P,_,C,A){P.setAttribute("x","-100%"),P.setAttribute("y","-100%"),P.setAttribute("width","300%"),P.setAttribute("height","300%"),this.filterManager=_;var T=createNS("feGaussianBlur");T.setAttribute("result",A),P.appendChild(T),this.feGaussianBlur=T}SVGGaussianBlurEffect.prototype.renderFrame=function(P){if(P||this.filterManager._mdf){var _=.3,C=this.filterManager.effectElements[0].p.v*_,A=this.filterManager.effectElements[1].p.v,T=A==3?0:C,E=A==2?0:C;this.feGaussianBlur.setAttribute("stdDeviation",T+" "+E);var I=this.filterManager.effectElements[2].p.v==1?"wrap":"duplicate";this.feGaussianBlur.setAttribute("edgeMode",I)}};function TransformEffect(){}TransformEffect.prototype.init=function(P){this.effectsManager=P,this.type=effectTypes.TRANSFORM_EFFECT,this.matrix=new Matrix,this.opacity=-1,this._mdf=!1,this._opMdf=!1},TransformEffect.prototype.renderFrame=function(P){if(this._opMdf=!1,this._mdf=!1,P||this.effectsManager._mdf){var _=this.effectsManager.effectElements,C=_[0].p.v,A=_[1].p.v,T=_[2].p.v===1,E=_[3].p.v,I=T?E:_[4].p.v,F=_[5].p.v,B=_[6].p.v,G=_[7].p.v;this.matrix.reset(),this.matrix.translate(-C[0],-C[1],C[2]),this.matrix.scale(I*.01,E*.01,1),this.matrix.rotate(-G*degToRads),this.matrix.skewFromAxis(-F*degToRads,(B+90)*degToRads),this.matrix.translate(A[0],A[1],0),this._mdf=!0,this.opacity!==_[8].p.v&&(this.opacity=_[8].p.v,this._opMdf=!0)}};function SVGTransformEffect(P,_){this.init(_)}extendPrototype([TransformEffect],SVGTransformEffect);function CVTransformEffect(P){this.init(P)}return extendPrototype([TransformEffect],CVTransformEffect),registerRenderer("canvas",CanvasRenderer),registerRenderer("html",HybridRenderer),registerRenderer("svg",SVGRenderer),ShapeModifiers.registerModifier("tm",TrimModifier),ShapeModifiers.registerModifier("pb",PuckerAndBloatModifier),ShapeModifiers.registerModifier("rp",RepeaterModifier),ShapeModifiers.registerModifier("rd",RoundCornersModifier),ShapeModifiers.registerModifier("zz",ZigZagModifier),ShapeModifiers.registerModifier("op",OffsetPathModifier),setExpressionsPlugin(Expressions),setExpressionInterfaces(getInterface),initialize$1(),initialize(),registerEffect$1(20,SVGTintFilter,!0),registerEffect$1(21,SVGFillFilter,!0),registerEffect$1(22,SVGStrokeEffect,!1),registerEffect$1(23,SVGTritoneFilter,!0),registerEffect$1(24,SVGProLevelsFilter,!0),registerEffect$1(25,SVGDropShadowEffect,!0),registerEffect$1(28,SVGMatte3Effect,!1),registerEffect$1(29,SVGGaussianBlurEffect,!0),registerEffect$1(35,SVGTransformEffect,!1),registerEffect(35,CVTransformEffect),lottie})}(lottie$2,lottie$2.exports)),lottie$2.exports}var lottieExports=requireLottie();const lottie=getDefaultExportFromCjs(lottieExports);let passAnimationData=null;const getPassAnimationData=()=>passAnimationData,getBasePath=()=>window.location.pathname.startsWith("/game/flappy-plane")?"/game/flappy-plane":"";async function assetsPreload(){const P=getBasePath();Assets.addBundle("images",{background:`${P}/assets/images/background.png`,ground:`${P}/assets/images/groundDirt.png`,plane:`${P}/assets/images/plane.png`,rockTop:`${P}/assets/images/rockTop.png`,rockBottom:`${P}/assets/images/rockBottom.png`,groundTop:`${P}/assets/images/groundTop.png`,groundBottom:`${P}/assets/images/groundBottom.png`});try{await Assets.loadBundle("images");try{const _=await fetch(`${P}/assets/lottie/pass.json`);_.ok&&(passAnimationData=await _.json())}catch{}}catch(_){throw console.error("   :",_),_}}class PlayingScene extends Scene{constructor(_){super(_),Object.defineProperty(this,"player",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ground",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"obstacleManager",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"score",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"scoreContainer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"scoreBackground",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"scoreLabel",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"scoreValue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"hintContainer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"hintBackground",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"hintText",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"showDebugGraphics",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"gameController",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"scoreManager",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"animationContainer",{enumerable:!0,configurable:!0,writable:!0,value:null}),this.gameController=GameController.getInstance(),this.scoreManager=ScoreManager.getInstance()}initialize(){super.initialize(),this.setupGameElements(),this.setupScoreUI(),this.setupScoreEvents(),this.setupHintButton(),setTimeout(()=>{this.player.enableJumping()},500),this.gameController.startPhysics(),this.on("postrender",this.update.bind(this))}setupHintButton(){this.hintContainer=new Container,this.addChild(this.hintContainer),this.hintBackground=new Graphics,this.hintBackground.fill({color:16764928}),this.hintBackground.stroke({color:3028027,width:3}),this.hintBackground.roundRect(0,0,100,50,8),this.hintBackground.fill(),this.hintBackground.stroke(),this.hintContainer.position.set(DEFAULT_CONFIG.GAME_WIDTH-120,40),this.hintContainer.addChild(this.hintBackground);const _=new TextStyle({fontFamily:"Chicalo",fontSize:30,fill:"#31383e",align:"center"});this.hintText=new Text({text:"HINT",style:_}),this.hintText.position.set((this.hintBackground.width-this.hintText.width)/2,(this.hintBackground.height-this.hintText.height)/2),this.hintContainer.addChild(this.hintText),this.hintContainer.eventMode="static",this.hintContainer.cursor="pointer",this.hintContainer.on("pointerdown",C=>{C.stopPropagation(),this.player&&(this.player.isJumpBlocked=!0),this.toggleDebugGraphics()}),this.hintContainer.on("pointerup",()=>{this.player&&(this.player.isJumpBlocked=!1)}),this.hintContainer.on("pointerupoutside",()=>{this.player&&(this.player.isJumpBlocked=!1)})}toggleDebugGraphics(){this.showDebugGraphics=!this.showDebugGraphics,this.obstacleManager&&this.obstacleManager.setDebugGraphicsVisibility(this.showDebugGraphics)}setupScoreEvents(){this.scoreManager.on("scoreChanged",_=>{this.score=_,this.updateScoreDisplay(),_%5===0&&_>0&&this.playLevelUpAnimation()}),this.obstacleManager&&(this.obstacleManager.updateGapSize(this.score),this.obstacleManager.updateSpawnInterval(this.score))}playLevelUpAnimation(){const _=getPassAnimationData();if(!_)return;this.animationContainer&&(document.body.removeChild(this.animationContainer),this.animationContainer=null),this.animationContainer=document.createElement("div");const C=document.querySelector("canvas");if(!C){console.error("    .");return}const A=C.getBoundingClientRect(),T=A.left+A.width/2,E=A.top+A.height/2;this.animationContainer.style.position="absolute",this.animationContainer.style.left=`${T}px`,this.animationContainer.style.top=`${E}px`,this.animationContainer.style.transform="translate(-50%, -50%)",this.animationContainer.style.zIndex="1000",this.animationContainer.style.pointerEvents="none",document.body.appendChild(this.animationContainer);const I=lottie.loadAnimation({container:this.animationContainer,renderer:"svg",loop:!1,autoplay:!0,animationData:_,rendererSettings:{preserveAspectRatio:"xMidYMid meet"}});I.addEventListener("complete",()=>{this.animationContainer&&(document.body.removeChild(this.animationContainer),this.animationContainer=null)});const F=()=>{if(this.animationContainer){const B=C.getBoundingClientRect(),G=B.left+B.width/2,R=B.top+B.height/2;this.animationContainer.style.left=`${G}px`,this.animationContainer.style.top=`${R}px`}};window.addEventListener("resize",F),I.addEventListener("complete",()=>{window.removeEventListener("resize",F)})}setupGameElements(){this.obstacleManager=new ObstacleManager,this.addChild(this.obstacleManager),this.player=new Player,this.addChild(this.player),this.ground=new Ground,this.addChild(this.ground),this.gameController.setPlayer(this.player),this.gameController.setGround(this.ground),this.gameController.setObstacleManager(this.obstacleManager),this.gameController.on("scoreChanged",_=>{this.score=_,this.updateScoreDisplay()}),this.gameController.on("gameOver",_=>{console.log(" ,  :",_)})}setupScoreUI(){this.scoreContainer=new Container,this.addChild(this.scoreContainer),this.scoreBackground=new Graphics,this.scoreBackground.fill({color:16764928}),this.scoreBackground.stroke({color:3028027,width:3}),this.scoreBackground.roundRect(0,0,180,56,8),this.scoreBackground.fill(),this.scoreBackground.stroke(),this.scoreContainer.position.set(20,40),this.scoreContainer.addChild(this.scoreBackground);const _=new TextStyle({fontFamily:"Chicalo",fontSize:36,fill:"#31383e",align:"left"});this.scoreLabel=new Text({text:"SCORE",style:_}),this.scoreLabel.position.set(10,10),this.scoreContainer.addChild(this.scoreLabel);const C=new TextStyle({fontFamily:"Chicalo",fontSize:36,fill:"#ffffff",stroke:{color:"#31383e",width:3},align:"left"});this.scoreValue=new Text({text:"0",style:C}),this.scoreValue.position.set(this.scoreLabel.width+18,10),this.scoreContainer.addChild(this.scoreValue),this.updateScoreDisplay()}updateScoreDisplay(){this.scoreValue.text=this.score.toString()}update(_){super.update(_),this.obstacleManager&&this.obstacleManager.update(_,this.score),this.player&&this.player.update(_),this.ground&&this.ground.update(_),this.gameController.update()}reset(){this.scoreManager.resetScore(),this.removeChildren(),this.addCommonBackground(),this.setupGameElements(),this.setupScoreUI(),this.setupScoreEvents(),this.setupHintButton(),setTimeout(()=>{this.player.enableJumping()},500),this.gameController.startPhysics()}pause(){super.pause(),console.log("PlayingScene pause,  :",this.scoreManager.getScore()),this.gameController.stopPhysics()}}const{GAME_WIDTH:GAME_WIDTH$1,GAME_HEIGHT:GAME_HEIGHT$1}=DEFAULT_CONFIG;class GameOverScene extends Scene{constructor(_){super(_),Object.defineProperty(this,"scoreValue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"bestValue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"scoreManager",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.scoreManager=ScoreManager.getInstance(),this.scoreManager.on("scoreChanged",this.updateScoreDisplay.bind(this)),this.scoreManager.on("highScoreChanged",this.updateScoreDisplay.bind(this))}initialize(){super.initialize(),this.addGround(),this.addTitle(),this.addGameOverUI(),this.addRetryButton(),this.updateScoreDisplay()}updateScoreDisplay(){if(this.scoreValue){const _=this.scoreManager.getScore();this.scoreValue.text=_.toString()}this.bestValue&&(this.bestValue.text=this.scoreManager.getHighScore().toString())}addGameOverUI(){const _=new Graphics,C=335,A=200,T=(GAME_WIDTH$1-C)/2,E=(GAME_HEIGHT$1-A)/2;_.fill({color:9924938}),_.stroke({color:3028027,width:2}),_.roundRect(T,E,C,A,4),_.fill(),_.stroke();const I=4,F=56,B=new Graphics;B.fill({color:6375470}),B.rect(T+C/2-I/2,E+(A-F)/2,I,F),B.fill();const G=new Text({text:"SCORE",style:{fontFamily:"Chicalo",fontSize:36,fill:16777215,stroke:{color:0,width:6},align:"center"}});G.anchor.set(.5),G.position.set(T+C*.25,E+A*.35),this.scoreValue=new Text({text:this.scoreManager.getScore().toString(),style:{fontFamily:"Chicalo",fontSize:28,fill:16777215,stroke:{color:0,width:6},align:"center"}}),this.scoreValue.anchor.set(.5),this.scoreValue.position.set(T+C*.25,E+A*.6);const R=new Text({text:"BEST",style:{fontFamily:"Chicalo",fontSize:36,fill:16764928,stroke:{color:0,width:6},align:"center"}});R.anchor.set(.5),R.position.set(T+C*.75,E+A*.35);const z=new Text({text:this.scoreManager.getHighScore().toString(),style:{fontFamily:"Chicalo",fontSize:28,fill:16764928,stroke:{color:0,width:6},align:"center"}});z.anchor.set(.5),z.position.set(T+C*.75,E+A*.6),this.bestValue=z,this.addChild(_,B,G,this.scoreValue,R,this.bestValue)}addTitle(){const _=new Text({text:"GAME OVER",style:{fontFamily:"Chicalo",fontSize:64,fontWeight:"bold",fill:16777215,stroke:{color:3028027,width:5},align:"center",dropShadow:!0}});_.position.set(GAME_WIDTH$1/2,GAME_HEIGHT$1/4),_.anchor.set(.5),this.addChild(_)}addGround(){const _=Sprite.from("ground");_.anchor.set(0,1),_.position.set(0,GAME_HEIGHT$1),_.width=GAME_WIDTH$1,this.addChild(_)}addRetryButton(){const _=new Container;_.eventMode="static",_.cursor="pointer";const C=200,A=(GAME_HEIGHT$1-C)/2,T=150,E=60,I=GAME_WIDTH$1/2-T/2,F=A+C+60,B=new Graphics;B.fill({color:16730112}),B.stroke({color:0,width:3}),B.roundRect(0,0,T,E,8),B.fill(),B.stroke();const G=new Text({text:"RETRY",style:{fontFamily:"Chicalo",fontSize:36,fill:16777215,align:"center"}});G.anchor.set(.5),G.position.set(T/2,E/2),_.addChild(B,G),_.position.set(I,F),_.on("pointerdown",this.handleRetryClick.bind(this)),this.addChild(_)}handleRetryClick(_){GameController.getInstance().resetGame(),SceneController.getInstance().switchScene(SceneType.READY)}}class SceneController{constructor(){Object.defineProperty(this,"ticker",{enumerable:!0,configurable:!0,writable:!0,value:new Ticker}),Object.defineProperty(this,"sceneMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"stage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"currentScene",{enumerable:!0,configurable:!0,writable:!0,value:SceneType.READY})}static getInstance(){return SceneController.instance||(SceneController.instance=new SceneController),SceneController.instance}initialize(_){this.stage=_,this.initializeScene(),this.switchScene(SceneType.READY),this.ticker.stop(),this.ticker.add(this.update.bind(this)),this.ticker.start()}initializeScene(){this.sceneMap.set(SceneType.READY,new ReadyScene(this.stage)),this.sceneMap.set(SceneType.PLAYING,new PlayingScene(this.stage)),this.sceneMap.set(SceneType.GAMEOVER,new GameOverScene(this.stage))}switchScene(_){if(!this.stage)return;const C=this.sceneMap.get(this.currentScene);C&&(C.pause(),this.stage.removeChild(C)),this.currentScene=_;const A=this.sceneMap.get(this.currentScene);A&&(A.isInitialized?A.reset():A.initialize(),A.resume(),this.stage.addChild(A))}update(_){const C=_.deltaTime,A=this.sceneMap.get(this.currentScene);A!=null&&A.isEnable&&A.isInitialized&&A.update(C)}}const{GAME_WIDTH,GAME_HEIGHT}=DEFAULT_CONFIG;class App{constructor(){Kt(this,"app",new Application);Kt(this,"size",{width:0,height:0,scale:1})}async initialize(){this.size=calculateStageSize(GAME_WIDTH,GAME_HEIGHT),await this.app.init({width:this.size.width,height:this.size.height,background:"#333333"}),this.app.stage.scale.set(this.size.scale);const _=document.getElementById("app");_==null||_.appendChild(this.app.canvas),Logger.initialize("game/flappy-plane"),await assetsPreload(),SceneController.getInstance().initialize(this.app.stage),window.addEventListener("resize",()=>{this.size=calculateStageSize(GAME_WIDTH,GAME_HEIGHT),this.app.renderer.resize(this.size.width,this.size.height),this.app.stage.scale.set(this.size.scale)})}getApplication(){return this.app}}const app=new App;app.initialize();export{VERSION as $,AbstractRenderer as A,BufferUsage as B,Container as C,DOMAdapter as D,ExtensionType as E,Bounds as F,GpuProgram as G,TexturePool as H,FilterEffect as I,Sprite as J,getAttributeInfoFromFormat as K,unsafeEvalSupported as L,Matrix as M,uid as N,Rectangle as O,Point as P,SystemRunner as Q,RendererType as R,STENCIL_MODES as S,Ticker as T,UPDATE_PRIORITY as U,multiplyColors as V,UPDATE_VISIBLE as W,UPDATE_COLOR as X,UPDATE_BLEND as Y,Color as Z,getLocalBounds as _,EventEmitter as a,deprecation as a0,v8_0_0 as a1,RendererInitHook as a2,Geometry as a3,compileHighShaderGlProgram as a4,colorBitGl as a5,generateTextureBatchBitGl as a6,roundPixelsBitGl as a7,getBatchSamplersUniformGroup as a8,TextStyle as a9,generateTextStyleKey as aa,BatchableGraphics as ab,getAdjustedBlendModeBlend as ac,ViewableBuffer as ad,TextureStyle as ae,BitmapFontManager as af,getBitmapTextLayout as ag,Graphics as ah,Cache as ai,updateQuadBounds as aj,CanvasTextMetrics as ak,nextPow2 as al,fontStringFromTextStyle as am,getCanvasFillStyle as an,GraphicsContextSystem as ao,Buffer as b,BindGroup as c,createIdFromString as d,extensions as e,fastCopy as f,getTextureBatchBindGroup as g,CLEAR as h,CanvasSource as i,TextureSource as j,UniformGroup as k,CanvasPool as l,compileHighShaderGpuProgram as m,colorBit as n,generateTextureBatchBit as o,roundPixelsBit as p,getMaxTexturesPerBatch as q,removeItems as r,Shader as s,Texture as t,GlProgram as u,TextureMatrix as v,warn as w,DefaultBatcher as x,BigPool as y,getGlobalBounds as z};
